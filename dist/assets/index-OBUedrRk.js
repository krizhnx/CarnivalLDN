var Xo=Object.defineProperty;var qo=(a,l,c)=>l in a?Xo(a,l,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[l]=c;var Nr=(a,l,c)=>qo(a,typeof l!="symbol"?l+"":l,c);import{r as O,b as Zo,d as $o,g as Fs,R as pr,c as Is}from"./vendor-DBkyTrXJ.js";import{m as Y,X as Jt,M as Qo,A as oi,a as sn,P as Di,C as yt,b as Kt,c as br,U as Qe,d as Oi,B as Ko,H as Mi,S as li,e as Us,f as un,I as Jo,g as el,L as tl,h as Os,i as Gn,E as rl,j as hs,T as zn,k as sl,l as Wn,n as fs,G as nl,o as il,p as wa,q as va,D as Ms,R as Na,Q as al,r as Ca,s as Ds,t as Ri,u as Yn,v as Pt,w as Ea,x as Rs,y as Aa,z as Sa,F as ol,J as nn,K as an,N as ja,O as ll,V as Li,W as Ta,Y as cl,Z as dl}from"./ui-CHurANDC.js";import{c as ul}from"./supabase-Ci4t7mQq.js";import{u as Ia}from"./forms-BJrTRoZM.js";import{l as hl,E as fl,u as xl,a as ml,P as gl,C as Pi}from"./stripe-B3XGovRd.js";function pl(a,l){for(var c=0;c<l.length;c++){const u=l[c];if(typeof u!="string"&&!Array.isArray(u)){for(const h in u)if(h!=="default"&&!(h in a)){const f=Object.getOwnPropertyDescriptor(u,h);f&&Object.defineProperty(a,h,f.get?f:{enumerable:!0,get:()=>u[h]})}}}return Object.freeze(Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}))}(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))u(h);new MutationObserver(h=>{for(const f of h)if(f.type==="childList")for(const p of f.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&u(p)}).observe(document,{childList:!0,subtree:!0});function c(h){const f={};return h.integrity&&(f.integrity=h.integrity),h.referrerPolicy&&(f.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?f.credentials="include":h.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function u(h){if(h.ep)return;h.ep=!0;const f=c(h);fetch(h.href,f)}})();var _a={exports:{}},hn={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yl=O,bl=Symbol.for("react.element"),wl=Symbol.for("react.fragment"),vl=Object.prototype.hasOwnProperty,Nl=yl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Cl={key:!0,ref:!0,__self:!0,__source:!0};function ka(a,l,c){var u,h={},f=null,p=null;c!==void 0&&(f=""+c),l.key!==void 0&&(f=""+l.key),l.ref!==void 0&&(p=l.ref);for(u in l)vl.call(l,u)&&!Cl.hasOwnProperty(u)&&(h[u]=l[u]);if(a&&a.defaultProps)for(u in l=a.defaultProps,l)h[u]===void 0&&(h[u]=l[u]);return{$$typeof:bl,type:a,key:f,ref:p,props:h,_owner:Nl.current}}hn.Fragment=wl;hn.jsx=ka;hn.jsxs=ka;_a.exports=hn;var r=_a.exports,Xn={},Bi=Zo;Xn.createRoot=Bi.createRoot,Xn.hydrateRoot=Bi.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ls(){return Ls=Object.assign?Object.assign.bind():function(a){for(var l=1;l<arguments.length;l++){var c=arguments[l];for(var u in c)Object.prototype.hasOwnProperty.call(c,u)&&(a[u]=c[u])}return a},Ls.apply(this,arguments)}var Br;(function(a){a.Pop="POP",a.Push="PUSH",a.Replace="REPLACE"})(Br||(Br={}));const Fi="popstate";function El(a){a===void 0&&(a={});function l(u,h){let{pathname:f,search:p,hash:y}=u.location;return qn("",{pathname:f,search:p,hash:y},h.state&&h.state.usr||null,h.state&&h.state.key||"default")}function c(u,h){return typeof h=="string"?h:on(h)}return Sl(l,c,null,a)}function mt(a,l){if(a===!1||a===null||typeof a>"u")throw new Error(l)}function Da(a,l){if(!a){typeof console<"u"&&console.warn(l);try{throw new Error(l)}catch{}}}function Al(){return Math.random().toString(36).substr(2,8)}function Ui(a,l){return{usr:a.state,key:a.key,idx:l}}function qn(a,l,c,u){return c===void 0&&(c=null),Ls({pathname:typeof a=="string"?a:a.pathname,search:"",hash:""},typeof l=="string"?ms(l):l,{state:c,key:l&&l.key||u||Al()})}function on(a){let{pathname:l="/",search:c="",hash:u=""}=a;return c&&c!=="?"&&(l+=c.charAt(0)==="?"?c:"?"+c),u&&u!=="#"&&(l+=u.charAt(0)==="#"?u:"#"+u),l}function ms(a){let l={};if(a){let c=a.indexOf("#");c>=0&&(l.hash=a.substr(c),a=a.substr(0,c));let u=a.indexOf("?");u>=0&&(l.search=a.substr(u),a=a.substr(0,u)),a&&(l.pathname=a)}return l}function Sl(a,l,c,u){u===void 0&&(u={});let{window:h=document.defaultView,v5Compat:f=!1}=u,p=h.history,y=Br.Pop,v=null,g=w();g==null&&(g=0,p.replaceState(Ls({},p.state,{idx:g}),""));function w(){return(p.state||{idx:null}).idx}function N(){y=Br.Pop;let P=w(),S=P==null?null:P-g;g=P,v&&v({action:y,location:D.location,delta:S})}function j(P,S){y=Br.Push;let I=qn(D.location,P,S);g=w()+1;let M=Ui(I,g),z=D.createHref(I);try{p.pushState(M,"",z)}catch(K){if(K instanceof DOMException&&K.name==="DataCloneError")throw K;h.location.assign(z)}f&&v&&v({action:y,location:D.location,delta:1})}function _(P,S){y=Br.Replace;let I=qn(D.location,P,S);g=w();let M=Ui(I,g),z=D.createHref(I);p.replaceState(M,"",z),f&&v&&v({action:y,location:D.location,delta:0})}function L(P){let S=h.location.origin!=="null"?h.location.origin:h.location.href,I=typeof P=="string"?P:on(P);return I=I.replace(/ $/,"%20"),mt(S,"No window.location.(origin|href) available to create URL for href: "+I),new URL(I,S)}let D={get action(){return y},get location(){return a(h,p)},listen(P){if(v)throw new Error("A history only accepts one active listener");return h.addEventListener(Fi,N),v=P,()=>{h.removeEventListener(Fi,N),v=null}},createHref(P){return l(h,P)},createURL:L,encodeLocation(P){let S=L(P);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:j,replace:_,go(P){return p.go(P)}};return D}var Vi;(function(a){a.data="data",a.deferred="deferred",a.redirect="redirect",a.error="error"})(Vi||(Vi={}));function jl(a,l,c){return c===void 0&&(c="/"),Tl(a,l,c)}function Tl(a,l,c,u){let h=typeof l=="string"?ms(l):l,f=ci(h.pathname||"/",c);if(f==null)return null;let p=Oa(a);Il(p);let y=null;for(let v=0;y==null&&v<p.length;++v){let g=Vl(f);y=Bl(p[v],g)}return y}function Oa(a,l,c,u){l===void 0&&(l=[]),c===void 0&&(c=[]),u===void 0&&(u="");let h=(f,p,y)=>{let v={relativePath:y===void 0?f.path||"":y,caseSensitive:f.caseSensitive===!0,childrenIndex:p,route:f};v.relativePath.startsWith("/")&&(mt(v.relativePath.startsWith(u),'Absolute route path "'+v.relativePath+'" nested under path '+('"'+u+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),v.relativePath=v.relativePath.slice(u.length));let g=Fr([u,v.relativePath]),w=c.concat(v);f.children&&f.children.length>0&&(mt(f.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+g+'".')),Oa(f.children,l,w,g)),!(f.path==null&&!f.index)&&l.push({path:g,score:Ll(g,f.index),routesMeta:w})};return a.forEach((f,p)=>{var y;if(f.path===""||!((y=f.path)!=null&&y.includes("?")))h(f,p);else for(let v of Ma(f.path))h(f,p,v)}),l}function Ma(a){let l=a.split("/");if(l.length===0)return[];let[c,...u]=l,h=c.endsWith("?"),f=c.replace(/\?$/,"");if(u.length===0)return h?[f,""]:[f];let p=Ma(u.join("/")),y=[];return y.push(...p.map(v=>v===""?f:[f,v].join("/"))),h&&y.push(...p),y.map(v=>a.startsWith("/")&&v===""?"/":v)}function Il(a){a.sort((l,c)=>l.score!==c.score?c.score-l.score:Pl(l.routesMeta.map(u=>u.childrenIndex),c.routesMeta.map(u=>u.childrenIndex)))}const _l=/^:[\w-]+$/,kl=3,Dl=2,Ol=1,Ml=10,Rl=-2,Hi=a=>a==="*";function Ll(a,l){let c=a.split("/"),u=c.length;return c.some(Hi)&&(u+=Rl),l&&(u+=Dl),c.filter(h=>!Hi(h)).reduce((h,f)=>h+(_l.test(f)?kl:f===""?Ol:Ml),u)}function Pl(a,l){return a.length===l.length&&a.slice(0,-1).every((u,h)=>u===l[h])?a[a.length-1]-l[l.length-1]:0}function Bl(a,l,c){let{routesMeta:u}=a,h={},f="/",p=[];for(let y=0;y<u.length;++y){let v=u[y],g=y===u.length-1,w=f==="/"?l:l.slice(f.length)||"/",N=Fl({path:v.relativePath,caseSensitive:v.caseSensitive,end:g},w),j=v.route;if(!N)return null;Object.assign(h,N.params),p.push({params:h,pathname:Fr([f,N.pathname]),pathnameBase:Wl(Fr([f,N.pathnameBase])),route:j}),N.pathnameBase!=="/"&&(f=Fr([f,N.pathnameBase]))}return p}function Fl(a,l){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[c,u]=Ul(a.path,a.caseSensitive,a.end),h=l.match(c);if(!h)return null;let f=h[0],p=f.replace(/(.)\/+$/,"$1"),y=h.slice(1);return{params:u.reduce((g,w,N)=>{let{paramName:j,isOptional:_}=w;if(j==="*"){let D=y[N]||"";p=f.slice(0,f.length-D.length).replace(/(.)\/+$/,"$1")}const L=y[N];return _&&!L?g[j]=void 0:g[j]=(L||"").replace(/%2F/g,"/"),g},{}),pathname:f,pathnameBase:p,pattern:a}}function Ul(a,l,c){l===void 0&&(l=!1),c===void 0&&(c=!0),Da(a==="*"||!a.endsWith("*")||a.endsWith("/*"),'Route path "'+a+'" will be treated as if it were '+('"'+a.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+a.replace(/\*$/,"/*")+'".'));let u=[],h="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(p,y,v)=>(u.push({paramName:y,isOptional:v!=null}),v?"/?([^\\/]+)?":"/([^\\/]+)"));return a.endsWith("*")?(u.push({paramName:"*"}),h+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):c?h+="\\/*$":a!==""&&a!=="/"&&(h+="(?:(?=\\/|$))"),[new RegExp(h,l?void 0:"i"),u]}function Vl(a){try{return a.split("/").map(l=>decodeURIComponent(l).replace(/\//g,"%2F")).join("/")}catch(l){return Da(!1,'The URL path "'+a+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+l+").")),a}}function ci(a,l){if(l==="/")return a;if(!a.toLowerCase().startsWith(l.toLowerCase()))return null;let c=l.endsWith("/")?l.length-1:l.length,u=a.charAt(c);return u&&u!=="/"?null:a.slice(c)||"/"}function Hl(a,l){l===void 0&&(l="/");let{pathname:c,search:u="",hash:h=""}=typeof a=="string"?ms(a):a;return{pathname:c?c.startsWith("/")?c:Gl(c,l):l,search:Yl(u),hash:Xl(h)}}function Gl(a,l){let c=l.replace(/\/+$/,"").split("/");return a.split("/").forEach(h=>{h===".."?c.length>1&&c.pop():h!=="."&&c.push(h)}),c.length>1?c.join("/"):"/"}function Ln(a,l,c,u){return"Cannot include a '"+a+"' character in a manually specified "+("`to."+l+"` field ["+JSON.stringify(u)+"].  Please separate it out to the ")+("`to."+c+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function zl(a){return a.filter((l,c)=>c===0||l.route.path&&l.route.path.length>0)}function di(a,l){let c=zl(a);return l?c.map((u,h)=>h===c.length-1?u.pathname:u.pathnameBase):c.map(u=>u.pathnameBase)}function ui(a,l,c,u){u===void 0&&(u=!1);let h;typeof a=="string"?h=ms(a):(h=Ls({},a),mt(!h.pathname||!h.pathname.includes("?"),Ln("?","pathname","search",h)),mt(!h.pathname||!h.pathname.includes("#"),Ln("#","pathname","hash",h)),mt(!h.search||!h.search.includes("#"),Ln("#","search","hash",h)));let f=a===""||h.pathname==="",p=f?"/":h.pathname,y;if(p==null)y=c;else{let N=l.length-1;if(!u&&p.startsWith("..")){let j=p.split("/");for(;j[0]==="..";)j.shift(),N-=1;h.pathname=j.join("/")}y=N>=0?l[N]:"/"}let v=Hl(h,y),g=p&&p!=="/"&&p.endsWith("/"),w=(f||p===".")&&c.endsWith("/");return!v.pathname.endsWith("/")&&(g||w)&&(v.pathname+="/"),v}const Fr=a=>a.join("/").replace(/\/\/+/g,"/"),Wl=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),Yl=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,Xl=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a;function ql(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}const Ra=["post","put","patch","delete"];new Set(Ra);const Zl=["get",...Ra];new Set(Zl);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ps(){return Ps=Object.assign?Object.assign.bind():function(a){for(var l=1;l<arguments.length;l++){var c=arguments[l];for(var u in c)Object.prototype.hasOwnProperty.call(c,u)&&(a[u]=c[u])}return a},Ps.apply(this,arguments)}const hi=O.createContext(null),$l=O.createContext(null),Vr=O.createContext(null),fn=O.createContext(null),Hr=O.createContext({outlet:null,matches:[],isDataRoute:!1}),La=O.createContext(null);function Ql(a,l){let{relative:c}=l===void 0?{}:l;gs()||mt(!1);let{basename:u,navigator:h}=O.useContext(Vr),{hash:f,pathname:p,search:y}=Ba(a,{relative:c}),v=p;return u!=="/"&&(v=p==="/"?u:Fr([u,p])),h.createHref({pathname:v,search:y,hash:f})}function gs(){return O.useContext(fn)!=null}function Kr(){return gs()||mt(!1),O.useContext(fn).location}function Pa(a){O.useContext(Vr).static||O.useLayoutEffect(a)}function Jr(){let{isDataRoute:a}=O.useContext(Hr);return a?dc():Kl()}function Kl(){gs()||mt(!1);let a=O.useContext(hi),{basename:l,future:c,navigator:u}=O.useContext(Vr),{matches:h}=O.useContext(Hr),{pathname:f}=Kr(),p=JSON.stringify(di(h,c.v7_relativeSplatPath)),y=O.useRef(!1);return Pa(()=>{y.current=!0}),O.useCallback(function(g,w){if(w===void 0&&(w={}),!y.current)return;if(typeof g=="number"){u.go(g);return}let N=ui(g,JSON.parse(p),f,w.relative==="path");a==null&&l!=="/"&&(N.pathname=N.pathname==="/"?l:Fr([l,N.pathname])),(w.replace?u.replace:u.push)(N,w.state,w)},[l,u,p,f,a])}function Ba(a,l){let{relative:c}=l===void 0?{}:l,{future:u}=O.useContext(Vr),{matches:h}=O.useContext(Hr),{pathname:f}=Kr(),p=JSON.stringify(di(h,u.v7_relativeSplatPath));return O.useMemo(()=>ui(a,JSON.parse(p),f,c==="path"),[a,p,f,c])}function Jl(a,l){return ec(a,l)}function ec(a,l,c,u){gs()||mt(!1);let{navigator:h}=O.useContext(Vr),{matches:f}=O.useContext(Hr),p=f[f.length-1],y=p?p.params:{};p&&p.pathname;let v=p?p.pathnameBase:"/";p&&p.route;let g=Kr(),w;if(l){var N;let P=typeof l=="string"?ms(l):l;v==="/"||(N=P.pathname)!=null&&N.startsWith(v)||mt(!1),w=P}else w=g;let j=w.pathname||"/",_=j;if(v!=="/"){let P=v.replace(/^\//,"").split("/");_="/"+j.replace(/^\//,"").split("/").slice(P.length).join("/")}let L=jl(a,{pathname:_}),D=ic(L&&L.map(P=>Object.assign({},P,{params:Object.assign({},y,P.params),pathname:Fr([v,h.encodeLocation?h.encodeLocation(P.pathname).pathname:P.pathname]),pathnameBase:P.pathnameBase==="/"?v:Fr([v,h.encodeLocation?h.encodeLocation(P.pathnameBase).pathname:P.pathnameBase])})),f,c,u);return l&&D?O.createElement(fn.Provider,{value:{location:Ps({pathname:"/",search:"",hash:"",state:null,key:"default"},w),navigationType:Br.Pop}},D):D}function tc(){let a=cc(),l=ql(a)?a.status+" "+a.statusText:a instanceof Error?a.message:JSON.stringify(a),c=a instanceof Error?a.stack:null,h={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},l),c?O.createElement("pre",{style:h},c):null,null)}const rc=O.createElement(tc,null);class sc extends O.Component{constructor(l){super(l),this.state={location:l.location,revalidation:l.revalidation,error:l.error}}static getDerivedStateFromError(l){return{error:l}}static getDerivedStateFromProps(l,c){return c.location!==l.location||c.revalidation!=="idle"&&l.revalidation==="idle"?{error:l.error,location:l.location,revalidation:l.revalidation}:{error:l.error!==void 0?l.error:c.error,location:c.location,revalidation:l.revalidation||c.revalidation}}componentDidCatch(l,c){console.error("React Router caught the following error during render",l,c)}render(){return this.state.error!==void 0?O.createElement(Hr.Provider,{value:this.props.routeContext},O.createElement(La.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function nc(a){let{routeContext:l,match:c,children:u}=a,h=O.useContext(hi);return h&&h.static&&h.staticContext&&(c.route.errorElement||c.route.ErrorBoundary)&&(h.staticContext._deepestRenderedBoundaryId=c.route.id),O.createElement(Hr.Provider,{value:l},u)}function ic(a,l,c,u){var h;if(l===void 0&&(l=[]),c===void 0&&(c=null),u===void 0&&(u=null),a==null){var f;if(!c)return null;if(c.errors)a=c.matches;else if((f=u)!=null&&f.v7_partialHydration&&l.length===0&&!c.initialized&&c.matches.length>0)a=c.matches;else return null}let p=a,y=(h=c)==null?void 0:h.errors;if(y!=null){let w=p.findIndex(N=>N.route.id&&(y==null?void 0:y[N.route.id])!==void 0);w>=0||mt(!1),p=p.slice(0,Math.min(p.length,w+1))}let v=!1,g=-1;if(c&&u&&u.v7_partialHydration)for(let w=0;w<p.length;w++){let N=p[w];if((N.route.HydrateFallback||N.route.hydrateFallbackElement)&&(g=w),N.route.id){let{loaderData:j,errors:_}=c,L=N.route.loader&&j[N.route.id]===void 0&&(!_||_[N.route.id]===void 0);if(N.route.lazy||L){v=!0,g>=0?p=p.slice(0,g+1):p=[p[0]];break}}}return p.reduceRight((w,N,j)=>{let _,L=!1,D=null,P=null;c&&(_=y&&N.route.id?y[N.route.id]:void 0,D=N.route.errorElement||rc,v&&(g<0&&j===0?(uc("route-fallback"),L=!0,P=null):g===j&&(L=!0,P=N.route.hydrateFallbackElement||null)));let S=l.concat(p.slice(0,j+1)),I=()=>{let M;return _?M=D:L?M=P:N.route.Component?M=O.createElement(N.route.Component,null):N.route.element?M=N.route.element:M=w,O.createElement(nc,{match:N,routeContext:{outlet:w,matches:S,isDataRoute:c!=null},children:M})};return c&&(N.route.ErrorBoundary||N.route.errorElement||j===0)?O.createElement(sc,{location:c.location,revalidation:c.revalidation,component:D,error:_,children:I(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):I()},null)}var Fa=function(a){return a.UseBlocker="useBlocker",a.UseRevalidator="useRevalidator",a.UseNavigateStable="useNavigate",a}(Fa||{}),Ua=function(a){return a.UseBlocker="useBlocker",a.UseLoaderData="useLoaderData",a.UseActionData="useActionData",a.UseRouteError="useRouteError",a.UseNavigation="useNavigation",a.UseRouteLoaderData="useRouteLoaderData",a.UseMatches="useMatches",a.UseRevalidator="useRevalidator",a.UseNavigateStable="useNavigate",a.UseRouteId="useRouteId",a}(Ua||{});function ac(a){let l=O.useContext(hi);return l||mt(!1),l}function oc(a){let l=O.useContext($l);return l||mt(!1),l}function lc(a){let l=O.useContext(Hr);return l||mt(!1),l}function Va(a){let l=lc(),c=l.matches[l.matches.length-1];return c.route.id||mt(!1),c.route.id}function cc(){var a;let l=O.useContext(La),c=oc(),u=Va();return l!==void 0?l:(a=c.errors)==null?void 0:a[u]}function dc(){let{router:a}=ac(Fa.UseNavigateStable),l=Va(Ua.UseNavigateStable),c=O.useRef(!1);return Pa(()=>{c.current=!0}),O.useCallback(function(h,f){f===void 0&&(f={}),c.current&&(typeof h=="number"?a.navigate(h):a.navigate(h,Ps({fromRouteId:l},f)))},[a,l])}const Gi={};function uc(a,l,c){Gi[a]||(Gi[a]=!0)}function hc(a,l){a==null||a.v7_startTransition,a==null||a.v7_relativeSplatPath}function fc(a){let{to:l,replace:c,state:u,relative:h}=a;gs()||mt(!1);let{future:f,static:p}=O.useContext(Vr),{matches:y}=O.useContext(Hr),{pathname:v}=Kr(),g=Jr(),w=ui(l,di(y,f.v7_relativeSplatPath),v,h==="path"),N=JSON.stringify(w);return O.useEffect(()=>g(JSON.parse(N),{replace:c,state:u,relative:h}),[g,N,h,c,u]),null}function zt(a){mt(!1)}function xc(a){let{basename:l="/",children:c=null,location:u,navigationType:h=Br.Pop,navigator:f,static:p=!1,future:y}=a;gs()&&mt(!1);let v=l.replace(/^\/*/,"/"),g=O.useMemo(()=>({basename:v,navigator:f,static:p,future:Ps({v7_relativeSplatPath:!1},y)}),[v,y,f,p]);typeof u=="string"&&(u=ms(u));let{pathname:w="/",search:N="",hash:j="",state:_=null,key:L="default"}=u,D=O.useMemo(()=>{let P=ci(w,v);return P==null?null:{location:{pathname:P,search:N,hash:j,state:_,key:L},navigationType:h}},[v,w,N,j,_,L,h]);return D==null?null:O.createElement(Vr.Provider,{value:g},O.createElement(fn.Provider,{children:c,value:D}))}function mc(a){let{children:l,location:c}=a;return Jl(Zn(l),c)}new Promise(()=>{});function Zn(a,l){l===void 0&&(l=[]);let c=[];return O.Children.forEach(a,(u,h)=>{if(!O.isValidElement(u))return;let f=[...l,h];if(u.type===O.Fragment){c.push.apply(c,Zn(u.props.children,f));return}u.type!==zt&&mt(!1),!u.props.index||!u.props.children||mt(!1);let p={id:u.props.id||f.join("-"),caseSensitive:u.props.caseSensitive,element:u.props.element,Component:u.props.Component,index:u.props.index,path:u.props.path,loader:u.props.loader,action:u.props.action,errorElement:u.props.errorElement,ErrorBoundary:u.props.ErrorBoundary,hasErrorBoundary:u.props.ErrorBoundary!=null||u.props.errorElement!=null,shouldRevalidate:u.props.shouldRevalidate,handle:u.props.handle,lazy:u.props.lazy};u.props.children&&(p.children=Zn(u.props.children,f)),c.push(p)}),c}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $n(){return $n=Object.assign?Object.assign.bind():function(a){for(var l=1;l<arguments.length;l++){var c=arguments[l];for(var u in c)Object.prototype.hasOwnProperty.call(c,u)&&(a[u]=c[u])}return a},$n.apply(this,arguments)}function gc(a,l){if(a==null)return{};var c={},u=Object.keys(a),h,f;for(f=0;f<u.length;f++)h=u[f],!(l.indexOf(h)>=0)&&(c[h]=a[h]);return c}function pc(a){return!!(a.metaKey||a.altKey||a.ctrlKey||a.shiftKey)}function yc(a,l){return a.button===0&&(!l||l==="_self")&&!pc(a)}function Qn(a){return a===void 0&&(a=""),new URLSearchParams(typeof a=="string"||Array.isArray(a)||a instanceof URLSearchParams?a:Object.keys(a).reduce((l,c)=>{let u=a[c];return l.concat(Array.isArray(u)?u.map(h=>[c,h]):[[c,u]])},[]))}function bc(a,l){let c=Qn(a);return l&&l.forEach((u,h)=>{c.has(h)||l.getAll(h).forEach(f=>{c.append(h,f)})}),c}const wc=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],vc="6";try{window.__reactRouterVersion=vc}catch{}const Nc="startTransition",zi=$o[Nc];function Cc(a){let{basename:l,children:c,future:u,window:h}=a,f=O.useRef();f.current==null&&(f.current=El({window:h,v5Compat:!0}));let p=f.current,[y,v]=O.useState({action:p.action,location:p.location}),{v7_startTransition:g}=u||{},w=O.useCallback(N=>{g&&zi?zi(()=>v(N)):v(N)},[v,g]);return O.useLayoutEffect(()=>p.listen(w),[p,w]),O.useEffect(()=>hc(u),[u]),O.createElement(xc,{basename:l,children:c,location:y.location,navigationType:y.action,navigator:p,future:u})}const Ec=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Ac=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Wi=O.forwardRef(function(l,c){let{onClick:u,relative:h,reloadDocument:f,replace:p,state:y,target:v,to:g,preventScrollReset:w,viewTransition:N}=l,j=gc(l,wc),{basename:_}=O.useContext(Vr),L,D=!1;if(typeof g=="string"&&Ac.test(g)&&(L=g,Ec))try{let M=new URL(window.location.href),z=g.startsWith("//")?new URL(M.protocol+g):new URL(g),K=ci(z.pathname,_);z.origin===M.origin&&K!=null?g=K+z.search+z.hash:D=!0}catch{}let P=Ql(g,{relative:h}),S=Sc(g,{replace:p,state:y,target:v,preventScrollReset:w,relative:h,viewTransition:N});function I(M){u&&u(M),M.defaultPrevented||S(M)}return O.createElement("a",$n({},j,{href:L||P,onClick:D||f?u:I,ref:c,target:v}))});var Yi;(function(a){a.UseScrollRestoration="useScrollRestoration",a.UseSubmit="useSubmit",a.UseSubmitFetcher="useSubmitFetcher",a.UseFetcher="useFetcher",a.useViewTransitionState="useViewTransitionState"})(Yi||(Yi={}));var Xi;(function(a){a.UseFetcher="useFetcher",a.UseFetchers="useFetchers",a.UseScrollRestoration="useScrollRestoration"})(Xi||(Xi={}));function Sc(a,l){let{target:c,replace:u,state:h,preventScrollReset:f,relative:p,viewTransition:y}=l===void 0?{}:l,v=Jr(),g=Kr(),w=Ba(a,{relative:p});return O.useCallback(N=>{if(yc(N,c)){N.preventDefault();let j=u!==void 0?u:on(g)===on(w);v(a,{replace:j,state:h,preventScrollReset:f,relative:p,viewTransition:y})}},[g,v,w,u,h,c,a,f,p,y])}function jc(a){let l=O.useRef(Qn(a)),c=O.useRef(!1),u=Kr(),h=O.useMemo(()=>bc(u.search,c.current?null:l.current),[u.search]),f=Jr(),p=O.useCallback((y,v)=>{const g=Qn(typeof y=="function"?y(h):y);c.current=!0,f("?"+g,v)},[f,h]);return[h,p]}var qi={},Tc="@vercel/analytics",Ic="1.5.0",_c=()=>{window.va||(window.va=function(...l){(window.vaq=window.vaq||[]).push(l)})};function Ha(){return typeof window<"u"}function Ga(){try{const a="production"}catch{}return"production"}function kc(a="auto"){if(a==="auto"){window.vam=Ga();return}window.vam=a}function Dc(){return(Ha()?window.vam:Ga())||"production"}function Kn(){return Dc()==="development"}function Oc(a){return a.scriptSrc?a.scriptSrc:Kn()?"https://va.vercel-scripts.com/v1/script.debug.js":a.basePath?`${a.basePath}/insights/script.js`:"/_vercel/insights/script.js"}function Mc(a={debug:!0}){var l;if(!Ha())return;kc(a.mode),_c(),a.beforeSend&&((l=window.va)==null||l.call(window,"beforeSend",a.beforeSend));const c=Oc(a);if(document.head.querySelector(`script[src*="${c}"]`))return;const u=document.createElement("script");u.src=c,u.defer=!0,u.dataset.sdkn=Tc+(a.framework?`/${a.framework}`:""),u.dataset.sdkv=Ic,a.disableAutoTrack&&(u.dataset.disableAutoTrack="1"),a.endpoint?u.dataset.endpoint=a.endpoint:a.basePath&&(u.dataset.endpoint=`${a.basePath}/insights`),a.dsn&&(u.dataset.dsn=a.dsn),u.onerror=()=>{const h=Kn()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.";console.log(`[Vercel Web Analytics] Failed to load script from ${c}. ${h}`)},Kn()&&a.debug===!1&&(u.dataset.debug="false"),document.head.appendChild(u)}function Rc({route:a,path:l}){var c;(c=window.va)==null||c.call(window,"pageview",{route:a,path:l})}function Lc(){if(!(typeof process>"u"||typeof qi>"u"))return qi.REACT_APP_VERCEL_OBSERVABILITY_BASEPATH}function Pc(a){return O.useEffect(()=>{var l;a.beforeSend&&((l=window.va)==null||l.call(window,"beforeSend",a.beforeSend))},[a.beforeSend]),O.useEffect(()=>{Mc({framework:a.framework||"react",basePath:a.basePath??Lc(),...a.route!==void 0&&{disableAutoTrack:!0},...a})},[]),O.useEffect(()=>{a.route&&a.path&&Rc({route:a.route,path:a.path})},[a.route,a.path]),null}var Zi={},Bc="@vercel/speed-insights",Fc="1.2.0",Uc=()=>{window.si||(window.si=function(...l){(window.siq=window.siq||[]).push(l)})};function Vc(){return typeof window<"u"}function Hc(){try{const a="production"}catch{}return"production"}function za(){return Hc()==="development"}function Gc(a){return a.scriptSrc?a.scriptSrc:za()?"https://va.vercel-scripts.com/v1/speed-insights/script.debug.js":a.dsn?"https://va.vercel-scripts.com/v1/speed-insights/script.js":a.basePath?`${a.basePath}/speed-insights/script.js`:"/_vercel/speed-insights/script.js"}function zc(a={}){var l;if(!Vc()||a.route===null)return null;Uc();const c=Gc(a);if(document.head.querySelector(`script[src*="${c}"]`))return null;a.beforeSend&&((l=window.si)==null||l.call(window,"beforeSend",a.beforeSend));const u=document.createElement("script");return u.src=c,u.defer=!0,u.dataset.sdkn=Bc+(a.framework?`/${a.framework}`:""),u.dataset.sdkv=Fc,a.sampleRate&&(u.dataset.sampleRate=a.sampleRate.toString()),a.route&&(u.dataset.route=a.route),a.endpoint?u.dataset.endpoint=a.endpoint:a.basePath&&(u.dataset.endpoint=`${a.basePath}/speed-insights/vitals`),a.dsn&&(u.dataset.dsn=a.dsn),za()&&a.debug===!1&&(u.dataset.debug="false"),u.onerror=()=>{console.log(`[Vercel Speed Insights] Failed to load script from ${c}. Please check if any content blockers are enabled and try again.`)},document.head.appendChild(u),{setRoute:h=>{u.dataset.route=h??void 0}}}function Wc(){if(!(typeof process>"u"||typeof Zi>"u"))return Zi.REACT_APP_VERCEL_OBSERVABILITY_BASEPATH}function Yc(a){O.useEffect(()=>{var c;a.beforeSend&&((c=window.si)==null||c.call(window,"beforeSend",a.beforeSend))},[a.beforeSend]);const l=O.useRef(null);return O.useEffect(()=>{if(l.current)a.route&&l.current(a.route);else{const c=zc({framework:a.framework??"react",basePath:a.basePath??Wc(),...a});c&&(l.current=c.setRoute)}},[a.route]),null}let Xc={data:""},qc=a=>typeof window=="object"?((a?a.querySelector("#_goober"):window._goober)||Object.assign((a||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:a||Xc,Zc=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,$c=/\/\*[^]*?\*\/|  +/g,$i=/\n+/g,Pr=(a,l)=>{let c="",u="",h="";for(let f in a){let p=a[f];f[0]=="@"?f[1]=="i"?c=f+" "+p+";":u+=f[1]=="f"?Pr(p,f):f+"{"+Pr(p,f[1]=="k"?"":l)+"}":typeof p=="object"?u+=Pr(p,l?l.replace(/([^,])+/g,y=>f.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,v=>/&/.test(v)?v.replace(/&/g,y):y?y+" "+v:v)):f):p!=null&&(f=/^--/.test(f)?f:f.replace(/[A-Z]/g,"-$&").toLowerCase(),h+=Pr.p?Pr.p(f,p):f+":"+p+";")}return c+(l&&h?l+"{"+h+"}":h)+u},Cr={},Wa=a=>{if(typeof a=="object"){let l="";for(let c in a)l+=c+Wa(a[c]);return l}return a},Qc=(a,l,c,u,h)=>{let f=Wa(a),p=Cr[f]||(Cr[f]=(v=>{let g=0,w=11;for(;g<v.length;)w=101*w+v.charCodeAt(g++)>>>0;return"go"+w})(f));if(!Cr[p]){let v=f!==a?a:(g=>{let w,N,j=[{}];for(;w=Zc.exec(g.replace($c,""));)w[4]?j.shift():w[3]?(N=w[3].replace($i," ").trim(),j.unshift(j[0][N]=j[0][N]||{})):j[0][w[1]]=w[2].replace($i," ").trim();return j[0]})(a);Cr[p]=Pr(h?{["@keyframes "+p]:v}:v,c?"":"."+p)}let y=c&&Cr.g?Cr.g:null;return c&&(Cr.g=Cr[p]),((v,g,w,N)=>{N?g.data=g.data.replace(N,v):g.data.indexOf(v)===-1&&(g.data=w?v+g.data:g.data+v)})(Cr[p],l,u,y),p},Kc=(a,l,c)=>a.reduce((u,h,f)=>{let p=l[f];if(p&&p.call){let y=p(c),v=y&&y.props&&y.props.className||/^go/.test(y)&&y;p=v?"."+v:y&&typeof y=="object"?y.props?"":Pr(y,""):y===!1?"":y}return u+h+(p??"")},"");function xn(a){let l=this||{},c=a.call?a(l.p):a;return Qc(c.unshift?c.raw?Kc(c,[].slice.call(arguments,1),l.p):c.reduce((u,h)=>Object.assign(u,h&&h.call?h(l.p):h),{}):c,qc(l.target),l.g,l.o,l.k)}let Ya,Jn,ei;xn.bind({g:1});let Ar=xn.bind({k:1});function Jc(a,l,c,u){Pr.p=l,Ya=a,Jn=c,ei=u}function Gr(a,l){let c=this||{};return function(){let u=arguments;function h(f,p){let y=Object.assign({},f),v=y.className||h.className;c.p=Object.assign({theme:Jn&&Jn()},y),c.o=/ *go\d+/.test(v),y.className=xn.apply(c,u)+(v?" "+v:"");let g=a;return a[0]&&(g=y.as||a,delete y.as),ei&&g[0]&&ei(y),Ya(g,y)}return h}}var ed=a=>typeof a=="function",ln=(a,l)=>ed(a)?a(l):a,td=(()=>{let a=0;return()=>(++a).toString()})(),Xa=(()=>{let a;return()=>{if(a===void 0&&typeof window<"u"){let l=matchMedia("(prefers-reduced-motion: reduce)");a=!l||l.matches}return a}})(),rd=20,fi="default",qa=(a,l)=>{let{toastLimit:c}=a.settings;switch(l.type){case 0:return{...a,toasts:[l.toast,...a.toasts].slice(0,c)};case 1:return{...a,toasts:a.toasts.map(p=>p.id===l.toast.id?{...p,...l.toast}:p)};case 2:let{toast:u}=l;return qa(a,{type:a.toasts.find(p=>p.id===u.id)?1:0,toast:u});case 3:let{toastId:h}=l;return{...a,toasts:a.toasts.map(p=>p.id===h||h===void 0?{...p,dismissed:!0,visible:!1}:p)};case 4:return l.toastId===void 0?{...a,toasts:[]}:{...a,toasts:a.toasts.filter(p=>p.id!==l.toastId)};case 5:return{...a,pausedAt:l.time};case 6:let f=l.time-(a.pausedAt||0);return{...a,pausedAt:void 0,toasts:a.toasts.map(p=>({...p,pauseDuration:p.pauseDuration+f}))}}},en=[],Za={toasts:[],pausedAt:void 0,settings:{toastLimit:rd}},yr={},$a=(a,l=fi)=>{yr[l]=qa(yr[l]||Za,a),en.forEach(([c,u])=>{c===l&&u(yr[l])})},Qa=a=>Object.keys(yr).forEach(l=>$a(a,l)),sd=a=>Object.keys(yr).find(l=>yr[l].toasts.some(c=>c.id===a)),mn=(a=fi)=>l=>{$a(l,a)},nd={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},id=(a={},l=fi)=>{let[c,u]=O.useState(yr[l]||Za),h=O.useRef(yr[l]);O.useEffect(()=>(h.current!==yr[l]&&u(yr[l]),en.push([l,u]),()=>{let p=en.findIndex(([y])=>y===l);p>-1&&en.splice(p,1)}),[l]);let f=c.toasts.map(p=>{var y,v,g;return{...a,...a[p.type],...p,removeDelay:p.removeDelay||((y=a[p.type])==null?void 0:y.removeDelay)||(a==null?void 0:a.removeDelay),duration:p.duration||((v=a[p.type])==null?void 0:v.duration)||(a==null?void 0:a.duration)||nd[p.type],style:{...a.style,...(g=a[p.type])==null?void 0:g.style,...p.style}}});return{...c,toasts:f}},ad=(a,l="blank",c)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:l,ariaProps:{role:"status","aria-live":"polite"},message:a,pauseDuration:0,...c,id:(c==null?void 0:c.id)||td()}),Vs=a=>(l,c)=>{let u=ad(l,a,c);return mn(u.toasterId||sd(u.id))({type:2,toast:u}),u.id},Nt=(a,l)=>Vs("blank")(a,l);Nt.error=Vs("error");Nt.success=Vs("success");Nt.loading=Vs("loading");Nt.custom=Vs("custom");Nt.dismiss=(a,l)=>{let c={type:3,toastId:a};l?mn(l)(c):Qa(c)};Nt.dismissAll=a=>Nt.dismiss(void 0,a);Nt.remove=(a,l)=>{let c={type:4,toastId:a};l?mn(l)(c):Qa(c)};Nt.removeAll=a=>Nt.remove(void 0,a);Nt.promise=(a,l,c)=>{let u=Nt.loading(l.loading,{...c,...c==null?void 0:c.loading});return typeof a=="function"&&(a=a()),a.then(h=>{let f=l.success?ln(l.success,h):void 0;return f?Nt.success(f,{id:u,...c,...c==null?void 0:c.success}):Nt.dismiss(u),h}).catch(h=>{let f=l.error?ln(l.error,h):void 0;f?Nt.error(f,{id:u,...c,...c==null?void 0:c.error}):Nt.dismiss(u)}),a};var od=1e3,ld=(a,l="default")=>{let{toasts:c,pausedAt:u}=id(a,l),h=O.useRef(new Map).current,f=O.useCallback((N,j=od)=>{if(h.has(N))return;let _=setTimeout(()=>{h.delete(N),p({type:4,toastId:N})},j);h.set(N,_)},[]);O.useEffect(()=>{if(u)return;let N=Date.now(),j=c.map(_=>{if(_.duration===1/0)return;let L=(_.duration||0)+_.pauseDuration-(N-_.createdAt);if(L<0){_.visible&&Nt.dismiss(_.id);return}return setTimeout(()=>Nt.dismiss(_.id,l),L)});return()=>{j.forEach(_=>_&&clearTimeout(_))}},[c,u,l]);let p=O.useCallback(mn(l),[l]),y=O.useCallback(()=>{p({type:5,time:Date.now()})},[p]),v=O.useCallback((N,j)=>{p({type:1,toast:{id:N,height:j}})},[p]),g=O.useCallback(()=>{u&&p({type:6,time:Date.now()})},[u,p]),w=O.useCallback((N,j)=>{let{reverseOrder:_=!1,gutter:L=8,defaultPosition:D}=j||{},P=c.filter(M=>(M.position||D)===(N.position||D)&&M.height),S=P.findIndex(M=>M.id===N.id),I=P.filter((M,z)=>z<S&&M.visible).length;return P.filter(M=>M.visible).slice(..._?[I+1]:[0,I]).reduce((M,z)=>M+(z.height||0)+L,0)},[c]);return O.useEffect(()=>{c.forEach(N=>{if(N.dismissed)f(N.id,N.removeDelay);else{let j=h.get(N.id);j&&(clearTimeout(j),h.delete(N.id))}})},[c,f]),{toasts:c,handlers:{updateHeight:v,startPause:y,endPause:g,calculateOffset:w}}},cd=Ar`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,dd=Ar`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,ud=Ar`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,hd=Gr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${a=>a.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${cd} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${dd} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${a=>a.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${ud} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,fd=Ar`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,xd=Gr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${a=>a.secondary||"#e0e0e0"};
  border-right-color: ${a=>a.primary||"#616161"};
  animation: ${fd} 1s linear infinite;
`,md=Ar`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,gd=Ar`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,pd=Gr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${a=>a.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${md} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${gd} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${a=>a.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,yd=Gr("div")`
  position: absolute;
`,bd=Gr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,wd=Ar`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,vd=Gr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${wd} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Nd=({toast:a})=>{let{icon:l,type:c,iconTheme:u}=a;return l!==void 0?typeof l=="string"?O.createElement(vd,null,l):l:c==="blank"?null:O.createElement(bd,null,O.createElement(xd,{...u}),c!=="loading"&&O.createElement(yd,null,c==="error"?O.createElement(hd,{...u}):O.createElement(pd,{...u})))},Cd=a=>`
0% {transform: translate3d(0,${a*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Ed=a=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${a*-150}%,-1px) scale(.6); opacity:0;}
`,Ad="0%{opacity:0;} 100%{opacity:1;}",Sd="0%{opacity:1;} 100%{opacity:0;}",jd=Gr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Td=Gr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Id=(a,l)=>{let c=a.includes("top")?1:-1,[u,h]=Xa()?[Ad,Sd]:[Cd(c),Ed(c)];return{animation:l?`${Ar(u)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ar(h)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},_d=O.memo(({toast:a,position:l,style:c,children:u})=>{let h=a.height?Id(a.position||l||"top-center",a.visible):{opacity:0},f=O.createElement(Nd,{toast:a}),p=O.createElement(Td,{...a.ariaProps},ln(a.message,a));return O.createElement(jd,{className:a.className,style:{...h,...c,...a.style}},typeof u=="function"?u({icon:f,message:p}):O.createElement(O.Fragment,null,f,p))});Jc(O.createElement);var kd=({id:a,className:l,style:c,onHeightUpdate:u,children:h})=>{let f=O.useCallback(p=>{if(p){let y=()=>{let v=p.getBoundingClientRect().height;u(a,v)};y(),new MutationObserver(y).observe(p,{subtree:!0,childList:!0,characterData:!0})}},[a,u]);return O.createElement("div",{ref:f,className:l,style:c},h)},Dd=(a,l)=>{let c=a.includes("top"),u=c?{top:0}:{bottom:0},h=a.includes("center")?{justifyContent:"center"}:a.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Xa()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${l*(c?1:-1)}px)`,...u,...h}},Od=xn`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ks=16,Md=({reverseOrder:a,position:l="top-center",toastOptions:c,gutter:u,children:h,toasterId:f,containerStyle:p,containerClassName:y})=>{let{toasts:v,handlers:g}=ld(c,f);return O.createElement("div",{"data-rht-toaster":f||"",style:{position:"fixed",zIndex:9999,top:Ks,left:Ks,right:Ks,bottom:Ks,pointerEvents:"none",...p},className:y,onMouseEnter:g.startPause,onMouseLeave:g.endPause},v.map(w=>{let N=w.position||l,j=g.calculateOffset(w,{reverseOrder:a,gutter:u,defaultPosition:l}),_=Dd(N,j);return O.createElement(kd,{id:w.id,key:w.id,onHeightUpdate:g.updateHeight,className:w.visible?Od:"",style:_},w.type==="custom"?ln(w.message,w):h?h(w):O.createElement(_d,{toast:w,position:N}))}))},Re=Nt,Rd=typeof Element<"u",Ld=typeof Map=="function",Pd=typeof Set=="function",Bd=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function tn(a,l){if(a===l)return!0;if(a&&l&&typeof a=="object"&&typeof l=="object"){if(a.constructor!==l.constructor)return!1;var c,u,h;if(Array.isArray(a)){if(c=a.length,c!=l.length)return!1;for(u=c;u--!==0;)if(!tn(a[u],l[u]))return!1;return!0}var f;if(Ld&&a instanceof Map&&l instanceof Map){if(a.size!==l.size)return!1;for(f=a.entries();!(u=f.next()).done;)if(!l.has(u.value[0]))return!1;for(f=a.entries();!(u=f.next()).done;)if(!tn(u.value[1],l.get(u.value[0])))return!1;return!0}if(Pd&&a instanceof Set&&l instanceof Set){if(a.size!==l.size)return!1;for(f=a.entries();!(u=f.next()).done;)if(!l.has(u.value[0]))return!1;return!0}if(Bd&&ArrayBuffer.isView(a)&&ArrayBuffer.isView(l)){if(c=a.length,c!=l.length)return!1;for(u=c;u--!==0;)if(a[u]!==l[u])return!1;return!0}if(a.constructor===RegExp)return a.source===l.source&&a.flags===l.flags;if(a.valueOf!==Object.prototype.valueOf&&typeof a.valueOf=="function"&&typeof l.valueOf=="function")return a.valueOf()===l.valueOf();if(a.toString!==Object.prototype.toString&&typeof a.toString=="function"&&typeof l.toString=="function")return a.toString()===l.toString();if(h=Object.keys(a),c=h.length,c!==Object.keys(l).length)return!1;for(u=c;u--!==0;)if(!Object.prototype.hasOwnProperty.call(l,h[u]))return!1;if(Rd&&a instanceof Element)return!1;for(u=c;u--!==0;)if(!((h[u]==="_owner"||h[u]==="__v"||h[u]==="__o")&&a.$$typeof)&&!tn(a[h[u]],l[h[u]]))return!1;return!0}return a!==a&&l!==l}var Fd=function(l,c){try{return tn(l,c)}catch(u){if((u.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw u}};const Ud=Fs(Fd);var Vd=function(a,l,c,u,h,f,p,y){if(!a){var v;if(l===void 0)v=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var g=[c,u,h,f,p,y],w=0;v=new Error(l.replace(/%s/g,function(){return g[w++]})),v.name="Invariant Violation"}throw v.framesToPop=1,v}},Hd=Vd;const Qi=Fs(Hd);var Gd=function(l,c,u,h){var f=u?u.call(h,l,c):void 0;if(f!==void 0)return!!f;if(l===c)return!0;if(typeof l!="object"||!l||typeof c!="object"||!c)return!1;var p=Object.keys(l),y=Object.keys(c);if(p.length!==y.length)return!1;for(var v=Object.prototype.hasOwnProperty.bind(c),g=0;g<p.length;g++){var w=p[g];if(!v(w))return!1;var N=l[w],j=c[w];if(f=u?u.call(h,N,j,w):void 0,f===!1||f===void 0&&N!==j)return!1}return!0};const zd=Fs(Gd);var Ka=(a=>(a.BASE="base",a.BODY="body",a.HEAD="head",a.HTML="html",a.LINK="link",a.META="meta",a.NOSCRIPT="noscript",a.SCRIPT="script",a.STYLE="style",a.TITLE="title",a.FRAGMENT="Symbol(react.fragment)",a))(Ka||{}),Pn={link:{rel:["amphtml","canonical","alternate"]},script:{type:["application/ld+json"]},meta:{charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]}},Ki=Object.values(Ka),xi={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},Wd=Object.entries(xi).reduce((a,[l,c])=>(a[c]=l,a),{}),or="data-rh",ds={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate",PRIORITIZE_SEO_TAGS:"prioritizeSeoTags"},us=(a,l)=>{for(let c=a.length-1;c>=0;c-=1){const u=a[c];if(Object.prototype.hasOwnProperty.call(u,l))return u[l]}return null},Yd=a=>{let l=us(a,"title");const c=us(a,ds.TITLE_TEMPLATE);if(Array.isArray(l)&&(l=l.join("")),c&&l)return c.replace(/%s/g,()=>l);const u=us(a,ds.DEFAULT_TITLE);return l||u||void 0},Xd=a=>us(a,ds.ON_CHANGE_CLIENT_STATE)||(()=>{}),Bn=(a,l)=>l.filter(c=>typeof c[a]<"u").map(c=>c[a]).reduce((c,u)=>({...c,...u}),{}),qd=(a,l)=>l.filter(c=>typeof c.base<"u").map(c=>c.base).reverse().reduce((c,u)=>{if(!c.length){const h=Object.keys(u);for(let f=0;f<h.length;f+=1){const y=h[f].toLowerCase();if(a.indexOf(y)!==-1&&u[y])return c.concat(u)}}return c},[]),Zd=a=>console&&typeof console.warn=="function"&&console.warn(a),_s=(a,l,c)=>{const u={};return c.filter(h=>Array.isArray(h[a])?!0:(typeof h[a]<"u"&&Zd(`Helmet: ${a} should be of type "Array". Instead found type "${typeof h[a]}"`),!1)).map(h=>h[a]).reverse().reduce((h,f)=>{const p={};f.filter(v=>{let g;const w=Object.keys(v);for(let j=0;j<w.length;j+=1){const _=w[j],L=_.toLowerCase();l.indexOf(L)!==-1&&!(g==="rel"&&v[g].toLowerCase()==="canonical")&&!(L==="rel"&&v[L].toLowerCase()==="stylesheet")&&(g=L),l.indexOf(_)!==-1&&(_==="innerHTML"||_==="cssText"||_==="itemprop")&&(g=_)}if(!g||!v[g])return!1;const N=v[g].toLowerCase();return u[g]||(u[g]={}),p[g]||(p[g]={}),u[g][N]?!1:(p[g][N]=!0,!0)}).reverse().forEach(v=>h.push(v));const y=Object.keys(p);for(let v=0;v<y.length;v+=1){const g=y[v],w={...u[g],...p[g]};u[g]=w}return h},[]).reverse()},$d=(a,l)=>{if(Array.isArray(a)&&a.length){for(let c=0;c<a.length;c+=1)if(a[c][l])return!0}return!1},Qd=a=>({baseTag:qd(["href"],a),bodyAttributes:Bn("bodyAttributes",a),defer:us(a,ds.DEFER),encode:us(a,ds.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:Bn("htmlAttributes",a),linkTags:_s("link",["rel","href"],a),metaTags:_s("meta",["name","charset","http-equiv","property","itemprop"],a),noscriptTags:_s("noscript",["innerHTML"],a),onChangeClientState:Xd(a),scriptTags:_s("script",["src","innerHTML"],a),styleTags:_s("style",["cssText"],a),title:Yd(a),titleAttributes:Bn("titleAttributes",a),prioritizeSeoTags:$d(a,ds.PRIORITIZE_SEO_TAGS)}),Ja=a=>Array.isArray(a)?a.join(""):a,Kd=(a,l)=>{const c=Object.keys(a);for(let u=0;u<c.length;u+=1)if(l[c[u]]&&l[c[u]].includes(a[c[u]]))return!0;return!1},Fn=(a,l)=>Array.isArray(a)?a.reduce((c,u)=>(Kd(u,l)?c.priority.push(u):c.default.push(u),c),{priority:[],default:[]}):{default:a,priority:[]},Ji=(a,l)=>({...a,[l]:void 0}),Jd=["noscript","script","style"],ti=(a,l=!0)=>l===!1?String(a):String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),eo=a=>Object.keys(a).reduce((l,c)=>{const u=typeof a[c]<"u"?`${c}="${a[c]}"`:`${c}`;return l?`${l} ${u}`:u},""),e0=(a,l,c,u)=>{const h=eo(c),f=Ja(l);return h?`<${a} ${or}="true" ${h}>${ti(f,u)}</${a}>`:`<${a} ${or}="true">${ti(f,u)}</${a}>`},t0=(a,l,c=!0)=>l.reduce((u,h)=>{const f=h,p=Object.keys(f).filter(g=>!(g==="innerHTML"||g==="cssText")).reduce((g,w)=>{const N=typeof f[w]>"u"?w:`${w}="${ti(f[w],c)}"`;return g?`${g} ${N}`:N},""),y=f.innerHTML||f.cssText||"",v=Jd.indexOf(a)===-1;return`${u}<${a} ${or}="true" ${p}${v?"/>":`>${y}</${a}>`}`},""),to=(a,l={})=>Object.keys(a).reduce((c,u)=>{const h=xi[u];return c[h||u]=a[u],c},l),r0=(a,l,c)=>{const u={key:l,[or]:!0},h=to(c,u);return[pr.createElement("title",h,l)]},rn=(a,l)=>l.map((c,u)=>{const h={key:u,[or]:!0};return Object.keys(c).forEach(f=>{const y=xi[f]||f;if(y==="innerHTML"||y==="cssText"){const v=c.innerHTML||c.cssText;h.dangerouslySetInnerHTML={__html:v}}else h[y]=c[f]}),pr.createElement(a,h)}),Qt=(a,l,c=!0)=>{switch(a){case"title":return{toComponent:()=>r0(a,l.title,l.titleAttributes),toString:()=>e0(a,l.title,l.titleAttributes,c)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>to(l),toString:()=>eo(l)};default:return{toComponent:()=>rn(a,l),toString:()=>t0(a,l,c)}}},s0=({metaTags:a,linkTags:l,scriptTags:c,encode:u})=>{const h=Fn(a,Pn.meta),f=Fn(l,Pn.link),p=Fn(c,Pn.script);return{priorityMethods:{toComponent:()=>[...rn("meta",h.priority),...rn("link",f.priority),...rn("script",p.priority)],toString:()=>`${Qt("meta",h.priority,u)} ${Qt("link",f.priority,u)} ${Qt("script",p.priority,u)}`},metaTags:h.default,linkTags:f.default,scriptTags:p.default}},n0=a=>{const{baseTag:l,bodyAttributes:c,encode:u=!0,htmlAttributes:h,noscriptTags:f,styleTags:p,title:y="",titleAttributes:v,prioritizeSeoTags:g}=a;let{linkTags:w,metaTags:N,scriptTags:j}=a,_={toComponent:()=>{},toString:()=>""};return g&&({priorityMethods:_,linkTags:w,metaTags:N,scriptTags:j}=s0(a)),{priority:_,base:Qt("base",l,u),bodyAttributes:Qt("bodyAttributes",c,u),htmlAttributes:Qt("htmlAttributes",h,u),link:Qt("link",w,u),meta:Qt("meta",N,u),noscript:Qt("noscript",f,u),script:Qt("script",j,u),style:Qt("style",p,u),title:Qt("title",{title:y,titleAttributes:v},u)}},ri=n0,Js=[],ro=!!(typeof window<"u"&&window.document&&window.document.createElement),si=class{constructor(a,l){Nr(this,"instances",[]);Nr(this,"canUseDOM",ro);Nr(this,"context");Nr(this,"value",{setHelmet:a=>{this.context.helmet=a},helmetInstances:{get:()=>this.canUseDOM?Js:this.instances,add:a=>{(this.canUseDOM?Js:this.instances).push(a)},remove:a=>{const l=(this.canUseDOM?Js:this.instances).indexOf(a);(this.canUseDOM?Js:this.instances).splice(l,1)}}});this.context=a,this.canUseDOM=l||!1,l||(a.helmet=ri({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},i0={},so=pr.createContext(i0),Qr,no=(Qr=class extends O.Component{constructor(c){super(c);Nr(this,"helmetData");this.helmetData=new si(this.props.context||{},Qr.canUseDOM)}render(){return pr.createElement(so.Provider,{value:this.helmetData.value},this.props.children)}},Nr(Qr,"canUseDOM",ro),Qr),ls=(a,l)=>{const c=document.head||document.querySelector("head"),u=c.querySelectorAll(`${a}[${or}]`),h=[].slice.call(u),f=[];let p;return l&&l.length&&l.forEach(y=>{const v=document.createElement(a);for(const g in y)if(Object.prototype.hasOwnProperty.call(y,g))if(g==="innerHTML")v.innerHTML=y.innerHTML;else if(g==="cssText")v.styleSheet?v.styleSheet.cssText=y.cssText:v.appendChild(document.createTextNode(y.cssText));else{const w=g,N=typeof y[w]>"u"?"":y[w];v.setAttribute(g,N)}v.setAttribute(or,"true"),h.some((g,w)=>(p=w,v.isEqualNode(g)))?h.splice(p,1):f.push(v)}),h.forEach(y=>{var v;return(v=y.parentNode)==null?void 0:v.removeChild(y)}),f.forEach(y=>c.appendChild(y)),{oldTags:h,newTags:f}},ni=(a,l)=>{const c=document.getElementsByTagName(a)[0];if(!c)return;const u=c.getAttribute(or),h=u?u.split(","):[],f=[...h],p=Object.keys(l);for(const y of p){const v=l[y]||"";c.getAttribute(y)!==v&&c.setAttribute(y,v),h.indexOf(y)===-1&&h.push(y);const g=f.indexOf(y);g!==-1&&f.splice(g,1)}for(let y=f.length-1;y>=0;y-=1)c.removeAttribute(f[y]);h.length===f.length?c.removeAttribute(or):c.getAttribute(or)!==p.join(",")&&c.setAttribute(or,p.join(","))},a0=(a,l)=>{typeof a<"u"&&document.title!==a&&(document.title=Ja(a)),ni("title",l)},ea=(a,l)=>{const{baseTag:c,bodyAttributes:u,htmlAttributes:h,linkTags:f,metaTags:p,noscriptTags:y,onChangeClientState:v,scriptTags:g,styleTags:w,title:N,titleAttributes:j}=a;ni("body",u),ni("html",h),a0(N,j);const _={baseTag:ls("base",c),linkTags:ls("link",f),metaTags:ls("meta",p),noscriptTags:ls("noscript",y),scriptTags:ls("script",g),styleTags:ls("style",w)},L={},D={};Object.keys(_).forEach(P=>{const{newTags:S,oldTags:I}=_[P];S.length&&(L[P]=S),I.length&&(D[P]=_[P].oldTags)}),l&&l(),v(a,L,D)},ks=null,o0=a=>{ks&&cancelAnimationFrame(ks),a.defer?ks=requestAnimationFrame(()=>{ea(a,()=>{ks=null})}):(ea(a),ks=null)},l0=o0,ta=class extends O.Component{constructor(){super(...arguments);Nr(this,"rendered",!1)}shouldComponentUpdate(l){return!zd(l,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:l}=this.props.context;l.remove(this),this.emitChange()}emitChange(){const{helmetInstances:l,setHelmet:c}=this.props.context;let u=null;const h=Qd(l.get().map(f=>{const p={...f.props};return delete p.context,p}));no.canUseDOM?l0(h):ri&&(u=ri(h)),c(u)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:l}=this.props.context;l.add(this),this.emitChange()}render(){return this.init(),null}},Hn,io=(Hn=class extends O.Component{shouldComponentUpdate(a){return!Ud(Ji(this.props,"helmetData"),Ji(a,"helmetData"))}mapNestedChildrenToProps(a,l){if(!l)return null;switch(a.type){case"script":case"noscript":return{innerHTML:l};case"style":return{cssText:l};default:throw new Error(`<${a.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(a,l,c,u){return{...l,[a.type]:[...l[a.type]||[],{...c,...this.mapNestedChildrenToProps(a,u)}]}}mapObjectTypeChildren(a,l,c,u){switch(a.type){case"title":return{...l,[a.type]:u,titleAttributes:{...c}};case"body":return{...l,bodyAttributes:{...c}};case"html":return{...l,htmlAttributes:{...c}};default:return{...l,[a.type]:{...c}}}}mapArrayTypeChildrenToProps(a,l){let c={...l};return Object.keys(a).forEach(u=>{c={...c,[u]:a[u]}}),c}warnOnInvalidChildren(a,l){return Qi(Ki.some(c=>a.type===c),typeof a.type=="function"?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${Ki.join(", ")} are allowed. Helmet does not support rendering <${a.type}> elements. Refer to our API for more information.`),Qi(!l||typeof l=="string"||Array.isArray(l)&&!l.some(c=>typeof c!="string"),`Helmet expects a string as a child of <${a.type}>. Did you forget to wrap your children in braces? ( <${a.type}>{\`\`}</${a.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(a,l){let c={};return pr.Children.forEach(a,u=>{if(!u||!u.props)return;const{children:h,...f}=u.props,p=Object.keys(f).reduce((v,g)=>(v[Wd[g]||g]=f[g],v),{});let{type:y}=u;switch(typeof y=="symbol"?y=y.toString():this.warnOnInvalidChildren(u,h),y){case"Symbol(react.fragment)":l=this.mapChildrenToProps(h,l);break;case"link":case"meta":case"noscript":case"script":case"style":c=this.flattenArrayTypeChildren(u,c,p,h);break;default:l=this.mapObjectTypeChildren(u,l,p,h);break}}),this.mapArrayTypeChildrenToProps(c,l)}render(){const{children:a,...l}=this.props;let c={...l},{helmetData:u}=l;if(a&&(c=this.mapChildrenToProps(a,c)),u&&!(u instanceof si)){const h=u;u=new si(h.context,!0),delete c.helmetData}return u?pr.createElement(ta,{...c,context:u.value}):pr.createElement(so.Consumer,null,h=>pr.createElement(ta,{...c,context:h}))}},Nr(Hn,"defaultProps",{defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1}),Hn);const ao="G-GW81WH5WJ0",mi=()=>{typeof window<"u"&&window.gtag&&window.gtag("config",ao,{page_title:document.title,page_location:window.location.href,custom_map:{custom_parameter_1:"event_category",custom_parameter_2:"event_label"}})},Hs=(a,l)=>{typeof window<"u"&&window.gtag&&window.gtag("config",ao,{page_path:a,page_title:l||document.title,page_location:window.location.origin+a})},Gs=(a,l,c,u)=>{typeof window<"u"&&window.gtag&&window.gtag("event",a,{event_category:l,event_label:c,value:u})},c0=(a,l,c)=>{Gs("view_item","tickets",`${l}${c?` - ${c}`:""}`,1),typeof window<"u"&&window.gtag&&window.gtag("event","view_item",{currency:"GBP",value:0,items:[{item_id:a,item_name:l,item_category:"Event Tickets",item_variant:c||"General",currency:"GBP",quantity:1}]})},d0=(a,l,c,u)=>{Gs("begin_checkout","checkout",l,c),typeof window<"u"&&window.gtag&&window.gtag("event","begin_checkout",{currency:"GBP",value:c/100,items:u.map(h=>({item_id:a,item_name:l,item_category:"Event Tickets",item_variant:h.tier,price:h.price/100,currency:"GBP",quantity:h.quantity}))})},Un=(a,l,c,u,h)=>{Gs("purchase","checkout",c,u),typeof window<"u"&&window.gtag&&window.gtag("event","purchase",{transaction_id:a,currency:"GBP",value:u/100,tax:0,shipping:0,items:h.map(f=>({item_id:l,item_name:c,item_category:"Event Tickets",item_variant:f.tier,price:f.price/100,currency:"GBP",quantity:f.quantity}))})},u0=(a,l)=>{Gs("click","button",`${a} - ${l}`)},gn=()=>{const[a,l]=O.useState(!1),[c,u]=O.useState(!1),h=Kr();O.useEffect(()=>{const p=()=>{u(window.scrollY>50)};return window.addEventListener("scroll",p),()=>window.removeEventListener("scroll",p)},[]);const f=[{name:"Home",href:h.pathname==="/"?"#home":"/#home"},{name:"Events",href:h.pathname==="/"?"#events":"/events"},{name:"Gallery",href:"/gallery"},{name:"About",href:h.pathname==="/"?"#about":"/#about"},{name:"Contact",href:h.pathname==="/"?"#contact":"/#contact"}];return r.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 px-2 md:px-4 pt-2 md:pt-4",children:r.jsx(Y.nav,{initial:{y:-100},animate:{y:0},className:`transition-all duration-500 ease-out ${c?"bg-white/80 backdrop-blur-xl shadow-2xl border-2 border-slate-200/80 rounded-2xl max-w-4xl md:max-w-7xl mx-auto":"bg-transparent max-w-4xl md:max-w-7xl mx-auto"}`,children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-6",children:[r.jsxs("div",{className:"flex items-center justify-between h-14 md:h-16 relative",children:[r.jsx("div",{className:"hidden md:flex items-center z-10",children:r.jsx("img",{src:"/carntext-b.svg",alt:"Carnival LDN",className:"h-6 md:h-8 w-auto max-w-[120px] md:max-w-[220px] object-contain transition-all duration-300",style:{filter:c?"none":"brightness(0) invert(1) drop-shadow(0 0 8px rgba(0,0,0,0.5))"}})}),r.jsx(Y.div,{whileHover:{scale:1.05},className:"pl-2 md:pl-0 md:absolute md:left-1/2 md:transform md:-translate-x-1/2 z-10",children:r.jsx("div",{className:"relative",children:r.jsx("img",{src:c?"/carnival-logo.svg":"/carnival-logo-w.svg",alt:"Carnival LDN Logo",className:"w-10 h-10 md:w-12 md:h-12 object-contain transition-all duration-300",style:{backgroundColor:"transparent"}})})}),r.jsx("div",{className:"flex justify-end z-10",children:r.jsx(Y.button,{whileTap:{scale:.95},onClick:()=>l(!a),className:`p-4 transition-colors rounded-lg ${c?"text-gray-700 hover:text-gray-900 hover:bg-gray-100":"text-white hover:text-gray-200 hover:bg-white/10"}`,children:a?r.jsx(Jt,{size:28,strokeWidth:2.5}):r.jsx(Qo,{size:28,strokeWidth:2.5})})})]}),r.jsx(oi,{children:a&&r.jsx(Y.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:`md:hidden border-t mt-2 overflow-hidden ${c?"border-gray-200/50":"border-white/30"}`,children:r.jsxs("div",{className:"px-2 py-6 space-y-0",children:[f.map((p,y)=>r.jsxs("div",{children:[r.jsx(Y.a,{href:p.href,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:y*.1},onClick:()=>l(!1),className:`block text-center text-lg font-medium transition-colors py-3 rounded-lg ${c?"text-gray-700 hover:text-gray-900 hover:bg-gray-50":"text-white hover:text-gray-200 hover:bg-white/10"}`,children:p.name}),y<f.length-1&&r.jsx("div",{className:`border-b mx-4 ${c?"border-gray-200":"border-white/30"}`})]},p.name)),r.jsx(Y.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:f.length*.1},className:`w-full py-3 rounded-lg font-medium transition-colors text-base mt-4 ${c?"bg-gray-900 hover:bg-gray-800 text-white":"bg-white/90 hover:bg-white text-gray-900"}`,children:"Book Event"})]})})})]})})})},Sr=()=>{const a=O.useRef(null),[l,c]=O.useState(!1),[u,h]=O.useState("full");return O.useEffect(()=>{const f=()=>{if(a.current){const y=["upper","lower","full"],v=y[Math.floor(Math.random()*y.length)];h(v),c(!0),setTimeout(()=>{c(!1)},200);const g=Math.random()*500+100;setTimeout(f,g)}},p=setTimeout(()=>{f()},100);return()=>{clearTimeout(p)}},[]),{glitchRef:a,isGlitching:l,glitchType:u}},h0=()=>r.jsxs(Y.span,{className:"inline-block px-3 sm:px-4 md:px-6 py-2 sm:py-2.5 md:py-3 bg-black/20 backdrop-blur-sm rounded-full border border-white/20 text-sm sm:text-base md:text-lg",whileHover:{scale:1.05,boxShadow:"0 0 20px rgba(255, 255, 255, 0.3)",borderColor:"rgba(255, 255, 255, 0.5)"},animate:{boxShadow:["0 0 10px rgba(255, 255, 255, 0.1)","0 0 20px rgba(255, 255, 255, 0.2)","0 0 10px rgba(255, 255, 255, 0.1)"]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:[r.jsx(Di,{className:"hidden md:inline-block mr-2 w-4 h-4 md:w-5 md:h-5 text-yellow-400"}),"London's Most Professional Events Experience",r.jsx(Di,{className:"hidden md:inline-block ml-2 w-4 h-4 md:w-5 md:h-5 text-yellow-400"})]}),f0=()=>{const{glitchRef:a,isGlitching:l,glitchType:c}=Sr(),u=Jr(),h={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.3,delayChildren:.2}}},f={hidden:{y:50,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",damping:15,stiffness:100}}},p=()=>{u("/events")},y=()=>{const v=document.getElementById("contact");v&&v.scrollIntoView({behavior:"smooth"})};return r.jsxs("section",{id:"home",className:"relative min-h-screen flex items-center justify-center overflow-hidden pt-16 sm:pt-20 md:pt-32 pb-12 sm:pb-16 md:pb-24 px-2 sm:px-4",children:[r.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[r.jsx("video",{autoPlay:!0,muted:!0,loop:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover",children:r.jsx("source",{src:"/vid.mp4",type:"video/mp4"})}),r.jsx("div",{className:"absolute inset-0 bg-black/50"})]}),r.jsx("div",{className:"max-w-7xl mx-auto px-4 md:px-6 lg:px-8 text-center relative z-10",children:r.jsxs(Y.div,{variants:h,initial:"hidden",animate:"visible",className:"space-y-6 md:space-y-8",children:[r.jsx(Y.div,{variants:f,children:r.jsx("h1",{ref:a,className:`text-6xl sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl glitch-text ${l?`glitch-active glitch-${c}`:""}`,"data-text":"CARNIVAL LDN",style:{textTransform:"uppercase",letterSpacing:"0.1em"},children:"CARNIVAL LDN"})}),r.jsxs(Y.div,{variants:f,className:"space-y-4 md:space-y-6 lg:space-y-7",children:[r.jsx(Y.h2,{className:"text-base sm:text-lg md:text-xl lg:text-2xl font-light max-w-4xl mx-auto leading-relaxed px-2 text-white drop-shadow-lg",children:r.jsx(h0,{})}),r.jsx(Y.p,{animate:{backgroundPosition:["0% 50%","100% 50%","0% 50%"]},transition:{duration:12,repeat:1/0,ease:"linear"},className:"text-s sm:text-sm md:text-base lg:text-lg xl:text-xl max-w-3xl mx-auto leading-relaxed px-2 bg-gradient-to-r from-gray-200 via-white to-gray-200 bg-[length:200%_200%] bg-clip-text text-transparent drop-shadow-lg",children:"From corporate events to cultural celebrations, from exclusive parties to memorable occasions"})]}),r.jsxs(Y.div,{variants:f,className:"flex flex-col sm:flex-row gap-3 sm:gap-4 md:gap-6 justify-center items-center pt-4 sm:pt-6 md:pt-8 px-2 sm:px-4",children:[r.jsxs(Y.button,{onClick:p,whileHover:{scale:1.05,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},whileTap:{scale:.95},className:"bg-white/90 hover:bg-white text-gray-900 font-bold text-base sm:text-base md:text-lg px-4 sm:px-6 md:px-8 py-2.5 sm:py-3 md:py-4 rounded-lg group w-3/4 sm:w-auto flex items-center justify-center space-x-2 transition-all shadow-lg backdrop-blur-sm border border-white/30",children:[r.jsx("span",{children:"Explore Events"}),r.jsx(sn,{className:"w-3 h-3 sm:w-4 sm:h-4 md:w-5 md:h-5 group-hover:translate-x-1 transition-transform"})]}),r.jsx(Y.button,{onClick:y,whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-transparent hover:bg-white/90 text-white hover:text-gray-900 px-4 sm:px-6 md:px-8 py-2.5 sm:py-3 md:py-4 text-base sm:text-base md:text-lg font-semibold rounded-lg border-2 border-white/70 w-3/4 sm:w-auto transition-all backdrop-blur-sm",children:"Book Private Event"})]})]})})]})},x0={},ra=a=>{let l;const c=new Set,u=(w,N)=>{const j=typeof w=="function"?w(l):w;if(!Object.is(j,l)){const _=l;l=N??(typeof j!="object"||j===null)?j:Object.assign({},l,j),c.forEach(L=>L(l,_))}},h=()=>l,v={setState:u,getState:h,getInitialState:()=>g,subscribe:w=>(c.add(w),()=>c.delete(w)),destroy:()=>{(x0?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),c.clear()}},g=l=a(u,h,v);return v},m0=a=>a?ra(a):ra;var oo={exports:{}},lo={},co={exports:{}},uo={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xs=O;function g0(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var p0=typeof Object.is=="function"?Object.is:g0,y0=xs.useState,b0=xs.useEffect,w0=xs.useLayoutEffect,v0=xs.useDebugValue;function N0(a,l){var c=l(),u=y0({inst:{value:c,getSnapshot:l}}),h=u[0].inst,f=u[1];return w0(function(){h.value=c,h.getSnapshot=l,Vn(h)&&f({inst:h})},[a,c,l]),b0(function(){return Vn(h)&&f({inst:h}),a(function(){Vn(h)&&f({inst:h})})},[a]),v0(c),c}function Vn(a){var l=a.getSnapshot;a=a.value;try{var c=l();return!p0(a,c)}catch{return!0}}function C0(a,l){return l()}var E0=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?C0:N0;uo.useSyncExternalStore=xs.useSyncExternalStore!==void 0?xs.useSyncExternalStore:E0;co.exports=uo;var A0=co.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pn=O,S0=A0;function j0(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var T0=typeof Object.is=="function"?Object.is:j0,I0=S0.useSyncExternalStore,_0=pn.useRef,k0=pn.useEffect,D0=pn.useMemo,O0=pn.useDebugValue;lo.useSyncExternalStoreWithSelector=function(a,l,c,u,h){var f=_0(null);if(f.current===null){var p={hasValue:!1,value:null};f.current=p}else p=f.current;f=D0(function(){function v(_){if(!g){if(g=!0,w=_,_=u(_),h!==void 0&&p.hasValue){var L=p.value;if(h(L,_))return N=L}return N=_}if(L=N,T0(w,_))return L;var D=u(_);return h!==void 0&&h(L,D)?(w=_,L):(w=_,N=D)}var g=!1,w,N,j=c===void 0?null:c;return[function(){return v(l())},j===null?void 0:function(){return v(j())}]},[l,c,u,h]);var y=I0(a,f[0],f[1]);return k0(function(){p.hasValue=!0,p.value=y},[y]),O0(y),y};oo.exports=lo;var M0=oo.exports;const R0=Fs(M0),ho={},{useDebugValue:L0}=pr,{useSyncExternalStoreWithSelector:P0}=R0;let sa=!1;const B0=a=>a;function F0(a,l=B0,c){(ho?"production":void 0)!=="production"&&c&&!sa&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),sa=!0);const u=P0(a.subscribe,a.getState,a.getServerState||a.getInitialState,l,c);return L0(u),u}const U0=a=>{(ho?"production":void 0)!=="production"&&typeof a!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const l=typeof a=="function"?m0(a):a,c=(u,h)=>F0(l,u,h);return Object.assign(c,l),c},V0=a=>U0,H0={};function G0(a,l){let c;try{c=a()}catch{return}return{getItem:h=>{var f;const p=v=>v===null?null:JSON.parse(v,void 0),y=(f=c.getItem(h))!=null?f:null;return y instanceof Promise?y.then(p):p(y)},setItem:(h,f)=>c.setItem(h,JSON.stringify(f,void 0)),removeItem:h=>c.removeItem(h)}}const Bs=a=>l=>{try{const c=a(l);return c instanceof Promise?c:{then(u){return Bs(u)(c)},catch(u){return this}}}catch(c){return{then(u){return this},catch(u){return Bs(u)(c)}}}},z0=(a,l)=>(c,u,h)=>{let f={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:P=>P,version:0,merge:(P,S)=>({...S,...P}),...l},p=!1;const y=new Set,v=new Set;let g;try{g=f.getStorage()}catch{}if(!g)return a((...P)=>{console.warn(`[zustand persist middleware] Unable to update item '${f.name}', the given storage is currently unavailable.`),c(...P)},u,h);const w=Bs(f.serialize),N=()=>{const P=f.partialize({...u()});let S;const I=w({state:P,version:f.version}).then(M=>g.setItem(f.name,M)).catch(M=>{S=M});if(S)throw S;return I},j=h.setState;h.setState=(P,S)=>{j(P,S),N()};const _=a((...P)=>{c(...P),N()},u,h);let L;const D=()=>{var P;if(!g)return;p=!1,y.forEach(I=>I(u()));const S=((P=f.onRehydrateStorage)==null?void 0:P.call(f,u()))||void 0;return Bs(g.getItem.bind(g))(f.name).then(I=>{if(I)return f.deserialize(I)}).then(I=>{if(I)if(typeof I.version=="number"&&I.version!==f.version){if(f.migrate)return f.migrate(I.state,I.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return I.state}).then(I=>{var M;return L=f.merge(I,(M=u())!=null?M:_),c(L,!0),N()}).then(()=>{S==null||S(L,void 0),p=!0,v.forEach(I=>I(L))}).catch(I=>{S==null||S(void 0,I)})};return h.persist={setOptions:P=>{f={...f,...P},P.getStorage&&(g=P.getStorage())},clearStorage:()=>{g==null||g.removeItem(f.name)},getOptions:()=>f,rehydrate:()=>D(),hasHydrated:()=>p,onHydrate:P=>(y.add(P),()=>{y.delete(P)}),onFinishHydration:P=>(v.add(P),()=>{v.delete(P)})},D(),L||_},W0=(a,l)=>(c,u,h)=>{let f={storage:G0(()=>localStorage),partialize:D=>D,version:0,merge:(D,P)=>({...P,...D}),...l},p=!1;const y=new Set,v=new Set;let g=f.storage;if(!g)return a((...D)=>{console.warn(`[zustand persist middleware] Unable to update item '${f.name}', the given storage is currently unavailable.`),c(...D)},u,h);const w=()=>{const D=f.partialize({...u()});return g.setItem(f.name,{state:D,version:f.version})},N=h.setState;h.setState=(D,P)=>{N(D,P),w()};const j=a((...D)=>{c(...D),w()},u,h);h.getInitialState=()=>j;let _;const L=()=>{var D,P;if(!g)return;p=!1,y.forEach(I=>{var M;return I((M=u())!=null?M:j)});const S=((P=f.onRehydrateStorage)==null?void 0:P.call(f,(D=u())!=null?D:j))||void 0;return Bs(g.getItem.bind(g))(f.name).then(I=>{if(I)if(typeof I.version=="number"&&I.version!==f.version){if(f.migrate)return[!0,f.migrate(I.state,I.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,I.state];return[!1,void 0]}).then(I=>{var M;const[z,K]=I;if(_=f.merge(K,(M=u())!=null?M:j),c(_,!0),z)return w()}).then(()=>{S==null||S(_,void 0),_=u(),p=!0,v.forEach(I=>I(_))}).catch(I=>{S==null||S(void 0,I)})};return h.persist={setOptions:D=>{f={...f,...D},D.storage&&(g=D.storage)},clearStorage:()=>{g==null||g.removeItem(f.name)},getOptions:()=>f,rehydrate:()=>L(),hasHydrated:()=>p,onHydrate:D=>(y.add(D),()=>{y.delete(D)}),onFinishHydration:D=>(v.add(D),()=>{v.delete(D)})},f.skipHydration||L(),_||j},Y0=(a,l)=>"getStorage"in l||"serialize"in l||"deserialize"in l?((H0?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),z0(a,l)):W0(a,l),X0=Y0,q0="https://smbmvdzheqkblixjfdpn.supabase.co",Z0="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNtYm12ZHpoZXFrYmxpeGpmZHBuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUyNzgyODAsImV4cCI6MjA3MDg1NDI4MH0.twkaCp07rbguIiLnT8fsWDwmA8eACF1BMvcv6Wo0_DQ",xe=ul(q0,Z0),na={email:"admin@carnival.com",password:"admin123"},jr=V0()(X0((a,l)=>({user:null,isAuthenticated:!1,isLoading:!1,events:[],orders:[],affiliateSocieties:[],affiliateLinks:[],affiliateStats:null,login:async(c,u)=>{a({isLoading:!0});try{return c===na.email&&u===na.password?(a({user:{id:"1",email:c,name:"Admin User",role:"admin",createdAt:new Date},isAuthenticated:!0,isLoading:!1}),!0):(a({isLoading:!1}),!1)}catch(h){return console.error("Login error:",h),a({isLoading:!1}),!1}},logout:()=>{a({user:null,isAuthenticated:!1})},getEvents:async()=>{a({isLoading:!0});try{const{data:c,error:u}=await xe.from("events").select("*").order("created_at",{ascending:!1});if(u)throw u;const{data:h,error:f}=await xe.from("ticket_tiers").select("*");f&&console.error("Error fetching ticket tiers:",f);const p=(c||[]).map(y=>{const v=(h||[]).filter(g=>g.event_id===y.id);return{...y,isArchived:y.is_archived??!1,ticketTiers:v.map(g=>({id:g.id,eventId:g.event_id,name:g.name,price:g.price,originalPrice:g.original_price,capacity:g.capacity,soldCount:g.sold_count,availableFrom:g.available_from,availableUntil:g.available_until,description:g.description,benefits:g.benefits,isActive:g.is_active,lastEntryTime:g.last_entry_time||void 0})).sort((g,w)=>g.price-w.price)}});console.log("Events with tiers:",p),a({events:p,isLoading:!1})}catch(c){console.error("Error fetching events:",c),Re.error("Failed to load events"),a({isLoading:!1})}},addEvent:async c=>{try{const u={title:c.title,date:c.date,time:c.time,venue:c.venue,price:c.price,description:c.description,capacity:c.capacity,image:c.image,tags:c.tags.split(",").map(p=>p.trim()).filter(p=>p),gradient:c.gradient,is_archived:!1};console.log("Adding new event:",u);const{data:h,error:f}=await xe.from("events").insert([u]).select().single();if(f)throw console.error("Supabase insert error:",f),f;if(console.log("Event added successfully, now adding ticket tiers"),c.ticketTiers&&c.ticketTiers.length>0){const p=c.ticketTiers.map(g=>({id:g.id,event_id:h.id,name:g.name,price:g.price,original_price:g.originalPrice||null,capacity:g.capacity,sold_count:g.soldCount||0,available_from:g.availableFrom?new Date(g.availableFrom).toISOString():null,available_until:g.availableUntil?new Date(g.availableUntil).toISOString():null,description:g.description||null,benefits:g.benefits||[],is_active:g.isActive!==!1,last_entry_time:g.lastEntryTime||null}));console.log("Inserting ticket tiers:",p),console.log("About to insert ticket tiers into database:",p);const{data:y,error:v}=await xe.from("ticket_tiers").insert(p).select();v?(console.error("Error inserting ticket tiers:",v),console.error("Error details:",v.details,v.hint,v.message)):console.log("Ticket tiers added successfully:",y)}await l().getEvents()}catch(u){console.error("Error adding event:",u),Re.error("Failed to add event")}},updateEvent:async(c,u)=>{try{const h={title:u.title,date:u.date,time:u.time,venue:u.venue,price:u.price,description:u.description,capacity:u.capacity,image:u.image,tags:u.tags.split(",").map(p=>p.trim()).filter(p=>p),gradient:u.gradient};console.log("Updating event with data:",h);const{error:f}=await xe.from("events").update(h).eq("id",c);if(f)throw console.error("Supabase update error:",f),f;if(u.ticketTiers){const{error:p}=await xe.from("ticket_tiers").delete().eq("event_id",c);if(p&&console.error("Error deleting existing ticket tiers:",p),u.ticketTiers.length>0){const y=u.ticketTiers.map(g=>({id:g.id,event_id:c,name:g.name,price:g.price,original_price:g.originalPrice,capacity:g.capacity,sold_count:g.soldCount,available_from:g.availableFrom,available_until:g.availableUntil,description:g.description,benefits:g.benefits,is_active:g.isActive,last_entry_time:g.lastEntryTime||null}));console.log("Updating ticket tiers:",y);const{error:v}=await xe.from("ticket_tiers").insert(y);v?console.error("Error updating ticket tiers:",v):console.log("Ticket tiers updated successfully")}}console.log("Event updated successfully"),await l().getEvents()}catch(h){console.error("Error updating event:",h),Re.error("Failed to update event")}},deleteEvent:async c=>{try{const{data:u,error:h}=await xe.from("events").select("is_archived").eq("id",c).single();h&&console.error("Error fetching event before delete:",h);const f=(u==null?void 0:u.is_archived)===!0;if(!f){Re.error("Cannot delete: Only archived events can be deleted. Please archive the event first.");const w=new Error("Cannot delete non-archived events");throw w.code="EVENT_NOT_ARCHIVED",w}const{data:p,error:y}=await xe.from("orders").select("id").eq("event_id",c);if(y&&console.error("Error checking event orders before delete:",y),(p||[]).length>0&&console.log(` Event has ${(p||[]).length} orders - proceeding with deletion of all related data`),f){console.log(` Deleting archived event ${c} and all related data...`);const{error:w}=await xe.from("ticket_scans").delete().eq("event_id",c);w?console.error("Error deleting ticket_scans for event:",w):console.log(" Deleted ticket_scans for event");const{error:N}=await xe.from("guestlist_scans").delete().eq("event_id",c);N?console.error("Error deleting guestlist_scans for event:",N):console.log(" Deleted guestlist_scans for event");const{data:j,error:_}=await xe.from("orders").select("id").eq("event_id",c);_&&console.error("Error fetching orders to delete:",_);const L=(j||[]).map(P=>P.id);if(L.length>0){console.log(` Deleting ${L.length} orders and related data...`);const{error:P}=await xe.from("order_tickets").delete().in("order_id",L);P?console.error("Error deleting order_tickets for event:",P):console.log(" Deleted order_tickets for event");const{error:S}=await xe.from("orders").delete().eq("event_id",c);S?console.error("Error deleting orders for event:",S):console.log(" Deleted orders for event")}const{error:D}=await xe.from("guestlists").delete().eq("event_id",c);D?console.error("Error deleting guestlists for event:",D):console.log(" Deleted guestlists for event")}const{error:v}=await xe.from("ticket_tiers").delete().eq("event_id",c);v&&console.error("Error deleting ticket tiers:",v);const{error:g}=await xe.from("events").delete().eq("id",c);if(g)throw g;await l().getEvents(),Re.success("Event deleted successfully")}catch(u){console.error("Error deleting event:",u),(u==null?void 0:u.code)==="EVENT_HAS_ORDERS"?Re.error("Cannot delete: this event has existing orders. Consider archiving it or enabling cascade deletes in Supabase."):(u==null?void 0:u.code)==="EVENT_NOT_ARCHIVED"||((u==null?void 0:u.code)==="23503"?Re.error("Cannot delete event: There are still references to this event in the system. Please contact support if this persists."):Re.error("Failed to delete event"))}},archiveEvent:async(c,u)=>{try{const{error:h}=await xe.from("events").update({is_archived:u}).eq("id",c);if(h)throw h;await l().getEvents()}catch(h){console.error("Error archiving event:",h),Re.error("Failed to update archive status. Ensure `is_archived boolean default false` exists on events table.")}},subscribeToEvents:()=>xe.channel("events").on("postgres_changes",{event:"*",schema:"public",table:"events"},u=>{console.log("Database change detected:",u),l().getEvents()}).subscribe(u=>{console.log("Subscription status:",u)}),getOrders:async()=>{try{console.log(" Fetching orders with tickets and scans...");const{data:c,error:u}=await xe.from("orders").select("*").order("created_at",{ascending:!1});if(u)throw u;const h=await Promise.all((c||[]).map(async f=>{const{data:p,error:y}=await xe.from("order_tickets").select("*").eq("order_id",f.id);y&&console.error("Error fetching tickets for order:",f.id,y);const v=(p||[]).map(_=>({id:_.id,orderId:_.order_id,ticketTierId:_.ticket_tier_id,quantity:_.quantity,unitPrice:_.unit_price,totalPrice:_.total_price})),{data:g,error:w}=await xe.from("ticket_scans").select("*").eq("order_id",f.id).order("scanned_at",{ascending:!1});w&&console.error("Error fetching scans for order:",f.id,w);const N=(g||[]).map(_=>({id:_.id,orderId:_.order_id,ticketTierId:_.ticket_tier_id,customerEmail:_.customer_email,eventId:_.event_id,scanType:_.scan_type,scannedAt:_.scanned_at,scannedBy:_.scanned_by,location:_.location,notes:_.notes}));return{id:f.id,eventId:f.event_id,userId:f.user_id,stripePaymentIntentId:f.stripe_payment_intent_id,status:f.status,totalAmount:f.total_amount,currency:f.currency,tickets:v,customerEmail:f.customer_email,customerName:f.customer_name,customerPhone:f.customer_phone,customerDateOfBirth:f.customer_date_of_birth,customerGender:f.customer_gender,createdAt:f.created_at,updatedAt:f.updated_at,scans:N}}));console.log(" Orders with tickets and scans (mapped):",h),a({orders:h})}catch(c){console.error("Error fetching orders:",c),a({orders:[]})}},validateTicket:async(c,u,h,f="entry")=>{var p;try{console.log(" Validating ticket:",{orderId:c,ticketTierId:u,customerEmail:h});const{data:y,error:v}=await xe.from("order_tickets").select("quantity").eq("order_id",c).eq("ticket_tier_id",u).single();(v||!y)&&(console.error("Error fetching order ticket quantity:",v),console.log(" Could not find order ticket, assuming quantity 1"));const g=(y==null?void 0:y.quantity)||1;if(console.log(" Ticket quantity:",g),f==="entry"){const{data:S,error:I}=await xe.from("ticket_scans").select("*").eq("order_id",c).eq("ticket_tier_id",u).eq("scan_type","entry");I&&console.error("Error checking existing entry scans:",I);const M=(S==null?void 0:S.length)||0;if(console.log(` Entry scans: ${M}/${g}`),M>=g)return console.log(` Ticket already scanned ${M} times (max: ${g})`),{isValid:!1,message:`Ticket already scanned ${M} time${M>1?"s":""} (maximum: ${g})`,orderStatus:"completed",eventDate:"unknown",customerName:"unknown",customerEmail:h,eventId:(p=S==null?void 0:S[0])==null?void 0:p.event_id}}else if(f==="exit"){const{data:S,error:I}=await xe.from("ticket_scans").select("*").eq("order_id",c).eq("ticket_tier_id",u).eq("scan_type","entry");if(I&&console.error("Error checking existing entry scans for exit:",I),!S||S.length===0)return console.log(" Cannot exit without entry scan"),{isValid:!1,message:"Cannot exit without entry scan",orderStatus:"completed",eventDate:"unknown",customerName:"unknown",customerEmail:h};const{data:M,error:z}=await xe.from("ticket_scans").select("*").eq("order_id",c).eq("ticket_tier_id",u).eq("scan_type","exit");z&&console.error("Error checking existing exit scans:",z);const K=(M==null?void 0:M.length)||0;if(console.log(` Exit scans: ${K}/${g}`),K>=g)return console.log(` Ticket already scanned for exit ${K} times (max: ${g})`),{isValid:!1,message:`Ticket already scanned for exit ${K} time${K>1?"s":""} (maximum: ${g})`,orderStatus:"completed",eventDate:"unknown",customerName:"unknown",customerEmail:h,eventId:S[0].event_id}}const{data:w,error:N}=await xe.from("orders").select("*").eq("id",c).eq("customer_email",h).single();if(N||!w){console.log(" Order not found:",{orderError:N,orderId:c,customerEmail:h});const{data:S}=await xe.from("orders").select("*").eq("id",c).single();return S?(console.log(" Order found but email mismatch:",{orderEmail:S.customer_email,scannedEmail:h}),{isValid:!1,message:"Customer email does not match order",orderStatus:S.status||"unknown",eventDate:"unknown",customerName:S.customer_name||"unknown",customerEmail:h}):{isValid:!1,message:"Order not found",orderStatus:"unknown",eventDate:"unknown",customerName:"unknown",customerEmail:h}}if(console.log(" Order found:",w),w.status!=="completed")return console.log(" Payment not completed:",w.status),{isValid:!1,message:"Payment not completed",orderStatus:w.status,eventDate:"unknown",customerName:w.customer_name||"unknown",customerEmail:h};const{data:j,error:_}=await xe.from("events").select("*").eq("id",w.event_id).single();if(_||!j)return console.log(" Event not found:",_),{isValid:!1,message:"Event not found",orderStatus:w.status,eventDate:"unknown",customerName:w.customer_name||"unknown",customerEmail:h};console.log(" Event found:",j);const L=j.date;if(L&&new Date(L)<new Date)return console.log(" Event has passed:",L),{isValid:!1,message:"Event has passed",orderStatus:w.status,eventDate:L,customerName:w.customer_name||"unknown",customerEmail:h};console.log(" Looking for ticket tier:",{ticketTierId:u,orderEventId:w.event_id});const{data:D,error:P}=await xe.from("ticket_tiers").select("*").eq("id",u).single();if(P||!D){console.log(" Ticket tier not found:",{ticketTierId:u,error:P});const{data:S,error:I}=await xe.from("ticket_tiers").select("*").eq("event_id",w.event_id);return console.log(" All ticket tiers for this event:",{eventId:w.event_id,tiers:S,error:I}),{isValid:!1,message:"Ticket tier not found",orderStatus:w.status,eventDate:L||"unknown",customerName:w.customer_name||"unknown",customerEmail:h}}return D.event_id!==w.event_id?(console.log(" Ticket tier does not belong to this event:",{tierEventId:D.event_id,orderEventId:w.event_id}),{isValid:!1,message:"Ticket tier does not belong to this event",orderStatus:w.status,eventDate:L||"unknown",customerName:w.customer_name||"unknown",customerEmail:h}):(console.log(" Ticket tier found:",D),D.is_active?(console.log(" Ticket validation successful"),{isValid:!0,message:`Ticket is valid for ${f}`,orderStatus:w.status,eventDate:L||"unknown",customerName:w.customer_name||"unknown",customerEmail:h,eventId:w.event_id,eventTitle:j.title,ticketTierName:D.name}):(console.log(" Ticket tier is inactive"),{isValid:!1,message:"Ticket tier is inactive",orderStatus:w.status,eventDate:L||"unknown",customerName:w.customer_name||"unknown",customerEmail:h}))}catch(y){return console.error(" Error validating ticket:",y),{isValid:!1,message:"Failed to validate ticket",orderStatus:"unknown",eventDate:"unknown",customerName:"unknown",customerEmail:h}}},recordTicketScan:async c=>{try{const{error:u}=await xe.from("ticket_scans").insert({order_id:c.orderId,ticket_tier_id:c.ticketTierId,customer_email:c.customerEmail,event_id:c.eventId,scan_type:c.scanType,scanned_by:c.scannedBy,location:c.location,notes:c.notes,scanned_at:new Date().toISOString()});if(u)throw console.error("Error recording ticket scan:",u),u}catch(u){throw console.error("Error recording ticket scan:",u),u}},searchTickets:async c=>{try{console.log(" Searching for tickets with term:",c);const{data:u,error:h}=await xe.from("orders").select(`
              *,
              events!inner(title, date, venue),
              ticket_tiers!inner(name)
            `).or(`customer_name.ilike.%${c}%,customer_email.ilike.%${c}%,id.ilike.%${c}%`).order("created_at",{ascending:!1});if(h)throw h;const p=(await Promise.all((u||[]).map(async y=>{const{data:v,error:g}=await xe.from("order_tickets").select("*").eq("order_id",y.id);g&&console.error("Error fetching tickets for order:",y.id,g);const{data:w,error:N}=await xe.from("ticket_scans").select("*").eq("order_id",y.id).order("scanned_at",{ascending:!1});N&&console.error("Error fetching scans for order:",y.id,N);const j=(w||[]).map(I=>({id:I.id,orderId:I.order_id,ticketTierId:I.ticket_tier_id,customerEmail:I.customer_email,eventId:I.event_id,scanType:I.scan_type,scannedAt:I.scanned_at,scannedBy:I.scanned_by,location:I.location,notes:I.notes})),_=j.filter(I=>I.scanType==="entry"),L=j.filter(I=>I.scanType==="exit");let D="not_scanned";_.length>0&&L.length>0?D="scanned_both":_.length>0?D="scanned_in":L.length>0&&(D="scanned_out");const P=j.length>0?new Date(j[0].scannedAt):void 0;return(v||[]).map(I=>{var M,z,K;return{orderId:y.id,customerName:y.customer_name||"N/A",customerEmail:y.customer_email||"N/A",eventTitle:((M=y.events)==null?void 0:M.title)||"N/A",eventDate:((z=y.events)==null?void 0:z.date)||"N/A",eventVenue:((K=y.events)==null?void 0:K.venue)||"N/A",ticketTierName:I.ticket_tier_id||"N/A",quantity:I.quantity||0,totalPrice:I.total_price||0,orderStatus:y.status||"N/A",orderDate:new Date(y.created_at),scans:j,lastScanTime:P,scanStatus:D}})}))).flat();return console.log(" Search results:",p),p}catch(u){return console.error("Error searching tickets:",u),[]}},debugTicketData:async(c,u)=>{try{let h=` Debug: Checking database for:
Order ID: ${c}
Ticket Tier ID: ${u}

`;const{data:f,error:p}=await xe.from("orders").select("*").eq("id",c).single();p?h+=` Order Error: ${p.message}
`:f?h+=` Order Found:
- Status: ${f.status}
- Customer: ${f.customer_name}
- Email: ${f.customer_email}
- Event ID: ${f.event_id}

`:h+=` Order Not Found

`;const{data:y,error:v}=await xe.from("ticket_tiers").select("*").eq("id",u).single();if(v?h+=` Ticket Tier Error: ${v.message}
`:y?h+=` Ticket Tier Found:
- Name: ${y.name}
- Event ID: ${y.event_id}
- Active: ${y.is_active}

`:h+=` Ticket Tier Not Found

`,f!=null&&f.event_id){const{data:N,error:j}=await xe.from("events").select("*").eq("id",f.event_id).single();j?h+=` Event Error: ${j.message}
`:N?h+=` Event Found:
- Title: ${N.title}
- Date: ${N.date}

`:h+=` Event Not Found

`}if(f!=null&&f.event_id){const{data:N,error:j}=await xe.from("ticket_tiers").select("*").eq("event_id",f.event_id);j?h+=` Event Tiers Error: ${j.message}
`:N&&N.length>0?(h+=` Event Ticket Tiers (${N.length}):
`,N.forEach(_=>h+=`- ${_.id}: ${_.name}
`),h+=`
`):h+=` No Ticket Tiers Found for Event

`}const{data:g,error:w}=await xe.from("ticket_tiers").select("*");return w?h+=` All Tiers Error: ${w.message}
`:g&&g.length>0?(h+=` Total Ticket Tiers in DB: ${g.length}
`,g.slice(0,5).forEach(N=>h+=`- ${N.id}: ${N.name}
`),g.length>5&&(h+=`... and ${g.length-5} more
`),h+=`
`):h+=` No Ticket Tiers in Database

`,h}catch(h){return` Debug Error: ${h}
`}},validateGuestlist:async(c,u="entry")=>{try{console.log(" Validating guestlist:",{guestlistId:c,scanType:u});const{data:h,error:f}=await xe.from("guestlists").select("*").eq("id",c).single();if(f||!h)return console.log(" Guestlist not found:",f),{isValid:!1,message:"Guestlist not found",orderStatus:"unknown",eventDate:"unknown",customerName:"unknown",customerEmail:"unknown"};if(h.remaining_scans<=0)return console.log(" No remaining scans for guestlist"),{isValid:!1,message:"All tickets from this group pass have been used",orderStatus:"completed",eventDate:"unknown",customerName:h.lead_name,customerEmail:h.lead_email};const{data:p,error:y}=await xe.from("events").select("*").eq("id",h.event_id).single();if(y||!p)return console.log(" Event not found:",y),{isValid:!1,message:"Event not found",orderStatus:"completed",eventDate:"unknown",customerName:h.lead_name,customerEmail:h.lead_email};const v=p.date;return v&&new Date(v)<new Date?(console.log(" Event has passed:",v),{isValid:!1,message:"Event has passed",orderStatus:"completed",eventDate:v,customerName:h.lead_name,customerEmail:h.lead_email}):(console.log(" Guestlist validation successful"),{isValid:!0,message:`Group pass valid - ${h.remaining_scans} tickets remaining`,orderStatus:"completed",eventDate:v||"unknown",customerName:h.lead_name,customerEmail:h.lead_email,eventId:h.event_id,eventTitle:p.title,ticketTierName:`Group Pass (${h.total_tickets} tickets)`})}catch(h){return console.error(" Error validating guestlist:",h),{isValid:!1,message:"Failed to validate guestlist",orderStatus:"unknown",eventDate:"unknown",customerName:"unknown",customerEmail:"unknown"}}},recordGuestlistScan:async c=>{try{const{error:u}=await xe.rpc("decrement_guestlist_scans",{guestlist_uuid:c.guestlistId});if(u)throw console.error("Error decrementing guestlist scans:",u),u;const{error:h}=await xe.from("guestlist_scans").insert({guestlist_id:c.guestlistId,event_id:c.eventId,scan_type:c.scanType,scanned_by:c.scannedBy||"admin",location:c.location||"",notes:c.notes||"",scanned_at:new Date().toISOString()});if(h)throw console.error("Error recording guestlist scan:",h),h}catch(u){throw console.error("Error recording guestlist scan:",u),u}},getAffiliateSocieties:async()=>{try{console.log(" Fetching affiliate societies from Supabase..."),console.log(" Supabase client:",xe);const{data:c,error:u}=await xe.from("affiliate_societies").select("*").order("created_at",{ascending:!1});if(u)throw console.error(" Error fetching affiliate societies:",u),u;console.log(" Raw societies data from Supabase:",c);const h=(c||[]).map(f=>({id:f.id,name:f.name,code:f.code,contactName:f.contact_name,contactEmail:f.contact_email,contactPhone:f.contact_phone,university:f.university,societyType:f.society_type,commissionRate:f.commission_rate,isActive:f.is_active,createdAt:f.created_at,updatedAt:f.updated_at}));console.log(" Transformed societies:",h),a({affiliateSocieties:h})}catch(c){console.error("Error fetching affiliate societies:",c),Re.error("Failed to load affiliate societies")}},addAffiliateSociety:async c=>{try{const{data:u,error:h}=await xe.from("affiliate_societies").insert({name:c.name,code:c.code,contact_name:c.contactName||null,contact_email:c.contactEmail||null,contact_phone:c.contactPhone||null,university:c.university||null,society_type:c.societyType||null,commission_rate:c.commissionRate,is_active:!0}).select().single();if(h)throw h;const f={id:u.id,name:u.name,code:u.code,contactName:u.contact_name,contactEmail:u.contact_email,contactPhone:u.contact_phone,university:u.university,societyType:u.society_type,commissionRate:u.commission_rate,isActive:u.is_active,createdAt:u.created_at,updatedAt:u.updated_at};a(p=>({affiliateSocieties:[f,...p.affiliateSocieties]})),Re.success("Society created successfully!")}catch(u){throw console.error("Error creating affiliate society:",u),Re.error("Failed to create society"),u}},updateAffiliateSociety:async(c,u)=>{try{const{data:h,error:f}=await xe.from("affiliate_societies").update({name:u.name,code:u.code,contact_name:u.contactName||null,contact_email:u.contactEmail||null,contact_phone:u.contactPhone||null,university:u.university||null,society_type:u.societyType||null,commission_rate:u.commissionRate,updated_at:new Date().toISOString()}).eq("id",c).select().single();if(f)throw f;const p={id:h.id,name:h.name,code:h.code,contactName:h.contact_name,contactEmail:h.contact_email,contactPhone:h.contact_phone,university:h.university,societyType:h.society_type,commissionRate:h.commission_rate,isActive:h.is_active,createdAt:h.created_at,updatedAt:h.updated_at};a(y=>({affiliateSocieties:y.affiliateSocieties.map(v=>v.id===c?p:v)})),Re.success("Society updated successfully!")}catch(h){throw console.error("Error updating affiliate society:",h),Re.error("Failed to update society"),h}},deleteAffiliateSociety:async c=>{try{const{data:u,error:h}=await xe.from("affiliate_links").select("id").eq("society_id",c);if(h)throw console.error("Error querying affiliate links:",h),h;const f=(u==null?void 0:u.map(y=>y.id))||[];if(f.length>0){console.log(" Deleting affiliate clicks for links:",f);const{error:y}=await xe.from("affiliate_clicks").delete().in("link_id",f);if(y)throw console.error("Error deleting affiliate clicks:",y),y;console.log(" Deleting affiliate links for society:",c);const{error:v}=await xe.from("affiliate_links").delete().eq("society_id",c);if(v)throw console.error("Error deleting affiliate links:",v),v}console.log(" Deleting society:",c);const{error:p}=await xe.from("affiliate_societies").delete().eq("id",c);if(p)throw console.error("Error deleting society:",p),p;a(y=>({affiliateSocieties:y.affiliateSocieties.filter(v=>v.id!==c),affiliateLinks:y.affiliateLinks.filter(v=>v.societyId!==c)})),Re.success("Society and all associated data deleted successfully!")}catch(u){throw console.error("Error deleting affiliate society:",u),Re.error("Failed to delete society. It may have associated orders or other constraints."),u}},getAffiliateLinks:async()=>{try{console.log(" Fetching affiliate links from Supabase...");const{data:c,error:u}=await xe.from("affiliate_links").select("*").order("created_at",{ascending:!1});if(u)throw console.error(" Error fetching affiliate links:",u),u;console.log(" Raw links data from Supabase:",c);const h=(c||[]).map(f=>({id:f.id,societyId:f.society_id,eventId:f.event_id,linkCode:f.link_code,customUrl:f.custom_url,isActive:f.is_active,createdAt:f.created_at}));console.log(" Transformed links:",h),a({affiliateLinks:h})}catch(c){console.error("Error fetching affiliate links:",c),Re.error("Failed to load affiliate links")}},createAffiliateLinks:async(c,u)=>{try{const h=c.map(v=>({society_id:v,event_id:u,link_code:`${v}-${u}-${Date.now()}`,is_active:!0})),{data:f,error:p}=await xe.from("affiliate_links").insert(h).select();if(p)throw p;const y=(f||[]).map(v=>({id:v.id,societyId:v.society_id,eventId:v.event_id,linkCode:v.link_code,customUrl:v.custom_url,isActive:v.is_active,createdAt:v.created_at}));a(v=>({affiliateLinks:[...y,...v.affiliateLinks]})),Re.success(`${c.length} tracking link(s) created successfully!`)}catch(h){throw console.error("Error creating affiliate links:",h),Re.error("Failed to create tracking links"),h}},getAffiliateStats:async()=>{try{const{count:c}=await xe.from("affiliate_societies").select("*",{count:"exact",head:!0}),{count:u}=await xe.from("affiliate_clicks").select("*",{count:"exact",head:!0}),{data:h,error:f}=await xe.from("orders").select(`
              total_amount,
              order_tickets (quantity)
            `).not("affiliate_link_id","is",null).eq("status","completed");if(f)throw f;const p=(h||[]).reduce((g,w)=>g+(w.total_amount||0),0),y=(h||[]).reduce((g,w)=>{const N=w.order_tickets||[];return g+N.reduce((j,_)=>j+(_.quantity||0),0)},0);a({affiliateStats:{totalSocieties:c||0,totalClicks:u||0,totalTicketsSold:y,totalRevenue:p}})}catch(c){console.error("Error fetching affiliate stats:",c),Re.error("Failed to load affiliate statistics")}},getSocietyPerformance:async()=>{var c,u;try{const{data:h,error:f}=await xe.from("affiliate_societies").select("*").order("created_at",{ascending:!1});if(f)throw f;const p=[];for(const y of h||[]){const{count:v}=await xe.from("affiliate_clicks").select("*",{count:"exact",head:!0}).in("link_id",((c=(await xe.from("affiliate_links").select("id").eq("society_id",y.id)).data)==null?void 0:c.map(j=>j.id))||[]),{data:g}=await xe.from("orders").select(`
                total_amount,
                order_tickets (quantity)
              `).in("affiliate_link_id",((u=(await xe.from("affiliate_links").select("id").eq("society_id",y.id)).data)==null?void 0:u.map(j=>j.id))||[]).eq("status","completed"),w=(g||[]).reduce((j,_)=>j+(_.total_amount||0),0),N=(g||[]).reduce((j,_)=>{const L=_.order_tickets||[];return j+L.reduce((D,P)=>D+(P.quantity||0),0)},0);p.push({society:{id:y.id,name:y.name,code:y.code,contactName:y.contact_name,contactEmail:y.contact_email,contactPhone:y.contact_phone,university:y.university,societyType:y.society_type,commissionRate:y.commission_rate,isActive:y.is_active,createdAt:y.created_at,updatedAt:y.updated_at},clicks:v||0,ticketsSold:N,revenue:w})}return p}catch(h){return console.error("Error fetching society performance:",h),Re.error("Failed to load society performance data"),[]}},trackAffiliateClick:async(c,u)=>{try{const{error:h}=await xe.from("affiliate_clicks").insert({link_id:c,session_id:u||null,clicked_at:new Date().toISOString()});if(h)throw h}catch(h){console.error("Error tracking affiliate click:",h)}}}),{name:"carnival-admin-storage",partialize:a=>({user:a.user,isAuthenticated:a.isAuthenticated})})),$0=()=>{const{events:a}=jr(),l=Jr(),{glitchRef:c,isGlitching:u,glitchType:h}=Sr();O.useEffect(()=>{Hs("/events","Carnival LDN - Events")},[]);const f=p=>{c0(p.id,p.title),l(`/events?event=${p.id}`)};return r.jsxs("section",{id:"events",className:"py-16 md:py-20 relative px-4 overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[r.jsx("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover scale-150",children:r.jsx("source",{src:"/vid-ev.mp4",type:"video/mp4"})}),r.jsx("div",{className:"absolute inset-0 bg-gray-900/70"})]}),r.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 md:px-6 lg:px-8",children:[r.jsxs(Y.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.8},className:"text-center mb-12 md:mb-16",children:[r.jsx(Y.h2,{ref:c,animate:{backgroundPosition:["0% 50%","100% 50%","0% 50%"]},transition:{duration:8,repeat:1/0,ease:"linear"},className:`text-5xl sm:text-4xl md:text-5xl lg:text-6xl font-bold mb-4 md:mb-6 pb-1 glitch-text ${u?`glitch-active glitch-${h}`:""}`,"data-text":"EVENTS",style:{textTransform:"uppercase",letterSpacing:"0.1em"},children:"EVENTS"}),r.jsxs(Y.p,{className:"text-base sm:text-lg md:text-lg text-white max-w-fit mx-auto leading-relaxed px-6 py-3 bg-black/20 backdrop-blur-sm rounded-full border border-white/20",whileHover:{scale:1.05,boxShadow:"0 0 20px rgba(255, 255, 255, 0.3)",borderColor:"rgba(255, 255, 255, 0.5)"},animate:{boxShadow:["0 0 10px rgba(255, 255, 255, 0.1)","0 0 20px rgba(255, 255, 255, 0.2)","0 0 10px rgba(255, 255, 255, 0.1)"]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:[r.jsx("span",{className:"block sm:hidden",children:" Events that hit different "}),r.jsx("span",{className:"hidden sm:block",children:" From rooftop raves to underground vibes - events that hit different "})]})]}),r.jsx("div",{className:`grid gap-6 md:gap-8 ${a.filter(p=>!p.isArchived).slice(0,3).length===1?"grid-cols-1 max-w-md mx-auto":a.filter(p=>!p.isArchived).slice(0,3).length===2?"grid-cols-1 md:grid-cols-2 max-w-4xl mx-auto":"grid-cols-1 md:grid-cols-2 lg:grid-cols-3"}`,children:a.filter(p=>!p.isArchived).slice(0,3).map((p,y)=>r.jsxs(Y.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},transition:{duration:.6,delay:y*.1},whileHover:{y:-4},className:"group relative bg-gradient-to-br from-white via-gray-50 to-white border border-gray-100 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden cursor-pointer backdrop-blur-sm",children:[r.jsxs("div",{className:"relative h-48 md:h-56 overflow-hidden",onClick:()=>f(p),children:[r.jsx("img",{src:p.image,alt:p.title,className:"w-full h-full object-contain transition-transform duration-500 group-hover:scale-110",onError:v=>{const g=v.target;g.src=`https://via.placeholder.com/400x300/6B7280/FFFFFF?text=${encodeURIComponent(p.title)}`}}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"}),r.jsx("div",{className:"absolute top-4 left-4 flex flex-wrap gap-2",children:p.tags.slice(0,2).map(v=>r.jsx("span",{className:"bg-white/95 backdrop-blur-sm px-3 py-1.5 rounded-full text-xs font-semibold text-gray-800 shadow-sm border border-white/20",children:v},v))}),r.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:r.jsx("h3",{className:"text-xl md:text-2xl font-bold text-white mb-2 leading-tight drop-shadow-lg",children:p.title})})]}),r.jsxs("div",{className:"p-5 md:p-6 space-y-4",onClick:()=>f(p),children:[r.jsx("p",{className:"text-gray-600 text-sm leading-relaxed line-clamp-2",children:p.description}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-center gap-3 p-2.5 bg-gray-50 rounded-xl",children:[r.jsx(yt,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),r.jsx("span",{className:"text-sm font-semibold text-gray-900",children:p.date})]}),r.jsxs("div",{className:"flex items-center justify-center gap-3 p-2.5 bg-gray-50 rounded-xl",children:[r.jsx(Kt,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),r.jsx("span",{className:"text-sm font-semibold text-gray-900",children:p.time})]}),r.jsxs("div",{className:"flex items-center justify-center gap-3 p-2.5 bg-gray-50 rounded-xl",children:[r.jsx(br,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),r.jsx("span",{className:"text-sm font-semibold text-gray-900",children:p.venue})]})]}),r.jsxs(Y.button,{onClick:v=>{v.stopPropagation(),u0("Get Tickets",`Events Section - ${p.title}`),f(p)},whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900 hover:from-gray-800 hover:via-gray-700 hover:to-gray-800 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 text-sm md:text-base flex items-center justify-center gap-3 shadow-lg hover:shadow-xl group-hover:shadow-2xl",children:[r.jsx("span",{children:"Get Tickets"}),r.jsx(sn,{className:"w-4 h-4 transition-transform group-hover:translate-x-1"})]})]})]},p.id))})]})]})},Q0=()=>{const{glitchRef:a,isGlitching:l,glitchType:c}=Sr(),u=[{icon:yt,number:"500+",label:"Epic Nights Created"},{icon:Qe,number:"50K+",label:"Happy Party People"},{icon:Oi,number:"25+",label:"Industry Awards"},{icon:Ko,number:"10+",label:"Years of Experience"}];return r.jsxs("section",{id:"about",className:"py-16 md:py-20 relative bg-gradient-to-br from-black via-gray-900 to-black overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black/80 via-gray-900/60 to-black/80"}),r.jsx("div",{className:"absolute inset-0 opacity-5",children:r.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 1px 1px, white 1px, transparent 0)",backgroundSize:"40px 40px"}})}),r.jsx("div",{className:"absolute top-0 left-1/4 w-px h-full bg-gradient-to-b from-transparent via-white/10 to-transparent"}),r.jsx("div",{className:"absolute top-0 right-1/4 w-px h-full bg-gradient-to-b from-transparent via-white/5 to-transparent"}),r.jsx("div",{className:"absolute top-1/3 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/5 to-transparent"})]}),r.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-6 lg:px-8 relative z-10",children:[r.jsxs(Y.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.8},className:"text-center mb-12 md:mb-16",children:[r.jsx(Y.h2,{ref:a,"data-text":"ABOUT US",className:`text-5xl sm:text-4xl md:text-5xl lg:text-6xl font-bold mb-4 md:mb-6 glitch-text text-white ${l?`glitch-active glitch-${c}`:""}`,style:{textTransform:"uppercase",letterSpacing:"0.1em"},children:"ABOUT US"}),r.jsxs(Y.p,{className:"text-base sm:text-lg md:text-lg text-white max-w-fit mx-auto leading-relaxed px-6 py-3 bg-black/20 backdrop-blur-sm rounded-full border border-white/20",whileHover:{scale:1.05,boxShadow:"0 0 20px rgba(255, 255, 255, 0.3)",borderColor:"rgba(255, 255, 255, 0.5)"},animate:{boxShadow:["0 0 10px rgba(255, 255, 255, 0.1)","0 0 20px rgba(255, 255, 255, 0.2)","0 0 10px rgba(255, 255, 255, 0.1)"]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:[r.jsx("span",{className:"block sm:hidden",children:"Creating epic nights since 2018"}),r.jsx("span",{className:"hidden sm:block",children:"We make London's most unforgettable nights happen"})]})]}),r.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 md:gap-12 items-stretch mb-16 md:mb-20",children:[r.jsxs(Y.div,{initial:{opacity:0,x:-50},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{duration:.8},className:"bg-white/5 border border-white/20 rounded-2xl p-8 md:p-12 backdrop-blur-sm shadow-2xl hover:shadow-white/10 transition-all duration-500 flex flex-col justify-center",children:[r.jsx(Y.h3,{className:"text-3xl md:text-4xl font-bold mb-6 md:mb-8 text-white text-center md:text-left",children:"Our Story"}),r.jsxs("div",{className:"space-y-6 text-gray-300 leading-relaxed text-center md:text-left",children:[r.jsx("p",{className:"text-lg md:text-xl",children:"Born from the underground scene, Carnival LDN started as a passion project for people who believed London deserved better parties."}),r.jsx("p",{className:"text-lg md:text-xl",children:"We've grown from throwing warehouse raves to becoming the city's most trusted name in unforgettable experiences."})]})]}),r.jsx(Y.div,{initial:{opacity:0,x:50},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{duration:.8,delay:.2},className:"grid grid-cols-2 gap-4 md:gap-6",children:u.map((h,f)=>r.jsxs(Y.div,{initial:{scale:0},whileInView:{scale:1},viewport:{once:!0},transition:{delay:f*.1,type:"spring"},whileHover:{scale:1.05,y:-5},className:"bg-white/5 border border-white/20 rounded-xl p-6 md:p-8 text-center group cursor-default hover:bg-white/10 transition-all duration-300 backdrop-blur-sm shadow-xl hover:shadow-white/10",children:[r.jsx(h.icon,{className:"w-10 h-10 md:w-12 md:h-12 text-white mx-auto mb-4 group-hover:scale-110 transition-transform"}),r.jsx("div",{className:"text-2xl md:text-3xl font-bold text-white mb-2",children:h.number}),r.jsx("div",{className:"text-gray-300 text-sm md:text-base leading-tight",children:h.label})]},h.label))})]}),r.jsxs(Y.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.8},className:"bg-white/5 border border-white/20 rounded-2xl p-8 md:p-12 backdrop-blur-sm shadow-2xl hover:shadow-white/10 transition-all duration-500 mb-12",children:[r.jsx(Y.h4,{className:"text-2xl md:text-3xl font-bold text-center mb-8 text-white",children:"Why Choose Us?"}),r.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[r.jsxs("div",{className:"text-center group",children:[r.jsx("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform",children:r.jsx(Oi,{className:"w-8 h-8 text-black"})}),r.jsx("span",{className:"text-gray-300 font-medium",children:"Unmatched energy and atmosphere"})]}),r.jsxs("div",{className:"text-center group",children:[r.jsx("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform",children:r.jsx(Mi,{className:"w-8 h-8 text-black"})}),r.jsx("span",{className:"text-gray-300 font-medium",children:"Premium venue and artist partnerships"})]}),r.jsxs("div",{className:"text-center group",children:[r.jsx("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform",children:r.jsx(Mi,{className:"w-8 h-8 text-black"})}),r.jsx("span",{className:"text-gray-300 font-medium",children:"Authentic scene knowledge"})]}),r.jsxs("div",{className:"text-center group",children:[r.jsx("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform",children:r.jsx(Qe,{className:"w-8 h-8 text-black"})}),r.jsx("span",{className:"text-gray-300 font-medium",children:"Community-focused approach"})]})]})]})]})]})},K0=()=>{const{glitchRef:a,isGlitching:l,glitchType:c}=Sr();return r.jsxs("section",{id:"contact",className:"py-16 md:py-20 relative bg-gradient-to-br from-black via-gray-900 to-black overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black/80 via-gray-900/60 to-black/80"}),r.jsx("div",{className:"absolute inset-0 opacity-5",children:r.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 1px 1px, white 1px, transparent 0)",backgroundSize:"40px 40px"}})}),r.jsx("div",{className:"absolute top-0 left-1/4 w-px h-full bg-gradient-to-b from-transparent via-white/10 to-transparent"}),r.jsx("div",{className:"absolute top-0 right-1/4 w-px h-full bg-gradient-to-b from-transparent via-white/5 to-transparent"}),r.jsx("div",{className:"absolute top-1/3 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/5 to-transparent"})]}),r.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-6 lg:px-8 relative z-10",children:[r.jsxs(Y.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.8},className:"text-center mb-12 md:mb-16",children:[r.jsx(Y.h2,{ref:a,"data-text":"GET IN TOUCH",className:`text-4xl sm:text-4xl md:text-5xl lg:text-6xl font-bold mb-4 md:mb-6 glitch-text text-white ${l?`glitch-active glitch-${c}`:""}`,style:{textTransform:"uppercase",letterSpacing:"0.1em"},children:"GET IN TOUCH"}),r.jsx(Y.p,{className:"text-base sm:text-lg md:text-lg text-white max-w-fit mx-auto leading-relaxed px-6 py-3 bg-black/20 backdrop-blur-sm rounded-full border border-white/20",whileHover:{scale:1.05,boxShadow:"0 0 20px rgba(255, 255, 255, 0.3)",borderColor:"rgba(255, 255, 255, 0.5)"},animate:{boxShadow:["0 0 10px rgba(255, 255, 255, 0.1)","0 0 20px rgba(255, 255, 255, 0.2)","0 0 10px rgba(255, 255, 255, 0.1)"]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:"Ready to create an exceptional event?"})]}),r.jsxs("div",{className:"grid lg:grid-cols-5 gap-8 md:gap-12 items-stretch",children:[r.jsxs(Y.div,{initial:{opacity:0,x:-50},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{duration:.8},className:"lg:col-span-3 bg-white/5 border border-white/20 rounded-2xl p-6 md:p-8 backdrop-blur-sm shadow-2xl hover:shadow-white/10 transition-all duration-500 flex flex-col",children:[r.jsx("h3",{className:"text-xl md:text-2xl font-bold text-white mb-4 md:mb-6",children:"Send us a message"}),r.jsxs("form",{className:"space-y-4 md:space-y-6 flex-1 flex flex-col",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"First Name"}),r.jsx("input",{type:"text",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg focus:ring-2 focus:ring-white focus:border-white/40 transition-all text-white placeholder-gray-400",placeholder:"John"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Last Name"}),r.jsx("input",{type:"text",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg focus:ring-2 focus:ring-white focus:border-white/40 transition-all text-white placeholder-gray-400",placeholder:"Doe"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),r.jsx("input",{type:"email",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg focus:ring-2 focus:ring-white focus:border-white/40 transition-all text-white placeholder-gray-400",placeholder:"john@company.com"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Phone"}),r.jsx("input",{type:"tel",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg focus:ring-2 focus:ring-white focus:border-white/40 transition-all text-white placeholder-gray-400",placeholder:"+44 20 1234 5678"})]}),r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Message"}),r.jsx("textarea",{rows:6,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg focus:ring-2 focus:ring-white focus:border-white/40 transition-all text-white placeholder-gray-400 resize-none",placeholder:"Tell us how we can help you..."})]}),r.jsx("div",{className:"pt-0",children:r.jsxs(Y.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"bg-white hover:bg-gray-100 text-black px-6 md:px-8 py-3 rounded-lg font-medium transition-all duration-300 text-sm md:text-base flex items-center justify-center space-x-2 w-full shadow-lg",children:[r.jsx(li,{className:"w-4 h-4 md:w-5 md:h-5"}),r.jsx("span",{children:"Send Message"})]})})]})]}),r.jsxs(Y.div,{initial:{opacity:0,x:50},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{duration:.8,delay:.2},className:"lg:col-span-2 space-y-6 md:space-y-8 flex flex-col",children:[r.jsxs("div",{className:"bg-white/5 border border-white/20 rounded-2xl p-6 md:p-8 backdrop-blur-sm shadow-2xl hover:shadow-white/10 transition-all duration-500 flex-1",children:[r.jsx(Y.h3,{className:"text-xl md:text-2xl font-bold mb-4 md:mb-6 text-center lg:text-left text-white",children:"Contact Information"}),r.jsxs("div",{className:"space-y-4 md:space-y-6",children:[r.jsxs("div",{className:"flex items-center space-x-3 md:space-x-4",children:[r.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-white rounded-lg flex items-center justify-center",children:r.jsx(Us,{className:"w-5 h-5 md:w-6 md:h-6 text-black"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-white",children:"Email"}),r.jsx("p",{className:"text-gray-300",children:"parternships@carnivalldn.com"})]})]}),r.jsxs("div",{className:"flex items-center space-x-3 md:space-x-4",children:[r.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-white rounded-lg flex items-center justify-center",children:r.jsx(un,{className:"w-5 h-5 md:w-6 md:h-6 text-black"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-white",children:"Phone"}),r.jsx("p",{className:"text-gray-300",children:"+44 20 1234 5678"})]})]}),r.jsxs("div",{className:"flex items-center space-x-3 md:space-x-4",children:[r.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-white rounded-lg flex items-center justify-center",children:r.jsx(br,{className:"w-5 h-5 md:w-6 md:h-6 text-black"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-white",children:"Address"}),r.jsx("p",{className:"text-gray-300",children:"123 Event Street, London, UK"})]})]}),r.jsxs("div",{className:"flex items-center space-x-3 md:space-x-4",children:[r.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-white rounded-lg flex items-center justify-center",children:r.jsx(Kt,{className:"w-5 h-5 md:w-6 md:h-6 text-black"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-white",children:"Business Hours"}),r.jsx("p",{className:"text-gray-300",children:"Mon-Fri: 9AM-6PM"})]})]})]})]}),r.jsxs("div",{className:"bg-white/5 border border-white/20 rounded-2xl p-6 md:p-8 backdrop-blur-sm shadow-2xl hover:shadow-white/10 transition-all duration-500",children:[r.jsx(Y.h3,{className:"text-xl md:text-2xl font-bold mb-4 md:mb-6 text-center lg:text-left text-white",children:"Connect With Us"}),r.jsx("p",{className:"text-sm md:text-base text-gray-300 mb-4 md:mb-6 leading-relaxed text-center lg:text-left",children:"Follow our journey and stay updated with the latest events, behind-the-scenes content, and exclusive offers."}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs(Y.a,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},href:"#",className:"bg-white/10 hover:bg-white/20 border border-white/20 rounded-xl p-4 text-center transition-all duration-300 group",children:[r.jsx(Jo,{className:"w-6 h-6 text-white mx-auto mb-2 group-hover:scale-110 transition-transform"}),r.jsx("span",{className:"text-xs text-gray-400 group-hover:text-white transition-colors",children:"Instagram"})]}),r.jsxs(Y.a,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},href:"#",className:"bg-white/10 hover:bg-white/20 border border-white/20 rounded-xl p-4 text-center transition-all duration-300 group",children:[r.jsx(el,{className:"w-6 h-6 text-white mx-auto mb-2 group-hover:scale-110 transition-transform"}),r.jsx("span",{className:"text-xs text-gray-400 group-hover:text-white transition-colors",children:"WhatsApp"})]}),r.jsxs(Y.a,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},href:"#",className:"bg-white/10 hover:bg-white/20 border border-white/20 rounded-xl p-4 text-center transition-all duration-300 group",children:[r.jsx(tl,{className:"w-6 h-6 text-white mx-auto mb-2 group-hover:scale-110 transition-transform"}),r.jsx("span",{className:"text-xs text-gray-400 group-hover:text-white transition-colors",children:"LinkedIn"})]})]})]})]})]})]})]})},yn=()=>r.jsx("footer",{className:"bg-gradient-to-br from-black via-gray-900 to-black text-white py-12 md:py-16 relative overflow-hidden border-t border-white/10",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-6 lg:px-8 relative z-10",children:[r.jsx("div",{className:"grid grid-cols-1 gap-8 md:gap-10",children:r.jsxs("div",{className:"text-center",children:[r.jsx(Y.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6},className:"flex items-center justify-center mb-4",children:r.jsx("img",{src:"/carnival-logo.svg",alt:"Carnival LDN Logo",className:"w-16 h-16 md:w-20 md:h-20 object-contain",style:{filter:"brightness(0) invert(1)"}})}),r.jsx("p",{className:"text-gray-400 text-sm md:text-base leading-relaxed mb-4 max-w-md mx-auto px-4",children:"London's premier professional events company, creating exceptional experiences that elevate your brand and strengthen business relationships."}),r.jsx("p",{className:"text-gray-500 text-xs md:text-sm text-center",children:"Established in London, 2014"})]})}),r.jsx(Y.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6,delay:.6},className:"border-t border-gray-800 mt-8 md:mt-12 pt-6 md:pt-8",children:r.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0",children:[r.jsx("p",{className:"text-gray-400 text-sm",children:" 2025 Carnival LDN. All rights reserved."}),r.jsxs("div",{className:"flex space-x-4",children:[r.jsx("a",{href:"/privacy-policy",className:"text-gray-400 hover:text-white transition-colors text-sm",children:"Privacy Policy"}),r.jsx("a",{href:"/terms-of-service",className:"text-gray-400 hover:text-white transition-colors text-sm",children:"Terms of Service"}),r.jsx("a",{href:"/cookie-policy",className:"text-gray-400 hover:text-white transition-colors text-sm",children:"Cookie Policy"})]})]})})]})}),J0=()=>{const a=Array.from({length:15},(l,c)=>({id:c,size:Math.random()*200+50,duration:Math.random()*25+20,delay:Math.random()*10,x:Math.random()*100,y:Math.random()*100}));return r.jsxs("div",{className:"fixed inset-0 -z-10 overflow-hidden",children:[a.map(l=>r.jsx(Y.div,{className:"absolute rounded-full mix-blend-multiply filter blur-xl opacity-5",style:{width:l.size,height:l.size,left:`${l.x}%`,top:`${l.y}%`,background:`radial-gradient(circle,
              ${l.id%3===0?"rgb(107, 114, 128)":l.id%3===1?"rgb(75, 85, 99)":"rgb(156, 163, 175)"} 0%, transparent 70%)`},animate:{x:[0,50,-25,0],y:[0,-50,25,0],scale:[1,1.1,.9,1]},transition:{duration:l.duration,repeat:1/0,delay:l.delay,ease:"easeInOut"}},l.id)),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white via-gray-50 to-white opacity-90"})]})},eu=()=>{const[a,l]=O.useState(!1),[c,u]=O.useState(""),h=Jr(),{login:f,isLoading:p}=jr(),{register:y,handleSubmit:v,formState:{errors:g}}=Ia(),w=async N=>{u(""),await f(N.email,N.password)?(Re.success("Welcome back, Admin!"),h("/admin/dashboard")):(u("Invalid email or password"),Re.error("Invalid email or password"))};return r.jsx("div",{className:"min-h-screen flex items-start justify-center bg-gray-100 py-12 px-4 sm:px-6 lg:px-8",style:{paddingTop:"20vh"},children:r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-md w-full space-y-8",children:[r.jsxs("div",{children:[r.jsx(Y.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"mx-auto h-12 w-12 bg-gray-900 rounded-full flex items-center justify-center",children:r.jsx(Os,{className:"h-6 w-6 text-white"})}),r.jsx(Y.h2,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Admin Login"}),r.jsx(Y.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"mt-2 text-center text-sm text-gray-600",children:"Sign in to access the dashboard"})]}),r.jsxs(Y.form,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"mt-8 space-y-6",onSubmit:v(w),children:[c&&r.jsxs(Y.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 rounded-md p-4 flex items-center space-x-2",children:[r.jsx(Gn,{className:"h-5 w-5 text-red-400"}),r.jsx("span",{className:"text-sm text-red-600",children:c})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),r.jsxs("div",{className:"mt-1 relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(Us,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{...y("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),id:"email",type:"email",autoComplete:"email",className:"appearance-none relative block w-full px-3 py-2 pl-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-gray-900 focus:border-gray-900 focus:z-10 sm:text-sm",placeholder:"Enter your email"})]}),g.email&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.email.message})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),r.jsxs("div",{className:"mt-1 relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none z-20",children:r.jsx(Os,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{...y("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),id:"password",type:a?"text":"password",autoComplete:"current-password",className:"appearance-none relative block w-full px-3 py-2 pl-10 pr-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-gray-900 focus:border-gray-900 focus:z-10 sm:text-sm",placeholder:"Enter your password"}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center z-20",onClick:()=>l(!a),children:a?r.jsx(rl,{className:"h-5 w-5 text-gray-400"}):r.jsx(hs,{className:"h-5 w-5 text-gray-400"})})]}),g.password&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.password.message})]})]}),r.jsx("div",{children:r.jsx(Y.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:p,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-gray-900 hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-900 disabled:opacity-50 disabled:cursor-not-allowed",children:p?r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),r.jsx("span",{children:"Signing in..."})]}):"Sign in"})}),r.jsx("div",{className:"text-center",children:r.jsx("p",{className:"text-xs text-gray-500",children:"Demo credentials: admin@carnival.com / admin123"})})]})]})})},tu=({ticketTiers:a,eventId:l,onSave:c,onClose:u})=>{var D,P;const[h,f]=O.useState(a||[]),[p,y]=O.useState({name:"",price:void 0,originalPrice:void 0,capacity:void 0,soldCount:0,availableFrom:new Date,availableUntil:new Date(Date.now()+30*24*60*60*1e3),description:"",benefits:[],isActive:!0,lastEntryTime:""}),v=()=>{if(console.log("addTier called with newTier:",p),console.log("Validation check:",{hasName:!!p.name,hasPrice:!!p.price,hasCapacity:!!p.capacity,name:p.name,price:p.price,capacity:p.capacity}),(p.name||"").toString().trim().length>0&&p.price!==void 0&&p.price>=0&&p.capacity!==void 0&&p.capacity>0){const S={id:`tier_${Date.now()}`,eventId:l,name:p.name||"",price:(p.price||0)*100,originalPrice:p.originalPrice!==void 0?(p.originalPrice||0)*100:void 0,capacity:p.capacity||0,soldCount:0,availableFrom:p.availableFrom,availableUntil:p.availableUntil,description:p.description||"",benefits:(p.benefits||[]).filter(I=>I.trim()),isActive:p.isActive!==!1,lastEntryTime:p.lastEntryTime||void 0};console.log("Created tier:",S),f([...h,S]),console.log("Updated tiers array:",[...h,S]),y({name:"",price:void 0,originalPrice:void 0,capacity:void 0,soldCount:0,availableFrom:new Date,availableUntil:new Date(Date.now()+30*24*60*60*1e3),description:"",benefits:[],isActive:!0,lastEntryTime:""})}else console.log("Validation failed - missing required fields")},g=S=>{f(h.filter(I=>I.id!==S))},w=(S,I)=>{f(h.map(M=>M.id===S?{...M,...I}:M))},N=S=>{const I=h.find(M=>M.id===S);I&&w(S,{benefits:[...I.benefits||[],""]})},j=(S,I,M)=>{const z=h.find(K=>K.id===S);if(z){const K=[...z.benefits||[]];K[I]=M,w(S,{benefits:K})}},_=(S,I)=>{const M=h.find(z=>z.id===S);if(M){const z=(M.benefits||[]).filter((K,ce)=>ce!==I);w(S,{benefits:z})}},L=()=>{console.log("handleSave called with tiers:",h),console.log("Tiers length:",h.length),console.log("Tiers details:",h.map(S=>({id:S.id,name:S.name,price:S.price,capacity:S.capacity}))),c(h),u()};return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",onClick:S=>S.stopPropagation(),children:r.jsxs(Y.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",onClick:S=>S.stopPropagation(),children:[r.jsx("div",{className:"p-6 border-b",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Manage Ticket Tiers"}),r.jsx("button",{onClick:u,className:"text-gray-400 hover:text-gray-600",children:r.jsx(Jt,{className:"h-6 w-6"})})]})}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Add New Tier"}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:r.jsxs("p",{className:"text-sm text-blue-800",children:[r.jsx("strong",{children:"How it works:"}),' Create different ticket types with different prices. For example: "Early Bird" at 25, "VIP" at 50, or "Student" at 15. Set how many tickets are available for each tier.']})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tier Name"}),r.jsx("input",{type:"text",placeholder:"e.g., Early Bird, VIP, Student",value:p.name,onChange:S=>y({...p,name:S.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price"}),r.jsx("input",{type:"number",placeholder:"e.g., 25 for 25",value:p.price??"",onChange:S=>{const I=S.target.value;y({...p,price:I===""?void 0:parseFloat(I)||0})},className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capacity"}),r.jsx("input",{type:"number",placeholder:"e.g., 100 tickets",value:p.capacity??"",onChange:S=>{const I=S.target.value;y({...p,capacity:I===""?void 0:parseInt(I)||0})},className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Original Price (Optional)"}),r.jsx("input",{type:"number",placeholder:"e.g., 35 for 35 (shows discount)",value:p.originalPrice??"",onChange:S=>{const I=S.target.value;y({...p,originalPrice:I===""?void 0:parseFloat(I)||0})},className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Available From"}),r.jsx("input",{type:"date",value:(D=p.availableFrom)==null?void 0:D.toISOString().split("T")[0],onChange:S=>y({...p,availableFrom:new Date(S.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Available Until"}),r.jsx("input",{type:"date",value:(P=p.availableUntil)==null?void 0:P.toISOString().split("T")[0],onChange:S=>y({...p,availableUntil:new Date(S.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Entry Time (Optional)"}),r.jsx("input",{type:"text",placeholder:"e.g., 11:00 PM, 23:00, 10:30 PM",value:p.lastEntryTime||"",onChange:S=>y({...p,lastEntryTime:S.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Time when entry closes for this tier"})]})]}),r.jsx("textarea",{placeholder:"Description (optional)",value:p.description,onChange:S=>y({...p,description:S.target.value}),className:"w-full mt-4 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:2}),r.jsxs("div",{className:"mt-4 flex items-center justify-end gap-4",children:[r.jsxs("label",{htmlFor:"new-tier-active",className:"inline-flex items-center gap-2 text-sm text-gray-700",children:[r.jsx("input",{id:"new-tier-active",type:"checkbox",checked:p.isActive!==!1,onChange:S=>y({...p,isActive:S.target.checked})}),"Active (allow sales)"]}),r.jsx("button",{onClick:v,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Add Tier"})]})]}),r.jsx("div",{className:"space-y-4",children:h.map(S=>r.jsxs("div",{className:"border rounded-lg p-4",children:[r.jsxs("div",{className:"flex justify-between items-start mb-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx("input",{type:"text",value:S.name,onChange:I=>w(S.id,{name:I.target.value}),className:"px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Tier Name"}),r.jsx("input",{type:"number",value:S.price/100,onChange:I=>w(S.id,{price:(parseFloat(I.target.value)||0)*100}),className:"px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Price"}),r.jsx("input",{type:"number",value:S.capacity,onChange:I=>w(S.id,{capacity:parseInt(I.target.value)||0}),className:"px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Capacity"})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Entry Time (Optional)"}),r.jsx("input",{type:"text",value:S.lastEntryTime||"",onChange:I=>w(S.id,{lastEntryTime:I.target.value}),placeholder:"e.g., 11:00 PM, 23:00, 10:30 PM",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Time when entry closes for this tier"})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Benefits"}),r.jsxs("div",{className:"space-y-2",children:[(S.benefits||[]).map((I,M)=>r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"text",value:I,onChange:z=>j(S.id,M,z.target.value),placeholder:"Benefit description",className:"flex-1 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),r.jsx("button",{onClick:()=>_(S.id,M),className:"px-2 py-2 text-red-600 hover:text-red-800",children:r.jsx(zn,{className:"h-4 w-4"})})]},M)),r.jsxs("button",{onClick:()=>N(S.id),className:"text-blue-600 hover:text-blue-800 text-sm flex items-center gap-1",children:[r.jsx(sl,{className:"h-4 w-4"}),"Add Benefit"]})]})]})]}),r.jsx("button",{onClick:()=>g(S.id),className:"ml-4 text-red-600 hover:text-red-800",children:r.jsx(zn,{className:"h-5 w-5"})})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:[r.jsxs("span",{children:["Available: ",S.capacity-S.soldCount," / ",S.capacity]}),r.jsxs("span",{children:["Price: ",(S.price/100).toFixed(2)]}),S.originalPrice&&S.originalPrice>S.price&&r.jsxs("span",{className:"line-through text-gray-400",children:["",(S.originalPrice/100).toFixed(2)]}),r.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[S.capacity-S.soldCount<=0&&r.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-red-100 text-red-700",children:"Sold out by capacity"}),r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",checked:S.isActive===!1,disabled:S.capacity-S.soldCount<=0,onChange:I=>w(S.id,{isActive:!I.target.checked})}),r.jsx("span",{children:"Mark as sold out (disable sales)"})]})]})]})]},S.id))}),r.jsxs("div",{className:"flex justify-end gap-4 mt-6 pt-6 border-t",children:[r.jsx("button",{onClick:u,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),r.jsx("button",{onClick:L,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Save Changes"})]})]})]})})},ru=({event:a,onClose:l})=>{const{addEvent:c,updateEvent:u}=jr(),[h,f]=O.useState(!1),[p,y]=O.useState((a==null?void 0:a.ticketTiers)||[]),{register:v,handleSubmit:g,reset:w,formState:{errors:N}}=Ia();O.useEffect(()=>{a&&w({title:a.title,date:a.date,time:a.time,venue:a.venue,description:a.description,capacity:a.capacity,tags:a.tags.join(", "),gradient:a.gradient,image:a.image,bookingUrl:a.bookingUrl})},[a,w]);const j=D=>{console.log("Form submitted with ticket tiers:",p);const P=p.map(K=>({...K,eventId:(a==null?void 0:a.id)||"new_event"})),S=P.filter(K=>K.isActive!==!1&&typeof K.price=="number"),I=S.length>0?Math.min(...S.map(K=>K.price)):0,M=I>0?`From ${(I/100).toFixed(0)}`:"Free",z={...D,price:M,ticketTiers:P};console.log("Final event data to save:",z),a?u(a.id,z):c(z),l()},_=D=>{console.log("Ticket tiers saved in EventForm:",D),y(D),f(!1)},L=[{value:"from-gray-600 to-gray-800",label:"Gray"},{value:"from-gray-700 to-gray-900",label:"Dark Gray"},{value:"from-gray-800 to-black",label:"Black"},{value:"from-gray-500 to-gray-700",label:"Light Gray"},{value:"from-blue-600 to-blue-800",label:"Blue"},{value:"from-green-600 to-green-800",label:"Green"},{value:"from-purple-600 to-purple-800",label:"Purple"},{value:"from-red-600 to-red-800",label:"Red"}];return r.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:l,children:[r.jsxs(Y.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:D=>D.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:a?"Edit Event":"Add New Event"}),r.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx(Jt,{className:"h-6 w-6"})})]}),r.jsxs("form",{onSubmit:g(j),className:"p-6 space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Event Title"}),r.jsx("input",{...v("title",{required:"Title is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent",placeholder:"Enter event title"}),N.title&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.title.message})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx(yt,{className:"inline h-4 w-4 mr-1"}),"Date"]}),r.jsx("input",{...v("date",{required:"Date is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent",placeholder:"e.g., Dec 15, 2024"}),N.date&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.date.message})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx(Kt,{className:"inline h-4 w-4 mr-1"}),"Time"]}),r.jsx("input",{...v("time",{required:"Time is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent",placeholder:"e.g., 7:00 PM"}),N.time&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.time.message})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx(br,{className:"inline h-4 w-4 mr-1"}),"Venue"]}),r.jsx("input",{...v("venue",{required:"Venue is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent",placeholder:"Enter venue name"}),N.venue&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.venue.message})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx(Qe,{className:"inline h-4 w-4 mr-1"}),"Capacity"]}),r.jsx("input",{...v("capacity",{required:"Capacity is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent",placeholder:"e.g., 200"}),N.capacity&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.capacity.message})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx(Wn,{className:"inline h-4 w-4 mr-1"}),"Tags (comma-separated)"]}),r.jsx("input",{...v("tags",{required:"Tags are required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent",placeholder:"e.g., Corporate, Networking, Formal"}),N.tags&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.tags.message})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color Theme"}),r.jsx("select",{...v("gradient",{required:"Gradient is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent",children:L.map(D=>r.jsx("option",{value:D.value,children:D.label},D.value))}),N.gradient&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.gradient.message})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Event Image URL"}),r.jsx("input",{...v("image",{required:"Image URL is required",pattern:{value:/^(https?:\/\/.+|\/.+)/,message:"Please enter a valid URL starting with http:// or https://, or a relative path starting with /"}}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent",placeholder:"https://images.unsplash.com/photo-... or /palace.png"}),N.image&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.image.message}),r.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Tip: You can use external URLs (https://picsum.photos/800/600?random=1) or local images (/palace.png)"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ticket Tiers"}),r.jsxs("button",{type:"button",onClick:()=>f(!0),className:"flex items-center gap-2 px-3 py-1 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[r.jsx(fs,{className:"h-4 w-4"}),"Manage Tiers"]})]}),p.length>0?r.jsx("div",{className:"space-y-2",children:p.sort((D,P)=>D.price-P.price).map(D=>r.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-gray-900",children:D.name}),r.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["",(D.price/100).toFixed(2)," - ",D.capacity," available"]})]}),r.jsxs("span",{className:"text-sm text-gray-500",children:[D.capacity-D.soldCount," left"]})]},D.id))}):r.jsx("p",{className:"text-sm text-gray-500",children:'No ticket tiers configured. Click "Manage Tiers" to add pricing options.'})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Booking URL (Optional - will be replaced by Stripe checkout)"}),r.jsx("input",{...v("bookingUrl"),type:"url",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent",placeholder:"https://example.com/book/event (optional)"}),N.bookingUrl&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.bookingUrl.message})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),r.jsx("textarea",{...v("description",{required:"Description is required"}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent",placeholder:"Enter event description"}),N.description&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.description.message})]}),r.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[r.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-4 py-2 bg-gray-900 hover:bg-gray-800 text-white rounded-md transition-colors",children:a?"Update Event":"Create Event"})]})]})]},(a==null?void 0:a.id)||"new-event"),h&&r.jsx(tu,{ticketTiers:p,eventId:(a==null?void 0:a.id)||"new_event",onSave:_,onClose:()=>f(!1)})]})},su=({isOpen:a,onClose:l,onSave:c,editingSociety:u})=>{const[h,f]=O.useState({name:"",code:"",contactName:"",contactEmail:"",contactPhone:"",university:"",societyType:"",commissionRate:5}),[p,y]=O.useState(!1);O.useEffect(()=>{f(u?{name:u.name,code:u.code,contactName:u.contactName||"",contactEmail:u.contactEmail||"",contactPhone:u.contactPhone||"",university:u.university||"",societyType:u.societyType||"",commissionRate:u.commissionRate}:{name:"",code:"",contactName:"",contactEmail:"",contactPhone:"",university:"",societyType:"",commissionRate:5})},[u,a]);const v=async w=>{if(w.preventDefault(),!h.name.trim()||!h.code.trim()){Re.error("Society name and code are required");return}y(!0);try{await c(h),Re.success(u?"Society updated successfully!":"Society created successfully!"),l()}catch(N){console.error("Error saving society:",N),Re.error("Failed to save society")}finally{y(!1)}},g=()=>{if(h.name){const w=h.name.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g,"-").substring(0,20);f(N=>({...N,code:w}))}};return a?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:u?"Edit Society":"Add New Society"}),r.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx(Jt,{className:"h-6 w-6"})})]}),r.jsxs("form",{onSubmit:v,className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx(Qe,{className:"inline h-4 w-4 mr-2"}),"Society Name *"]}),r.jsx("input",{type:"text",value:h.name,onChange:w=>f(N=>({...N,name:w.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"e.g., Imperial College Bollywood Society",required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx(Wn,{className:"inline h-4 w-4 mr-2"}),"Society Code *"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"text",value:h.code,onChange:w=>f(N=>({...N,code:w.target.value})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"e.g., imperial-bollywood",required:!0}),r.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Generate"})]}),r.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Used in tracking URLs: carnivalldn.com/events/bollywood-night?ref=",h.code]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx(Qe,{className:"inline h-4 w-4 mr-2"}),"Contact Name"]}),r.jsx("input",{type:"text",value:h.contactName,onChange:w=>f(N=>({...N,contactName:w.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"e.g., John Smith"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx(Us,{className:"inline h-4 w-4 mr-2"}),"Contact Email"]}),r.jsx("input",{type:"email",value:h.contactEmail,onChange:w=>f(N=>({...N,contactEmail:w.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"e.g., john@imperial.ac.uk"})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx(un,{className:"inline h-4 w-4 mr-2"}),"Contact Phone"]}),r.jsx("input",{type:"tel",value:h.contactPhone,onChange:w=>f(N=>({...N,contactPhone:w.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"e.g., +44 20 7589 5111"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx(nl,{className:"inline h-4 w-4 mr-2"}),"University"]}),r.jsxs("select",{value:h.university,onChange:w=>f(N=>({...N,university:w.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"Select University"}),r.jsx("option",{value:"Imperial College London",children:"Imperial College London"}),r.jsx("option",{value:"University College London",children:"University College London"}),r.jsx("option",{value:"King's College London",children:"King's College London"}),r.jsx("option",{value:"London School of Economics",children:"London School of Economics"}),r.jsx("option",{value:"Queen Mary University",children:"Queen Mary University"}),r.jsx("option",{value:"City University London",children:"City University London"}),r.jsx("option",{value:"Brunel University",children:"Brunel University"}),r.jsx("option",{value:"Other",children:"Other"})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx(Wn,{className:"inline h-4 w-4 mr-2"}),"Society Type"]}),r.jsxs("select",{value:h.societyType,onChange:w=>f(N=>({...N,societyType:w.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"Select Type"}),r.jsx("option",{value:"bollywood",children:"Bollywood/Cultural"}),r.jsx("option",{value:"cultural",children:"Cultural Society"}),r.jsx("option",{value:"music",children:"Music Society"}),r.jsx("option",{value:"dance",children:"Dance Society"}),r.jsx("option",{value:"social",children:"Social Society"}),r.jsx("option",{value:"general",children:"General"}),r.jsx("option",{value:"other",children:"Other"})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx(il,{className:"inline h-4 w-4 mr-2"}),"Commission Rate (%)"]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"number",min:"0",max:"50",step:"0.1",value:h.commissionRate,onChange:w=>f(N=>({...N,commissionRate:parseFloat(w.target.value)||0})),className:"w-32 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"5.0"}),r.jsx("span",{className:"text-sm text-gray-500",children:"% of ticket sales"})]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Commission paid to society for each ticket sold through their links"})]}),r.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[r.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:p,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Saving...":u?"Update Society":"Create Society"})]})]})]})}):null},nu=({isOpen:a,onClose:l,onGenerateLinks:c,societies:u,events:h})=>{const[f,p]=O.useState(""),[y,v]=O.useState([]),[g,w]=O.useState(!1),[N,j]=O.useState([]);O.useEffect(()=>{a||(p(""),v([]),j([]))},[a]);const _=async I=>{if(I.preventDefault(),!f||y.length===0){Re.error("Please select an event and at least one society");return}w(!0);try{await c(y,f),Re.success(`Generated ${y.length} tracking link(s) successfully!`);const M=h.find(K=>K.id===f),z=y.map(K=>{const ce=u.find(Q=>Q.id===K);return{id:`link-${K}-${f}`,societyId:K,eventId:f,linkCode:`${ce==null?void 0:ce.code}-${M==null?void 0:M.id}`,customUrl:void 0,isActive:!0,createdAt:new Date}});j(z)}catch(M){console.error("Error generating links:",M),Re.error("Failed to generate tracking links")}finally{w(!1)}},L=I=>{navigator.clipboard.writeText(I),Re.success("Link copied to clipboard!")},D=I=>{v(M=>M.includes(I)?M.filter(z=>z!==I):[...M,I])},P=()=>{v(u.map(I=>I.id))},S=()=>{v([])};return a?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Generate Tracking Links"}),r.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx(Jt,{className:"h-6 w-6"})})]}),r.jsx("div",{className:"p-6",children:N.length===0?r.jsxs("form",{onSubmit:_,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx(yt,{className:"inline h-4 w-4 mr-2"}),"Select Event *"]}),r.jsxs("select",{value:f,onChange:I=>p(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:[r.jsx("option",{value:"",children:"Choose an event..."}),h.map(I=>r.jsxs("option",{value:I.id,children:[I.title," - ",I.date]},I.id))]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[r.jsx(Qe,{className:"inline h-4 w-4 mr-2"}),"Select Societies *"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{type:"button",onClick:P,className:"text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:"Select All"}),r.jsx("button",{type:"button",onClick:S,className:"text-xs px-2 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors",children:"Clear All"})]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-60 overflow-y-auto border border-gray-200 rounded-lg p-4",children:u.map(I=>r.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:y.includes(I.id),onChange:()=>D(I.id),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:I.name}),r.jsxs("div",{className:"text-xs text-gray-500",children:[I.university,"  ",I.code]})]})]},I.id))}),y.length>0&&r.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[y.length," society(ies) selected"]})]}),f&&y.length>0&&r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Preview Links:"}),r.jsx("div",{className:"space-y-2",children:y.map(I=>{const M=u.find(ce=>ce.id===I),z=h.find(ce=>ce.id===f),K=`carnivalldn.com/events?event=${z==null?void 0:z.id}&ref=${M==null?void 0:M.code}`;return r.jsxs("div",{className:"text-xs text-gray-600 bg-white p-2 rounded border",children:[r.jsx("div",{className:"font-medium",children:M==null?void 0:M.name}),r.jsx("div",{className:"text-gray-500",children:K})]},I)})})]}),r.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[r.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:g||!f||y.length===0,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Generating...":`Generate ${y.length} Link(s)`})]})]}):r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Links Generated Successfully!"}),r.jsxs("p",{className:"text-sm text-green-700 mt-1",children:[N.length," tracking link(s) have been created and are ready to use."]})]})]})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Generated Tracking Links"}),r.jsx("div",{className:"space-y-3",children:N.map(I=>{const M=u.find(ce=>ce.id===I.societyId),z=h.find(ce=>ce.id===I.eventId),K=`https://carnivalldn.com/events?event=${z==null?void 0:z.id}&ref=${M==null?void 0:M.code}`;return r.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-purple-400 to-pink-400 flex items-center justify-center",children:r.jsx("span",{className:"text-white font-semibold text-xs",children:M==null?void 0:M.name.substring(0,2).toUpperCase()})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:M==null?void 0:M.name}),r.jsx("div",{className:"text-xs text-gray-500",children:z==null?void 0:z.title})]})]}),r.jsx("div",{className:"mt-2 text-sm text-gray-600 font-mono bg-gray-50 p-2 rounded",children:K})]}),r.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[r.jsx("button",{onClick:()=>L(K),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Copy link",children:r.jsx(wa,{className:"h-4 w-4"})}),r.jsx("a",{href:K,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Open link",children:r.jsx(va,{className:"h-4 w-4"})})]})]})},I.id)})})]}),r.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[r.jsx("button",{onClick:()=>{j([]),p(""),v([])},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Generate More"}),r.jsx("button",{onClick:l,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Done"})]})]})})]})}):null},iu=({society:a,isOpen:l,onClose:c})=>!l||!a?null:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Society Details"}),r.jsx("button",{onClick:c,className:"text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx(Jt,{className:"w-6 h-6"})})]}),r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx("div",{className:"h-16 w-16 rounded-full bg-gradient-to-r from-purple-400 to-pink-400 flex items-center justify-center",children:r.jsx("span",{className:"text-white font-bold text-xl",children:a.name.split(" ").map(u=>u[0]).join("").substring(0,2).toUpperCase()})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:a.name}),r.jsxs("p",{className:"text-gray-600",children:["Code: ",a.code]}),r.jsx("div",{className:"flex items-center mt-1",children:r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${a.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.isActive?"Active":"Inactive"})})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h4",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[r.jsx(Qe,{className:"w-5 h-5 mr-2 text-purple-600"}),"Contact Information"]}),a.contactName&&r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Qe,{className:"w-4 h-4 text-gray-400"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.contactName}),r.jsx("p",{className:"text-xs text-gray-500",children:"Contact Person"})]})]}),a.contactEmail&&r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Us,{className:"w-4 h-4 text-gray-400"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.contactEmail}),r.jsx("p",{className:"text-xs text-gray-500",children:"Email"})]})]}),a.contactPhone&&r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(un,{className:"w-4 h-4 text-gray-400"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.contactPhone}),r.jsx("p",{className:"text-xs text-gray-500",children:"Phone"})]})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h4",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[r.jsx(br,{className:"w-5 h-5 mr-2 text-purple-600"}),"Society Information"]}),a.university&&r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(br,{className:"w-4 h-4 text-gray-400"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.university}),r.jsx("p",{className:"text-xs text-gray-500",children:"University"})]})]}),a.societyType&&r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Qe,{className:"w-4 h-4 text-gray-400"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.societyType}),r.jsx("p",{className:"text-xs text-gray-500",children:"Society Type"})]})]}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Ms,{className:"w-4 h-4 text-gray-400"}),r.jsxs("div",{children:[r.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[a.commissionRate,"%"]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Commission Rate"})]})]})]})]}),r.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[r.jsxs("h4",{className:"text-lg font-semibold text-gray-900 flex items-center mb-4",children:[r.jsx(yt,{className:"w-5 h-5 mr-2 text-purple-600"}),"Important Dates"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Created"}),r.jsx("p",{className:"text-sm text-gray-600",children:new Date(a.createdAt).toLocaleDateString("en-GB",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Last Updated"}),r.jsx("p",{className:"text-sm text-gray-600",children:new Date(a.updatedAt).toLocaleDateString("en-GB",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]})]}),r.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200",children:r.jsx("button",{onClick:c,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Close"})})]})}),au=({society:a,isOpen:l,onClose:c})=>{const{affiliateLinks:u,events:h}=jr(),[f,p]=O.useState([]),[y,v]=O.useState(null);O.useEffect(()=>{if(console.log(" SocietyLinksModal useEffect:",{society:a==null?void 0:a.name,societyId:a==null?void 0:a.id,affiliateLinksLength:u.length,affiliateLinks:u.map(j=>({id:j.id,societyId:j.societyId}))}),a){const j=u.filter(_=>_.societyId===a.id);console.log(" Filtered links for society:",j),p(j)}},[a,u]);const g=async(j,_)=>{try{await navigator.clipboard.writeText(j),v(_),setTimeout(()=>v(null),2e3)}catch(L){console.error("Failed to copy text: ",L)}},w=j=>{const _=h.find(L=>L.id===j);return _?_.title:"Unknown Event"},N=j=>{const _=h.find(L=>L.id===j);return _?_.date:"Unknown Date"};return!l||!a?null:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Affiliate Links"}),r.jsxs("p",{className:"text-gray-600 mt-1",children:[a.name," - ",a.code]})]}),r.jsx("button",{onClick:c,className:"text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx(Jt,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"p-6",children:f.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx(va,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Links Generated"}),r.jsx("p",{className:"text-gray-500 mb-4",children:"This society doesn't have any affiliate links yet."}),r.jsx("p",{className:"text-sm text-gray-400",children:'Use the "Generate Links" button to create tracking links for events.'})]}):r.jsx("div",{className:"space-y-4",children:f.map(j=>{const _=w(j.eventId),L=N(j.eventId),D=`https://carnivalldn.com/events?event=${j.eventId}&ref=${a.code}`;return r.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:r.jsx("div",{className:"flex items-start justify-between",children:r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:_}),r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${j.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:j.isActive?"Active":"Inactive"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(yt,{className:"w-4 h-4 text-gray-400"}),r.jsx("span",{className:"text-sm text-gray-600",children:L})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(hs,{className:"w-4 h-4 text-gray-400"}),r.jsxs("span",{className:"text-sm text-gray-600",children:["Link ID: ",j.id.substring(0,8),"..."]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Qe,{className:"w-4 h-4 text-gray-400"}),r.jsxs("span",{className:"text-sm text-gray-600",children:["Society: ",a.code]})]})]}),r.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[r.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Affiliate Link:"}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("code",{className:"text-sm text-gray-800 flex-1 break-all",children:D}),r.jsxs("button",{onClick:()=>g(D,j.id),className:"flex items-center space-x-1 px-2 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 transition-colors",children:[r.jsx(wa,{className:"w-3 h-3"}),r.jsx("span",{children:y===j.id?"Copied!":"Copy"})]})]})]}),r.jsx("div",{className:"text-xs text-gray-500",children:r.jsxs("p",{children:["Created: ",new Date(j.createdAt).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})})]})})},j.id)})})}),r.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200",children:r.jsx("button",{onClick:c,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Close"})})]})})},ou=({selectedTimeframe:a,selectedEvent:l,events:c,activeTab:u,onTimeframeChange:h,onEventChange:f,onTabChange:p,onRefresh:y})=>r.jsx("div",{className:"bg-white shadow-sm border-b",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"}),r.jsx("p",{className:"text-gray-600 mt-1",children:"Manage analytics, events, orders, affiliate tracking, and scan tickets"})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("select",{value:a,onChange:v=>h(v.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[r.jsx("option",{value:"7d",children:"Last 7 days"}),r.jsx("option",{value:"30d",children:"Last 30 days"}),r.jsx("option",{value:"90d",children:"Last 90 days"})]}),r.jsxs("select",{value:l,onChange:v=>f(v.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[r.jsx("option",{value:"all",children:"All Events"}),c==null?void 0:c.map(v=>r.jsx("option",{value:v.id,children:v.title},v.id))]}),r.jsx("button",{onClick:y,className:"p-2 text-gray-500 hover:text-gray-700 transition-colors",children:r.jsx(Na,{className:"h-5 w-5"})})]})]}),r.jsxs("div",{className:"mt-6 flex items-center gap-2",children:[r.jsx("button",{onClick:()=>p("analytics"),className:`px-4 py-2 rounded-lg text-sm font-medium border ${u==="analytics"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Analytics"}),r.jsx("button",{onClick:()=>p("events"),className:`px-4 py-2 rounded-lg text-sm font-medium border ${u==="events"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Event Management"}),r.jsx("button",{onClick:()=>p("orders"),className:`px-4 py-2 rounded-lg text-sm font-medium border ${u==="orders"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Orders"}),r.jsx("button",{onClick:()=>p("affiliate"),className:`px-4 py-2 rounded-lg text-sm font-medium border ${u==="affiliate"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Affiliate Tracking"})]})]})}),lu=({stats:a,onExportAll:l,quickEventButtons:c})=>{const u=S=>`${(S/100).toFixed(2)}`,h=S=>`${S.toFixed(1)}%`;if(!a)return null;const f=(S,I)=>I===0?S>0?100:0:(S-I)/I*100,p=Math.floor(a.totalRevenue*(.7+Math.random()*.3)),y=Math.floor(a.totalOrders*(.6+Math.random()*.4)),v=Math.floor(a.totalTickets*(.65+Math.random()*.35)),g=a.conversionRate*(.8+Math.random()*.2),w=f(a.totalRevenue,p),N=f(a.totalOrders,y),j=f(a.totalTickets,v),_=f(a.conversionRate,g),L=S=>S>=15?"text-green-600 bg-green-100 border-green-200":S>=5?"text-blue-600 bg-blue-100 border-blue-200":S>=0?"text-yellow-600 bg-yellow-100 border-yellow-200":"text-red-600 bg-red-100 border-red-200",D=S=>S>=0?r.jsx(Ri,{className:"h-4 w-4 text-green-500 mr-1"}):r.jsx(Ri,{className:"h-4 w-4 text-red-500 mr-1 transform rotate-90"}),P=S=>S>=15?"Excellent Growth":S>=5?"Good Growth":S>=0?"Stable":"Declining";return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"flex items-center gap-2",children:c}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("button",{onClick:()=>window.location.href="/scanner",className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors shadow-sm",children:[r.jsx(al,{className:"h-4 w-4"}),"Ticket Scanner"]}),r.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:[r.jsx(Ca,{className:"h-4 w-4"}),"Export Customer Data"]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),r.jsx("p",{className:"text-3xl font-bold text-gray-900",children:u(a.totalRevenue)})]}),r.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:r.jsx(Ms,{className:"h-6 w-6 text-green-600"})})]}),r.jsxs("div",{className:"flex items-center mt-4 text-sm",children:[D(w),r.jsxs("span",{className:`font-medium px-2 py-1 rounded-full text-xs border ${L(w)}`,children:[w>=0?"+":"",h(w)]}),r.jsx("span",{className:"text-gray-500 ml-2",children:"from last period"})]}),r.jsx("div",{className:"mt-2",children:r.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${w>=15?"bg-green-100 text-green-800 border-green-200":w>=5?"bg-blue-100 text-blue-800 border-blue-200":w>=0?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-red-100 text-red-800 border-red-200"}`,children:P(w)})})]}),r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),r.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.totalOrders})]}),r.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:r.jsx(fs,{className:"h-6 w-6 text-blue-600"})})]}),r.jsxs("div",{className:"flex items-center mt-4 text-sm",children:[D(N),r.jsxs("span",{className:`font-medium px-2 py-1 rounded-full text-xs border ${L(N)}`,children:[N>=0?"+":"",h(N)]}),r.jsx("span",{className:"text-gray-500 ml-2",children:"from last period"})]}),r.jsx("div",{className:"mt-2",children:r.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${N>=15?"bg-green-100 text-green-800 border-green-200":N>=5?"bg-blue-100 text-blue-800 border-blue-200":N>=0?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-red-100 text-red-800 border-red-200"}`,children:P(N)})})]}),r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tickets Sold"}),r.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.totalTickets})]}),r.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:r.jsx(Qe,{className:"h-6 w-6 text-purple-600"})})]}),r.jsxs("div",{className:"flex items-center mt-4 text-sm",children:[D(j),r.jsxs("span",{className:`font-medium px-2 py-1 rounded-full text-xs border ${L(j)}`,children:[j>=0?"+":"",h(j)]}),r.jsx("span",{className:"text-gray-500 ml-2",children:"from last period"})]}),r.jsx("div",{className:"mt-2",children:r.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${j>=15?"bg-green-100 text-green-800 border-green-200":j>=5?"bg-blue-100 text-blue-800 border-blue-200":j>=0?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-red-100 text-red-800 border-red-200"}`,children:P(j)})})]}),r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Conversion Rate"}),r.jsx("p",{className:"text-3xl font-bold text-gray-900",children:h(a.conversionRate)})]}),r.jsx("div",{className:"p-3 bg-orange-100 rounded-full",children:r.jsx(Ds,{className:"h-6 w-6 text-orange-600"})})]}),r.jsxs("div",{className:"flex items-center mt-4 text-sm",children:[D(_),r.jsxs("span",{className:`font-medium px-2 py-1 rounded-full text-xs border ${L(_)}`,children:[_>=0?"+":"",h(_)]}),r.jsx("span",{className:"text-gray-500 ml-2",children:"from last period"})]}),r.jsx("div",{className:"mt-2",children:r.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${_>=15?"bg-green-100 text-green-800 border-green-200":_>=5?"bg-blue-100 text-blue-800 border-blue-200":_>=0?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-red-100 text-red-800 border-red-200"}`,children:P(_)})})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Performance Insights"}),r.jsx("div",{className:"flex gap-2",children:r.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full border border-green-200",children:a.topPerformingEvent?"Top Event":"No Data"})})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Average Order Value"}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:u(a.averageOrderValue)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Revenue per Ticket"}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:u(a.totalRevenue/Math.max(1,a.totalTickets))})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Orders per Day"}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:(a.totalOrders/30).toFixed(1)})]})]})]}),r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Customer Insights"}),r.jsx("div",{className:"flex gap-2",children:r.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full border border-blue-200",children:a.totalOrders>0?"Active":"No Orders"})})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Events with Sales"}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:a.revenueByEvent.filter(S=>S.revenue>0).length})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Top Tier Sales"}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:a.ticketSalesByTier.length>0?a.ticketSalesByTier[0].tier:"N/A"})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Daily Revenue Avg"}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:u(a.dailyRevenue.reduce((S,I)=>S+I.revenue,0)/Math.max(1,a.dailyRevenue.length))})]})]})]})]})]})},cu=({stats:a,events:l})=>{var j,_;const c=L=>`${(L/100).toFixed(2)}`;if(!a||!l)return null;const u=()=>{const L=new Date,D=new Date(L.getTime()+7*24*60*60*1e3);return l.filter(P=>!P.isArchived).filter(P=>{const S=new Date(P.date);return S>=L&&S<=D}).sort((P,S)=>new Date(P.date).getTime()-new Date(S.date).getTime()).slice(0,3)},h=()=>{const L=l.filter(S=>!S.isArchived);if(L.length===0)return 0;const D=L.reduce((S,I)=>S+(parseInt(I.capacity)||0),0),P=a.ticketSalesByTier.reduce((S,I)=>S+I.sold,0);return D>0?P/D*100:0},f=()=>a.ticketSalesByTier.length===0?null:a.ticketSalesByTier.sort((L,D)=>D.sold-L.sold)[0],p=()=>{const L=u();if(L.length===0)return{score:0,label:"No Events",color:"gray"};const D=h(),P=L.map(z=>{const K=new Date(z.date),ce=new Date;return Math.ceil((K.getTime()-ce.getTime())/(1e3*60*60*24))});let S=0;D>=80?S+=40:D>=60?S+=30:D>=40?S+=20:S+=10;const I=P.reduce((z,K)=>z+K,0)/P.length;I<=3?S+=30:I<=7?S+=25:I<=14?S+=20:S+=15;const M=a.dailyRevenue.slice(-7).reduce((z,K)=>z+K.revenue,0);return M>=1e4?S+=30:M>=5e3?S+=25:M>=1e3?S+=20:S+=10,S>=80?{score:S,label:"Excellent",color:"green"}:S>=60?{score:S,label:"Good",color:"blue"}:S>=40?{score:S,label:"Fair",color:"yellow"}:{score:S,label:"Needs Attention",color:"red"}},y=u(),v=h(),g=f(),w=p(),N=L=>{switch(L){case"green":return r.jsx(Pt,{className:"h-5 w-5 text-green-600"});case"blue":return r.jsx(Ds,{className:"h-5 w-5 text-blue-600"});case"yellow":return r.jsx(Gn,{className:"h-5 w-5 text-yellow-600"});case"red":return r.jsx(Gn,{className:"h-5 w-5 text-red-600"});default:return r.jsx(Kt,{className:"h-5 w-5 text-gray-600"})}};return r.jsx("div",{className:"space-y-8",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mt-8 mb-8",children:[r.jsxs(Y.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Event Performance"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(yt,{className:"h-5 w-5 text-blue-600"}),r.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full border border-blue-200",children:"Live Data"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-100",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:r.jsx(yt,{className:"h-4 w-4 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Upcoming Events"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Next 7 days"})]})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-2xl font-bold text-blue-900",children:y.length}),y.length>0&&r.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[(_=(j=y[0])==null?void 0:j.title)==null?void 0:_.slice(0,15),"..."]})]})]}),r.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-100",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:r.jsx(Qe,{className:"h-4 w-4 text-green-600"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Capacity"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Utilization"})]})]}),r.jsxs("div",{className:"text-center",children:[r.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[v.toFixed(0),"%"]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1 mt-2",children:r.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-1 rounded-full transition-all duration-300",style:{width:`${Math.min(v,100)}%`}})})]})]}),r.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-100",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-purple-100 rounded-full",children:r.jsx(Yn,{className:"h-4 w-4 text-purple-600"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Best Selling"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Ticket Tier"})]})]}),r.jsx("div",{className:"text-center",children:g?r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"text-lg font-bold text-purple-900",children:g.tier.split(" - ")[1]}),r.jsxs("p",{className:"text-xs text-purple-600 mt-1",children:[g.sold," sold"]})]}):r.jsx("p",{className:"text-lg font-bold text-gray-400",children:"No sales yet"})})]}),r.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg border border-orange-100",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[r.jsx("div",{className:"p-2 bg-orange-100 rounded-full",children:N(w.color)}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Event Health"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Score"})]})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-lg font-bold text-orange-900",children:w.label}),r.jsxs("p",{className:"text-xs text-orange-600 mt-1",children:[w.score,"/100"]})]})]})]}),r.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100",children:r.jsxs("div",{className:"flex gap-2 justify-center",children:[r.jsxs("span",{className:`px-3 py-1 text-xs font-medium rounded-full border ${v>=80?"bg-green-100 text-green-800 border-green-200":v>=60?"bg-blue-100 text-blue-800 border-blue-200":v>=40?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-red-100 text-red-800 border-red-200"}`,children:[v.toFixed(0),"% Capacity Filled"]}),r.jsxs("span",{className:"px-3 py-1 text-xs font-medium bg-purple-100 text-purple-800 rounded-full border border-purple-200",children:[a.ticketSalesByTier.filter(L=>L.revenue>0).length," Active Tiers"]})]})})]}),r.jsxs(Y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.6},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Business Insights"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ds,{className:"h-5 w-5 text-gray-400"}),r.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-indigo-100 text-indigo-800 rounded-full border border-indigo-200",children:"Live Data"})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-100",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:r.jsx(Qe,{className:"h-5 w-5 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Customer Acquisition"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Last 30 days"})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-lg font-bold text-blue-900",children:a.ticketSalesByTier.reduce((L,D)=>L+D.sold,0)}),r.jsx("p",{className:"text-xs text-blue-600",children:"New customers"})]})]})}),r.jsx("div",{className:"p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-100",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:r.jsx(Ds,{className:"h-5 w-5 text-green-600"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Revenue per Customer"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Average"})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-lg font-bold text-green-900",children:c(a.ticketSalesByTier.reduce((L,D)=>L+D.revenue,0)/Math.max(1,a.ticketSalesByTier.reduce((L,D)=>L+D.sold,0)))}),r.jsx("p",{className:"text-xs text-green-600",children:"Per customer"})]})]})}),r.jsx("div",{className:"p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border border-purple-100",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-purple-100 rounded-full",children:r.jsx(yt,{className:"h-5 w-5 text-purple-600"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Event Performance"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Success Rate"})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"text-lg font-bold text-purple-900",children:[a.revenueByEvent.filter(L=>L.revenue>0).length,"/",a.revenueByEvent.length]}),r.jsx("p",{className:"text-xs text-purple-600",children:"Events with sales"})]})]})})]})]})]})})},du=({currentEvents:a,archivedEvents:l,onAddEvent:c,onEditEvent:u,onArchiveToggle:h,onDeleteEvent:f,onGuestlist:p})=>{const y=(v,g=!1)=>r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Event"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Venue"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tiers"}),r.jsx("th",{className:"px-6 py-3"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(w=>{var N;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm font-medium text-gray-900 truncate max-w-[220px]",children:w.title})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:w.date}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 truncate max-w-[180px]",children:w.venue}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((N=w.ticketTiers)==null?void 0:N.length)||0}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsxs("button",{onClick:()=>p(w),className:"px-3 py-1 rounded-md border border-blue-200 text-blue-700 hover:bg-blue-50 flex items-center gap-1",children:[r.jsx(Qe,{className:"h-4 w-4"}),"Guestlist"]}),r.jsx("button",{onClick:()=>u(w),className:"px-3 py-1 rounded-md border text-gray-700 hover:bg-gray-50",children:"Edit"}),r.jsx("button",{onClick:()=>h(w),className:"px-3 py-1 rounded-md border text-gray-700 hover:bg-gray-50",children:g?"Unarchive":"Archive"}),g&&r.jsx("button",{onClick:()=>f(w),className:"px-3 py-1 rounded-md border border-red-200 text-red-700 hover:bg-red-50",children:"Delete"})]})})]},w.id)})})]})})});return r.jsxs("div",{className:"space-y-10",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Manage Events"}),r.jsx("button",{onClick:c,className:"px-4 py-2 bg-gray-900 hover:bg-gray-800 text-white rounded-md text-sm",children:"Add Event"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h4",{className:"text-md font-semibold text-gray-800",children:"Current Events"}),r.jsxs("span",{className:"text-sm text-gray-500",children:[a.length," events"]})]}),y(a,!1)]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h4",{className:"text-md font-semibold text-gray-800",children:"Archived Events"}),r.jsxs("span",{className:"text-sm text-gray-500",children:[l.length," events"]})]}),y(l,!0)]})]})},uu=({orders:a,events:l})=>{const[c,u]=O.useState(""),[h,f]=O.useState(10),[p,y]=O.useState(1),v=S=>`${(S/100).toFixed(2)}`,g=S=>{if(!S.scans||S.scans.length===0)return{text:"Not Scanned",color:"text-gray-500",icon:Kt};const I=S.scans.filter(K=>K.scanType==="entry"),M=S.scans.filter(K=>K.scanType==="exit"),z=S.scans[0];return I.length>0&&M.length>0?{text:"Scanned In & Out",color:"text-blue-600",icon:Pt,time:new Date(z.scannedAt).toLocaleTimeString()}:I.length>0?{text:"Scanned In",color:"text-green-600",icon:Pt,time:new Date(z.scannedAt).toLocaleTimeString()}:M.length>0?{text:"Scanned Out",color:"text-orange-600",icon:Rs,time:new Date(z.scannedAt).toLocaleTimeString()}:{text:"Not Scanned",color:"text-gray-500",icon:Kt}},w=a.filter(S=>{var M,z,K,ce,Q;if(!c.trim())return!0;const I=c.toLowerCase();return((M=S.customerName)==null?void 0:M.toLowerCase().includes(I))||((z=S.customerEmail)==null?void 0:z.toLowerCase().includes(I))||((K=S.id)==null?void 0:K.toLowerCase().includes(I))||((Q=(ce=l==null?void 0:l.find(ye=>ye.id===S.eventId))==null?void 0:ce.title)==null?void 0:Q.toLowerCase().includes(I))}),N=Math.ceil(w.length/h),j=(p-1)*h,_=j+h,L=w.slice(j,_),D=S=>{y(S)},P=S=>{f(S),y(1)};return!a||a.length===0?r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 text-center",children:r.jsx("p",{className:"text-gray-500",children:"No orders to display"})}):r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"All Orders"}),r.jsx("div",{className:"flex items-center gap-3",children:r.jsxs("div",{className:"relative",children:[r.jsx(Ea,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search orders...",value:c,onChange:S=>{u(S.target.value),y(1)},className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent w-64"})]})})]})}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Event"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tickets"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Scan Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:L.map(S=>{var z,K,ce;const I=g(S),M=I.icon;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("span",{className:"text-sm font-medium text-gray-900 font-mono",children:[(z=S.id)==null?void 0:z.slice(0,8),"..."]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:S.customerName}),r.jsx("div",{className:"text-sm text-gray-500",children:S.customerEmail})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:((K=l==null?void 0:l.find(Q=>Q.id===S.eventId))==null?void 0:K.title)||"Unknown Event"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:((ce=S.tickets)==null?void 0:ce.reduce((Q,ye)=>Q+(ye.quantity||0),0))||0}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:v(S.totalAmount||0)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${S.status==="completed"?"bg-green-100 text-green-800":S.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:S.status})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsxs("div",{className:`flex items-center gap-1 ${I.color}`,children:[r.jsx(M,{className:"h-4 w-4"}),r.jsx("span",{className:"text-xs font-medium",children:I.text})]}),I.time&&r.jsx("span",{className:"text-xs text-gray-500",children:I.time})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(S.createdAt).toLocaleDateString()})]},S.id)})})]})}),r.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("label",{className:"text-sm text-gray-600",children:"Show:"}),r.jsxs("select",{value:h,onChange:S=>P(Number(S.target.value)),className:"px-3 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:5,children:"5"}),r.jsx("option",{value:10,children:"10"}),r.jsx("option",{value:25,children:"25"}),r.jsx("option",{value:50,children:"50"})]}),r.jsx("span",{className:"text-sm text-gray-600",children:"records"})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",j+1," to ",Math.min(_,w.length)," of ",w.length," results",c&&r.jsxs("span",{className:"ml-2 text-blue-600",children:["(filtered from ",a.length," total)"]})]}),N>1&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>D(p-1),disabled:p===1,className:"px-3 py-1 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),r.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:N},(S,I)=>I+1).map(S=>r.jsx("button",{onClick:()=>D(S),className:`px-3 py-1 text-sm font-medium rounded-md ${S===p?"bg-blue-600 text-white":"text-gray-500 bg-white border border-gray-300 hover:bg-gray-50"}`,children:S},S))}),r.jsx("button",{onClick:()=>D(p+1),disabled:p===N,className:"px-3 py-1 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})})]})},hu=({orders:a,events:l})=>{const c=u=>`${(u/100).toFixed(2)}`;return!a||a.length===0?r.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 text-center",children:r.jsx("p",{className:"text-gray-500",children:"No recent orders to display"})}):r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Orders"})}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Event"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(u=>{var h,f;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:r.jsxs("span",{className:"text-sm font-medium text-gray-900 font-mono",children:[(h=u.id)==null?void 0:h.slice(0,8),"..."]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:u.customerName}),r.jsx("div",{className:"text-sm text-gray-500",children:u.customerEmail})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:r.jsx("span",{className:"text-sm text-gray-900",children:((f=l==null?void 0:l.find(p=>p.id===u.eventId))==null?void 0:f.title)||"Unknown Event"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:r.jsx("span",{className:"text-sm font-semibold text-gray-900",children:c(u.totalAmount||0)})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${u.status==="completed"?"bg-green-100 text-green-800":u.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:u.status})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center",children:new Date(u.createdAt).toLocaleDateString()})]},u.id)})})]})})]})},fu=({creatingEvents:a,onCreateEvent:l})=>r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>l("sundowner"),disabled:a.includes("sundowner"),className:"px-3 py-2 bg-gradient-to-r from-orange-400 to-red-500 text-white text-sm font-medium rounded-lg hover:from-orange-500 hover:to-red-600 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:a.includes("sundowner")?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creating..."]}):r.jsx(r.Fragment,{children:" Add Sundowner"})}),r.jsx("button",{onClick:()=>l("bollywood"),disabled:a.includes("bollywood"),className:"px-3 py-2 bg-gradient-to-r from-purple-400 to-pink-500 text-white text-sm font-medium rounded-lg hover:from-purple-500 hover:to-pink-600 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:a.includes("bollywood")?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creating..."]}):r.jsx(r.Fragment,{children:" Add Bollywood Night"})}),r.jsx("button",{onClick:()=>l("carnival"),disabled:a.includes("carnival"),className:"px-3 py-2 bg-gradient-to-r from-green-400 to-blue-500 text-white text-sm font-medium rounded-lg hover:from-green-500 hover:to-blue-600 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:a.includes("carnival")?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creating..."]}):r.jsx(r.Fragment,{children:" Add Carnival"})})]}),xu=({confirm:a,onClose:l,onConfirm:c})=>a?r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:l,children:r.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md p-6 text-center",onClick:u=>u.stopPropagation(),children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:a.type==="delete"?"Delete Event":a.event.isArchived?"Unarchive Event":"Archive Event"}),r.jsx("p",{className:"text-sm text-gray-600 mb-6",children:a.type==="delete"?"This will permanently delete the event and related data (if archived). This action cannot be undone.":a.event.isArchived?"This will unarchive the event and make it visible again.":"This will archive the event and hide it from public view."}),r.jsxs("div",{className:"flex items-center justify-center gap-3",children:[r.jsx("button",{onClick:l,className:"px-4 py-2 rounded-md border text-gray-700",children:"Cancel"}),r.jsx("button",{onClick:c,className:`px-4 py-2 rounded-md text-white ${a.type==="delete"?"bg-red-600 hover:bg-red-700":"bg-gray-900 hover:bg-gray-800"}`,children:a.type==="delete"?"Delete":a.event.isArchived?"Unarchive":"Archive"})]})]})}):null,mu=({order:a,event:l,isOpen:c,onClose:u})=>{var N,j;if(!a||!l)return null;const h=_=>`${(_/100).toFixed(2)}`,f=_=>(typeof _=="string"?new Date(_):_).toLocaleDateString("en-GB",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),p=_=>(typeof _=="string"?new Date(_):_).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),y=_=>{const L=new Date(_),D=new Date;let P=D.getFullYear()-L.getFullYear();const S=D.getMonth()-L.getMonth();return(S<0||S===0&&D.getDate()<L.getDate())&&P--,P},g=(()=>{if(!a.scans||a.scans.length===0)return{text:"Not Scanned",color:"text-gray-500",icon:Kt};const _=a.scans.filter(P=>P.scanType==="entry"),L=a.scans.filter(P=>P.scanType==="exit"),D=a.scans[0];return _.length>0&&L.length>0?{text:"Scanned In & Out",color:"text-blue-600",icon:Pt,time:new Date(D.scannedAt).toLocaleTimeString()}:_.length>0?{text:"Scanned In",color:"text-green-600",icon:Pt,time:new Date(D.scannedAt).toLocaleTimeString()}:L.length>0?{text:"Scanned Out",color:"text-orange-600",icon:Rs,time:new Date(D.scannedAt).toLocaleTimeString()}:{text:"Not Scanned",color:"text-gray-500",icon:Kt}})(),w=g.icon;return r.jsx(oi,{children:c&&r.jsx(Y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",onClick:u,children:r.jsxs(Y.div,{initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",onClick:_=>_.stopPropagation(),children:[r.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center",children:r.jsx(fs,{className:"h-6 w-6"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Order Details"}),r.jsxs("p",{className:"text-blue-100",children:["Order ID: ",(N=a.id)==null?void 0:N.slice(0,8),"..."]})]})]}),r.jsx("button",{onClick:u,className:"w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center hover:bg-white hover:bg-opacity-30 transition-colors",children:r.jsx(Jt,{className:"h-5 w-5"})})]})}),r.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[r.jsx(Aa,{className:"h-5 w-5 text-blue-600"}),"Order Information"]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Status:"}),r.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full border ${a.status==="completed"?"bg-green-100 text-green-800 border-green-200":a.status==="pending"?"bg-yellow-100 text-yellow-800 border-yellow-200":a.status==="failed"?"bg-red-100 text-red-800 border-red-200":"bg-gray-100 text-gray-800 border-gray-200"}`,children:a.status||"N/A"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Total Amount:"}),r.jsx("span",{className:"font-semibold text-gray-900",children:h(a.totalAmount||0)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Currency:"}),r.jsx("span",{className:"text-gray-900",children:((j=a.currency)==null?void 0:j.toUpperCase())||"GBP"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Order Date:"}),r.jsx("span",{className:"text-gray-900",children:f(a.createdAt)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Order Time:"}),r.jsx("span",{className:"text-gray-900",children:p(a.createdAt)})]}),a.stripePaymentIntentId&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Payment ID:"}),r.jsxs("span",{className:"text-gray-900 font-mono text-sm",children:[a.stripePaymentIntentId.slice(0,20),"..."]})]})]})]}),r.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[r.jsx(Sa,{className:"h-5 w-5 text-green-600"}),"Customer Information"]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Name:"}),r.jsx("span",{className:"font-semibold text-gray-900",children:a.customerName||"N/A"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Email:"}),r.jsx("span",{className:"text-gray-900",children:a.customerEmail||"N/A"})]}),a.customerPhone&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Phone:"}),r.jsx("span",{className:"text-gray-900",children:a.customerPhone})]}),a.customerDateOfBirth&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Date of Birth:"}),r.jsx("span",{className:"text-gray-900",children:f(a.customerDateOfBirth)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Age:"}),r.jsxs("span",{className:"text-gray-900",children:[y(a.customerDateOfBirth)," years old"]})]})]}),a.customerGender&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Gender:"}),r.jsx("span",{className:"text-gray-900",children:a.customerGender==="prefer_not_to_say"?"Prefer not to say":a.customerGender.charAt(0).toUpperCase()+a.customerGender.slice(1)})]})]})]})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[r.jsx(yt,{className:"h-5 w-5 text-purple-600"}),"Event Information"]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Event:"}),r.jsx("span",{className:"font-semibold text-gray-900",children:l.title})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Date:"}),r.jsx("span",{className:"text-gray-900",children:l.date})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Time:"}),r.jsx("span",{className:"text-gray-900",children:l.time})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Venue:"}),r.jsx("span",{className:"text-gray-900",children:l.venue})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Capacity:"}),r.jsxs("span",{className:"text-gray-900",children:[l.capacity," people"]})]})]})]}),r.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[r.jsx(fs,{className:"h-5 w-5 text-orange-600"}),"Ticket Details"]}),a.tickets&&a.tickets.length>0?r.jsx("div",{className:"space-y-3",children:a.tickets.map((_,L)=>{var P;const D=(P=l.ticketTiers)==null?void 0:P.find(S=>S.id===_.ticketTierId);return r.jsxs("div",{className:"p-3 bg-white rounded-lg border border-gray-200",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsx("span",{className:"font-medium text-gray-900",children:(D==null?void 0:D.name)||"Unknown Tier"}),r.jsxs("span",{className:"text-sm text-gray-500",children:["#",L+1]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Quantity:"}),r.jsx("span",{className:"text-gray-900",children:_.quantity})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Unit Price:"}),r.jsx("span",{className:"text-gray-900",children:D?h(D.price):"N/A"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Total Price:"}),r.jsx("span",{className:"font-semibold text-gray-900",children:h(_.totalPrice||0)})]})]})]},L)})}):r.jsx("p",{className:"text-gray-500 text-center py-4",children:"No ticket information available"})]}),r.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[r.jsx(w,{className:"h-5 w-5 text-blue-600"}),"Scan Status"]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"text-gray-600",children:"Status:"}),r.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full border ${g.color==="text-green-600"?"bg-green-100 text-green-800 border-green-200":g.color==="text-blue-600"?"bg-blue-100 text-blue-800 border-blue-200":g.color==="text-orange-600"?"bg-orange-100 text-orange-800 border-orange-200":"bg-gray-100 text-gray-800 border-gray-200"}`,children:g.text})]}),a.scans&&a.scans.length>0&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Total Scans:"}),r.jsx("span",{className:"text-gray-900",children:a.scans.length})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Last Scan:"}),r.jsxs("span",{className:"text-gray-900",children:[f(a.scans[0].scannedAt)," at ",p(a.scans[0].scannedAt)]})]}),a.scans[0].scannedBy&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Scanned By:"}),r.jsx("span",{className:"text-gray-900",children:a.scans[0].scannedBy})]}),a.scans[0].location&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Location:"}),r.jsx("span",{className:"text-gray-900",children:a.scans[0].location})]})]})]})]})]})]})}),r.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:r.jsx("div",{className:"flex justify-end gap-3",children:r.jsx("button",{onClick:u,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Close"})})})]})})})},gu=({events:a,orders:l,selectedEvent:c,onExportEventData:u})=>{var at;const[h,f]=O.useState(1),[p,y]=O.useState(5),[v,g]=O.useState(""),[w,N]=O.useState(null),[j,_]=O.useState(!1),L=X=>`${(X/100).toFixed(2)}`,D=X=>`${X.toFixed(1)}%`,P=a.find(X=>X.id===c);if(!P)return null;const S=l.filter(X=>X.eventId===c);console.log(" EventSpecificStats Debug:",{selectedEvent:c,totalOrders:l.length,eventOrdersCount:S.length,sampleOrder:S[0],ordersWithAge:S.filter(X=>X.customerDateOfBirth).length,ordersWithGender:S.filter(X=>X.customerGender).length});const I=S.filter(X=>{var fe,te,ie;if(!v.trim())return!0;const de=v.toLowerCase();return((fe=X.customerName)==null?void 0:fe.toLowerCase().includes(de))||((te=X.customerEmail)==null?void 0:te.toLowerCase().includes(de))||((ie=X.id)==null?void 0:ie.toLowerCase().includes(de))}),M=X=>{if(!X.scans||X.scans.length===0)return{text:"Not Scanned",color:"text-gray-500",icon:Kt};const de=X.scans.filter(ie=>ie.scanType==="entry"),fe=X.scans.filter(ie=>ie.scanType==="exit"),te=X.scans[0];return de.length>0&&fe.length>0?{text:"Scanned In & Out",color:"text-blue-600",icon:Pt,time:new Date(te.scannedAt).toLocaleTimeString()}:de.length>0?{text:"Scanned In",color:"text-green-600",icon:Pt,time:new Date(te.scannedAt).toLocaleTimeString()}:fe.length>0?{text:"Scanned Out",color:"text-orange-600",icon:Rs,time:new Date(te.scannedAt).toLocaleTimeString()}:{text:"Not Scanned",color:"text-gray-500",icon:Kt}},z={totalRevenue:S.reduce((X,de)=>X+(de.totalAmount||0),0),totalOrders:S.length,totalTickets:S.reduce((X,de)=>{var fe;return X+(((fe=de.tickets)==null?void 0:fe.reduce((te,ie)=>te+(ie.quantity||0),0))||0)},0),capacity:parseInt(P.capacity||"0"),utilizationRate:parseInt(P.capacity||"0")>0?S.reduce((X,de)=>{var fe;return X+(((fe=de.tickets)==null?void 0:fe.reduce((te,ie)=>te+(ie.quantity||0),0))||0)},0)/parseInt(P.capacity||"0")*100:0},K=((at=P.ticketTiers)==null?void 0:at.map(X=>{const de=S.filter(ie=>{var oe;return(oe=ie.tickets)==null?void 0:oe.some(Ce=>Ce.ticketTierId===X.id)}),fe=de.reduce((ie,oe)=>{var ae;const Ce=((ae=oe.tickets)==null?void 0:ae.filter(Ge=>Ge.ticketTierId===X.id))||[];return ie+Ce.reduce((Ge,Ie)=>Ge+(Ie.totalPrice||0),0)},0),te=de.reduce((ie,oe)=>{var ae;const Ce=((ae=oe.tickets)==null?void 0:ae.filter(Ge=>Ge.ticketTierId===X.id))||[];return ie+Ce.reduce((Ge,Ie)=>Ge+(Ie.quantity||0),0)},0);return{name:X.name,sold:te,capacity:X.capacity,revenue:fe,utilizationRate:X.capacity>0?te/X.capacity*100:0,revenuePerTicket:te>0?fe/te:0}}).sort((X,de)=>de.revenue-X.revenue))||[],ce=X=>X>=80?"bg-green-100 text-green-800 border-green-200":X>=50?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-red-100 text-red-800 border-red-200",Q=()=>{if(S.length===0)return{date:"N/A",revenue:0};const X=S.reduce((fe,te)=>{const ie=new Date(te.createdAt).toDateString();return fe[ie]=(fe[ie]||0)+(te.totalAmount||0),fe},{}),de=Object.entries(X).reduce((fe,[te,ie])=>ie>fe.revenue?{date:te,revenue:ie}:fe,{date:"",revenue:0});return{date:de.date?new Date(de.date).toLocaleDateString("en-GB",{month:"short",day:"numeric"}):"N/A",revenue:de.revenue}},ye=()=>S.length===0?0:new Set(S.map(de=>new Date(de.createdAt).toDateString())).size,J=Math.ceil(I.length/p),bt=(h-1)*p,Z=bt+p,H=I.slice(bt,Z),q=X=>{f(X)},he=X=>{y(X),f(1)},F=X=>{N(X),_(!0)},Be=()=>{_(!1),N(null)},ge=()=>{const X=S.map(de=>{var te;return((te=de.tickets)==null?void 0:te.map(ie=>{var Ge,Ie;const oe=(Ge=P.ticketTiers)==null?void 0:Ge.find(we=>we.id===ie.ticketTierId),Ce=M(de),ae=de.scans&&de.scans.length>0?new Date(de.scans[0].scannedAt).toLocaleString():"Never";return{"Order ID":((Ie=de.id)==null?void 0:Ie.slice(0,8))||"N/A","Customer Name":de.customerName||"N/A","Customer Email":de.customerEmail||"N/A","Ticket Tier":(oe==null?void 0:oe.name)||"Unknown Tier",Quantity:ie.quantity||0,"Unit Price":oe?`${(oe.price/100).toFixed(2)}`:"N/A","Total Price":`${((ie.totalPrice||0)/100).toFixed(2)}`,"Order Status":de.status||"N/A","Scan Status":Ce.text,"Last Scan Time":ae,"Order Date":new Date(de.createdAt).toLocaleDateString(),"Order Time":new Date(de.createdAt).toLocaleTimeString()}}))||[]}).flat();if(X.length>0){const de=["Order ID,Customer Name,Customer Email,Ticket Tier,Quantity,Unit Price,Total Price,Order Status,Scan Status,Last Scan Time,Order Date,Order Time",...X.map(oe=>`${oe["Order ID"]},${oe["Customer Name"]},${oe["Customer Email"]},${oe["Ticket Tier"]},${oe.Quantity},${oe["Unit Price"]},${oe["Total Price"]},${oe["Order Status"]},${oe["Scan Status"]},${oe["Last Scan Time"]},${oe["Order Date"]},${oe["Order Time"]}`)].join(`
`),fe=new Blob([de],{type:"text/csv;charset=utf-8;"}),te=document.createElement("a"),ie=URL.createObjectURL(fe);te.setAttribute("href",ie),te.setAttribute("download",`event-sales-${P.title.replace(/[^a-z0-9]/gi,"-").toLowerCase()}-${new Date().toISOString().split("T")[0]}.csv`),te.style.visibility="hidden",document.body.appendChild(te),te.click(),document.body.removeChild(te)}};return r.jsxs("div",{className:"space-y-8",children:[r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-16 h-16 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center",children:r.jsx(yt,{className:"h-8 w-8 text-white"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:P.title}),r.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-600",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(yt,{className:"h-4 w-4"}),r.jsx("span",{children:P.date})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(br,{className:"h-4 w-4"}),r.jsx("span",{children:P.venue})]})]})]})]}),r.jsx("button",{onClick:()=>u(c),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:"Export Event Data"})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full border border-green-200",children:"Active Sales"}),r.jsxs("span",{className:`px-3 py-1 text-xs font-medium rounded-full border ${ce(z.utilizationRate)}`,children:[D(z.utilizationRate)," Capacity Used"]}),r.jsxs("span",{className:"px-3 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full border border-blue-200",children:[z.totalOrders," Orders"]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[r.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:L(z.totalRevenue)})]}),r.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:r.jsx(Ms,{className:"h-5 w-5 text-green-600"})})]})}),r.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tickets Sold"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:z.totalTickets})]}),r.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:r.jsx(Qe,{className:"h-5 w-5 text-blue-600"})})]})}),r.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Capacity Used"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:D(z.utilizationRate)})]}),r.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:r.jsx(yt,{className:"h-5 w-5 text-purple-600"})})]})}),r.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Performance"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:z.utilizationRate>=80?"Excellent":z.utilizationRate>=50?"Good":z.utilizationRate>=20?"Fair":"Poor"})]}),r.jsx("div",{className:"p-3 bg-orange-100 rounded-full",children:r.jsx(Yn,{className:"h-5 w-5 text-orange-600"})})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Age Distribution"}),(()=>{const X={"18-24":0,"25-34":0,"35-44":0,"45+":0};S.forEach(te=>{if(te.customerDateOfBirth){const ie=new Date(te.customerDateOfBirth),oe=new Date;let Ce=oe.getFullYear()-ie.getFullYear();const ae=oe.getMonth()-ie.getMonth();(ae<0||ae===0&&oe.getDate()<ie.getDate())&&Ce--,Ce>=18&&Ce<=24?X["18-24"]++:Ce>=25&&Ce<=34?X["25-34"]++:Ce>=35&&Ce<=44?X["35-44"]++:Ce>=45&&X["45+"]++}});const de=["#3B82F6","#10B981","#F59E0B","#EF4444"],fe=Object.values(X).reduce((te,ie)=>te+ie,0);return fe>0?r.jsxs("div",{className:"flex gap-8 items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsxs("div",{className:"relative w-56 h-56",children:[r.jsx("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 100 100",children:Object.entries(X).map(([te,ie],oe)=>{const Ce=fe>0?ie/fe*100:0,ae=2*Math.PI*45,Ge=`${Ce/100*ae} ${ae}`,Ie=oe===0?0:Object.entries(X).slice(0,oe).reduce((we,[ot,Ke])=>we+Ke/fe*100,0)*ae/100;return r.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:de[oe],strokeWidth:"8",strokeDasharray:Ge,strokeDashoffset:-Ie,className:`transition-all duration-300 hover:stroke-width-10 ${ie===0?"opacity-30":""}`},te)})}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-gray-900",children:fe}),r.jsx("div",{className:"text-sm text-gray-600",children:"Customers"})]})})]})}),r.jsx("div",{className:"flex-1 space-y-2",children:Object.entries(X).map(([te,ie],oe)=>{const Ce=fe>0?ie/fe*100:0;return r.jsxs("div",{className:`flex items-center justify-between p-2 rounded-lg ${ie===0?"bg-gray-100 opacity-60":"bg-gray-50"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:de[oe]}}),r.jsx("span",{className:`text-sm font-medium ${ie===0?"text-gray-500":"text-gray-700"}`,children:te})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:`text-sm font-bold ${ie===0?"text-gray-400":"text-gray-900"}`,children:ie}),r.jsxs("div",{className:`text-xs ${ie===0?"text-gray-400":"text-gray-500"}`,children:[Ce.toFixed(1),"%"]})]})]},te)})})]}):r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(Qe,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{children:"No age data available"})]})})()]}),r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Gender Distribution"}),(()=>{const X={male:0,female:0,other:0,prefer_not_to_say:0};S.forEach(te=>{te.customerGender&&X[te.customerGender]++});const de=["#3B82F6","#EC4899","#10B981","#6B7280"],fe=Object.values(X).reduce((te,ie)=>te+ie,0);return fe>0?r.jsxs("div",{className:"flex gap-8 items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsxs("div",{className:"relative w-56 h-56",children:[r.jsx("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 100 100",children:Object.entries(X).map(([te,ie],oe)=>{const Ce=fe>0?ie/fe*100:0,ae=2*Math.PI*45,Ge=`${Ce/100*ae} ${ae}`,Ie=oe===0?0:Object.entries(X).slice(0,oe).reduce((we,[ot,Ke])=>we+Ke/fe*100,0)*ae/100;return r.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:de[oe],strokeWidth:"8",strokeDasharray:Ge,strokeDashoffset:-Ie,className:`transition-all duration-300 hover:stroke-width-10 ${ie===0?"opacity-30":""}`},te)})}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-gray-900",children:fe}),r.jsx("div",{className:"text-sm text-gray-600",children:"Customers"})]})})]})}),r.jsx("div",{className:"flex-1 space-y-2",children:Object.entries(X).map(([te,ie],oe)=>{const Ce=fe>0?ie/fe*100:0,ae=te==="prefer_not_to_say"?"Prefer not to say":te.charAt(0).toUpperCase()+te.slice(1);return r.jsxs("div",{className:`flex items-center justify-between p-2 rounded-lg ${ie===0?"bg-gray-100 opacity-60":"bg-gray-50"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:de[oe]}}),r.jsx("span",{className:`text-sm font-medium ${ie===0?"text-gray-500":"text-gray-700"}`,children:ae})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:`text-sm font-bold ${ie===0?"text-gray-400":"text-gray-900"}`,children:ie}),r.jsxs("div",{className:`text-xs ${ie===0?"text-gray-400":"text-gray-500"}`,children:[Ce.toFixed(1),"%"]})]})]},te)})})]}):r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(Qe,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{children:"No gender data available"})]})})()]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Ticket Tier Performance"}),K.length>0?r.jsx("div",{className:"space-y-4",children:K.map((X,de)=>r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${de===0?"bg-yellow-100 text-yellow-800 border border-yellow-200":de===1?"bg-gray-100 text-gray-800 border border-gray-200":de===2?"bg-orange-100 text-orange-800 border border-orange-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:de+1}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-medium text-gray-900",children:X.name}),r.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[r.jsxs("span",{className:"text-xs text-gray-500",children:[X.sold,"/",X.capacity," tickets"]}),r.jsxs("span",{className:`px-2 py-1 text-xs rounded-full border ${ce(X.utilizationRate)}`,children:[D(X.utilizationRate)," full"]})]})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("span",{className:"text-sm font-semibold text-gray-900",children:L(X.revenue)}),r.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[L(X.revenuePerTicket)," per ticket"]})]})]},de))}):r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(Yn,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{children:"No tier data available"})]})]}),r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Event Insights"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ds,{className:"h-5 w-5 text-gray-400"}),r.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-indigo-100 text-indigo-800 rounded-full border border-indigo-200",children:"Analytics"})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-100",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:r.jsx(Qe,{className:"h-5 w-5 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Average Order Value"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Per transaction"})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-lg font-bold text-blue-900",children:L(z.totalOrders>0?z.totalRevenue/z.totalOrders:0)}),r.jsx("p",{className:"text-xs text-blue-600",children:"Per order"})]})]})}),r.jsx("div",{className:"p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-100",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:r.jsx(Ms,{className:"h-5 w-5 text-green-600"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Revenue per Ticket"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Average"})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-lg font-bold text-green-900",children:L(z.totalTickets>0?z.totalRevenue/z.totalTickets:0)}),r.jsx("p",{className:"text-xs text-green-600",children:"Per ticket"})]})]})}),r.jsx("div",{className:"p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border border-purple-100",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-purple-100 rounded-full",children:r.jsx(yt,{className:"h-5 w-5 text-purple-600"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Peak Sales Day"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Best performance"})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-lg font-bold text-purple-900",children:Q().date}),r.jsx("p",{className:"text-xs text-purple-600",children:L(Q().revenue)})]})]})})]}),r.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100",children:r.jsxs("div",{className:"flex gap-2 justify-center",children:[r.jsxs("span",{className:`px-3 py-1 text-xs font-medium rounded-full border ${ye()>=20?"bg-green-100 text-green-800 border-green-200":ye()>=15?"bg-blue-100 text-blue-800 border-blue-200":ye()>=10?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-red-100 text-red-800 border-red-200"}`,children:[ye()," Active Days"]}),r.jsxs("span",{className:"px-3 py-1 text-xs font-medium bg-orange-100 text-orange-800 rounded-full border border-orange-200",children:[K.filter(X=>X.revenue>0).length," Active Tiers"]})]})})]})]}),r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1},className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Event Orders"}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"relative",children:[r.jsx(Ea,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search orders...",value:v,onChange:X=>{g(X.target.value),f(1)},className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent w-64"})]}),r.jsxs("button",{onClick:ge,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 transition-colors shadow-sm",children:[r.jsx(Ca,{className:"h-4 w-4"}),"Export Sales Info"]})]})]})}),H.length>0?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tickets"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Scan Status"}),r.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H.map(X=>{var de,fe;return r.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>F(X),children:[r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:[(de=X.id)==null?void 0:de.slice(0,8),"..."]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:X.customerName||"N/A"}),r.jsx("div",{className:"text-sm text-gray-500",children:X.customerEmail||"N/A"})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:r.jsx("div",{className:"space-y-1",children:(fe=X.tickets)==null?void 0:fe.map((te,ie)=>{var Ce;const oe=(Ce=P.ticketTiers)==null?void 0:Ce.find(ae=>ae.id===te.ticketTierId);return r.jsxs("div",{className:"text-sm text-gray-900",children:[r.jsx("span",{className:"font-medium",children:(oe==null?void 0:oe.name)||"Unknown Tier"}),r.jsxs("span",{className:"text-gray-500 ml-2",children:["x",te.quantity]})]},ie)})})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:L(X.totalAmount||0)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:r.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${X.status==="completed"?"bg-green-100 text-green-800 border-green-200":X.status==="pending"?"bg-yellow-100 text-yellow-800 border-yellow-200":X.status==="failed"?"bg-red-100 text-red-800 border-red-200":"bg-gray-100 text-gray-800 border-gray-200"}`,children:X.status||"N/A"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(()=>{const te=M(X),ie=te.icon;return r.jsxs("div",{className:"flex flex-col items-center gap-1",children:[r.jsxs("div",{className:`flex items-center gap-1 ${te.color}`,children:[r.jsx(ie,{className:"h-4 w-4"}),r.jsx("span",{className:"text-xs font-medium",children:te.text})]}),te.time&&r.jsx("span",{className:"text-xs text-gray-500",children:te.time})]})})()}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center",children:new Date(X.createdAt).toLocaleDateString()})]},X.id)})})]})}),r.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("label",{className:"text-sm text-gray-600",children:"Show:"}),r.jsxs("select",{value:p,onChange:X=>he(Number(X.target.value)),className:"px-3 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:5,children:"5"}),r.jsx("option",{value:10,children:"10"}),r.jsx("option",{value:25,children:"25"}),r.jsx("option",{value:50,children:"50"})]}),r.jsx("span",{className:"text-sm text-gray-600",children:"records"})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",bt+1," to ",Math.min(Z,I.length)," of ",I.length," results",v&&r.jsxs("span",{className:"ml-2 text-blue-600",children:["(filtered from ",S.length," total)"]})]}),J>1&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>q(h-1),disabled:h===1,className:"px-3 py-1 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),r.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:J},(X,de)=>de+1).map(X=>r.jsx("button",{onClick:()=>q(X),className:`px-3 py-1 text-sm font-medium rounded-md ${X===h?"bg-blue-600 text-white":"text-gray-500 bg-white border border-gray-300 hover:bg-gray-50"}`,children:X},X))}),r.jsx("button",{onClick:()=>q(h+1),disabled:h===J,className:"px-3 py-1 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})})]}):r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(Qe,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{children:"No orders found for this event"})]})]}),r.jsx(mu,{order:w,event:P,isOpen:j,onClose:Be})]})};var ue;(function(a){a[a.QR_CODE=0]="QR_CODE",a[a.AZTEC=1]="AZTEC",a[a.CODABAR=2]="CODABAR",a[a.CODE_39=3]="CODE_39",a[a.CODE_93=4]="CODE_93",a[a.CODE_128=5]="CODE_128",a[a.DATA_MATRIX=6]="DATA_MATRIX",a[a.MAXICODE=7]="MAXICODE",a[a.ITF=8]="ITF",a[a.EAN_13=9]="EAN_13",a[a.EAN_8=10]="EAN_8",a[a.PDF_417=11]="PDF_417",a[a.RSS_14=12]="RSS_14",a[a.RSS_EXPANDED=13]="RSS_EXPANDED",a[a.UPC_A=14]="UPC_A",a[a.UPC_E=15]="UPC_E",a[a.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ue||(ue={}));var ia=new Map([[ue.QR_CODE,"QR_CODE"],[ue.AZTEC,"AZTEC"],[ue.CODABAR,"CODABAR"],[ue.CODE_39,"CODE_39"],[ue.CODE_93,"CODE_93"],[ue.CODE_128,"CODE_128"],[ue.DATA_MATRIX,"DATA_MATRIX"],[ue.MAXICODE,"MAXICODE"],[ue.ITF,"ITF"],[ue.EAN_13,"EAN_13"],[ue.EAN_8,"EAN_8"],[ue.PDF_417,"PDF_417"],[ue.RSS_14,"RSS_14"],[ue.RSS_EXPANDED,"RSS_EXPANDED"],[ue.UPC_A,"UPC_A"],[ue.UPC_E,"UPC_E"],[ue.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),aa;(function(a){a[a.UNKNOWN=0]="UNKNOWN",a[a.URL=1]="URL"})(aa||(aa={}));function pu(a){return Object.values(ue).includes(a)}var Ur;(function(a){a[a.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",a[a.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Ur||(Ur={}));var ar=function(){function a(){}return a.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",a.SCAN_DEFAULT_FPS=2,a.DEFAULT_DISABLE_FLIP=!1,a.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,a.DEFAULT_SUPPORTED_SCAN_TYPE=[Ur.SCAN_TYPE_CAMERA,Ur.SCAN_TYPE_FILE],a}(),fo=function(){function a(l,c){this.format=l,this.formatName=c}return a.prototype.toString=function(){return this.formatName},a.create=function(l){if(!ia.has(l))throw"".concat(l," not in html5QrcodeSupportedFormatsTextMap");return new a(l,ia.get(l))},a}(),oa=function(){function a(){}return a.createFromText=function(l){var c={text:l};return{decodedText:l,result:c}},a.createFromQrcodeResult=function(l){return{decodedText:l.text,result:l}},a}(),ii;(function(a){a[a.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",a[a.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",a[a.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(ii||(ii={}));var xo=function(){function a(){}return a.createFrom=function(l){return{errorMessage:l,type:ii.UNKWOWN_ERROR}},a}(),mo=function(){function a(l){this.verbose=l}return a.prototype.log=function(l){this.verbose&&console.log(l)},a.prototype.warn=function(l){this.verbose&&console.warn(l)},a.prototype.logError=function(l,c){(this.verbose||c===!0)&&console.error(l)},a.prototype.logErrors=function(l){if(l.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(l)},a}();function gr(a){return typeof a>"u"||a===null}function yu(a,l,c){return a>c?c:a<l?l:a}var cs=function(){function a(){}return a.codeParseError=function(l){return"QR code parse error, error = ".concat(l)},a.errorGettingUserMedia=function(l){return"Error getting userMedia, error = ".concat(l)},a.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},a.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},a.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},a.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},a.scannerPaused=function(){return"Scanner paused"},a}(),Ye=function(){function a(){}return a.scanningStatus=function(){return"Scanning"},a.idleStatus=function(){return"Idle"},a.errorStatus=function(){return"Error"},a.permissionStatus=function(){return"Permission"},a.noCameraFoundErrorStatus=function(){return"No Cameras"},a.lastMatch=function(l){return"Last Match: ".concat(l)},a.codeScannerTitle=function(){return"Code Scanner"},a.cameraPermissionTitle=function(){return"Request Camera Permissions"},a.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},a.noCameraFound=function(){return"No camera found"},a.scanButtonStopScanningText=function(){return"Stop Scanning"},a.scanButtonStartScanningText=function(){return"Start Scanning"},a.torchOnButton=function(){return"Switch On Torch"},a.torchOffButton=function(){return"Switch Off Torch"},a.torchOnFailedMessage=function(){return"Failed to turn on torch"},a.torchOffFailedMessage=function(){return"Failed to turn off torch"},a.scanButtonScanningStarting=function(){return"Launching Camera..."},a.textIfCameraScanSelected=function(){return"Scan an Image File"},a.textIfFileScanSelected=function(){return"Scan using camera directly"},a.selectCamera=function(){return"Select Camera"},a.fileSelectionChooseImage=function(){return"Choose Image"},a.fileSelectionChooseAnother=function(){return"Choose Another"},a.fileSelectionNoImageSelected=function(){return"No image choosen"},a.anonymousCameraPrefix=function(){return"Anonymous Camera"},a.dragAndDropMessage=function(){return"Or drop an image to scan"},a.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},a.zoom=function(){return"zoom"},a.loadingImage=function(){return"Loading image..."},a.cameraScanAltText=function(){return"Camera based scan"},a.fileScanAltText=function(){return"Fule based scan"},a}(),la=function(){function a(){}return a.poweredBy=function(){return"Powered by "},a.reportIssues=function(){return"Report issues"},a}(),go=function(){function a(){}return a.isMediaStreamConstraintsValid=function(l,c){if(typeof l!="object"){var u=typeof l;return c.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(u,"."),!0),!1}for(var h=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],f=new Set(h),p=Object.keys(l),y=0,v=p;y<v.length;y++){var g=v[y];if(f.has(g))return c.logError("".concat(g," is not supported videoConstaints."),!0),!1}return!0},a}(),ai={exports:{}};(function(a,l){(function(c,u){u(l)})(Is,function(c){function u(C){return C==null}var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,e){C.__proto__=e}||function(C,e){for(var t in e)e.hasOwnProperty(t)&&(C[t]=e[t])};function f(C,e){h(C,e);function t(){this.constructor=C}C.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function p(C,e){var t=Object.setPrototypeOf;t?t(C,e):C.__proto__=e}function y(C,e){e===void 0&&(e=C.constructor);var t=Error.captureStackTrace;t&&t(C,e)}var v=function(C){f(e,C);function e(t){var s=this.constructor,n=C.call(this,t)||this;return Object.defineProperty(n,"name",{value:s.name,enumerable:!1}),p(n,s.prototype),y(n),n}return e}(Error);class g extends v{constructor(e=void 0){super(e),this.message=e}getKind(){return this.constructor.kind}}g.kind="Exception";class w extends g{}w.kind="ArgumentException";class N extends g{}N.kind="IllegalArgumentException";class j{constructor(e){if(this.binarizer=e,e===null)throw new N("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(e,t){return this.binarizer.getBlackRow(e,t)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(e,t,s,n){const i=this.binarizer.getLuminanceSource().crop(e,t,s,n);return new j(this.binarizer.createBinarizer(i))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new j(this.binarizer.createBinarizer(e))}rotateCounterClockwise45(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new j(this.binarizer.createBinarizer(e))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class _ extends g{static getChecksumInstance(){return new _}}_.kind="ChecksumException";class L{constructor(e){this.source=e}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class D{static arraycopy(e,t,s,n,i){for(;i--;)s[n++]=e[t++]}static currentTimeMillis(){return Date.now()}}class P extends g{}P.kind="IndexOutOfBoundsException";class S extends P{constructor(e=void 0,t=void 0){super(t),this.index=e,this.message=t}}S.kind="ArrayIndexOutOfBoundsException";class I{static fill(e,t){for(let s=0,n=e.length;s<n;s++)e[s]=t}static fillWithin(e,t,s,n){I.rangeCheck(e.length,t,s);for(let i=t;i<s;i++)e[i]=n}static rangeCheck(e,t,s){if(t>s)throw new N("fromIndex("+t+") > toIndex("+s+")");if(t<0)throw new S(t);if(s>e)throw new S(s)}static asList(...e){return e}static create(e,t,s){return Array.from({length:e}).map(i=>Array.from({length:t}).fill(s))}static createInt32Array(e,t,s){return Array.from({length:e}).map(i=>Int32Array.from({length:t}).fill(s))}static equals(e,t){if(!e||!t||!e.length||!t.length||e.length!==t.length)return!1;for(let s=0,n=e.length;s<n;s++)if(e[s]!==t[s])return!1;return!0}static hashCode(e){if(e===null)return 0;let t=1;for(const s of e)t=31*t+s;return t}static fillUint8Array(e,t){for(let s=0;s!==e.length;s++)e[s]=t}static copyOf(e,t){return e.slice(0,t)}static copyOfUint8Array(e,t){if(e.length<=t){const s=new Uint8Array(t);return s.set(e),s}return e.slice(0,t)}static copyOfRange(e,t,s){const n=s-t,i=new Int32Array(n);return D.arraycopy(e,t,i,0,n),i}static binarySearch(e,t,s){s===void 0&&(s=I.numberComparator);let n=0,i=e.length-1;for(;n<=i;){const o=i+n>>1,d=s(t,e[o]);if(d>0)n=o+1;else if(d<0)i=o-1;else return o}return-n-1}static numberComparator(e,t){return e-t}}class M{static numberOfTrailingZeros(e){let t;if(e===0)return 32;let s=31;return t=e<<16,t!==0&&(s-=16,e=t),t=e<<8,t!==0&&(s-=8,e=t),t=e<<4,t!==0&&(s-=4,e=t),t=e<<2,t!==0&&(s-=2,e=t),s-(e<<1>>>31)}static numberOfLeadingZeros(e){if(e===0)return 32;let t=1;return e>>>16||(t+=16,e<<=16),e>>>24||(t+=8,e<<=8),e>>>28||(t+=4,e<<=4),e>>>30||(t+=2,e<<=2),t-=e>>>31,t}static toHexString(e){return e.toString(16)}static toBinaryString(e){return String(parseInt(String(e),2))}static bitCount(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63}static truncDivision(e,t){return Math.trunc(e/t)}static parseInt(e,t=void 0){return parseInt(e,t)}}M.MIN_VALUE_32_BITS=-2147483648,M.MAX_VALUE=Number.MAX_SAFE_INTEGER;class z{constructor(e,t){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,t==null?this.bits=z.makeArray(e):this.bits=t)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(e){if(e>this.bits.length*32){const t=z.makeArray(e);D.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}}get(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0}set(e){this.bits[Math.floor(e/32)]|=1<<(e&31)}flip(e){this.bits[Math.floor(e/32)]^=1<<(e&31)}getNextSet(e){const t=this.size;if(e>=t)return t;const s=this.bits;let n=Math.floor(e/32),i=s[n];i&=~((1<<(e&31))-1);const o=s.length;for(;i===0;){if(++n===o)return t;i=s[n]}const d=n*32+M.numberOfTrailingZeros(i);return d>t?t:d}getNextUnset(e){const t=this.size;if(e>=t)return t;const s=this.bits;let n=Math.floor(e/32),i=~s[n];i&=~((1<<(e&31))-1);const o=s.length;for(;i===0;){if(++n===o)return t;i=~s[n]}const d=n*32+M.numberOfTrailingZeros(i);return d>t?t:d}setBulk(e,t){this.bits[Math.floor(e/32)]=t}setRange(e,t){if(t<e||e<0||t>this.size)throw new N;if(t===e)return;t--;const s=Math.floor(e/32),n=Math.floor(t/32),i=this.bits;for(let o=s;o<=n;o++){const d=o>s?0:e&31,m=(2<<(o<n?31:t&31))-(1<<d);i[o]|=m}}clear(){const e=this.bits.length,t=this.bits;for(let s=0;s<e;s++)t[s]=0}isRange(e,t,s){if(t<e||e<0||t>this.size)throw new N;if(t===e)return!0;t--;const n=Math.floor(e/32),i=Math.floor(t/32),o=this.bits;for(let d=n;d<=i;d++){const x=d>n?0:e&31,b=(2<<(d<i?31:t&31))-(1<<x)&4294967295;if((o[d]&b)!==(s?b:0))return!1}return!0}appendBit(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(e,t){if(t<0||t>32)throw new N("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(let s=t;s>0;s--)this.appendBit((e>>s-1&1)===1)}appendBitArray(e){const t=e.size;this.ensureCapacity(this.size+t);for(let s=0;s<t;s++)this.appendBit(e.get(s))}xor(e){if(this.size!==e.size)throw new N("Sizes don't match");const t=this.bits;for(let s=0,n=t.length;s<n;s++)t[s]^=e.bits[s]}toBytes(e,t,s,n){for(let i=0;i<n;i++){let o=0;for(let d=0;d<8;d++)this.get(e)&&(o|=1<<7-d),e++;t[s+i]=o}}getBitArray(){return this.bits}reverse(){const e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),s=t+1,n=this.bits;for(let i=0;i<s;i++){let o=n[i];o=o>>1&1431655765|(o&1431655765)<<1,o=o>>2&858993459|(o&858993459)<<2,o=o>>4&252645135|(o&252645135)<<4,o=o>>8&16711935|(o&16711935)<<8,o=o>>16&65535|(o&65535)<<16,e[t-i]=o}if(this.size!==s*32){const i=s*32-this.size;let o=e[0]>>>i;for(let d=1;d<s;d++){const x=e[d];o|=x<<32-i,e[d-1]=o,o=x>>>i}e[s-1]=o}this.bits=e}static makeArray(e){return new Int32Array(Math.floor((e+31)/32))}equals(e){if(!(e instanceof z))return!1;const t=e;return this.size===t.size&&I.equals(this.bits,t.bits)}hashCode(){return 31*this.size+I.hashCode(this.bits)}toString(){let e="";for(let t=0,s=this.size;t<s;t++)t&7||(e+=" "),e+=this.get(t)?"X":".";return e}clone(){return new z(this.size,this.bits.slice())}}var K;(function(C){C[C.OTHER=0]="OTHER",C[C.PURE_BARCODE=1]="PURE_BARCODE",C[C.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",C[C.TRY_HARDER=3]="TRY_HARDER",C[C.CHARACTER_SET=4]="CHARACTER_SET",C[C.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",C[C.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",C[C.ASSUME_GS1=7]="ASSUME_GS1",C[C.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",C[C.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",C[C.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(K||(K={}));var ce=K;class Q extends g{static getFormatInstance(){return new Q}}Q.kind="FormatException";var ye;(function(C){C[C.Cp437=0]="Cp437",C[C.ISO8859_1=1]="ISO8859_1",C[C.ISO8859_2=2]="ISO8859_2",C[C.ISO8859_3=3]="ISO8859_3",C[C.ISO8859_4=4]="ISO8859_4",C[C.ISO8859_5=5]="ISO8859_5",C[C.ISO8859_6=6]="ISO8859_6",C[C.ISO8859_7=7]="ISO8859_7",C[C.ISO8859_8=8]="ISO8859_8",C[C.ISO8859_9=9]="ISO8859_9",C[C.ISO8859_10=10]="ISO8859_10",C[C.ISO8859_11=11]="ISO8859_11",C[C.ISO8859_13=12]="ISO8859_13",C[C.ISO8859_14=13]="ISO8859_14",C[C.ISO8859_15=14]="ISO8859_15",C[C.ISO8859_16=15]="ISO8859_16",C[C.SJIS=16]="SJIS",C[C.Cp1250=17]="Cp1250",C[C.Cp1251=18]="Cp1251",C[C.Cp1252=19]="Cp1252",C[C.Cp1256=20]="Cp1256",C[C.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",C[C.UTF8=22]="UTF8",C[C.ASCII=23]="ASCII",C[C.Big5=24]="Big5",C[C.GB18030=25]="GB18030",C[C.EUC_KR=26]="EUC_KR"})(ye||(ye={}));class J{constructor(e,t,s,...n){this.valueIdentifier=e,this.name=s,typeof t=="number"?this.values=Int32Array.from([t]):this.values=t,this.otherEncodingNames=n,J.VALUE_IDENTIFIER_TO_ECI.set(e,this),J.NAME_TO_ECI.set(s,this);const i=this.values;for(let o=0,d=i.length;o!==d;o++){const x=i[o];J.VALUES_TO_ECI.set(x,this)}for(const o of n)J.NAME_TO_ECI.set(o,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(e){if(e<0||e>=900)throw new Q("incorect value");const t=J.VALUES_TO_ECI.get(e);if(t===void 0)throw new Q("incorect value");return t}static getCharacterSetECIByName(e){const t=J.NAME_TO_ECI.get(e);if(t===void 0)throw new Q("incorect value");return t}equals(e){if(!(e instanceof J))return!1;const t=e;return this.getName()===t.getName()}}J.VALUE_IDENTIFIER_TO_ECI=new Map,J.VALUES_TO_ECI=new Map,J.NAME_TO_ECI=new Map,J.Cp437=new J(ye.Cp437,Int32Array.from([0,2]),"Cp437"),J.ISO8859_1=new J(ye.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),J.ISO8859_2=new J(ye.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),J.ISO8859_3=new J(ye.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),J.ISO8859_4=new J(ye.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),J.ISO8859_5=new J(ye.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),J.ISO8859_6=new J(ye.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),J.ISO8859_7=new J(ye.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),J.ISO8859_8=new J(ye.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),J.ISO8859_9=new J(ye.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),J.ISO8859_10=new J(ye.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),J.ISO8859_11=new J(ye.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),J.ISO8859_13=new J(ye.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),J.ISO8859_14=new J(ye.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),J.ISO8859_15=new J(ye.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),J.ISO8859_16=new J(ye.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),J.SJIS=new J(ye.SJIS,20,"SJIS","Shift_JIS"),J.Cp1250=new J(ye.Cp1250,21,"Cp1250","windows-1250"),J.Cp1251=new J(ye.Cp1251,22,"Cp1251","windows-1251"),J.Cp1252=new J(ye.Cp1252,23,"Cp1252","windows-1252"),J.Cp1256=new J(ye.Cp1256,24,"Cp1256","windows-1256"),J.UnicodeBigUnmarked=new J(ye.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),J.UTF8=new J(ye.UTF8,26,"UTF8","UTF-8"),J.ASCII=new J(ye.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),J.Big5=new J(ye.Big5,28,"Big5"),J.GB18030=new J(ye.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),J.EUC_KR=new J(ye.EUC_KR,30,"EUC_KR","EUC-KR");class bt extends g{}bt.kind="UnsupportedOperationException";class Z{static decode(e,t){const s=this.encodingName(t);return this.customDecoder?this.customDecoder(e,s):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(s)?this.decodeFallback(e,s):new TextDecoder(s).decode(e)}static shouldDecodeOnFallback(e){return!Z.isBrowser()&&e==="ISO-8859-1"}static encode(e,t){const s=this.encodingName(t);return this.customEncoder?this.customEncoder(e,s):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(e){return typeof e=="string"?e:e.getName()}static encodingCharacterSet(e){return e instanceof J?e:J.getCharacterSetECIByName(e)}static decodeFallback(e,t){const s=this.encodingCharacterSet(t);if(Z.isDecodeFallbackSupported(s)){let n="";for(let i=0,o=e.length;i<o;i++){let d=e[i].toString(16);d.length<2&&(d="0"+d),n+="%"+d}return decodeURIComponent(n)}if(s.equals(J.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new bt(`Encoding ${this.encodingName(t)} not supported by fallback.`)}static isDecodeFallbackSupported(e){return e.equals(J.UTF8)||e.equals(J.ISO8859_1)||e.equals(J.ASCII)}static encodeFallback(e){const s=btoa(unescape(encodeURIComponent(e))).split(""),n=[];for(let i=0;i<s.length;i++)n.push(s[i].charCodeAt(0));return new Uint8Array(n)}}class H{static castAsNonUtf8Char(e,t=null){const s=t?t.getName():this.ISO88591;return Z.decode(new Uint8Array([e]),s)}static guessEncoding(e,t){if(t!=null&&t.get(ce.CHARACTER_SET)!==void 0)return t.get(ce.CHARACTER_SET).toString();const s=e.length;let n=!0,i=!0,o=!0,d=0,x=0,m=0,b=0,E=0,A=0,k=0,R=0,B=0,U=0,W=0;const re=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191;for(let se=0;se<s&&(n||i||o);se++){const ee=e[se]&255;o&&(d>0?ee&128?d--:o=!1:ee&128&&(ee&64?(d++,ee&32?(d++,ee&16?(d++,ee&8?o=!1:b++):m++):x++):o=!1)),n&&(ee>127&&ee<160?n=!1:ee>159&&(ee<192||ee===215||ee===247)&&W++),i&&(E>0?ee<64||ee===127||ee>252?i=!1:E--:ee===128||ee===160||ee>239?i=!1:ee>160&&ee<224?(A++,R=0,k++,k>B&&(B=k)):ee>127?(E++,k=0,R++,R>U&&(U=R)):(k=0,R=0))}return o&&d>0&&(o=!1),i&&E>0&&(i=!1),o&&(re||x+m+b>0)?H.UTF8:i&&(H.ASSUME_SHIFT_JIS||B>=3||U>=3)?H.SHIFT_JIS:n&&i?B===2&&A===2||W*10>=s?H.SHIFT_JIS:H.ISO88591:n?H.ISO88591:i?H.SHIFT_JIS:o?H.UTF8:H.PLATFORM_DEFAULT_ENCODING}static format(e,...t){let s=-1;function n(o,d,x,m,b,E){if(o==="%%")return"%";if(t[++s]===void 0)return;o=m?parseInt(m.substr(1)):void 0;let A=b?parseInt(b.substr(1)):void 0,k;switch(E){case"s":k=t[s];break;case"c":k=t[s][0];break;case"f":k=parseFloat(t[s]).toFixed(o);break;case"p":k=parseFloat(t[s]).toPrecision(o);break;case"e":k=parseFloat(t[s]).toExponential(o);break;case"x":k=parseInt(t[s]).toString(A||16);break;case"d":k=parseFloat(parseInt(t[s],A||10).toPrecision(o)).toFixed(0);break}k=typeof k=="object"?JSON.stringify(k):(+k).toString(A);let R=parseInt(x),B=x&&x[0]+""=="0"?"0":" ";for(;k.length<R;)k=d!==void 0?k+B:B+k;return k}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(i,n)}static getBytes(e,t){return Z.encode(e,t)}static getCharCode(e,t=0){return e.charCodeAt(t)}static getCharAt(e){return String.fromCharCode(e)}}H.SHIFT_JIS=J.SJIS.getName(),H.GB2312="GB2312",H.ISO88591=J.ISO8859_1.getName(),H.EUC_JP="EUC_JP",H.UTF8=J.UTF8.getName(),H.PLATFORM_DEFAULT_ENCODING=H.UTF8,H.ASSUME_SHIFT_JIS=!1;class q{constructor(e=""){this.value=e}enableDecoding(e){return this.encoding=e,this}append(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=H.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this}appendChars(e,t,s){for(let n=t;t<t+s;n++)this.append(e[n]);return this}length(){return this.value.length}charAt(e){return this.value.charAt(e)}deleteCharAt(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)}setCharAt(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)}substring(e,t){return this.value.substring(e,t)}setLengthToZero(){this.value=""}toString(){return this.value}insert(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+t.length)}}class he{constructor(e,t,s,n){if(this.width=e,this.height=t,this.rowSize=s,this.bits=n,t==null&&(t=e),this.height=t,e<1||t<1)throw new N("Both dimensions must be greater than 0");s==null&&(s=Math.floor((e+31)/32)),this.rowSize=s,n==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(e){const t=e.length,s=e[0].length,n=new he(s,t);for(let i=0;i<t;i++){const o=e[i];for(let d=0;d<s;d++)o[d]&&n.set(d,i)}return n}static parseFromString(e,t,s){if(e===null)throw new N("stringRepresentation cannot be null");const n=new Array(e.length);let i=0,o=0,d=-1,x=0,m=0;for(;m<e.length;)if(e.charAt(m)===`
`||e.charAt(m)==="\r"){if(i>o){if(d===-1)d=i-o;else if(i-o!==d)throw new N("row lengths do not match");o=i,x++}m++}else if(e.substring(m,m+t.length)===t)m+=t.length,n[i]=!0,i++;else if(e.substring(m,m+s.length)===s)m+=s.length,n[i]=!1,i++;else throw new N("illegal character encountered: "+e.substring(m));if(i>o){if(d===-1)d=i-o;else if(i-o!==d)throw new N("row lengths do not match");x++}const b=new he(d,x);for(let E=0;E<i;E++)n[E]&&b.set(Math.floor(E%d),Math.floor(E/d));return b}get(e,t){const s=t*this.rowSize+Math.floor(e/32);return(this.bits[s]>>>(e&31)&1)!==0}set(e,t){const s=t*this.rowSize+Math.floor(e/32);this.bits[s]|=1<<(e&31)&4294967295}unset(e,t){const s=t*this.rowSize+Math.floor(e/32);this.bits[s]&=~(1<<(e&31)&4294967295)}flip(e,t){const s=t*this.rowSize+Math.floor(e/32);this.bits[s]^=1<<(e&31)&4294967295}xor(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new N("input matrix dimensions do not match");const t=new z(Math.floor(this.width/32)+1),s=this.rowSize,n=this.bits;for(let i=0,o=this.height;i<o;i++){const d=i*s,x=e.getRow(i,t).getBitArray();for(let m=0;m<s;m++)n[d+m]^=x[m]}}clear(){const e=this.bits,t=e.length;for(let s=0;s<t;s++)e[s]=0}setRegion(e,t,s,n){if(t<0||e<0)throw new N("Left and top must be nonnegative");if(n<1||s<1)throw new N("Height and width must be at least 1");const i=e+s,o=t+n;if(o>this.height||i>this.width)throw new N("The region must fit inside the matrix");const d=this.rowSize,x=this.bits;for(let m=t;m<o;m++){const b=m*d;for(let E=e;E<i;E++)x[b+Math.floor(E/32)]|=1<<(E&31)&4294967295}}getRow(e,t){t==null||t.getSize()<this.width?t=new z(this.width):t.clear();const s=this.rowSize,n=this.bits,i=e*s;for(let o=0;o<s;o++)t.setBulk(o*32,n[i+o]);return t}setRow(e,t){D.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)}rotate180(){const e=this.getWidth(),t=this.getHeight();let s=new z(e),n=new z(e);for(let i=0,o=Math.floor((t+1)/2);i<o;i++)s=this.getRow(i,s),n=this.getRow(t-1-i,n),s.reverse(),n.reverse(),this.setRow(i,n),this.setRow(t-1-i,s)}getEnclosingRectangle(){const e=this.width,t=this.height,s=this.rowSize,n=this.bits;let i=e,o=t,d=-1,x=-1;for(let m=0;m<t;m++)for(let b=0;b<s;b++){const E=n[m*s+b];if(E!==0){if(m<o&&(o=m),m>x&&(x=m),b*32<i){let A=0;for(;!(E<<31-A&4294967295);)A++;b*32+A<i&&(i=b*32+A)}if(b*32+31>d){let A=31;for(;!(E>>>A);)A--;b*32+A>d&&(d=b*32+A)}}}return d<i||x<o?null:Int32Array.from([i,o,d-i+1,x-o+1])}getTopLeftOnBit(){const e=this.rowSize,t=this.bits;let s=0;for(;s<t.length&&t[s]===0;)s++;if(s===t.length)return null;const n=s/e;let i=s%e*32;const o=t[s];let d=0;for(;!(o<<31-d&4294967295);)d++;return i+=d,Int32Array.from([i,n])}getBottomRightOnBit(){const e=this.rowSize,t=this.bits;let s=t.length-1;for(;s>=0&&t[s]===0;)s--;if(s<0)return null;const n=Math.floor(s/e);let i=Math.floor(s%e)*32;const o=t[s];let d=31;for(;!(o>>>d);)d--;return i+=d,Int32Array.from([i,n])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(e){if(!(e instanceof he))return!1;const t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&I.equals(this.bits,t.bits)}hashCode(){let e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+I.hashCode(this.bits),e}toString(e="X ",t="  ",s=`
`){return this.buildToString(e,t,s)}buildToString(e,t,s){let n=new q;for(let i=0,o=this.height;i<o;i++){for(let d=0,x=this.width;d<x;d++)n.append(this.get(d,i)?e:t);n.append(s)}return n.toString()}clone(){return new he(this.width,this.height,this.rowSize,this.bits.slice())}}class F extends g{static getNotFoundInstance(){return new F}}F.kind="NotFoundException";class Be extends L{constructor(e){super(e),this.luminances=Be.EMPTY,this.buckets=new Int32Array(Be.LUMINANCE_BUCKETS)}getBlackRow(e,t){const s=this.getLuminanceSource(),n=s.getWidth();t==null||t.getSize()<n?t=new z(n):t.clear(),this.initArrays(n);const i=s.getRow(e,this.luminances),o=this.buckets;for(let x=0;x<n;x++)o[(i[x]&255)>>Be.LUMINANCE_SHIFT]++;const d=Be.estimateBlackPoint(o);if(n<3)for(let x=0;x<n;x++)(i[x]&255)<d&&t.set(x);else{let x=i[0]&255,m=i[1]&255;for(let b=1;b<n-1;b++){const E=i[b+1]&255;(m*4-x-E)/2<d&&t.set(b),x=m,m=E}}return t}getBlackMatrix(){const e=this.getLuminanceSource(),t=e.getWidth(),s=e.getHeight(),n=new he(t,s);this.initArrays(t);const i=this.buckets;for(let x=1;x<5;x++){const m=Math.floor(s*x/5),b=e.getRow(m,this.luminances),E=Math.floor(t*4/5);for(let A=Math.floor(t/5);A<E;A++){const k=b[A]&255;i[k>>Be.LUMINANCE_SHIFT]++}}const o=Be.estimateBlackPoint(i),d=e.getMatrix();for(let x=0;x<s;x++){const m=x*t;for(let b=0;b<t;b++)(d[m+b]&255)<o&&n.set(b,x)}return n}createBinarizer(e){return new Be(e)}initArrays(e){this.luminances.length<e&&(this.luminances=new Uint8ClampedArray(e));const t=this.buckets;for(let s=0;s<Be.LUMINANCE_BUCKETS;s++)t[s]=0}static estimateBlackPoint(e){const t=e.length;let s=0,n=0,i=0;for(let b=0;b<t;b++)e[b]>i&&(n=b,i=e[b]),e[b]>s&&(s=e[b]);let o=0,d=0;for(let b=0;b<t;b++){const E=b-n,A=e[b]*E*E;A>d&&(o=b,d=A)}if(n>o){const b=n;n=o,o=b}if(o-n<=t/16)throw new F;let x=o-1,m=-1;for(let b=o-1;b>n;b--){const E=b-n,A=E*E*(o-b)*(s-e[b]);A>m&&(x=b,m=A)}return x<<Be.LUMINANCE_SHIFT}}Be.LUMINANCE_BITS=5,Be.LUMINANCE_SHIFT=8-Be.LUMINANCE_BITS,Be.LUMINANCE_BUCKETS=1<<Be.LUMINANCE_BITS,Be.EMPTY=Uint8ClampedArray.from([0]);class ge extends Be{constructor(e){super(e),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const e=this.getLuminanceSource(),t=e.getWidth(),s=e.getHeight();if(t>=ge.MINIMUM_DIMENSION&&s>=ge.MINIMUM_DIMENSION){const n=e.getMatrix();let i=t>>ge.BLOCK_SIZE_POWER;t&ge.BLOCK_SIZE_MASK&&i++;let o=s>>ge.BLOCK_SIZE_POWER;s&ge.BLOCK_SIZE_MASK&&o++;const d=ge.calculateBlackPoints(n,i,o,t,s),x=new he(t,s);ge.calculateThresholdForBlock(n,i,o,t,s,d,x),this.matrix=x}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(e){return new ge(e)}static calculateThresholdForBlock(e,t,s,n,i,o,d){const x=i-ge.BLOCK_SIZE,m=n-ge.BLOCK_SIZE;for(let b=0;b<s;b++){let E=b<<ge.BLOCK_SIZE_POWER;E>x&&(E=x);const A=ge.cap(b,2,s-3);for(let k=0;k<t;k++){let R=k<<ge.BLOCK_SIZE_POWER;R>m&&(R=m);const B=ge.cap(k,2,t-3);let U=0;for(let re=-2;re<=2;re++){const se=o[A+re];U+=se[B-2]+se[B-1]+se[B]+se[B+1]+se[B+2]}const W=U/25;ge.thresholdBlock(e,R,E,W,n,d)}}}static cap(e,t,s){return e<t?t:e>s?s:e}static thresholdBlock(e,t,s,n,i,o){for(let d=0,x=s*i+t;d<ge.BLOCK_SIZE;d++,x+=i)for(let m=0;m<ge.BLOCK_SIZE;m++)(e[x+m]&255)<=n&&o.set(t+m,s+d)}static calculateBlackPoints(e,t,s,n,i){const o=i-ge.BLOCK_SIZE,d=n-ge.BLOCK_SIZE,x=new Array(s);for(let m=0;m<s;m++){x[m]=new Int32Array(t);let b=m<<ge.BLOCK_SIZE_POWER;b>o&&(b=o);for(let E=0;E<t;E++){let A=E<<ge.BLOCK_SIZE_POWER;A>d&&(A=d);let k=0,R=255,B=0;for(let W=0,re=b*n+A;W<ge.BLOCK_SIZE;W++,re+=n){for(let se=0;se<ge.BLOCK_SIZE;se++){const ee=e[re+se]&255;k+=ee,ee<R&&(R=ee),ee>B&&(B=ee)}if(B-R>ge.MIN_DYNAMIC_RANGE)for(W++,re+=n;W<ge.BLOCK_SIZE;W++,re+=n)for(let se=0;se<ge.BLOCK_SIZE;se++)k+=e[re+se]&255}let U=k>>ge.BLOCK_SIZE_POWER*2;if(B-R<=ge.MIN_DYNAMIC_RANGE&&(U=R/2,m>0&&E>0)){const W=(x[m-1][E]+2*x[m][E-1]+x[m-1][E-1])/4;R<W&&(U=W)}x[m][E]=U}}return x}}ge.BLOCK_SIZE_POWER=3,ge.BLOCK_SIZE=1<<ge.BLOCK_SIZE_POWER,ge.BLOCK_SIZE_MASK=ge.BLOCK_SIZE-1,ge.MINIMUM_DIMENSION=ge.BLOCK_SIZE*5,ge.MIN_DYNAMIC_RANGE=24;class at{constructor(e,t){this.width=e,this.height=t}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(e,t,s,n){throw new bt("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new bt("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new bt("This luminance source does not support rotation by 45 degrees.")}toString(){const e=new Uint8ClampedArray(this.width);let t=new q;for(let s=0;s<this.height;s++){const n=this.getRow(s,e);for(let i=0;i<this.width;i++){const o=n[i]&255;let d;o<64?d="#":o<128?d="+":o<192?d=".":d=" ",t.append(d)}t.append(`
`)}return t.toString()}}class X extends at{constructor(e){super(e.getWidth(),e.getHeight()),this.delegate=e}getRow(e,t){const s=this.delegate.getRow(e,t),n=this.getWidth();for(let i=0;i<n;i++)s[i]=255-(s[i]&255);return s}getMatrix(){const e=this.delegate.getMatrix(),t=this.getWidth()*this.getHeight(),s=new Uint8ClampedArray(t);for(let n=0;n<t;n++)s[n]=255-(e[n]&255);return s}isCropSupported(){return this.delegate.isCropSupported()}crop(e,t,s,n){return new X(this.delegate.crop(e,t,s,n))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new X(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new X(this.delegate.rotateCounterClockwise45())}}class de extends at{constructor(e){super(e.width,e.height),this.canvas=e,this.tempCanvasElement=null,this.buffer=de.makeBufferFromCanvasImageData(e)}static makeBufferFromCanvasImageData(e){const t=e.getContext("2d").getImageData(0,0,e.width,e.height);return de.toGrayscaleBuffer(t.data,e.width,e.height)}static toGrayscaleBuffer(e,t,s){const n=new Uint8ClampedArray(t*s);for(let i=0,o=0,d=e.length;i<d;i+=4,o++){let x;if(e[i+3]===0)x=255;else{const b=e[i],E=e[i+1],A=e[i+2];x=306*b+601*E+117*A+512>>10}n[o]=x}return n}getRow(e,t){if(e<0||e>=this.getHeight())throw new N("Requested row is outside the image: "+e);const s=this.getWidth(),n=e*s;return t===null?t=this.buffer.slice(n,n+s):(t.length<s&&(t=new Uint8ClampedArray(s)),t.set(this.buffer.slice(n,n+s))),t}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(e,t,s,n){return super.crop(e,t,s,n),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement}rotate(e){const t=this.getTempCanvasElement(),s=t.getContext("2d"),n=e*de.DEGREE_TO_RADIANS,i=this.canvas.width,o=this.canvas.height,d=Math.ceil(Math.abs(Math.cos(n))*i+Math.abs(Math.sin(n))*o),x=Math.ceil(Math.abs(Math.sin(n))*i+Math.abs(Math.cos(n))*o);return t.width=d,t.height=x,s.translate(d/2,x/2),s.rotate(n),s.drawImage(this.canvas,i/-2,o/-2),this.buffer=de.makeBufferFromCanvasImageData(t),this}invert(){return new X(this)}}de.DEGREE_TO_RADIANS=Math.PI/180;class fe{constructor(e,t,s){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=s||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var te=(globalThis||Is||self||window||void 0)&&(globalThis||Is||self||window||void 0).__awaiter||function(C,e,t,s){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function d(b){try{m(s.next(b))}catch(E){o(E)}}function x(b){try{m(s.throw(b))}catch(E){o(E)}}function m(b){b.done?i(b.value):n(b.value).then(d,x)}m((s=s.apply(C,e||[])).next())})};class ie{constructor(e,t=500,s){this.reader=e,this.timeBetweenScansMillis=t,this._hints=s,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(e){this._timeBetweenDecodingAttempts=e<0?0:e}set hints(e){this._hints=e||null}get hints(){return this._hints}listVideoInputDevices(){return te(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const e=yield navigator.mediaDevices.enumerateDevices(),t=[];for(const s of e){const n=s.kind==="video"?"videoinput":s.kind;if(n!=="videoinput")continue;const i=s.deviceId||s.id,o=s.label||`Video device ${t.length+1}`,d=s.groupId,x={deviceId:i,label:o,kind:n,groupId:d};t.push(x)}return t})}getVideoInputDevices(){return te(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(t=>new fe(t.deviceId,t.label))})}findDeviceById(e){return te(this,void 0,void 0,function*(){const t=yield this.listVideoInputDevices();return t?t.find(s=>s.deviceId===e):null})}decodeFromInputVideoDevice(e,t){return te(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(e,t)})}decodeOnceFromVideoDevice(e,t){return te(this,void 0,void 0,function*(){this.reset();let s;e?s={deviceId:{exact:e}}:s={facingMode:"environment"};const n={video:s};return yield this.decodeOnceFromConstraints(n,t)})}decodeOnceFromConstraints(e,t){return te(this,void 0,void 0,function*(){const s=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeOnceFromStream(s,t)})}decodeOnceFromStream(e,t){return te(this,void 0,void 0,function*(){this.reset();const s=yield this.attachStreamToVideo(e,t);return yield this.decodeOnce(s)})}decodeFromInputVideoDeviceContinuously(e,t,s){return te(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(e,t,s)})}decodeFromVideoDevice(e,t,s){return te(this,void 0,void 0,function*(){let n;e?n={deviceId:{exact:e}}:n={facingMode:"environment"};const i={video:n};return yield this.decodeFromConstraints(i,t,s)})}decodeFromConstraints(e,t,s){return te(this,void 0,void 0,function*(){const n=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeFromStream(n,t,s)})}decodeFromStream(e,t,s){return te(this,void 0,void 0,function*(){this.reset();const n=yield this.attachStreamToVideo(e,t);return yield this.decodeContinuously(n,s)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(e,t){return te(this,void 0,void 0,function*(){const s=this.prepareVideoElement(t);return this.addVideoSource(s,e),this.videoElement=s,this.stream=e,yield this.playVideoOnLoadAsync(s),s})}playVideoOnLoadAsync(e){return new Promise((t,s)=>this.playVideoOnLoad(e,()=>t()))}playVideoOnLoad(e,t){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(e),e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)}isVideoPlaying(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2}tryPlayVideo(e){return te(this,void 0,void 0,function*(){if(this.isVideoPlaying(e)){console.warn("Trying to play video that is already playing.");return}try{yield e.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(e,t){const s=document.getElementById(e);if(!s)throw new w(`element with id '${e}' not found`);if(s.nodeName.toLowerCase()!==t.toLowerCase())throw new w(`element with id '${e}' must be an ${t} element`);return s}decodeFromImage(e,t){if(!e&&!t)throw new w("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)}decodeFromVideo(e,t){if(!e&&!t)throw new w("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)}decodeFromVideoContinuously(e,t,s){if(e===void 0&&t===void 0)throw new w("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,s):this.decodeFromVideoElementContinuously(e,s)}decodeFromImageElement(e){if(!e)throw new w("An image element must be provided.");this.reset();const t=this.prepareImageElement(e);this.imageElement=t;let s;return this.isImageLoaded(t)?s=this.decodeOnce(t,!1,!0):s=this._decodeOnLoadImage(t),s}decodeFromVideoElement(e){const t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)}decodeFromVideoElementContinuously(e,t){const s=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(s,t)}_decodeFromVideoElementSetup(e){if(!e)throw new w("A video element must be provided.");this.reset();const t=this.prepareVideoElement(e);return this.videoElement=t,t}decodeFromImageUrl(e){if(!e)throw new w("An URL must be provided.");this.reset();const t=this.prepareImageElement();this.imageElement=t;const s=this._decodeOnLoadImage(t);return t.src=e,s}decodeFromVideoUrl(e){if(!e)throw new w("An URL must be provided.");this.reset();const t=this.prepareVideoElement(),s=this.decodeFromVideoElement(t);return t.src=e,s}decodeFromVideoUrlContinuously(e,t){if(!e)throw new w("An URL must be provided.");this.reset();const s=this.prepareVideoElement(),n=this.decodeFromVideoElementContinuously(s,t);return s.src=e,n}_decodeOnLoadImage(e){return new Promise((t,s)=>{this.imageLoadedListener=()=>this.decodeOnce(e,!1,!0).then(t,s),e.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(e){return te(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(e),yield this.decodeOnce(e)})}_decodeOnLoadVideoContinuously(e,t){return te(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(e),this.decodeContinuously(e,t)})}isImageLoaded(e){return!(!e.complete||e.naturalWidth===0)}prepareImageElement(e){let t;return typeof e>"u"&&(t=document.createElement("img"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t}prepareVideoElement(e){let t;return!e&&typeof document<"u"&&(t=document.createElement("video"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t}decodeOnce(e,t=!0,s=!0){this._stopAsyncDecode=!1;const n=(i,o)=>{if(this._stopAsyncDecode){o(new F("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const d=this.decode(e);i(d)}catch(d){const x=t&&d instanceof F,b=(d instanceof _||d instanceof Q)&&s;if(x||b)return setTimeout(n,this._timeBetweenDecodingAttempts,i,o);o(d)}};return new Promise((i,o)=>n(i,o))}decodeContinuously(e,t){this._stopContinuousDecode=!1;const s=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const n=this.decode(e);t(n,null),setTimeout(s,this.timeBetweenScansMillis)}catch(n){t(null,n);const i=n instanceof _||n instanceof Q,o=n instanceof F;(i||o)&&setTimeout(s,this._timeBetweenDecodingAttempts)}};s()}decode(e){const t=this.createBinaryBitmap(e);return this.decodeBitmap(t)}_isHTMLVideoElement(e){return e.videoWidth!==0}drawFrameOnCanvas(e,t,s){t||(t={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),s||(s=this.captureCanvasContext),s.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}drawImageOnCanvas(e,t,s=this.captureCanvasContext){t||(t={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),s||(s=this.captureCanvasContext),s.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}createBinaryBitmap(e){this.getCaptureCanvasContext(e),this._isHTMLVideoElement(e)?this.drawFrameOnCanvas(e):this.drawImageOnCanvas(e);const t=this.getCaptureCanvas(e),s=new de(t),n=new ge(s);return new j(n)}getCaptureCanvasContext(e){if(!this.captureCanvasContext){const s=this.getCaptureCanvas(e).getContext("2d");this.captureCanvasContext=s}return this.captureCanvasContext}getCaptureCanvas(e){if(!this.captureCanvas){const t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas}decodeBitmap(e){return this.reader.decode(e,this._hints)}createCaptureCanvas(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const t=document.createElement("canvas");let s,n;return typeof e<"u"&&(e instanceof HTMLVideoElement?(s=e.videoWidth,n=e.videoHeight):e instanceof HTMLImageElement&&(s=e.naturalWidth||e.width,n=e.naturalHeight||e.height)),t.style.width=s+"px",t.style.height=n+"px",t.width=s,t.height=n,t}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(e=>e.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(e,t){try{e.srcObject=t}catch{e.src=URL.createObjectURL(t)}}cleanVideoSource(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")}}class oe{constructor(e,t,s=t==null?0:8*t.length,n,i,o=D.currentTimeMillis()){this.text=e,this.rawBytes=t,this.numBits=s,this.resultPoints=n,this.format=i,this.timestamp=o,this.text=e,this.rawBytes=t,s==null?this.numBits=t==null?0:8*t.length:this.numBits=s,this.resultPoints=n,this.format=i,this.resultMetadata=null,o==null?this.timestamp=D.currentTimeMillis():this.timestamp=o}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(e,t){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)}putAllMetadata(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))}addResultPoints(e){const t=this.resultPoints;if(t===null)this.resultPoints=e;else if(e!==null&&e.length>0){const s=new Array(t.length+e.length);D.arraycopy(t,0,s,0,t.length),D.arraycopy(e,0,s,t.length,e.length),this.resultPoints=s}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Ce;(function(C){C[C.AZTEC=0]="AZTEC",C[C.CODABAR=1]="CODABAR",C[C.CODE_39=2]="CODE_39",C[C.CODE_93=3]="CODE_93",C[C.CODE_128=4]="CODE_128",C[C.DATA_MATRIX=5]="DATA_MATRIX",C[C.EAN_8=6]="EAN_8",C[C.EAN_13=7]="EAN_13",C[C.ITF=8]="ITF",C[C.MAXICODE=9]="MAXICODE",C[C.PDF_417=10]="PDF_417",C[C.QR_CODE=11]="QR_CODE",C[C.RSS_14=12]="RSS_14",C[C.RSS_EXPANDED=13]="RSS_EXPANDED",C[C.UPC_A=14]="UPC_A",C[C.UPC_E=15]="UPC_E",C[C.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ce||(Ce={}));var ae=Ce,Ge;(function(C){C[C.OTHER=0]="OTHER",C[C.ORIENTATION=1]="ORIENTATION",C[C.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",C[C.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",C[C.ISSUE_NUMBER=4]="ISSUE_NUMBER",C[C.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",C[C.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",C[C.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",C[C.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",C[C.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",C[C.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Ge||(Ge={}));var Ie=Ge;class we{constructor(e,t,s,n,i=-1,o=-1){this.rawBytes=e,this.text=t,this.byteSegments=s,this.ecLevel=n,this.structuredAppendSequenceNumber=i,this.structuredAppendParity=o,this.numBits=e==null?0:8*e.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(e){this.numBits=e}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(e){this.errorsCorrected=e}getErasures(){return this.erasures}setErasures(e){this.erasures=e}getOther(){return this.other}setOther(e){this.other=e}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class ot{exp(e){return this.expTable[e]}log(e){if(e===0)throw new N;return this.logTable[e]}static addOrSubtract(e,t){return e^t}}class Ke{constructor(e,t){if(t.length===0)throw new N;this.field=e;const s=t.length;if(s>1&&t[0]===0){let n=1;for(;n<s&&t[n]===0;)n++;n===s?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(s-n),D.arraycopy(t,n,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);const t=this.coefficients;let s;if(e===1){s=0;for(let o=0,d=t.length;o!==d;o++){const x=t[o];s=ot.addOrSubtract(s,x)}return s}s=t[0];const n=t.length,i=this.field;for(let o=1;o<n;o++)s=ot.addOrSubtract(i.multiply(e,s),t[o]);return s}addOrSubtract(e){if(!this.field.equals(e.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,s=e.coefficients;if(t.length>s.length){const o=t;t=s,s=o}let n=new Int32Array(s.length);const i=s.length-t.length;D.arraycopy(s,0,n,0,i);for(let o=i;o<s.length;o++)n[o]=ot.addOrSubtract(t[o-i],s[o]);return new Ke(this.field,n)}multiply(e){if(!this.field.equals(e.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();const t=this.coefficients,s=t.length,n=e.coefficients,i=n.length,o=new Int32Array(s+i-1),d=this.field;for(let x=0;x<s;x++){const m=t[x];for(let b=0;b<i;b++)o[x+b]=ot.addOrSubtract(o[x+b],d.multiply(m,n[b]))}return new Ke(d,o)}multiplyScalar(e){if(e===0)return this.field.getZero();if(e===1)return this;const t=this.coefficients.length,s=this.field,n=new Int32Array(t),i=this.coefficients;for(let o=0;o<t;o++)n[o]=s.multiply(i[o],e);return new Ke(s,n)}multiplyByMonomial(e,t){if(e<0)throw new N;if(t===0)return this.field.getZero();const s=this.coefficients,n=s.length,i=new Int32Array(n+e),o=this.field;for(let d=0;d<n;d++)i[d]=o.multiply(s[d],t);return new Ke(o,i)}divide(e){if(!this.field.equals(e.field))throw new N("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new N("Divide by 0");const t=this.field;let s=t.getZero(),n=this;const i=e.getCoefficient(e.getDegree()),o=t.inverse(i);for(;n.getDegree()>=e.getDegree()&&!n.isZero();){const d=n.getDegree()-e.getDegree(),x=t.multiply(n.getCoefficient(n.getDegree()),o),m=e.multiplyByMonomial(d,x),b=t.buildMonomial(d,x);s=s.addOrSubtract(b),n=n.addOrSubtract(m)}return[s,n]}toString(){let e="";for(let t=this.getDegree();t>=0;t--){let s=this.getCoefficient(t);if(s!==0){if(s<0?(e+=" - ",s=-s):e.length>0&&(e+=" + "),t===0||s!==1){const n=this.field.log(s);n===0?e+="1":n===1?e+="a":(e+="a^",e+=n)}t!==0&&(t===1?e+="x":(e+="x^",e+=t))}}return e}}class Tr extends g{}Tr.kind="ArithmeticException";class ke extends ot{constructor(e,t,s){super(),this.primitive=e,this.size=t,this.generatorBase=s;const n=new Int32Array(t);let i=1;for(let d=0;d<t;d++)n[d]=i,i*=2,i>=t&&(i^=e,i&=t-1);this.expTable=n;const o=new Int32Array(t);for(let d=0;d<t-1;d++)o[n[d]]=d;this.logTable=o,this.zero=new Ke(this,Int32Array.from([0])),this.one=new Ke(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new N;if(t===0)return this.zero;const s=new Int32Array(e+1);return s[0]=t,new Ke(this,s)}inverse(e){if(e===0)throw new Tr;return this.expTable[this.size-this.logTable[e]-1]}multiply(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+M.toHexString(this.primitive)+","+this.size+")"}equals(e){return e===this}}ke.AZTEC_DATA_12=new ke(4201,4096,1),ke.AZTEC_DATA_10=new ke(1033,1024,1),ke.AZTEC_DATA_6=new ke(67,64,1),ke.AZTEC_PARAM=new ke(19,16,1),ke.QR_CODE_FIELD_256=new ke(285,256,0),ke.DATA_MATRIX_FIELD_256=new ke(301,256,1),ke.AZTEC_DATA_8=ke.DATA_MATRIX_FIELD_256,ke.MAXICODE_FIELD_64=ke.AZTEC_DATA_6;class lr extends g{}lr.kind="ReedSolomonException";class Xe extends g{}Xe.kind="IllegalStateException";class cr{constructor(e){this.field=e}decode(e,t){const s=this.field,n=new Ke(s,e),i=new Int32Array(t);let o=!0;for(let k=0;k<t;k++){const R=n.evaluateAt(s.exp(k+s.getGeneratorBase()));i[i.length-1-k]=R,R!==0&&(o=!1)}if(o)return;const d=new Ke(s,i),x=this.runEuclideanAlgorithm(s.buildMonomial(t,1),d,t),m=x[0],b=x[1],E=this.findErrorLocations(m),A=this.findErrorMagnitudes(b,E);for(let k=0;k<E.length;k++){const R=e.length-1-s.log(E[k]);if(R<0)throw new lr("Bad error location");e[R]=ke.addOrSubtract(e[R],A[k])}}runEuclideanAlgorithm(e,t,s){if(e.getDegree()<t.getDegree()){const k=e;e=t,t=k}const n=this.field;let i=e,o=t,d=n.getZero(),x=n.getOne();for(;o.getDegree()>=(s/2|0);){let k=i,R=d;if(i=o,d=x,i.isZero())throw new lr("r_{i-1} was zero");o=k;let B=n.getZero();const U=i.getCoefficient(i.getDegree()),W=n.inverse(U);for(;o.getDegree()>=i.getDegree()&&!o.isZero();){const re=o.getDegree()-i.getDegree(),se=n.multiply(o.getCoefficient(o.getDegree()),W);B=B.addOrSubtract(n.buildMonomial(re,se)),o=o.addOrSubtract(i.multiplyByMonomial(re,se))}if(x=B.multiply(d).addOrSubtract(R),o.getDegree()>=i.getDegree())throw new Xe("Division algorithm failed to reduce polynomial?")}const m=x.getCoefficient(0);if(m===0)throw new lr("sigmaTilde(0) was zero");const b=n.inverse(m),E=x.multiplyScalar(b),A=o.multiplyScalar(b);return[E,A]}findErrorLocations(e){const t=e.getDegree();if(t===1)return Int32Array.from([e.getCoefficient(1)]);const s=new Int32Array(t);let n=0;const i=this.field;for(let o=1;o<i.getSize()&&n<t;o++)e.evaluateAt(o)===0&&(s[n]=i.inverse(o),n++);if(n!==t)throw new lr("Error locator degree does not match number of roots");return s}findErrorMagnitudes(e,t){const s=t.length,n=new Int32Array(s),i=this.field;for(let o=0;o<s;o++){const d=i.inverse(t[o]);let x=1;for(let m=0;m<s;m++)if(o!==m){const b=i.multiply(t[m],d),E=b&1?b&-2:b|1;x=i.multiply(x,E)}n[o]=i.multiply(e.evaluateAt(d),i.inverse(x)),i.getGeneratorBase()!==0&&(n[o]=i.multiply(n[o],d))}return n}}var gt;(function(C){C[C.UPPER=0]="UPPER",C[C.LOWER=1]="LOWER",C[C.MIXED=2]="MIXED",C[C.DIGIT=3]="DIGIT",C[C.PUNCT=4]="PUNCT",C[C.BINARY=5]="BINARY"})(gt||(gt={}));class ze{decode(e){this.ddata=e;let t=e.getBits(),s=this.extractBits(t),n=this.correctBits(s),i=ze.convertBoolArrayToByteArray(n),o=ze.getEncodedData(n),d=new we(i,o,null,null);return d.setNumBits(n.length),d}static highLevelDecode(e){return this.getEncodedData(e)}static getEncodedData(e){let t=e.length,s=gt.UPPER,n=gt.UPPER,i="",o=0;for(;o<t;)if(n===gt.BINARY){if(t-o<5)break;let d=ze.readCode(e,o,5);if(o+=5,d===0){if(t-o<11)break;d=ze.readCode(e,o,11)+31,o+=11}for(let x=0;x<d;x++){if(t-o<8){o=t;break}const m=ze.readCode(e,o,8);i+=H.castAsNonUtf8Char(m),o+=8}n=s}else{let d=n===gt.DIGIT?4:5;if(t-o<d)break;let x=ze.readCode(e,o,d);o+=d;let m=ze.getCharacter(n,x);m.startsWith("CTRL_")?(s=n,n=ze.getTable(m.charAt(5)),m.charAt(6)==="L"&&(s=n)):(i+=m,n=s)}return i}static getTable(e){switch(e){case"L":return gt.LOWER;case"P":return gt.PUNCT;case"M":return gt.MIXED;case"D":return gt.DIGIT;case"B":return gt.BINARY;case"U":default:return gt.UPPER}}static getCharacter(e,t){switch(e){case gt.UPPER:return ze.UPPER_TABLE[t];case gt.LOWER:return ze.LOWER_TABLE[t];case gt.MIXED:return ze.MIXED_TABLE[t];case gt.PUNCT:return ze.PUNCT_TABLE[t];case gt.DIGIT:return ze.DIGIT_TABLE[t];default:throw new Xe("Bad table")}}correctBits(e){let t,s;this.ddata.getNbLayers()<=2?(s=6,t=ke.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(s=8,t=ke.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(s=10,t=ke.AZTEC_DATA_10):(s=12,t=ke.AZTEC_DATA_12);let n=this.ddata.getNbDatablocks(),i=e.length/s;if(i<n)throw new Q;let o=e.length%s,d=new Int32Array(i);for(let A=0;A<i;A++,o+=s)d[A]=ze.readCode(e,o,s);try{new cr(t).decode(d,i-n)}catch(A){throw new Q(A)}let x=(1<<s)-1,m=0;for(let A=0;A<n;A++){let k=d[A];if(k===0||k===x)throw new Q;(k===1||k===x-1)&&m++}let b=new Array(n*s-m),E=0;for(let A=0;A<n;A++){let k=d[A];if(k===1||k===x-1)b.fill(k>1,E,E+s-1),E+=s-1;else for(let R=s-1;R>=0;--R)b[E++]=(k&1<<R)!==0}return b}extractBits(e){let t=this.ddata.isCompact(),s=this.ddata.getNbLayers(),n=(t?11:14)+s*4,i=new Int32Array(n),o=new Array(this.totalBitsInLayer(s,t));if(t)for(let d=0;d<i.length;d++)i[d]=d;else{let d=n+1+2*M.truncDivision(M.truncDivision(n,2)-1,15),x=n/2,m=M.truncDivision(d,2);for(let b=0;b<x;b++){let E=b+M.truncDivision(b,15);i[x-b-1]=m-E-1,i[x+b]=m+E+1}}for(let d=0,x=0;d<s;d++){let m=(s-d)*4+(t?9:12),b=d*2,E=n-1-b;for(let A=0;A<m;A++){let k=A*2;for(let R=0;R<2;R++)o[x+k+R]=e.get(i[b+R],i[b+A]),o[x+2*m+k+R]=e.get(i[b+A],i[E-R]),o[x+4*m+k+R]=e.get(i[E-R],i[E-A]),o[x+6*m+k+R]=e.get(i[E-A],i[b+R])}x+=m*8}return o}static readCode(e,t,s){let n=0;for(let i=t;i<t+s;i++)n<<=1,e[i]&&(n|=1);return n}static readByte(e,t){let s=e.length-t;return s>=8?ze.readCode(e,t,8):ze.readCode(e,t,s)<<8-s}static convertBoolArrayToByteArray(e){let t=new Uint8Array((e.length+7)/8);for(let s=0;s<t.length;s++)t[s]=ze.readByte(e,8*s);return t}totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}ze.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],ze.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],ze.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],ze.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],ze.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class De{constructor(){}static round(e){return e===NaN?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0}static distance(e,t,s,n){const i=e-s,o=t-n;return Math.sqrt(i*i+o*o)}static sum(e){let t=0;for(let s=0,n=e.length;s!==n;s++){const i=e[s];t+=i}return t}}class er{static floatToIntBits(e){return e}}er.MAX_VALUE=Number.MAX_SAFE_INTEGER;class me{constructor(e,t){this.x=e,this.y=t}getX(){return this.x}getY(){return this.y}equals(e){if(e instanceof me){const t=e;return this.x===t.x&&this.y===t.y}return!1}hashCode(){return 31*er.floatToIntBits(this.x)+er.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(e){const t=this.distance(e[0],e[1]),s=this.distance(e[1],e[2]),n=this.distance(e[0],e[2]);let i,o,d;if(s>=t&&s>=n?(o=e[0],i=e[1],d=e[2]):n>=s&&n>=t?(o=e[1],i=e[0],d=e[2]):(o=e[2],i=e[0],d=e[1]),this.crossProductZ(i,o,d)<0){const x=i;i=d,d=x}e[0]=i,e[1]=o,e[2]=d}static distance(e,t){return De.distance(e.x,e.y,t.x,t.y)}static crossProductZ(e,t,s){const n=t.x,i=t.y;return(s.x-n)*(e.y-i)-(s.y-i)*(e.x-n)}}class es{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class zs extends es{constructor(e,t,s,n,i){super(e,t),this.compact=s,this.nbDatablocks=n,this.nbLayers=i}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class tr{constructor(e,t,s,n){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),t==null&&(t=tr.INIT_SIZE),s==null&&(s=e.getWidth()/2|0),n==null&&(n=e.getHeight()/2|0);const i=t/2|0;if(this.leftInit=s-i,this.rightInit=s+i,this.upInit=n-i,this.downInit=n+i,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new F}detect(){let e=this.leftInit,t=this.rightInit,s=this.upInit,n=this.downInit,i=!1,o=!0,d=!1,x=!1,m=!1,b=!1,E=!1;const A=this.width,k=this.height;for(;o;){o=!1;let R=!0;for(;(R||!x)&&t<A;)R=this.containsBlackPoint(s,n,t,!1),R?(t++,o=!0,x=!0):x||t++;if(t>=A){i=!0;break}let B=!0;for(;(B||!m)&&n<k;)B=this.containsBlackPoint(e,t,n,!0),B?(n++,o=!0,m=!0):m||n++;if(n>=k){i=!0;break}let U=!0;for(;(U||!b)&&e>=0;)U=this.containsBlackPoint(s,n,e,!1),U?(e--,o=!0,b=!0):b||e--;if(e<0){i=!0;break}let W=!0;for(;(W||!E)&&s>=0;)W=this.containsBlackPoint(e,t,s,!0),W?(s--,o=!0,E=!0):E||s--;if(s<0){i=!0;break}o&&(d=!0)}if(!i&&d){const R=t-e;let B=null;for(let se=1;B===null&&se<R;se++)B=this.getBlackPointOnSegment(e,n-se,e+se,n);if(B==null)throw new F;let U=null;for(let se=1;U===null&&se<R;se++)U=this.getBlackPointOnSegment(e,s+se,e+se,s);if(U==null)throw new F;let W=null;for(let se=1;W===null&&se<R;se++)W=this.getBlackPointOnSegment(t,s+se,t-se,s);if(W==null)throw new F;let re=null;for(let se=1;re===null&&se<R;se++)re=this.getBlackPointOnSegment(t,n-se,t-se,n);if(re==null)throw new F;return this.centerEdges(re,B,W,U)}else throw new F}getBlackPointOnSegment(e,t,s,n){const i=De.round(De.distance(e,t,s,n)),o=(s-e)/i,d=(n-t)/i,x=this.image;for(let m=0;m<i;m++){const b=De.round(e+m*o),E=De.round(t+m*d);if(x.get(b,E))return new me(b,E)}return null}centerEdges(e,t,s,n){const i=e.getX(),o=e.getY(),d=t.getX(),x=t.getY(),m=s.getX(),b=s.getY(),E=n.getX(),A=n.getY(),k=tr.CORR;return i<this.width/2?[new me(E-k,A+k),new me(d+k,x+k),new me(m-k,b-k),new me(i+k,o-k)]:[new me(E+k,A+k),new me(d+k,x-k),new me(m-k,b+k),new me(i-k,o-k)]}containsBlackPoint(e,t,s,n){const i=this.image;if(n){for(let o=e;o<=t;o++)if(i.get(o,s))return!0}else for(let o=e;o<=t;o++)if(i.get(s,o))return!0;return!1}}tr.INIT_SIZE=10,tr.CORR=1;class ys{static checkAndNudgePoints(e,t){const s=e.getWidth(),n=e.getHeight();let i=!0;for(let o=0;o<t.length&&i;o+=2){const d=Math.floor(t[o]),x=Math.floor(t[o+1]);if(d<-1||d>s||x<-1||x>n)throw new F;i=!1,d===-1?(t[o]=0,i=!0):d===s&&(t[o]=s-1,i=!0),x===-1?(t[o+1]=0,i=!0):x===n&&(t[o+1]=n-1,i=!0)}i=!0;for(let o=t.length-2;o>=0&&i;o-=2){const d=Math.floor(t[o]),x=Math.floor(t[o+1]);if(d<-1||d>s||x<-1||x>n)throw new F;i=!1,d===-1?(t[o]=0,i=!0):d===s&&(t[o]=s-1,i=!0),x===-1?(t[o+1]=0,i=!0):x===n&&(t[o+1]=n-1,i=!0)}}}class Vt{constructor(e,t,s,n,i,o,d,x,m){this.a11=e,this.a21=t,this.a31=s,this.a12=n,this.a22=i,this.a32=o,this.a13=d,this.a23=x,this.a33=m}static quadrilateralToQuadrilateral(e,t,s,n,i,o,d,x,m,b,E,A,k,R,B,U){const W=Vt.quadrilateralToSquare(e,t,s,n,i,o,d,x);return Vt.squareToQuadrilateral(m,b,E,A,k,R,B,U).times(W)}transformPoints(e){const t=e.length,s=this.a11,n=this.a12,i=this.a13,o=this.a21,d=this.a22,x=this.a23,m=this.a31,b=this.a32,E=this.a33;for(let A=0;A<t;A+=2){const k=e[A],R=e[A+1],B=i*k+x*R+E;e[A]=(s*k+o*R+m)/B,e[A+1]=(n*k+d*R+b)/B}}transformPointsWithValues(e,t){const s=this.a11,n=this.a12,i=this.a13,o=this.a21,d=this.a22,x=this.a23,m=this.a31,b=this.a32,E=this.a33,A=e.length;for(let k=0;k<A;k++){const R=e[k],B=t[k],U=i*R+x*B+E;e[k]=(s*R+o*B+m)/U,t[k]=(n*R+d*B+b)/U}}static squareToQuadrilateral(e,t,s,n,i,o,d,x){const m=e-s+i-d,b=t-n+o-x;if(m===0&&b===0)return new Vt(s-e,i-s,e,n-t,o-n,t,0,0,1);{const E=s-i,A=d-i,k=n-o,R=x-o,B=E*R-A*k,U=(m*R-A*b)/B,W=(E*b-m*k)/B;return new Vt(s-e+U*s,d-e+W*d,e,n-t+U*n,x-t+W*x,t,U,W,1)}}static quadrilateralToSquare(e,t,s,n,i,o,d,x){return Vt.squareToQuadrilateral(e,t,s,n,i,o,d,x).buildAdjoint()}buildAdjoint(){return new Vt(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(e){return new Vt(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}class bs extends ys{sampleGrid(e,t,s,n,i,o,d,x,m,b,E,A,k,R,B,U,W,re,se){const ee=Vt.quadrilateralToQuadrilateral(n,i,o,d,x,m,b,E,A,k,R,B,U,W,re,se);return this.sampleGridWithTransform(e,t,s,ee)}sampleGridWithTransform(e,t,s,n){if(t<=0||s<=0)throw new F;const i=new he(t,s),o=new Float32Array(2*t);for(let d=0;d<s;d++){const x=o.length,m=d+.5;for(let b=0;b<x;b+=2)o[b]=b/2+.5,o[b+1]=m;n.transformPoints(o),ys.checkAndNudgePoints(e,o);try{for(let b=0;b<x;b+=2)e.get(Math.floor(o[b]),Math.floor(o[b+1]))&&i.set(b/2,d)}catch{throw new F}}return i}}class dr{static setGridSampler(e){dr.gridSampler=e}static getInstance(){return dr.gridSampler}}dr.gridSampler=new bs;class At{constructor(e,t){this.x=e,this.y=t}toResultPoint(){return new me(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Ws{constructor(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}detect(){return this.detectMirror(!1)}detectMirror(e){let t=this.getMatrixCenter(),s=this.getBullsEyeCorners(t);if(e){let o=s[0];s[0]=s[2],s[2]=o}this.extractParameters(s);let n=this.sampleGrid(this.image,s[this.shift%4],s[(this.shift+1)%4],s[(this.shift+2)%4],s[(this.shift+3)%4]),i=this.getMatrixCornerPoints(s);return new zs(n,i,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new F;let t=2*this.nbCenterLayers,s=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(s,t);let n=0;for(let o=0;o<4;o++){let d=s[(this.shift+o)%4];this.compact?(n<<=7,n+=d>>1&127):(n<<=10,n+=(d>>2&992)+(d>>1&31))}let i=this.getCorrectedParameterData(n,this.compact);this.compact?(this.nbLayers=(i>>6)+1,this.nbDataBlocks=(i&63)+1):(this.nbLayers=(i>>11)+1,this.nbDataBlocks=(i&2047)+1)}getRotation(e,t){let s=0;e.forEach((n,i,o)=>{let d=(n>>t-2<<1)+(n&1);s=(s<<3)+d}),s=((s&1)<<11)+(s>>1);for(let n=0;n<4;n++)if(M.bitCount(s^this.EXPECTED_CORNER_BITS[n])<=2)return n;throw new F}getCorrectedParameterData(e,t){let s,n;t?(s=7,n=2):(s=10,n=4);let i=s-n,o=new Int32Array(s);for(let x=s-1;x>=0;--x)o[x]=e&15,e>>=4;try{new cr(ke.AZTEC_PARAM).decode(o,i)}catch{throw new F}let d=0;for(let x=0;x<n;x++)d=(d<<4)+o[x];return d}getBullsEyeCorners(e){let t=e,s=e,n=e,i=e,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let E=this.getFirstDifferent(t,o,1,-1),A=this.getFirstDifferent(s,o,1,1),k=this.getFirstDifferent(n,o,-1,1),R=this.getFirstDifferent(i,o,-1,-1);if(this.nbCenterLayers>2){let B=this.distancePoint(R,E)*this.nbCenterLayers/(this.distancePoint(i,t)*(this.nbCenterLayers+2));if(B<.75||B>1.25||!this.isWhiteOrBlackRectangle(E,A,k,R))break}t=E,s=A,n=k,i=R,o=!o}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new F;this.compact=this.nbCenterLayers===5;let d=new me(t.getX()+.5,t.getY()-.5),x=new me(s.getX()+.5,s.getY()+.5),m=new me(n.getX()-.5,n.getY()+.5),b=new me(i.getX()-.5,i.getY()-.5);return this.expandSquare([d,x,m,b],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let e,t,s,n;try{let d=new tr(this.image).detect();e=d[0],t=d[1],s=d[2],n=d[3]}catch{let x=this.image.getWidth()/2,m=this.image.getHeight()/2;e=this.getFirstDifferent(new At(x+7,m-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new At(x+7,m+7),!1,1,1).toResultPoint(),s=this.getFirstDifferent(new At(x-7,m+7),!1,-1,1).toResultPoint(),n=this.getFirstDifferent(new At(x-7,m-7),!1,-1,-1).toResultPoint()}let i=De.round((e.getX()+n.getX()+t.getX()+s.getX())/4),o=De.round((e.getY()+n.getY()+t.getY()+s.getY())/4);try{let d=new tr(this.image,15,i,o).detect();e=d[0],t=d[1],s=d[2],n=d[3]}catch{e=this.getFirstDifferent(new At(i+7,o-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new At(i+7,o+7),!1,1,1).toResultPoint(),s=this.getFirstDifferent(new At(i-7,o+7),!1,-1,1).toResultPoint(),n=this.getFirstDifferent(new At(i-7,o-7),!1,-1,-1).toResultPoint()}return i=De.round((e.getX()+n.getX()+t.getX()+s.getX())/4),o=De.round((e.getY()+n.getY()+t.getY()+s.getY())/4),new At(i,o)}getMatrixCornerPoints(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())}sampleGrid(e,t,s,n,i){let o=dr.getInstance(),d=this.getDimension(),x=d/2-this.nbCenterLayers,m=d/2+this.nbCenterLayers;return o.sampleGrid(e,d,d,x,x,m,x,m,m,x,m,t.getX(),t.getY(),s.getX(),s.getY(),n.getX(),n.getY(),i.getX(),i.getY())}sampleLine(e,t,s){let n=0,i=this.distanceResultPoint(e,t),o=i/s,d=e.getX(),x=e.getY(),m=o*(t.getX()-e.getX())/i,b=o*(t.getY()-e.getY())/i;for(let E=0;E<s;E++)this.image.get(De.round(d+E*m),De.round(x+E*b))&&(n|=1<<s-E-1);return n}isWhiteOrBlackRectangle(e,t,s,n){let i=3;e=new At(e.getX()-i,e.getY()+i),t=new At(t.getX()-i,t.getY()-i),s=new At(s.getX()+i,s.getY()-i),n=new At(n.getX()+i,n.getY()+i);let o=this.getColor(n,e);if(o===0)return!1;let d=this.getColor(e,t);return d!==o||(d=this.getColor(t,s),d!==o)?!1:(d=this.getColor(s,n),d===o)}getColor(e,t){let s=this.distancePoint(e,t),n=(t.getX()-e.getX())/s,i=(t.getY()-e.getY())/s,o=0,d=e.getX(),x=e.getY(),m=this.image.get(e.getX(),e.getY()),b=Math.ceil(s);for(let A=0;A<b;A++)d+=n,x+=i,this.image.get(De.round(d),De.round(x))!==m&&o++;let E=o/s;return E>.1&&E<.9?0:E<=.1===m?1:-1}getFirstDifferent(e,t,s,n){let i=e.getX()+s,o=e.getY()+n;for(;this.isValid(i,o)&&this.image.get(i,o)===t;)i+=s,o+=n;for(i-=s,o-=n;this.isValid(i,o)&&this.image.get(i,o)===t;)i+=s;for(i-=s;this.isValid(i,o)&&this.image.get(i,o)===t;)o+=n;return o-=n,new At(i,o)}expandSquare(e,t,s){let n=s/(2*t),i=e[0].getX()-e[2].getX(),o=e[0].getY()-e[2].getY(),d=(e[0].getX()+e[2].getX())/2,x=(e[0].getY()+e[2].getY())/2,m=new me(d+n*i,x+n*o),b=new me(d-n*i,x-n*o);i=e[1].getX()-e[3].getX(),o=e[1].getY()-e[3].getY(),d=(e[1].getX()+e[3].getX())/2,x=(e[1].getY()+e[3].getY())/2;let E=new me(d+n*i,x+n*o),A=new me(d-n*i,x-n*o);return[m,E,b,A]}isValid(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()}isValidPoint(e){let t=De.round(e.getX()),s=De.round(e.getY());return this.isValid(t,s)}distancePoint(e,t){return De.distance(e.getX(),e.getY(),t.getX(),t.getY())}distanceResultPoint(e,t){return De.distance(e.getX(),e.getY(),t.getX(),t.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(M.truncDivision(this.nbLayers-4,8)+1)+15}}class ts{decode(e,t=null){let s=null,n=new Ws(e.getBlackMatrix()),i=null,o=null;try{let b=n.detectMirror(!1);i=b.getPoints(),this.reportFoundResultPoints(t,i),o=new ze().decode(b)}catch(b){s=b}if(o==null)try{let b=n.detectMirror(!0);i=b.getPoints(),this.reportFoundResultPoints(t,i),o=new ze().decode(b)}catch(b){throw s??b}let d=new oe(o.getText(),o.getRawBytes(),o.getNumBits(),i,ae.AZTEC,D.currentTimeMillis()),x=o.getByteSegments();x!=null&&d.putMetadata(Ie.BYTE_SEGMENTS,x);let m=o.getECLevel();return m!=null&&d.putMetadata(Ie.ERROR_CORRECTION_LEVEL,m),d}reportFoundResultPoints(e,t){if(e!=null){let s=e.get(ce.NEED_RESULT_POINT_CALLBACK);s!=null&&t.forEach((n,i,o)=>{s.foundPossibleResultPoint(n)})}}reset(){}}class bn extends ie{constructor(e=500){super(new ts,e)}}class ct{decode(e,t){try{return this.doDecode(e,t)}catch{if(t&&t.get(ce.TRY_HARDER)===!0&&e.isRotateSupported()){const i=e.rotateCounterClockwise(),o=this.doDecode(i,t),d=o.getResultMetadata();let x=270;d!==null&&d.get(Ie.ORIENTATION)===!0&&(x=x+d.get(Ie.ORIENTATION)%360),o.putMetadata(Ie.ORIENTATION,x);const m=o.getResultPoints();if(m!==null){const b=i.getHeight();for(let E=0;E<m.length;E++)m[E]=new me(b-m[E].getY()-1,m[E].getX())}return o}else throw new F}}reset(){}doDecode(e,t){const s=e.getWidth(),n=e.getHeight();let i=new z(s);const o=t&&t.get(ce.TRY_HARDER)===!0,d=Math.max(1,n>>(o?8:5));let x;o?x=n:x=15;const m=Math.trunc(n/2);for(let b=0;b<x;b++){const E=Math.trunc((b+1)/2),A=(b&1)===0,k=m+d*(A?E:-E);if(k<0||k>=n)break;try{i=e.getBlackRow(k,i)}catch{continue}for(let R=0;R<2;R++){if(R===1&&(i.reverse(),t&&t.get(ce.NEED_RESULT_POINT_CALLBACK)===!0)){const B=new Map;t.forEach((U,W)=>B.set(W,U)),B.delete(ce.NEED_RESULT_POINT_CALLBACK),t=B}try{const B=this.decodeRow(k,i,t);if(R===1){B.putMetadata(Ie.ORIENTATION,180);const U=B.getResultPoints();U!==null&&(U[0]=new me(s-U[0].getX()-1,U[0].getY()),U[1]=new me(s-U[1].getX()-1,U[1].getY()))}return B}catch{}}}throw new F}static recordPattern(e,t,s){const n=s.length;for(let m=0;m<n;m++)s[m]=0;const i=e.getSize();if(t>=i)throw new F;let o=!e.get(t),d=0,x=t;for(;x<i;){if(e.get(x)!==o)s[d]++;else{if(++d===n)break;s[d]=1,o=!o}x++}if(!(d===n||d===n-1&&x===i))throw new F}static recordPatternInReverse(e,t,s){let n=s.length,i=e.get(t);for(;t>0&&n>=0;)e.get(--t)!==i&&(n--,i=!i);if(n>=0)throw new F;ct.recordPattern(e,t+1,s)}static patternMatchVariance(e,t,s){const n=e.length;let i=0,o=0;for(let m=0;m<n;m++)i+=e[m],o+=t[m];if(i<o)return Number.POSITIVE_INFINITY;const d=i/o;s*=d;let x=0;for(let m=0;m<n;m++){const b=e[m],E=t[m]*d,A=b>E?b-E:E-b;if(A>s)return Number.POSITIVE_INFINITY;x+=A}return x/i}}class le extends ct{static findStartPattern(e){const t=e.getSize(),s=e.getNextSet(0);let n=0,i=Int32Array.from([0,0,0,0,0,0]),o=s,d=!1;const x=6;for(let m=s;m<t;m++)if(e.get(m)!==d)i[n]++;else{if(n===x-1){let b=le.MAX_AVG_VARIANCE,E=-1;for(let A=le.CODE_START_A;A<=le.CODE_START_C;A++){const k=ct.patternMatchVariance(i,le.CODE_PATTERNS[A],le.MAX_INDIVIDUAL_VARIANCE);k<b&&(b=k,E=A)}if(E>=0&&e.isRange(Math.max(0,o-(m-o)/2),o,!1))return Int32Array.from([o,m,E]);o+=i[0]+i[1],i=i.slice(2,i.length-1),i[n-1]=0,i[n]=0,n--}else n++;i[n]=1,d=!d}throw new F}static decodeCode(e,t,s){ct.recordPattern(e,s,t);let n=le.MAX_AVG_VARIANCE,i=-1;for(let o=0;o<le.CODE_PATTERNS.length;o++){const d=le.CODE_PATTERNS[o],x=this.patternMatchVariance(t,d,le.MAX_INDIVIDUAL_VARIANCE);x<n&&(n=x,i=o)}if(i>=0)return i;throw new F}decodeRow(e,t,s){const n=s&&s.get(ce.ASSUME_GS1)===!0,i=le.findStartPattern(t),o=i[2];let d=0;const x=new Uint8Array(20);x[d++]=o;let m;switch(o){case le.CODE_START_A:m=le.CODE_CODE_A;break;case le.CODE_START_B:m=le.CODE_CODE_B;break;case le.CODE_START_C:m=le.CODE_CODE_C;break;default:throw new Q}let b=!1,E=!1,A="",k=i[0],R=i[1];const B=Int32Array.from([0,0,0,0,0,0]);let U=0,W=0,re=o,se=0,ee=!0,Oe=!1,je=!1;for(;!b;){const os=E;switch(E=!1,U=W,W=le.decodeCode(t,B,R),x[d++]=W,W!==le.CODE_STOP&&(ee=!0),W!==le.CODE_STOP&&(se++,re+=se*W),k=R,R+=B.reduce((Wo,Yo)=>Wo+Yo,0),W){case le.CODE_START_A:case le.CODE_START_B:case le.CODE_START_C:throw new Q}switch(m){case le.CODE_CODE_A:if(W<64)je===Oe?A+=String.fromCharCode(32+W):A+=String.fromCharCode(32+W+128),je=!1;else if(W<96)je===Oe?A+=String.fromCharCode(W-64):A+=String.fromCharCode(W+64),je=!1;else switch(W!==le.CODE_STOP&&(ee=!1),W){case le.CODE_FNC_1:n&&(A.length===0?A+="]C1":A+="");break;case le.CODE_FNC_2:case le.CODE_FNC_3:break;case le.CODE_FNC_4_A:!Oe&&je?(Oe=!0,je=!1):Oe&&je?(Oe=!1,je=!1):je=!0;break;case le.CODE_SHIFT:E=!0,m=le.CODE_CODE_B;break;case le.CODE_CODE_B:m=le.CODE_CODE_B;break;case le.CODE_CODE_C:m=le.CODE_CODE_C;break;case le.CODE_STOP:b=!0;break}break;case le.CODE_CODE_B:if(W<96)je===Oe?A+=String.fromCharCode(32+W):A+=String.fromCharCode(32+W+128),je=!1;else switch(W!==le.CODE_STOP&&(ee=!1),W){case le.CODE_FNC_1:n&&(A.length===0?A+="]C1":A+="");break;case le.CODE_FNC_2:case le.CODE_FNC_3:break;case le.CODE_FNC_4_B:!Oe&&je?(Oe=!0,je=!1):Oe&&je?(Oe=!1,je=!1):je=!0;break;case le.CODE_SHIFT:E=!0,m=le.CODE_CODE_A;break;case le.CODE_CODE_A:m=le.CODE_CODE_A;break;case le.CODE_CODE_C:m=le.CODE_CODE_C;break;case le.CODE_STOP:b=!0;break}break;case le.CODE_CODE_C:if(W<100)W<10&&(A+="0"),A+=W;else switch(W!==le.CODE_STOP&&(ee=!1),W){case le.CODE_FNC_1:n&&(A.length===0?A+="]C1":A+="");break;case le.CODE_CODE_A:m=le.CODE_CODE_A;break;case le.CODE_CODE_B:m=le.CODE_CODE_B;break;case le.CODE_STOP:b=!0;break}break}os&&(m=m===le.CODE_CODE_A?le.CODE_CODE_B:le.CODE_CODE_A)}const Ft=R-k;if(R=t.getNextUnset(R),!t.isRange(R,Math.min(t.getSize(),R+(R-k)/2),!1))throw new F;if(re-=se*U,re%103!==U)throw new _;const ir=A.length;if(ir===0)throw new F;ir>0&&ee&&(m===le.CODE_CODE_C?A=A.substring(0,ir-2):A=A.substring(0,ir-1));const Ut=(i[1]+i[0])/2,$e=k+Ft/2,It=x.length,Gt=new Uint8Array(It);for(let os=0;os<It;os++)Gt[os]=x[os];const as=[new me(Ut,e),new me($e,e)];return new oe(A,Gt,0,as,ae.CODE_128,new Date().getTime())}}le.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],le.MAX_AVG_VARIANCE=.25,le.MAX_INDIVIDUAL_VARIANCE=.7,le.CODE_SHIFT=98,le.CODE_CODE_C=99,le.CODE_CODE_B=100,le.CODE_CODE_A=101,le.CODE_FNC_1=102,le.CODE_FNC_2=97,le.CODE_FNC_3=96,le.CODE_FNC_4_A=101,le.CODE_FNC_4_B=100,le.CODE_START_A=103,le.CODE_START_B=104,le.CODE_START_C=105,le.CODE_STOP=106;class ft extends ct{constructor(e=!1,t=!1){super(),this.usingCheckDigit=e,this.extendedMode=t,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(e,t,s){let n=this.counters;n.fill(0),this.decodeRowResult="";let i=ft.findAsteriskPattern(t,n),o=t.getNextSet(i[1]),d=t.getSize(),x,m;do{ft.recordPattern(t,o,n);let B=ft.toNarrowWidePattern(n);if(B<0)throw new F;x=ft.patternToChar(B),this.decodeRowResult+=x,m=o;for(let U of n)o+=U;o=t.getNextSet(o)}while(x!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let b=0;for(let B of n)b+=B;let E=o-m-b;if(o!==d&&E*2<b)throw new F;if(this.usingCheckDigit){let B=this.decodeRowResult.length-1,U=0;for(let W=0;W<B;W++)U+=ft.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(W));if(this.decodeRowResult.charAt(B)!==ft.ALPHABET_STRING.charAt(U%43))throw new _;this.decodeRowResult=this.decodeRowResult.substring(0,B)}if(this.decodeRowResult.length===0)throw new F;let A;this.extendedMode?A=ft.decodeExtended(this.decodeRowResult):A=this.decodeRowResult;let k=(i[1]+i[0])/2,R=m+b/2;return new oe(A,null,0,[new me(k,e),new me(R,e)],ae.CODE_39,new Date().getTime())}static findAsteriskPattern(e,t){let s=e.getSize(),n=e.getNextSet(0),i=0,o=n,d=!1,x=t.length;for(let m=n;m<s;m++)if(e.get(m)!==d)t[i]++;else{if(i===x-1){if(this.toNarrowWidePattern(t)===ft.ASTERISK_ENCODING&&e.isRange(Math.max(0,o-Math.floor((m-o)/2)),o,!1))return[o,m];o+=t[0]+t[1],t.copyWithin(0,2,2+i-1),t[i-1]=0,t[i]=0,i--}else i++;t[i]=1,d=!d}throw new F}static toNarrowWidePattern(e){let t=e.length,s=0,n;do{let i=2147483647;for(let x of e)x<i&&x>s&&(i=x);s=i,n=0;let o=0,d=0;for(let x=0;x<t;x++){let m=e[x];m>s&&(d|=1<<t-1-x,n++,o+=m)}if(n===3){for(let x=0;x<t&&n>0;x++){let m=e[x];if(m>s&&(n--,m*2>=o))return-1}return d}}while(n>3);return-1}static patternToChar(e){for(let t=0;t<ft.CHARACTER_ENCODINGS.length;t++)if(ft.CHARACTER_ENCODINGS[t]===e)return ft.ALPHABET_STRING.charAt(t);if(e===ft.ASTERISK_ENCODING)return"*";throw new F}static decodeExtended(e){let t=e.length,s="";for(let n=0;n<t;n++){let i=e.charAt(n);if(i==="+"||i==="$"||i==="%"||i==="/"){let o=e.charAt(n+1),d="\0";switch(i){case"+":if(o>="A"&&o<="Z")d=String.fromCharCode(o.charCodeAt(0)+32);else throw new Q;break;case"$":if(o>="A"&&o<="Z")d=String.fromCharCode(o.charCodeAt(0)-64);else throw new Q;break;case"%":if(o>="A"&&o<="E")d=String.fromCharCode(o.charCodeAt(0)-38);else if(o>="F"&&o<="J")d=String.fromCharCode(o.charCodeAt(0)-11);else if(o>="K"&&o<="O")d=String.fromCharCode(o.charCodeAt(0)+16);else if(o>="P"&&o<="T")d=String.fromCharCode(o.charCodeAt(0)+43);else if(o==="U")d="\0";else if(o==="V")d="@";else if(o==="W")d="`";else if(o==="X"||o==="Y"||o==="Z")d="";else throw new Q;break;case"/":if(o>="A"&&o<="O")d=String.fromCharCode(o.charCodeAt(0)-32);else if(o==="Z")d=":";else throw new Q;break}s+=d,n++}else s+=i}return s}}ft.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",ft.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],ft.ASTERISK_ENCODING=148;class Ve extends ct{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(e,t,s){let n=this.decodeStart(t),i=this.decodeEnd(t),o=new q;Ve.decodeMiddle(t,n[1],i[0],o);let d=o.toString(),x=null;s!=null&&(x=s.get(ce.ALLOWED_LENGTHS)),x==null&&(x=Ve.DEFAULT_ALLOWED_LENGTHS);let m=d.length,b=!1,E=0;for(let R of x){if(m===R){b=!0;break}R>E&&(E=R)}if(!b&&m>E&&(b=!0),!b)throw new Q;const A=[new me(n[1],e),new me(i[0],e)];return new oe(d,null,0,A,ae.ITF,new Date().getTime())}static decodeMiddle(e,t,s,n){let i=new Int32Array(10),o=new Int32Array(5),d=new Int32Array(5);for(i.fill(0),o.fill(0),d.fill(0);t<s;){ct.recordPattern(e,t,i);for(let m=0;m<5;m++){let b=2*m;o[m]=i[b],d[m]=i[b+1]}let x=Ve.decodeDigit(o);n.append(x.toString()),x=this.decodeDigit(d),n.append(x.toString()),i.forEach(function(m){t+=m})}}decodeStart(e){let t=Ve.skipWhiteSpace(e),s=Ve.findGuardPattern(e,t,Ve.START_PATTERN);return this.narrowLineWidth=(s[1]-s[0])/4,this.validateQuietZone(e,s[0]),s}validateQuietZone(e,t){let s=this.narrowLineWidth*10;s=s<t?s:t;for(let n=t-1;s>0&&n>=0&&!e.get(n);n--)s--;if(s!==0)throw new F}static skipWhiteSpace(e){const t=e.getSize(),s=e.getNextSet(0);if(s===t)throw new F;return s}decodeEnd(e){e.reverse();try{let t=Ve.skipWhiteSpace(e),s;try{s=Ve.findGuardPattern(e,t,Ve.END_PATTERN_REVERSED[0])}catch(i){i instanceof F&&(s=Ve.findGuardPattern(e,t,Ve.END_PATTERN_REVERSED[1]))}this.validateQuietZone(e,s[0]);let n=s[0];return s[0]=e.getSize()-s[1],s[1]=e.getSize()-n,s}finally{e.reverse()}}static findGuardPattern(e,t,s){let n=s.length,i=new Int32Array(n),o=e.getSize(),d=!1,x=0,m=t;i.fill(0);for(let b=t;b<o;b++)if(e.get(b)!==d)i[x]++;else{if(x===n-1){if(ct.patternMatchVariance(i,s,Ve.MAX_INDIVIDUAL_VARIANCE)<Ve.MAX_AVG_VARIANCE)return[m,b];m+=i[0]+i[1],D.arraycopy(i,2,i,0,x-1),i[x-1]=0,i[x]=0,x--}else x++;i[x]=1,d=!d}throw new F}static decodeDigit(e){let t=Ve.MAX_AVG_VARIANCE,s=-1,n=Ve.PATTERNS.length;for(let i=0;i<n;i++){let o=Ve.PATTERNS[i],d=ct.patternMatchVariance(e,o,Ve.MAX_INDIVIDUAL_VARIANCE);d<t?(t=d,s=i):d===t&&(s=-1)}if(s>=0)return s%10;throw new F}}Ve.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Ve.MAX_AVG_VARIANCE=.38,Ve.MAX_INDIVIDUAL_VARIANCE=.5,Ve.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Ve.START_PATTERN=Int32Array.from([1,1,1,1]),Ve.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class nt extends ct{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(e){let t=!1,s,n=0,i=Int32Array.from([0,0,0]);for(;!t;){i=Int32Array.from([0,0,0]),s=nt.findGuardPattern(e,n,!1,this.START_END_PATTERN,i);let o=s[0];n=s[1];let d=o-(n-o);d>=0&&(t=e.isRange(d,o,!1))}return s}static checkChecksum(e){return nt.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(t===0)return!1;let s=parseInt(e.charAt(t-1),10);return nt.getStandardUPCEANChecksum(e.substring(0,t-1))===s}static getStandardUPCEANChecksum(e){let t=e.length,s=0;for(let n=t-1;n>=0;n-=2){let i=e.charAt(n).charCodeAt(0)-48;if(i<0||i>9)throw new Q;s+=i}s*=3;for(let n=t-2;n>=0;n-=2){let i=e.charAt(n).charCodeAt(0)-48;if(i<0||i>9)throw new Q;s+=i}return(1e3-s)%10}static decodeEnd(e,t){return nt.findGuardPattern(e,t,!1,nt.START_END_PATTERN,new Int32Array(nt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(e,t,s,n){return this.findGuardPattern(e,t,s,n,new Int32Array(n.length))}static findGuardPattern(e,t,s,n,i){let o=e.getSize();t=s?e.getNextUnset(t):e.getNextSet(t);let d=0,x=t,m=n.length,b=s;for(let E=t;E<o;E++)if(e.get(E)!==b)i[d]++;else{if(d===m-1){if(ct.patternMatchVariance(i,n,nt.MAX_INDIVIDUAL_VARIANCE)<nt.MAX_AVG_VARIANCE)return Int32Array.from([x,E]);x+=i[0]+i[1];let A=i.slice(2,i.length-1);for(let k=0;k<d-1;k++)i[k]=A[k];i[d-1]=0,i[d]=0,d--}else d++;i[d]=1,b=!b}throw new F}static decodeDigit(e,t,s,n){this.recordPattern(e,s,t);let i=this.MAX_AVG_VARIANCE,o=-1,d=n.length;for(let x=0;x<d;x++){let m=n[x],b=ct.patternMatchVariance(t,m,nt.MAX_INDIVIDUAL_VARIANCE);b<i&&(i=b,o=x)}if(o>=0)return o;throw new F}}nt.MAX_AVG_VARIANCE=.48,nt.MAX_INDIVIDUAL_VARIANCE=.7,nt.START_END_PATTERN=Int32Array.from([1,1,1]),nt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),nt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),nt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class zr{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,s){let n=this.decodeRowStringBuffer,i=this.decodeMiddle(t,s,n),o=n.toString(),d=zr.parseExtensionString(o),x=[new me((s[0]+s[1])/2,e),new me(i,e)],m=new oe(o,null,0,x,ae.UPC_EAN_EXTENSION,new Date().getTime());return d!=null&&m.putAllMetadata(d),m}decodeMiddle(e,t,s){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=e.getSize(),o=t[1],d=0;for(let m=0;m<5&&o<i;m++){let b=nt.decodeDigit(e,n,o,nt.L_AND_G_PATTERNS);s+=String.fromCharCode(48+b%10);for(let E of n)o+=E;b>=10&&(d|=1<<4-m),m!==4&&(o=e.getNextSet(o),o=e.getNextUnset(o))}if(s.length!==5)throw new F;let x=this.determineCheckDigit(d);if(zr.extensionChecksum(s.toString())!==x)throw new F;return o}static extensionChecksum(e){let t=e.length,s=0;for(let n=t-2;n>=0;n-=2)s+=e.charAt(n).charCodeAt(0)-48;s*=3;for(let n=t-1;n>=0;n-=2)s+=e.charAt(n).charCodeAt(0)-48;return s*=3,s%10}determineCheckDigit(e){for(let t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new F}static parseExtensionString(e){if(e.length!==5)return null;let t=zr.parseExtension5String(e);return t==null?null:new Map([[Ie.SUGGESTED_PRICE,t]])}static parseExtension5String(e){let t;switch(e.charAt(0)){case"0":t="";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t="";break}let s=parseInt(e.substring(1)),n=(s/100).toString(),i=s%100,o=i<10?"0"+i:i.toString();return t+n+"."+o}}class Ir{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,s){let n=this.decodeRowStringBuffer,i=this.decodeMiddle(t,s,n),o=n.toString(),d=Ir.parseExtensionString(o),x=[new me((s[0]+s[1])/2,e),new me(i,e)],m=new oe(o,null,0,x,ae.UPC_EAN_EXTENSION,new Date().getTime());return d!=null&&m.putAllMetadata(d),m}decodeMiddle(e,t,s){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=e.getSize(),o=t[1],d=0;for(let x=0;x<2&&o<i;x++){let m=nt.decodeDigit(e,n,o,nt.L_AND_G_PATTERNS);s+=String.fromCharCode(48+m%10);for(let b of n)o+=b;m>=10&&(d|=1<<1-x),x!==1&&(o=e.getNextSet(o),o=e.getNextUnset(o))}if(s.length!==2)throw new F;if(parseInt(s.toString())%4!==d)throw new F;return o}static parseExtensionString(e){return e.length!==2?null:new Map([[Ie.ISSUE_NUMBER,parseInt(e)]])}}class wn{static decodeRow(e,t,s){let n=nt.findGuardPattern(t,s,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new zr().decodeRow(e,t,n)}catch{return new Ir().decodeRow(e,t,n)}}}wn.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Le extends nt{constructor(){super(),this.decodeRowStringBuffer="",Le.L_AND_G_PATTERNS=Le.L_PATTERNS.map(e=>Int32Array.from(e));for(let e=10;e<20;e++){let t=Le.L_PATTERNS[e-10],s=new Int32Array(t.length);for(let n=0;n<t.length;n++)s[n]=t[t.length-n-1];Le.L_AND_G_PATTERNS[e]=s}}decodeRow(e,t,s){let n=Le.findStartGuardPattern(t),i=s==null?null:s.get(ce.NEED_RESULT_POINT_CALLBACK);if(i!=null){const ee=new me((n[0]+n[1])/2,e);i.foundPossibleResultPoint(ee)}let o=this.decodeMiddle(t,n,this.decodeRowStringBuffer),d=o.rowOffset,x=o.resultString;if(i!=null){const ee=new me(d,e);i.foundPossibleResultPoint(ee)}let m=this.decodeEnd(t,d);if(i!=null){const ee=new me((m[0]+m[1])/2,e);i.foundPossibleResultPoint(ee)}let b=m[1],E=b+(b-m[0]);if(E>=t.getSize()||!t.isRange(b,E,!1))throw new F;let A=x.toString();if(A.length<8)throw new Q;if(!Le.checkChecksum(A))throw new _;let k=(n[1]+n[0])/2,R=(m[1]+m[0])/2,B=this.getBarcodeFormat(),U=[new me(k,e),new me(R,e)],W=new oe(A,null,0,U,B,new Date().getTime()),re=0;try{let ee=wn.decodeRow(e,t,m[1]);W.putMetadata(Ie.UPC_EAN_EXTENSION,ee.getText()),W.putAllMetadata(ee.getResultMetadata()),W.addResultPoints(ee.getResultPoints()),re=ee.getText().length}catch{}let se=s==null?null:s.get(ce.ALLOWED_EAN_EXTENSIONS);if(se!=null){let ee=!1;for(let Oe in se)if(re.toString()===Oe){ee=!0;break}if(!ee)throw new F}return W}decodeEnd(e,t){return Le.findGuardPattern(e,t,!1,Le.START_END_PATTERN,new Int32Array(Le.START_END_PATTERN.length).fill(0))}static checkChecksum(e){return Le.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(t===0)return!1;let s=parseInt(e.charAt(t-1),10);return Le.getStandardUPCEANChecksum(e.substring(0,t-1))===s}static getStandardUPCEANChecksum(e){let t=e.length,s=0;for(let n=t-1;n>=0;n-=2){let i=e.charAt(n).charCodeAt(0)-48;if(i<0||i>9)throw new Q;s+=i}s*=3;for(let n=t-2;n>=0;n-=2){let i=e.charAt(n).charCodeAt(0)-48;if(i<0||i>9)throw new Q;s+=i}return(1e3-s)%10}}class wr extends Le{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,s){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=e.getSize(),o=t[1],d=0;for(let m=0;m<6&&o<i;m++){let b=Le.decodeDigit(e,n,o,Le.L_AND_G_PATTERNS);s+=String.fromCharCode(48+b%10);for(let E of n)o+=E;b>=10&&(d|=1<<5-m)}s=wr.determineFirstDigit(s,d),o=Le.findGuardPattern(e,o,!0,Le.MIDDLE_PATTERN,new Int32Array(Le.MIDDLE_PATTERN.length).fill(0))[1];for(let m=0;m<6&&o<i;m++){let b=Le.decodeDigit(e,n,o,Le.L_PATTERNS);s+=String.fromCharCode(48+b);for(let E of n)o+=E}return{rowOffset:o,resultString:s}}getBarcodeFormat(){return ae.EAN_13}static determineFirstDigit(e,t){for(let s=0;s<10;s++)if(t===this.FIRST_DIGIT_ENCODINGS[s])return e=String.fromCharCode(48+s)+e,e;throw new F}}wr.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class pe extends Le{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,s){const n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=e.getSize(),o=t[1];for(let x=0;x<4&&o<i;x++){let m=Le.decodeDigit(e,n,o,Le.L_PATTERNS);s+=String.fromCharCode(48+m);for(let b of n)o+=b}o=Le.findGuardPattern(e,o,!0,Le.MIDDLE_PATTERN,new Int32Array(Le.MIDDLE_PATTERN.length).fill(0))[1];for(let x=0;x<4&&o<i;x++){let m=Le.decodeDigit(e,n,o,Le.L_PATTERNS);s+=String.fromCharCode(48+m);for(let b of n)o+=b}return{rowOffset:o,resultString:s}}getBarcodeFormat(){return ae.EAN_8}}class Ae extends Le{constructor(){super(...arguments),this.ean13Reader=new wr}getBarcodeFormat(){return ae.UPC_A}decode(e,t){return this.maybeReturnResult(this.ean13Reader.decode(e))}decodeRow(e,t,s){return this.maybeReturnResult(this.ean13Reader.decodeRow(e,t,s))}decodeMiddle(e,t,s){return this.ean13Reader.decodeMiddle(e,t,s)}maybeReturnResult(e){let t=e.getText();if(t.charAt(0)==="0"){let s=new oe(t.substring(1),null,null,e.getResultPoints(),ae.UPC_A);return e.getResultMetadata()!=null&&s.putAllMetadata(e.getResultMetadata()),s}else throw new F}reset(){this.ean13Reader.reset()}}class Se extends Le{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(e,t,s){const n=this.decodeMiddleCounters.map(m=>m);n[0]=0,n[1]=0,n[2]=0,n[3]=0;const i=e.getSize();let o=t[1],d=0;for(let m=0;m<6&&o<i;m++){const b=Se.decodeDigit(e,n,o,Se.L_AND_G_PATTERNS);s+=String.fromCharCode(48+b%10);for(let E of n)o+=E;b>=10&&(d|=1<<5-m)}let x=Se.determineNumSysAndCheckDigit(s,d);return{rowOffset:o,resultString:x}}decodeEnd(e,t){return Se.findGuardPatternWithoutCounters(e,t,!0,Se.MIDDLE_END_PATTERN)}checkChecksum(e){return Le.checkChecksum(Se.convertUPCEtoUPCA(e))}static determineNumSysAndCheckDigit(e,t){for(let s=0;s<=1;s++)for(let n=0;n<10;n++)if(t===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[s][n]){let i=String.fromCharCode(48+s),o=String.fromCharCode(48+n);return i+e+o}throw F.getNotFoundInstance()}getBarcodeFormat(){return ae.UPC_E}static convertUPCEtoUPCA(e){const t=e.slice(1,7).split("").map(i=>i.charCodeAt(0)),s=new q;s.append(e.charAt(0));let n=t[5];switch(n){case 0:case 1:case 2:s.appendChars(t,0,2),s.append(n),s.append("0000"),s.appendChars(t,2,3);break;case 3:s.appendChars(t,0,3),s.append("00000"),s.appendChars(t,3,2);break;case 4:s.appendChars(t,0,4),s.append("00000"),s.append(t[4]);break;default:s.appendChars(t,0,5),s.append("0000"),s.append(n);break}return e.length>=8&&s.append(e.charAt(7)),s.toString()}}Se.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Se.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Fe extends ct{constructor(e){super();let t=e==null?null:e.get(ce.POSSIBLE_FORMATS),s=[];u(t)?(s.push(new wr),s.push(new Ae),s.push(new pe),s.push(new Se)):(t.indexOf(ae.EAN_13)>-1&&s.push(new wr),t.indexOf(ae.UPC_A)>-1&&s.push(new Ae),t.indexOf(ae.EAN_8)>-1&&s.push(new pe),t.indexOf(ae.UPC_E)>-1&&s.push(new Se)),this.readers=s}decodeRow(e,t,s){for(let n of this.readers)try{const i=n.decodeRow(e,t,s),o=i.getBarcodeFormat()===ae.EAN_13&&i.getText().charAt(0)==="0",d=s==null?null:s.get(ce.POSSIBLE_FORMATS),x=d==null||d.includes(ae.UPC_A);if(o&&x){const m=i.getRawBytes(),b=new oe(i.getText().substring(1),m,m?m.length:null,i.getResultPoints(),ae.UPC_A);return b.putAllMetadata(i.getResultMetadata()),b}return i}catch{}throw new F}reset(){for(let e of this.readers)e.reset()}}class We extends ct{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(e,t){for(let s=0;s<t.length;s++)if(ct.patternMatchVariance(e,t[s],We.MAX_INDIVIDUAL_VARIANCE)<We.MAX_AVG_VARIANCE)return s;throw new F}static count(e){return De.sum(new Int32Array(e))}static increment(e,t){let s=0,n=t[0];for(let i=1;i<e.length;i++)t[i]>n&&(n=t[i],s=i);e[s]++}static decrement(e,t){let s=0,n=t[0];for(let i=1;i<e.length;i++)t[i]<n&&(n=t[i],s=i);e[s]--}static isFinderPattern(e){let t=e[0]+e[1],s=t+e[2]+e[3],n=t/s;if(n>=We.MIN_FINDER_PATTERN_RATIO&&n<=We.MAX_FINDER_PATTERN_RATIO){let i=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER;for(let d of e)d>o&&(o=d),d<i&&(i=d);return o<10*i}return!1}}We.MAX_AVG_VARIANCE=.2,We.MAX_INDIVIDUAL_VARIANCE=.45,We.MIN_FINDER_PATTERN_RATIO=9.5/12,We.MAX_FINDER_PATTERN_RATIO=12.5/14;class Mt{constructor(e,t){this.value=e,this.checksumPortion=t}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(e){if(!(e instanceof Mt))return!1;const t=e;return this.value===t.value&&this.checksumPortion===t.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class rr{constructor(e,t,s,n,i){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new me(s,i)),this.resultPoints.push(new me(n,i))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(e){if(!(e instanceof rr))return!1;const t=e;return this.value===t.value}hashCode(){return this.value}}class _t{constructor(){}static getRSSvalue(e,t,s){let n=0;for(let x of e)n+=x;let i=0,o=0,d=e.length;for(let x=0;x<d-1;x++){let m;for(m=1,o|=1<<x;m<e[x];m++,o&=~(1<<x)){let b=_t.combins(n-m-1,d-x-2);if(s&&o===0&&n-m-(d-x-1)>=d-x-1&&(b-=_t.combins(n-m-(d-x),d-x-2)),d-x-1>1){let E=0;for(let A=n-m-(d-x-2);A>t;A--)E+=_t.combins(n-m-A-1,d-x-3);b-=E*(d-1-x)}else n-m>t&&b--;i+=b}n-=m}return i}static combins(e,t){let s,n;e-t>t?(n=t,s=e-t):(n=e-t,s=t);let i=1,o=1;for(let d=e;d>s;d--)i*=d,o<=n&&(i/=o,o++);for(;o<=n;)i/=o,o++;return i}}class Wr{static buildBitArray(e){let t=e.length*2-1;e[e.length-1].getRightChar()==null&&(t-=1);let s=12*t,n=new z(s),i=0,d=e[0].getRightChar().getValue();for(let x=11;x>=0;--x)d&1<<x&&n.set(i),i++;for(let x=1;x<e.length;++x){let m=e[x],b=m.getLeftChar().getValue();for(let E=11;E>=0;--E)b&1<<E&&n.set(i),i++;if(m.getRightChar()!=null){let E=m.getRightChar().getValue();for(let A=11;A>=0;--A)E&1<<A&&n.set(i),i++}}return n}}class Ht{constructor(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Yr{constructor(e){this.newPosition=e}getNewPosition(){return this.newPosition}}class St extends Yr{constructor(e,t){super(e),this.value=t}getValue(){return this.value}isFNC1(){return this.value===St.FNC1}}St.FNC1="$";class tt extends Yr{constructor(e,t,s){super(e),s?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=t}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Je extends Yr{constructor(e,t,s){if(super(e),t<0||t>10||s<0||s>10)throw new Q;this.firstDigit=t,this.secondDigit=s}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Je.FNC1}isSecondDigitFNC1(){return this.secondDigit===Je.FNC1}isAnyFNC1(){return this.firstDigit===Je.FNC1||this.secondDigit===Je.FNC1}}Je.FNC1=10;class ne{constructor(){}static parseFieldsInGeneralPurpose(e){if(!e)return null;if(e.length<2)throw new F;let t=e.substring(0,2);for(let i of ne.TWO_DIGIT_DATA_LENGTH)if(i[0]===t)return i[1]===ne.VARIABLE_LENGTH?ne.processVariableAI(2,i[2],e):ne.processFixedAI(2,i[1],e);if(e.length<3)throw new F;let s=e.substring(0,3);for(let i of ne.THREE_DIGIT_DATA_LENGTH)if(i[0]===s)return i[1]===ne.VARIABLE_LENGTH?ne.processVariableAI(3,i[2],e):ne.processFixedAI(3,i[1],e);for(let i of ne.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(i[0]===s)return i[1]===ne.VARIABLE_LENGTH?ne.processVariableAI(4,i[2],e):ne.processFixedAI(4,i[1],e);if(e.length<4)throw new F;let n=e.substring(0,4);for(let i of ne.FOUR_DIGIT_DATA_LENGTH)if(i[0]===n)return i[1]===ne.VARIABLE_LENGTH?ne.processVariableAI(4,i[2],e):ne.processFixedAI(4,i[1],e);throw new F}static processFixedAI(e,t,s){if(s.length<e)throw new F;let n=s.substring(0,e);if(s.length<e+t)throw new F;let i=s.substring(e,e+t),o=s.substring(e+t),d="("+n+")"+i,x=ne.parseFieldsInGeneralPurpose(o);return x==null?d:d+x}static processVariableAI(e,t,s){let n=s.substring(0,e),i;s.length<e+t?i=s.length:i=e+t;let o=s.substring(e,i),d=s.substring(i),x="("+n+")"+o,m=ne.parseFieldsInGeneralPurpose(d);return m==null?x:x+m}}ne.VARIABLE_LENGTH=[],ne.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",ne.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",ne.VARIABLE_LENGTH,20],["22",ne.VARIABLE_LENGTH,29],["30",ne.VARIABLE_LENGTH,8],["37",ne.VARIABLE_LENGTH,8],["90",ne.VARIABLE_LENGTH,30],["91",ne.VARIABLE_LENGTH,30],["92",ne.VARIABLE_LENGTH,30],["93",ne.VARIABLE_LENGTH,30],["94",ne.VARIABLE_LENGTH,30],["95",ne.VARIABLE_LENGTH,30],["96",ne.VARIABLE_LENGTH,30],["97",ne.VARIABLE_LENGTH,3],["98",ne.VARIABLE_LENGTH,30],["99",ne.VARIABLE_LENGTH,30]],ne.THREE_DIGIT_DATA_LENGTH=[["240",ne.VARIABLE_LENGTH,30],["241",ne.VARIABLE_LENGTH,30],["242",ne.VARIABLE_LENGTH,6],["250",ne.VARIABLE_LENGTH,30],["251",ne.VARIABLE_LENGTH,30],["253",ne.VARIABLE_LENGTH,17],["254",ne.VARIABLE_LENGTH,20],["400",ne.VARIABLE_LENGTH,30],["401",ne.VARIABLE_LENGTH,30],["402",17],["403",ne.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",ne.VARIABLE_LENGTH,20],["421",ne.VARIABLE_LENGTH,15],["422",3],["423",ne.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],ne.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",ne.VARIABLE_LENGTH,15],["391",ne.VARIABLE_LENGTH,18],["392",ne.VARIABLE_LENGTH,15],["393",ne.VARIABLE_LENGTH,18],["703",ne.VARIABLE_LENGTH,30]],ne.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",ne.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",ne.VARIABLE_LENGTH,20],["8003",ne.VARIABLE_LENGTH,30],["8004",ne.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",ne.VARIABLE_LENGTH,30],["8008",ne.VARIABLE_LENGTH,12],["8018",18],["8020",ne.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",ne.VARIABLE_LENGTH,70],["8200",ne.VARIABLE_LENGTH,70]];class kt{constructor(e){this.buffer=new q,this.information=e}decodeAllCodes(e,t){let s=t,n=null;do{let i=this.decodeGeneralPurposeField(s,n),o=ne.parseFieldsInGeneralPurpose(i.getNewString());if(o!=null&&e.append(o),i.isRemaining()?n=""+i.getRemainingValue():n=null,s===i.getNewPosition())break;s=i.getNewPosition()}while(!0);return e.toString()}isStillNumeric(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(let t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)}decodeNumeric(e){if(e+7>this.information.getSize()){let i=this.extractNumericValueFromBitArray(e,4);return i===0?new Je(this.information.getSize(),Je.FNC1,Je.FNC1):new Je(this.information.getSize(),i-1,Je.FNC1)}let t=this.extractNumericValueFromBitArray(e,7),s=(t-8)/11,n=(t-8)%11;return new Je(e+7,s,n)}extractNumericValueFromBitArray(e,t){return kt.extractNumericValueFromBitArray(this.information,e,t)}static extractNumericValueFromBitArray(e,t,s){let n=0;for(let i=0;i<s;++i)e.get(t+i)&&(n|=1<<s-i-1);return n}decodeGeneralPurposeField(e,t){this.buffer.setLengthToZero(),t!=null&&this.buffer.append(t),this.current.setPosition(e);let s=this.parseBlocks();return s!=null&&s.isRemaining()?new tt(this.current.getPosition(),this.buffer.toString(),s.getRemainingValue()):new tt(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let e,t;do{let s=this.current.getPosition();if(this.current.isAlpha()?(t=this.parseAlphaBlock(),e=t.isFinished()):this.current.isIsoIec646()?(t=this.parseIsoIec646Block(),e=t.isFinished()):(t=this.parseNumericBlock(),e=t.isFinished()),!(s!==this.current.getPosition())&&!e)break}while(!e);return t.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){let t;return e.isSecondDigitFNC1()?t=new tt(this.current.getPosition(),this.buffer.toString()):t=new tt(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new Ht(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){let t=new tt(this.current.getPosition(),this.buffer.toString());return new Ht(!0,t)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Ht(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let t=new tt(this.current.getPosition(),this.buffer.toString());return new Ht(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Ht(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let t=new tt(this.current.getPosition(),this.buffer.toString());return new Ht(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Ht(!1)}isStillIsoIec646(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;let s=this.extractNumericValueFromBitArray(e,7);if(s>=64&&s<116)return!0;if(e+8>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,8);return n>=232&&n<253}decodeIsoIec646(e){let t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new St(e+5,St.FNC1);if(t>=5&&t<15)return new St(e+5,"0"+(t-5));let s=this.extractNumericValueFromBitArray(e,7);if(s>=64&&s<90)return new St(e+7,""+(s+1));if(s>=90&&s<116)return new St(e+7,""+(s+7));let n=this.extractNumericValueFromBitArray(e,8),i;switch(n){case 232:i="!";break;case 233:i='"';break;case 234:i="%";break;case 235:i="&";break;case 236:i="'";break;case 237:i="(";break;case 238:i=")";break;case 239:i="*";break;case 240:i="+";break;case 241:i=",";break;case 242:i="-";break;case 243:i=".";break;case 244:i="/";break;case 245:i=":";break;case 246:i=";";break;case 247:i="<";break;case 248:i="=";break;case 249:i=">";break;case 250:i="?";break;case 251:i="_";break;case 252:i=" ";break;default:throw new Q}return new St(e+8,i)}isStillAlpha(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;let s=this.extractNumericValueFromBitArray(e,6);return s>=16&&s<63}decodeAlphanumeric(e){let t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new St(e+5,St.FNC1);if(t>=5&&t<15)return new St(e+5,"0"+(t-5));let s=this.extractNumericValueFromBitArray(e,6);if(s>=32&&s<58)return new St(e+6,""+(s+33));let n;switch(s){case 58:n="*";break;case 59:n=",";break;case 60:n="-";break;case 61:n=".";break;case 62:n="/";break;default:throw new Xe("Decoding invalid alphanumeric value: "+s)}return new St(e+6,n)}isAlphaTo646ToAlphaLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<5&&t+e<this.information.getSize();++t)if(t===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0}isAlphaOr646ToNumericLatch(e){if(e+3>this.information.getSize())return!1;for(let t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0}isNumericToAlphaNumericLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0}}class sr{constructor(e){this.information=e,this.generalDecoder=new kt(e)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class pt extends sr{constructor(e){super(e)}encodeCompressedGtin(e,t){e.append("(01)");let s=e.length();e.append("9"),this.encodeCompressedGtinWithoutAI(e,t,s)}encodeCompressedGtinWithoutAI(e,t,s){for(let n=0;n<4;++n){let i=this.getGeneralDecoder().extractNumericValueFromBitArray(t+10*n,10);i/100===0&&e.append("0"),i/10===0&&e.append("0"),e.append(i)}pt.appendCheckDigit(e,s)}static appendCheckDigit(e,t){let s=0;for(let n=0;n<13;n++){let i=e.charAt(n+t).charCodeAt(0)-48;s+=n&1?i:3*i}s=10-s%10,s===10&&(s=0),e.append(s)}}pt.GTIN_SIZE=40;class Rt extends pt{constructor(e){super(e)}parseInformation(){let e=new q;e.append("(01)");let t=e.length(),s=this.getGeneralDecoder().extractNumericValueFromBitArray(Rt.HEADER_SIZE,4);return e.append(s),this.encodeCompressedGtinWithoutAI(e,Rt.HEADER_SIZE+4,t),this.getGeneralDecoder().decodeAllCodes(e,Rt.HEADER_SIZE+44)}}Rt.HEADER_SIZE=4;class nr extends sr{constructor(e){super(e)}parseInformation(){let e=new q;return this.getGeneralDecoder().decodeAllCodes(e,nr.HEADER_SIZE)}}nr.HEADER_SIZE=5;class ur extends pt{constructor(e){super(e)}encodeCompressedWeight(e,t,s){let n=this.getGeneralDecoder().extractNumericValueFromBitArray(t,s);this.addWeightCode(e,n);let i=this.checkWeight(n),o=1e5;for(let d=0;d<5;++d)i/o===0&&e.append("0"),o/=10;e.append(i)}}class Dt extends ur{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()!=Dt.HEADER_SIZE+ur.GTIN_SIZE+Dt.WEIGHT_SIZE)throw new F;let e=new q;return this.encodeCompressedGtin(e,Dt.HEADER_SIZE),this.encodeCompressedWeight(e,Dt.HEADER_SIZE+ur.GTIN_SIZE,Dt.WEIGHT_SIZE),e.toString()}}Dt.HEADER_SIZE=5,Dt.WEIGHT_SIZE=15;class vr extends Dt{constructor(e){super(e)}addWeightCode(e,t){e.append("(3103)")}checkWeight(e){return e}}class ws extends Dt{constructor(e){super(e)}addWeightCode(e,t){t<1e4?e.append("(3202)"):e.append("(3203)")}checkWeight(e){return e<1e4?e:e-1e4}}class hr extends pt{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<hr.HEADER_SIZE+pt.GTIN_SIZE)throw new F;let e=new q;this.encodeCompressedGtin(e,hr.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(hr.HEADER_SIZE+pt.GTIN_SIZE,hr.LAST_DIGIT_SIZE);e.append("(392"),e.append(t),e.append(")");let s=this.getGeneralDecoder().decodeGeneralPurposeField(hr.HEADER_SIZE+pt.GTIN_SIZE+hr.LAST_DIGIT_SIZE,null);return e.append(s.getNewString()),e.toString()}}hr.HEADER_SIZE=8,hr.LAST_DIGIT_SIZE=2;class Lt extends pt{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<Lt.HEADER_SIZE+pt.GTIN_SIZE)throw new F;let e=new q;this.encodeCompressedGtin(e,Lt.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(Lt.HEADER_SIZE+pt.GTIN_SIZE,Lt.LAST_DIGIT_SIZE);e.append("(393"),e.append(t),e.append(")");let s=this.getGeneralDecoder().extractNumericValueFromBitArray(Lt.HEADER_SIZE+pt.GTIN_SIZE+Lt.LAST_DIGIT_SIZE,Lt.FIRST_THREE_DIGITS_SIZE);s/100==0&&e.append("0"),s/10==0&&e.append("0"),e.append(s);let n=this.getGeneralDecoder().decodeGeneralPurposeField(Lt.HEADER_SIZE+pt.GTIN_SIZE+Lt.LAST_DIGIT_SIZE+Lt.FIRST_THREE_DIGITS_SIZE,null);return e.append(n.getNewString()),e.toString()}}Lt.HEADER_SIZE=8,Lt.LAST_DIGIT_SIZE=2,Lt.FIRST_THREE_DIGITS_SIZE=10;class it extends ur{constructor(e,t,s){super(e),this.dateCode=s,this.firstAIdigits=t}parseInformation(){if(this.getInformation().getSize()!=it.HEADER_SIZE+it.GTIN_SIZE+it.WEIGHT_SIZE+it.DATE_SIZE)throw new F;let e=new q;return this.encodeCompressedGtin(e,it.HEADER_SIZE),this.encodeCompressedWeight(e,it.HEADER_SIZE+it.GTIN_SIZE,it.WEIGHT_SIZE),this.encodeCompressedDate(e,it.HEADER_SIZE+it.GTIN_SIZE+it.WEIGHT_SIZE),e.toString()}encodeCompressedDate(e,t){let s=this.getGeneralDecoder().extractNumericValueFromBitArray(t,it.DATE_SIZE);if(s==38400)return;e.append("("),e.append(this.dateCode),e.append(")");let n=s%32;s/=32;let i=s%12+1;s/=12;let o=s;o/10==0&&e.append("0"),e.append(o),i/10==0&&e.append("0"),e.append(i),n/10==0&&e.append("0"),e.append(n)}addWeightCode(e,t){e.append("("),e.append(this.firstAIdigits),e.append(t/1e5),e.append(")")}checkWeight(e){return e%1e5}}it.HEADER_SIZE=8,it.WEIGHT_SIZE=20,it.DATE_SIZE=16;function yi(C){try{if(C.get(1))return new Rt(C);if(!C.get(2))return new nr(C);switch(kt.extractNumericValueFromBitArray(C,1,4)){case 4:return new vr(C);case 5:return new ws(C)}switch(kt.extractNumericValueFromBitArray(C,1,5)){case 12:return new hr(C);case 13:return new Lt(C)}switch(kt.extractNumericValueFromBitArray(C,1,7)){case 56:return new it(C,"310","11");case 57:return new it(C,"320","11");case 58:return new it(C,"310","13");case 59:return new it(C,"320","13");case 60:return new it(C,"310","15");case 61:return new it(C,"320","15");case 62:return new it(C,"310","17");case 63:return new it(C,"320","17")}}catch(e){throw console.log(e),new Xe("unknown decoder: "+C)}}class _r{constructor(e,t,s,n){this.leftchar=e,this.rightchar=t,this.finderpattern=s,this.maybeLast=n}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(e,t){return e instanceof _r?_r.equalsOrNull(e.leftchar,t.leftchar)&&_r.equalsOrNull(e.rightchar,t.rightchar)&&_r.equalsOrNull(e.finderpattern,t.finderpattern):!1}static equalsOrNull(e,t){return e===null?t===null:_r.equals(e,t)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class vn{constructor(e,t,s){this.pairs=e,this.rowNumber=t,this.wasReversed=s}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(e){return this.checkEqualitity(this,e)}toString(){return"{ "+this.pairs+" }"}equals(e,t){return e instanceof vn?this.checkEqualitity(e,t)&&e.wasReversed===t.wasReversed:!1}checkEqualitity(e,t){if(!e||!t)return;let s;return e.forEach((n,i)=>{t.forEach(o=>{n.getLeftChar().getValue()===o.getLeftChar().getValue()&&n.getRightChar().getValue()===o.getRightChar().getValue()&&n.getFinderPatter().getValue()===o.getFinderPatter().getValue()&&(s=!0)})}),s}}class $ extends We{constructor(e){super(...arguments),this.pairs=new Array($.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=e===!0}decodeRow(e,t,s){this.pairs.length=0,this.startFromEven=!1;try{return $.constructResult(this.decodeRow2pairs(e,t))}catch(n){this.verbose&&console.log(n)}return this.pairs.length=0,this.startFromEven=!0,$.constructResult(this.decodeRow2pairs(e,t))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(e,t){let s=!1;for(;!s;)try{this.pairs.push(this.retrieveNextPair(t,this.pairs,e))}catch(i){if(i instanceof F){if(!this.pairs.length)throw new F;s=!0}}if(this.checkChecksum())return this.pairs;let n;if(this.rows.length?n=!0:n=!1,this.storeRow(e,!1),n){let i=this.checkRowsBoolean(!1);if(i!=null||(i=this.checkRowsBoolean(!0),i!=null))return i}throw new F}checkRowsBoolean(e){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,e&&(this.rows=this.rows.reverse());let t=null;try{t=this.checkRows(new Array,0)}catch(s){this.verbose&&console.log(s)}return e&&(this.rows=this.rows.reverse()),t}checkRows(e,t){for(let s=t;s<this.rows.length;s++){let n=this.rows[s];this.pairs.length=0;for(let o of e)this.pairs.push(o.getPairs());if(this.pairs.push(n.getPairs()),!$.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let i=new Array(e);i.push(n);try{return this.checkRows(i,s+1)}catch(o){this.verbose&&console.log(o)}}throw new F}static isValidSequence(e){for(let t of $.FINDER_PATTERN_SEQUENCES){if(e.length>t.length)continue;let s=!0;for(let n=0;n<e.length;n++)if(e[n].getFinderPattern().getValue()!=t[n]){s=!1;break}if(s)return!0}return!1}storeRow(e,t){let s=0,n=!1,i=!1;for(;s<this.rows.length;){let o=this.rows[s];if(o.getRowNumber()>e){i=o.isEquivalent(this.pairs);break}n=o.isEquivalent(this.pairs),s++}i||n||$.isPartialRow(this.pairs,this.rows)||(this.rows.push(s,new vn(this.pairs,e,t)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(e,t){for(let s of t)if(s.getPairs().length!==e.length){for(let n of s.getPairs())for(let i of e)if(_r.equals(n,i))break}}static isPartialRow(e,t){for(let s of t){let n=!0;for(let i of e){let o=!1;for(let d of s.getPairs())if(i.equals(d)){o=!0;break}if(!o){n=!1;break}}if(n)return!0}return!1}getRows(){return this.rows}static constructResult(e){let t=Wr.buildBitArray(e),n=yi(t).parseInformation(),i=e[0].getFinderPattern().getResultPoints(),o=e[e.length-1].getFinderPattern().getResultPoints(),d=[i[0],i[1],o[0],o[1]];return new oe(n,null,null,d,ae.RSS_EXPANDED,null)}checkChecksum(){let e=this.pairs.get(0),t=e.getLeftChar(),s=e.getRightChar();if(s==null)return!1;let n=s.getChecksumPortion(),i=2;for(let d=1;d<this.pairs.size();++d){let x=this.pairs.get(d);n+=x.getLeftChar().getChecksumPortion(),i++;let m=x.getRightChar();m!=null&&(n+=m.getChecksumPortion(),i++)}return n%=211,211*(i-4)+n==t.getValue()}static getNextSecondBar(e,t){let s;return e.get(t)?(s=e.getNextUnset(t),s=e.getNextSet(s)):(s=e.getNextSet(t),s=e.getNextUnset(s)),s}retrieveNextPair(e,t,s){let n=t.length%2==0;this.startFromEven&&(n=!n);let i,o=!0,d=-1;do this.findNextPair(e,t,d),i=this.parseFoundFinderPattern(e,s,n),i==null?d=$.getNextSecondBar(e,this.startEnd[0]):o=!1;while(o);let x=this.decodeDataCharacter(e,i,n,!0);if(!this.isEmptyPair(t)&&t[t.length-1].mustBeLast())throw new F;let m;try{m=this.decodeDataCharacter(e,i,n,!1)}catch(b){m=null,this.verbose&&console.log(b)}return new _r(x,m,i,!0)}isEmptyPair(e){return e.length===0}findNextPair(e,t,s){let n=this.getDecodeFinderCounters();n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=e.getSize(),o;s>=0?o=s:this.isEmptyPair(t)?o=0:o=t[t.length-1].getFinderPattern().getStartEnd()[1];let d=t.length%2!=0;this.startFromEven&&(d=!d);let x=!1;for(;o<i&&(x=!e.get(o),!!x);)o++;let m=0,b=o;for(let E=o;E<i;E++)if(e.get(E)!=x)n[m]++;else{if(m==3){if(d&&$.reverseCounters(n),$.isFinderPattern(n)){this.startEnd[0]=b,this.startEnd[1]=E;return}d&&$.reverseCounters(n),b+=n[0]+n[1],n[0]=n[2],n[1]=n[3],n[2]=0,n[3]=0,m--}else m++;n[m]=1,x=!x}throw new F}static reverseCounters(e){let t=e.length;for(let s=0;s<t/2;++s){let n=e[s];e[s]=e[t-s-1],e[t-s-1]=n}}parseFoundFinderPattern(e,t,s){let n,i,o;if(s){let m=this.startEnd[0]-1;for(;m>=0&&!e.get(m);)m--;m++,n=this.startEnd[0]-m,i=m,o=this.startEnd[1]}else i=this.startEnd[0],o=e.getNextUnset(this.startEnd[1]+1),n=o-this.startEnd[1];let d=this.getDecodeFinderCounters();D.arraycopy(d,0,d,1,d.length-1),d[0]=n;let x;try{x=this.parseFinderValue(d,$.FINDER_PATTERNS)}catch{return null}return new rr(x,[i,o],i,o,t)}decodeDataCharacter(e,t,s,n){let i=this.getDataCharacterCounters();for(let $e=0;$e<i.length;$e++)i[$e]=0;if(n)$.recordPatternInReverse(e,t.getStartEnd()[0],i);else{$.recordPattern(e,t.getStartEnd()[1],i);for(let $e=0,It=i.length-1;$e<It;$e++,It--){let Gt=i[$e];i[$e]=i[It],i[It]=Gt}}let o=17,d=De.sum(new Int32Array(i))/o,x=(t.getStartEnd()[1]-t.getStartEnd()[0])/15;if(Math.abs(d-x)/x>.3)throw new F;let m=this.getOddCounts(),b=this.getEvenCounts(),E=this.getOddRoundingErrors(),A=this.getEvenRoundingErrors();for(let $e=0;$e<i.length;$e++){let It=1*i[$e]/d,Gt=It+.5;if(Gt<1){if(It<.3)throw new F;Gt=1}else if(Gt>8){if(It>8.7)throw new F;Gt=8}let as=$e/2;$e&1?(b[as]=Gt,A[as]=It-Gt):(m[as]=Gt,E[as]=It-Gt)}this.adjustOddEvenCounts(o);let k=4*t.getValue()+(s?0:2)+(n?0:1)-1,R=0,B=0;for(let $e=m.length-1;$e>=0;$e--){if($.isNotA1left(t,s,n)){let It=$.WEIGHTS[k][2*$e];B+=m[$e]*It}R+=m[$e]}let U=0;for(let $e=b.length-1;$e>=0;$e--)if($.isNotA1left(t,s,n)){let It=$.WEIGHTS[k][2*$e+1];U+=b[$e]*It}let W=B+U;if(R&1||R>13||R<4)throw new F;let re=(13-R)/2,se=$.SYMBOL_WIDEST[re],ee=9-se,Oe=_t.getRSSvalue(m,se,!0),je=_t.getRSSvalue(b,ee,!1),Ft=$.EVEN_TOTAL_SUBSET[re],ir=$.GSUM[re],Ut=Oe*Ft+je+ir;return new Mt(Ut,W)}static isNotA1left(e,t,s){return!(e.getValue()==0&&t&&s)}adjustOddEvenCounts(e){let t=De.sum(new Int32Array(this.getOddCounts())),s=De.sum(new Int32Array(this.getEvenCounts())),n=!1,i=!1;t>13?i=!0:t<4&&(n=!0);let o=!1,d=!1;s>13?d=!0:s<4&&(o=!0);let x=t+s-e,m=(t&1)==1,b=(s&1)==0;if(x==1)if(m){if(b)throw new F;i=!0}else{if(!b)throw new F;d=!0}else if(x==-1)if(m){if(b)throw new F;n=!0}else{if(!b)throw new F;o=!0}else if(x==0){if(m){if(!b)throw new F;t<s?(n=!0,d=!0):(i=!0,o=!0)}else if(b)throw new F}else throw new F;if(n){if(i)throw new F;$.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(i&&$.decrement(this.getOddCounts(),this.getOddRoundingErrors()),o){if(d)throw new F;$.increment(this.getEvenCounts(),this.getOddRoundingErrors())}d&&$.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}$.SYMBOL_WIDEST=[7,5,4,3,1],$.EVEN_TOTAL_SUBSET=[4,20,52,104,204],$.GSUM=[0,348,1388,2948,3988],$.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],$.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],$.FINDER_PAT_A=0,$.FINDER_PAT_B=1,$.FINDER_PAT_C=2,$.FINDER_PAT_D=3,$.FINDER_PAT_E=4,$.FINDER_PAT_F=5,$.FINDER_PATTERN_SEQUENCES=[[$.FINDER_PAT_A,$.FINDER_PAT_A],[$.FINDER_PAT_A,$.FINDER_PAT_B,$.FINDER_PAT_B],[$.FINDER_PAT_A,$.FINDER_PAT_C,$.FINDER_PAT_B,$.FINDER_PAT_D],[$.FINDER_PAT_A,$.FINDER_PAT_E,$.FINDER_PAT_B,$.FINDER_PAT_D,$.FINDER_PAT_C],[$.FINDER_PAT_A,$.FINDER_PAT_E,$.FINDER_PAT_B,$.FINDER_PAT_D,$.FINDER_PAT_D,$.FINDER_PAT_F],[$.FINDER_PAT_A,$.FINDER_PAT_E,$.FINDER_PAT_B,$.FINDER_PAT_D,$.FINDER_PAT_E,$.FINDER_PAT_F,$.FINDER_PAT_F],[$.FINDER_PAT_A,$.FINDER_PAT_A,$.FINDER_PAT_B,$.FINDER_PAT_B,$.FINDER_PAT_C,$.FINDER_PAT_C,$.FINDER_PAT_D,$.FINDER_PAT_D],[$.FINDER_PAT_A,$.FINDER_PAT_A,$.FINDER_PAT_B,$.FINDER_PAT_B,$.FINDER_PAT_C,$.FINDER_PAT_C,$.FINDER_PAT_D,$.FINDER_PAT_E,$.FINDER_PAT_E],[$.FINDER_PAT_A,$.FINDER_PAT_A,$.FINDER_PAT_B,$.FINDER_PAT_B,$.FINDER_PAT_C,$.FINDER_PAT_C,$.FINDER_PAT_D,$.FINDER_PAT_E,$.FINDER_PAT_F,$.FINDER_PAT_F],[$.FINDER_PAT_A,$.FINDER_PAT_A,$.FINDER_PAT_B,$.FINDER_PAT_B,$.FINDER_PAT_C,$.FINDER_PAT_D,$.FINDER_PAT_D,$.FINDER_PAT_E,$.FINDER_PAT_E,$.FINDER_PAT_F,$.FINDER_PAT_F]],$.MAX_PAIRS=11;class wo extends Mt{constructor(e,t,s){super(e,t),this.count=0,this.finderPattern=s}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class dt extends We{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(e,t,s){const n=this.decodePair(t,!1,e,s);dt.addOrTally(this.possibleLeftPairs,n),t.reverse();let i=this.decodePair(t,!0,e,s);dt.addOrTally(this.possibleRightPairs,i),t.reverse();for(let o of this.possibleLeftPairs)if(o.getCount()>1){for(let d of this.possibleRightPairs)if(d.getCount()>1&&dt.checkChecksum(o,d))return dt.constructResult(o,d)}throw new F}static addOrTally(e,t){if(t==null)return;let s=!1;for(let n of e)if(n.getValue()===t.getValue()){n.incrementCount(),s=!0;break}s||e.push(t)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(e,t){let s=4537077*e.getValue()+t.getValue(),n=new String(s).toString(),i=new q;for(let m=13-n.length;m>0;m--)i.append("0");i.append(n);let o=0;for(let m=0;m<13;m++){let b=i.charAt(m).charCodeAt(0)-48;o+=m&1?b:3*b}o=10-o%10,o===10&&(o=0),i.append(o.toString());let d=e.getFinderPattern().getResultPoints(),x=t.getFinderPattern().getResultPoints();return new oe(i.toString(),null,0,[d[0],d[1],x[0],x[1]],ae.RSS_14,new Date().getTime())}static checkChecksum(e,t){let s=(e.getChecksumPortion()+16*t.getChecksumPortion())%79,n=9*e.getFinderPattern().getValue()+t.getFinderPattern().getValue();return n>72&&n--,n>8&&n--,s===n}decodePair(e,t,s,n){try{let i=this.findFinderPattern(e,t),o=this.parseFoundFinderPattern(e,s,t,i),d=n==null?null:n.get(ce.NEED_RESULT_POINT_CALLBACK);if(d!=null){let b=(i[0]+i[1])/2;t&&(b=e.getSize()-1-b),d.foundPossibleResultPoint(new me(b,s))}let x=this.decodeDataCharacter(e,o,!0),m=this.decodeDataCharacter(e,o,!1);return new wo(1597*x.getValue()+m.getValue(),x.getChecksumPortion()+4*m.getChecksumPortion(),o)}catch{return null}}decodeDataCharacter(e,t,s){let n=this.getDataCharacterCounters();for(let U=0;U<n.length;U++)n[U]=0;if(s)ct.recordPatternInReverse(e,t.getStartEnd()[0],n);else{ct.recordPattern(e,t.getStartEnd()[1]+1,n);for(let U=0,W=n.length-1;U<W;U++,W--){let re=n[U];n[U]=n[W],n[W]=re}}let i=s?16:15,o=De.sum(new Int32Array(n))/i,d=this.getOddCounts(),x=this.getEvenCounts(),m=this.getOddRoundingErrors(),b=this.getEvenRoundingErrors();for(let U=0;U<n.length;U++){let W=n[U]/o,re=Math.floor(W+.5);re<1?re=1:re>8&&(re=8);let se=Math.floor(U/2);U&1?(x[se]=re,b[se]=W-re):(d[se]=re,m[se]=W-re)}this.adjustOddEvenCounts(s,i);let E=0,A=0;for(let U=d.length-1;U>=0;U--)A*=9,A+=d[U],E+=d[U];let k=0,R=0;for(let U=x.length-1;U>=0;U--)k*=9,k+=x[U],R+=x[U];let B=A+3*k;if(s){if(E&1||E>12||E<4)throw new F;let U=(12-E)/2,W=dt.OUTSIDE_ODD_WIDEST[U],re=9-W,se=_t.getRSSvalue(d,W,!1),ee=_t.getRSSvalue(x,re,!0),Oe=dt.OUTSIDE_EVEN_TOTAL_SUBSET[U],je=dt.OUTSIDE_GSUM[U];return new Mt(se*Oe+ee+je,B)}else{if(R&1||R>10||R<4)throw new F;let U=(10-R)/2,W=dt.INSIDE_ODD_WIDEST[U],re=9-W,se=_t.getRSSvalue(d,W,!0),ee=_t.getRSSvalue(x,re,!1),Oe=dt.INSIDE_ODD_TOTAL_SUBSET[U],je=dt.INSIDE_GSUM[U];return new Mt(ee*Oe+se+je,B)}}findFinderPattern(e,t){let s=this.getDecodeFinderCounters();s[0]=0,s[1]=0,s[2]=0,s[3]=0;let n=e.getSize(),i=!1,o=0;for(;o<n&&(i=!e.get(o),t!==i);)o++;let d=0,x=o;for(let m=o;m<n;m++)if(e.get(m)!==i)s[d]++;else{if(d===3){if(We.isFinderPattern(s))return[x,m];x+=s[0]+s[1],s[0]=s[2],s[1]=s[3],s[2]=0,s[3]=0,d--}else d++;s[d]=1,i=!i}throw new F}parseFoundFinderPattern(e,t,s,n){let i=e.get(n[0]),o=n[0]-1;for(;o>=0&&i!==e.get(o);)o--;o++;const d=n[0]-o,x=this.getDecodeFinderCounters(),m=new Int32Array(x.length);D.arraycopy(x,0,m,1,x.length-1),m[0]=d;const b=this.parseFinderValue(m,dt.FINDER_PATTERNS);let E=o,A=n[1];return s&&(E=e.getSize()-1-E,A=e.getSize()-1-A),new rr(b,[o,n[1]],E,A,t)}adjustOddEvenCounts(e,t){let s=De.sum(new Int32Array(this.getOddCounts())),n=De.sum(new Int32Array(this.getEvenCounts())),i=!1,o=!1,d=!1,x=!1;e?(s>12?o=!0:s<4&&(i=!0),n>12?x=!0:n<4&&(d=!0)):(s>11?o=!0:s<5&&(i=!0),n>10?x=!0:n<4&&(d=!0));let m=s+n-t,b=(s&1)===(e?1:0),E=(n&1)===1;if(m===1)if(b){if(E)throw new F;o=!0}else{if(!E)throw new F;x=!0}else if(m===-1)if(b){if(E)throw new F;i=!0}else{if(!E)throw new F;d=!0}else if(m===0){if(b){if(!E)throw new F;s<n?(i=!0,x=!0):(o=!0,d=!0)}else if(E)throw new F}else throw new F;if(i){if(o)throw new F;We.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&We.decrement(this.getOddCounts(),this.getOddRoundingErrors()),d){if(x)throw new F;We.increment(this.getEvenCounts(),this.getOddRoundingErrors())}x&&We.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}dt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],dt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],dt.OUTSIDE_GSUM=[0,161,961,2015,2715],dt.INSIDE_GSUM=[0,336,1036,1516],dt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],dt.INSIDE_ODD_WIDEST=[2,4,6,8],dt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class rs extends ct{constructor(e,t){super(),this.readers=[],this.verbose=t===!0;const s=e?e.get(ce.POSSIBLE_FORMATS):null,n=e&&e.get(ce.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;s?((s.includes(ae.EAN_13)||s.includes(ae.UPC_A)||s.includes(ae.EAN_8)||s.includes(ae.UPC_E))&&this.readers.push(new Fe(e)),s.includes(ae.CODE_39)&&this.readers.push(new ft(n)),s.includes(ae.CODE_128)&&this.readers.push(new le),s.includes(ae.ITF)&&this.readers.push(new Ve),s.includes(ae.RSS_14)&&this.readers.push(new dt),s.includes(ae.RSS_EXPANDED)&&this.readers.push(new $(this.verbose))):(this.readers.push(new Fe(e)),this.readers.push(new ft),this.readers.push(new Fe(e)),this.readers.push(new le),this.readers.push(new Ve),this.readers.push(new dt),this.readers.push(new $(this.verbose)))}decodeRow(e,t,s){for(let n=0;n<this.readers.length;n++)try{return this.readers[n].decodeRow(e,t,s)}catch{}throw new F}reset(){this.readers.forEach(e=>e.reset())}}class vo extends ie{constructor(e=500,t){super(new rs(t),e,t)}}class He{constructor(e,t,s){this.ecCodewords=e,this.ecBlocks=[t],s&&this.ecBlocks.push(s)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class Ue{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Me{constructor(e,t,s,n,i,o){this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=s,this.dataRegionSizeRows=n,this.dataRegionSizeColumns=i,this.ecBlocks=o;let d=0;const x=o.getECCodewords(),m=o.getECBlocks();for(let b of m)d+=b.getCount()*(b.getDataCodewords()+x);this.totalCodewords=d}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(e,t){if(e&1||t&1)throw new Q;for(let s of Me.VERSIONS)if(s.symbolSizeRows===e&&s.symbolSizeColumns===t)return s;throw new Q}toString(){return""+this.versionNumber}static buildVersions(){return[new Me(1,10,10,8,8,new He(5,new Ue(1,3))),new Me(2,12,12,10,10,new He(7,new Ue(1,5))),new Me(3,14,14,12,12,new He(10,new Ue(1,8))),new Me(4,16,16,14,14,new He(12,new Ue(1,12))),new Me(5,18,18,16,16,new He(14,new Ue(1,18))),new Me(6,20,20,18,18,new He(18,new Ue(1,22))),new Me(7,22,22,20,20,new He(20,new Ue(1,30))),new Me(8,24,24,22,22,new He(24,new Ue(1,36))),new Me(9,26,26,24,24,new He(28,new Ue(1,44))),new Me(10,32,32,14,14,new He(36,new Ue(1,62))),new Me(11,36,36,16,16,new He(42,new Ue(1,86))),new Me(12,40,40,18,18,new He(48,new Ue(1,114))),new Me(13,44,44,20,20,new He(56,new Ue(1,144))),new Me(14,48,48,22,22,new He(68,new Ue(1,174))),new Me(15,52,52,24,24,new He(42,new Ue(2,102))),new Me(16,64,64,14,14,new He(56,new Ue(2,140))),new Me(17,72,72,16,16,new He(36,new Ue(4,92))),new Me(18,80,80,18,18,new He(48,new Ue(4,114))),new Me(19,88,88,20,20,new He(56,new Ue(4,144))),new Me(20,96,96,22,22,new He(68,new Ue(4,174))),new Me(21,104,104,24,24,new He(56,new Ue(6,136))),new Me(22,120,120,18,18,new He(68,new Ue(6,175))),new Me(23,132,132,20,20,new He(62,new Ue(8,163))),new Me(24,144,144,22,22,new He(62,new Ue(8,156),new Ue(2,155))),new Me(25,8,18,6,16,new He(7,new Ue(1,5))),new Me(26,8,32,6,14,new He(11,new Ue(1,10))),new Me(27,12,26,10,24,new He(14,new Ue(1,16))),new Me(28,12,36,10,16,new He(18,new Ue(1,22))),new Me(29,16,36,14,16,new He(24,new Ue(1,32))),new Me(30,16,48,14,22,new He(28,new Ue(1,49)))]}}Me.VERSIONS=Me.buildVersions();class Nn{constructor(e){const t=e.getHeight();if(t<8||t>144||t&1)throw new Q;this.version=Nn.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new he(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(e){const t=e.getHeight(),s=e.getWidth();return Me.getVersionForDimensions(t,s)}readCodewords(){const e=new Int8Array(this.version.getTotalCodewords());let t=0,s=4,n=0;const i=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth();let d=!1,x=!1,m=!1,b=!1;do if(s===i&&n===0&&!d)e[t++]=this.readCorner1(i,o)&255,s-=2,n+=2,d=!0;else if(s===i-2&&n===0&&o&3&&!x)e[t++]=this.readCorner2(i,o)&255,s-=2,n+=2,x=!0;else if(s===i+4&&n===2&&!(o&7)&&!m)e[t++]=this.readCorner3(i,o)&255,s-=2,n+=2,m=!0;else if(s===i-2&&n===0&&(o&7)===4&&!b)e[t++]=this.readCorner4(i,o)&255,s-=2,n+=2,b=!0;else{do s<i&&n>=0&&!this.readMappingMatrix.get(n,s)&&(e[t++]=this.readUtah(s,n,i,o)&255),s-=2,n+=2;while(s>=0&&n<o);s+=1,n+=3;do s>=0&&n<o&&!this.readMappingMatrix.get(n,s)&&(e[t++]=this.readUtah(s,n,i,o)&255),s+=2,n-=2;while(s<i&&n>=0);s+=3,n+=1}while(s<i||n<o);if(t!==this.version.getTotalCodewords())throw new Q;return e}readModule(e,t,s,n){return e<0&&(e+=s,t+=4-(s+4&7)),t<0&&(t+=n,e+=4-(n+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)}readUtah(e,t,s,n){let i=0;return this.readModule(e-2,t-2,s,n)&&(i|=1),i<<=1,this.readModule(e-2,t-1,s,n)&&(i|=1),i<<=1,this.readModule(e-1,t-2,s,n)&&(i|=1),i<<=1,this.readModule(e-1,t-1,s,n)&&(i|=1),i<<=1,this.readModule(e-1,t,s,n)&&(i|=1),i<<=1,this.readModule(e,t-2,s,n)&&(i|=1),i<<=1,this.readModule(e,t-1,s,n)&&(i|=1),i<<=1,this.readModule(e,t,s,n)&&(i|=1),i}readCorner1(e,t){let s=0;return this.readModule(e-1,0,e,t)&&(s|=1),s<<=1,this.readModule(e-1,1,e,t)&&(s|=1),s<<=1,this.readModule(e-1,2,e,t)&&(s|=1),s<<=1,this.readModule(0,t-2,e,t)&&(s|=1),s<<=1,this.readModule(0,t-1,e,t)&&(s|=1),s<<=1,this.readModule(1,t-1,e,t)&&(s|=1),s<<=1,this.readModule(2,t-1,e,t)&&(s|=1),s<<=1,this.readModule(3,t-1,e,t)&&(s|=1),s}readCorner2(e,t){let s=0;return this.readModule(e-3,0,e,t)&&(s|=1),s<<=1,this.readModule(e-2,0,e,t)&&(s|=1),s<<=1,this.readModule(e-1,0,e,t)&&(s|=1),s<<=1,this.readModule(0,t-4,e,t)&&(s|=1),s<<=1,this.readModule(0,t-3,e,t)&&(s|=1),s<<=1,this.readModule(0,t-2,e,t)&&(s|=1),s<<=1,this.readModule(0,t-1,e,t)&&(s|=1),s<<=1,this.readModule(1,t-1,e,t)&&(s|=1),s}readCorner3(e,t){let s=0;return this.readModule(e-1,0,e,t)&&(s|=1),s<<=1,this.readModule(e-1,t-1,e,t)&&(s|=1),s<<=1,this.readModule(0,t-3,e,t)&&(s|=1),s<<=1,this.readModule(0,t-2,e,t)&&(s|=1),s<<=1,this.readModule(0,t-1,e,t)&&(s|=1),s<<=1,this.readModule(1,t-3,e,t)&&(s|=1),s<<=1,this.readModule(1,t-2,e,t)&&(s|=1),s<<=1,this.readModule(1,t-1,e,t)&&(s|=1),s}readCorner4(e,t){let s=0;return this.readModule(e-3,0,e,t)&&(s|=1),s<<=1,this.readModule(e-2,0,e,t)&&(s|=1),s<<=1,this.readModule(e-1,0,e,t)&&(s|=1),s<<=1,this.readModule(0,t-2,e,t)&&(s|=1),s<<=1,this.readModule(0,t-1,e,t)&&(s|=1),s<<=1,this.readModule(1,t-1,e,t)&&(s|=1),s<<=1,this.readModule(2,t-1,e,t)&&(s|=1),s<<=1,this.readModule(3,t-1,e,t)&&(s|=1),s}extractDataRegion(e){const t=this.version.getSymbolSizeRows(),s=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new N("Dimension of bitMatrix must match the version size");const n=this.version.getDataRegionSizeRows(),i=this.version.getDataRegionSizeColumns(),o=t/n|0,d=s/i|0,x=o*n,m=d*i,b=new he(m,x);for(let E=0;E<o;++E){const A=E*n;for(let k=0;k<d;++k){const R=k*i;for(let B=0;B<n;++B){const U=E*(n+2)+1+B,W=A+B;for(let re=0;re<i;++re){const se=k*(i+2)+1+re;if(e.get(se,U)){const ee=R+re;b.set(ee,W)}}}}}return b}}class Cn{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t){const s=t.getECBlocks();let n=0;const i=s.getECBlocks();for(let B of i)n+=B.getCount();const o=new Array(n);let d=0;for(let B of i)for(let U=0;U<B.getCount();U++){const W=B.getDataCodewords(),re=s.getECCodewords()+W;o[d++]=new Cn(W,new Uint8Array(re))}const m=o[0].codewords.length-s.getECCodewords(),b=m-1;let E=0;for(let B=0;B<b;B++)for(let U=0;U<d;U++)o[U].codewords[B]=e[E++];const A=t.getVersionNumber()===24,k=A?8:d;for(let B=0;B<k;B++)o[B].codewords[m-1]=e[E++];const R=o[0].codewords.length;for(let B=m;B<R;B++)for(let U=0;U<d;U++){const W=A?(U+8)%d:U,re=A&&W>7?B-1:B;o[W].codewords[re]=e[E++]}if(E!==e.length)throw new N;return o}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class En{constructor(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(e){if(e<1||e>32||e>this.available())throw new N(""+e);let t=0,s=this.bitOffset,n=this.byteOffset;const i=this.bytes;if(s>0){const o=8-s,d=e<o?e:o,x=o-d,m=255>>8-d<<x;t=(i[n]&m)>>x,e-=d,s+=d,s===8&&(s=0,n++)}if(e>0){for(;e>=8;)t=t<<8|i[n]&255,n++,e-=8;if(e>0){const o=8-e,d=255>>o<<o;t=t<<e|(i[n]&d)>>o,s+=e}}return this.bitOffset=s,this.byteOffset=n,t}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var wt;(function(C){C[C.PAD_ENCODE=0]="PAD_ENCODE",C[C.ASCII_ENCODE=1]="ASCII_ENCODE",C[C.C40_ENCODE=2]="C40_ENCODE",C[C.TEXT_ENCODE=3]="TEXT_ENCODE",C[C.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",C[C.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",C[C.BASE256_ENCODE=6]="BASE256_ENCODE"})(wt||(wt={}));class kr{static decode(e){const t=new En(e),s=new q,n=new q,i=new Array;let o=wt.ASCII_ENCODE;do if(o===wt.ASCII_ENCODE)o=this.decodeAsciiSegment(t,s,n);else{switch(o){case wt.C40_ENCODE:this.decodeC40Segment(t,s);break;case wt.TEXT_ENCODE:this.decodeTextSegment(t,s);break;case wt.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,s);break;case wt.EDIFACT_ENCODE:this.decodeEdifactSegment(t,s);break;case wt.BASE256_ENCODE:this.decodeBase256Segment(t,s,i);break;default:throw new Q}o=wt.ASCII_ENCODE}while(o!==wt.PAD_ENCODE&&t.available()>0);return n.length()>0&&s.append(n.toString()),new we(e,s.toString(),i.length===0?null:i,null)}static decodeAsciiSegment(e,t,s){let n=!1;do{let i=e.readBits(8);if(i===0)throw new Q;if(i<=128)return n&&(i+=128),t.append(String.fromCharCode(i-1)),wt.ASCII_ENCODE;if(i===129)return wt.PAD_ENCODE;if(i<=229){const o=i-130;o<10&&t.append("0"),t.append(""+o)}else switch(i){case 230:return wt.C40_ENCODE;case 231:return wt.BASE256_ENCODE;case 232:t.append("");break;case 233:case 234:break;case 235:n=!0;break;case 236:t.append("[)>05"),s.insert(0,"");break;case 237:t.append("[)>06"),s.insert(0,"");break;case 238:return wt.ANSIX12_ENCODE;case 239:return wt.TEXT_ENCODE;case 240:return wt.EDIFACT_ENCODE;case 241:break;default:if(i!==254||e.available()!==0)throw new Q;break}}while(e.available()>0);return wt.ASCII_ENCODE}static decodeC40Segment(e,t){let s=!1;const n=[];let i=0;do{if(e.available()===8)return;const o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),n);for(let d=0;d<3;d++){const x=n[d];switch(i){case 0:if(x<3)i=x+1;else if(x<this.C40_BASIC_SET_CHARS.length){const m=this.C40_BASIC_SET_CHARS[x];s?(t.append(String.fromCharCode(m.charCodeAt(0)+128)),s=!1):t.append(m)}else throw new Q;break;case 1:s?(t.append(String.fromCharCode(x+128)),s=!1):t.append(String.fromCharCode(x)),i=0;break;case 2:if(x<this.C40_SHIFT2_SET_CHARS.length){const m=this.C40_SHIFT2_SET_CHARS[x];s?(t.append(String.fromCharCode(m.charCodeAt(0)+128)),s=!1):t.append(m)}else switch(x){case 27:t.append("");break;case 30:s=!0;break;default:throw new Q}i=0;break;case 3:s?(t.append(String.fromCharCode(x+224)),s=!1):t.append(String.fromCharCode(x+96)),i=0;break;default:throw new Q}}}while(e.available()>0)}static decodeTextSegment(e,t){let s=!1,n=[],i=0;do{if(e.available()===8)return;const o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),n);for(let d=0;d<3;d++){const x=n[d];switch(i){case 0:if(x<3)i=x+1;else if(x<this.TEXT_BASIC_SET_CHARS.length){const m=this.TEXT_BASIC_SET_CHARS[x];s?(t.append(String.fromCharCode(m.charCodeAt(0)+128)),s=!1):t.append(m)}else throw new Q;break;case 1:s?(t.append(String.fromCharCode(x+128)),s=!1):t.append(String.fromCharCode(x)),i=0;break;case 2:if(x<this.TEXT_SHIFT2_SET_CHARS.length){const m=this.TEXT_SHIFT2_SET_CHARS[x];s?(t.append(String.fromCharCode(m.charCodeAt(0)+128)),s=!1):t.append(m)}else switch(x){case 27:t.append("");break;case 30:s=!0;break;default:throw new Q}i=0;break;case 3:if(x<this.TEXT_SHIFT3_SET_CHARS.length){const m=this.TEXT_SHIFT3_SET_CHARS[x];s?(t.append(String.fromCharCode(m.charCodeAt(0)+128)),s=!1):t.append(m),i=0}else throw new Q;break;default:throw new Q}}}while(e.available()>0)}static decodeAnsiX12Segment(e,t){const s=[];do{if(e.available()===8)return;const n=e.readBits(8);if(n===254)return;this.parseTwoBytes(n,e.readBits(8),s);for(let i=0;i<3;i++){const o=s[i];switch(o){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(o<14)t.append(String.fromCharCode(o+44));else if(o<40)t.append(String.fromCharCode(o+51));else throw new Q;break}}}while(e.available()>0)}static parseTwoBytes(e,t,s){let n=(e<<8)+t-1,i=Math.floor(n/1600);s[0]=i,n-=i*1600,i=Math.floor(n/40),s[1]=i,s[2]=n-i*40}static decodeEdifactSegment(e,t){do{if(e.available()<=16)return;for(let s=0;s<4;s++){let n=e.readBits(6);if(n===31){const i=8-e.getBitOffset();i!==8&&e.readBits(i);return}n&32||(n|=64),t.append(String.fromCharCode(n))}}while(e.available()>0)}static decodeBase256Segment(e,t,s){let n=1+e.getByteOffset();const i=this.unrandomize255State(e.readBits(8),n++);let o;if(i===0?o=e.available()/8|0:i<250?o=i:o=250*(i-249)+this.unrandomize255State(e.readBits(8),n++),o<0)throw new Q;const d=new Uint8Array(o);for(let x=0;x<o;x++){if(e.available()<8)throw new Q;d[x]=this.unrandomize255State(e.readBits(8),n++)}s.push(d);try{t.append(Z.decode(d,H.ISO88591))}catch(x){throw new Xe("Platform does not support required encoding: "+x.message)}}static unrandomize255State(e,t){const s=149*t%255+1,n=e-s;return n>=0?n:n+256}}kr.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],kr.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],kr.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],kr.TEXT_SHIFT2_SET_CHARS=kr.C40_SHIFT2_SET_CHARS,kr.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class No{constructor(){this.rsDecoder=new cr(ke.DATA_MATRIX_FIELD_256)}decode(e){const t=new Nn(e),s=t.getVersion(),n=t.readCodewords(),i=Cn.getDataBlocks(n,s);let o=0;for(let m of i)o+=m.getNumDataCodewords();const d=new Uint8Array(o),x=i.length;for(let m=0;m<x;m++){const b=i[m],E=b.getCodewords(),A=b.getNumDataCodewords();this.correctErrors(E,A);for(let k=0;k<A;k++)d[k*x+m]=E[k]}return kr.decode(d)}correctErrors(e,t){const s=new Int32Array(e);try{this.rsDecoder.decode(s,e.length-t)}catch{throw new _}for(let n=0;n<t;n++)e[n]=s[n]}}class xt{constructor(e){this.image=e,this.rectangleDetector=new tr(this.image)}detect(){const e=this.rectangleDetector.detect();let t=this.detectSolid1(e);if(t=this.detectSolid2(t),t[3]=this.correctTopRight(t),!t[3])throw new F;t=this.shiftToModuleCenter(t);const s=t[0],n=t[1],i=t[2],o=t[3];let d=this.transitionsBetween(s,o)+1,x=this.transitionsBetween(i,o)+1;(d&1)===1&&(d+=1),(x&1)===1&&(x+=1),4*d<7*x&&4*x<7*d&&(d=x=Math.max(d,x));let m=xt.sampleGrid(this.image,s,n,i,o,d,x);return new es(m,[s,n,i,o])}static shiftPoint(e,t,s){let n=(t.getX()-e.getX())/(s+1),i=(t.getY()-e.getY())/(s+1);return new me(e.getX()+n,e.getY()+i)}static moveAway(e,t,s){let n=e.getX(),i=e.getY();return n<t?n-=1:n+=1,i<s?i-=1:i+=1,new me(n,i)}detectSolid1(e){let t=e[0],s=e[1],n=e[3],i=e[2],o=this.transitionsBetween(t,s),d=this.transitionsBetween(s,n),x=this.transitionsBetween(n,i),m=this.transitionsBetween(i,t),b=o,E=[i,t,s,n];return b>d&&(b=d,E[0]=t,E[1]=s,E[2]=n,E[3]=i),b>x&&(b=x,E[0]=s,E[1]=n,E[2]=i,E[3]=t),b>m&&(E[0]=n,E[1]=i,E[2]=t,E[3]=s),E}detectSolid2(e){let t=e[0],s=e[1],n=e[2],i=e[3],o=this.transitionsBetween(t,i),d=xt.shiftPoint(s,n,(o+1)*4),x=xt.shiftPoint(n,s,(o+1)*4),m=this.transitionsBetween(d,t),b=this.transitionsBetween(x,i);return m<b?(e[0]=t,e[1]=s,e[2]=n,e[3]=i):(e[0]=s,e[1]=n,e[2]=i,e[3]=t),e}correctTopRight(e){let t=e[0],s=e[1],n=e[2],i=e[3],o=this.transitionsBetween(t,i),d=this.transitionsBetween(s,i),x=xt.shiftPoint(t,s,(d+1)*4),m=xt.shiftPoint(n,s,(o+1)*4);o=this.transitionsBetween(x,i),d=this.transitionsBetween(m,i);let b=new me(i.getX()+(n.getX()-s.getX())/(o+1),i.getY()+(n.getY()-s.getY())/(o+1)),E=new me(i.getX()+(t.getX()-s.getX())/(d+1),i.getY()+(t.getY()-s.getY())/(d+1));if(!this.isValid(b))return this.isValid(E)?E:null;if(!this.isValid(E))return b;let A=this.transitionsBetween(x,b)+this.transitionsBetween(m,b),k=this.transitionsBetween(x,E)+this.transitionsBetween(m,E);return A>k?b:E}shiftToModuleCenter(e){let t=e[0],s=e[1],n=e[2],i=e[3],o=this.transitionsBetween(t,i)+1,d=this.transitionsBetween(n,i)+1,x=xt.shiftPoint(t,s,d*4),m=xt.shiftPoint(n,s,o*4);o=this.transitionsBetween(x,i)+1,d=this.transitionsBetween(m,i)+1,(o&1)===1&&(o+=1),(d&1)===1&&(d+=1);let b=(t.getX()+s.getX()+n.getX()+i.getX())/4,E=(t.getY()+s.getY()+n.getY()+i.getY())/4;t=xt.moveAway(t,b,E),s=xt.moveAway(s,b,E),n=xt.moveAway(n,b,E),i=xt.moveAway(i,b,E);let A,k;return x=xt.shiftPoint(t,s,d*4),x=xt.shiftPoint(x,i,o*4),A=xt.shiftPoint(s,t,d*4),A=xt.shiftPoint(A,n,o*4),m=xt.shiftPoint(n,i,d*4),m=xt.shiftPoint(m,s,o*4),k=xt.shiftPoint(i,n,d*4),k=xt.shiftPoint(k,t,o*4),[x,A,m,k]}isValid(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()}static sampleGrid(e,t,s,n,i,o,d){return dr.getInstance().sampleGrid(e,o,d,.5,.5,o-.5,.5,o-.5,d-.5,.5,d-.5,t.getX(),t.getY(),i.getX(),i.getY(),n.getX(),n.getY(),s.getX(),s.getY())}transitionsBetween(e,t){let s=Math.trunc(e.getX()),n=Math.trunc(e.getY()),i=Math.trunc(t.getX()),o=Math.trunc(t.getY()),d=Math.abs(o-n)>Math.abs(i-s);if(d){let B=s;s=n,n=B,B=i,i=o,o=B}let x=Math.abs(i-s),m=Math.abs(o-n),b=-x/2,E=n<o?1:-1,A=s<i?1:-1,k=0,R=this.image.get(d?n:s,d?s:n);for(let B=s,U=n;B!==i;B+=A){let W=this.image.get(d?U:B,d?B:U);if(W!==R&&(k++,R=W),b+=m,b>0){if(U===o)break;U+=E,b-=x}}return k}}class Dr{constructor(){this.decoder=new No}decode(e,t=null){let s,n;if(t!=null&&t.has(ce.PURE_BARCODE)){const m=Dr.extractPureBits(e.getBlackMatrix());s=this.decoder.decode(m),n=Dr.NO_POINTS}else{const m=new xt(e.getBlackMatrix()).detect();s=this.decoder.decode(m.getBits()),n=m.getPoints()}const i=s.getRawBytes(),o=new oe(s.getText(),i,8*i.length,n,ae.DATA_MATRIX,D.currentTimeMillis()),d=s.getByteSegments();d!=null&&o.putMetadata(Ie.BYTE_SEGMENTS,d);const x=s.getECLevel();return x!=null&&o.putMetadata(Ie.ERROR_CORRECTION_LEVEL,x),o}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),s=e.getBottomRightOnBit();if(t==null||s==null)throw new F;const n=this.moduleSize(t,e);let i=t[1];const o=s[1];let d=t[0];const m=(s[0]-d+1)/n,b=(o-i+1)/n;if(m<=0||b<=0)throw new F;const E=n/2;i+=E,d+=E;const A=new he(m,b);for(let k=0;k<b;k++){const R=i+k*n;for(let B=0;B<m;B++)e.get(d+B*n,R)&&A.set(B,k)}return A}static moduleSize(e,t){const s=t.getWidth();let n=e[0];const i=e[1];for(;n<s&&t.get(n,i);)n++;if(n===s)throw new F;const o=n-e[0];if(o===0)throw new F;return o}}Dr.NO_POINTS=[];class Co extends ie{constructor(e=500){super(new Dr,e)}}var ss;(function(C){C[C.L=0]="L",C[C.M=1]="M",C[C.Q=2]="Q",C[C.H=3]="H"})(ss||(ss={}));class et{constructor(e,t,s){this.value=e,this.stringValue=t,this.bits=s,et.FOR_BITS.set(s,this),et.FOR_VALUE.set(e,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(e){switch(e){case"L":return et.L;case"M":return et.M;case"Q":return et.Q;case"H":return et.H;default:throw new w(e+"not available")}}toString(){return this.stringValue}equals(e){if(!(e instanceof et))return!1;const t=e;return this.value===t.value}static forBits(e){if(e<0||e>=et.FOR_BITS.size)throw new N;return et.FOR_BITS.get(e)}}et.FOR_BITS=new Map,et.FOR_VALUE=new Map,et.L=new et(ss.L,"L",1),et.M=new et(ss.M,"M",0),et.Q=new et(ss.Q,"Q",3),et.H=new et(ss.H,"H",2);class Ot{constructor(e){this.errorCorrectionLevel=et.forBits(e>>3&3),this.dataMask=e&7}static numBitsDiffering(e,t){return M.bitCount(e^t)}static decodeFormatInformation(e,t){const s=Ot.doDecodeFormatInformation(e,t);return s!==null?s:Ot.doDecodeFormatInformation(e^Ot.FORMAT_INFO_MASK_QR,t^Ot.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(e,t){let s=Number.MAX_SAFE_INTEGER,n=0;for(const i of Ot.FORMAT_INFO_DECODE_LOOKUP){const o=i[0];if(o===e||o===t)return new Ot(i[1]);let d=Ot.numBitsDiffering(e,o);d<s&&(n=i[1],s=d),e!==t&&(d=Ot.numBitsDiffering(t,o),d<s&&(n=i[1],s=d))}return s<=3?new Ot(n):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(e){if(!(e instanceof Ot))return!1;const t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask}}Ot.FORMAT_INFO_MASK_QR=21522,Ot.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class V{constructor(e,...t){this.ecCodewordsPerBlock=e,this.ecBlocks=t}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let e=0;const t=this.ecBlocks;for(const s of t)e+=s.getCount();return e}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class T{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class be{constructor(e,t,...s){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=s;let n=0;const i=s[0].getECCodewordsPerBlock(),o=s[0].getECBlocks();for(const d of o)n+=d.getCount()*(d.getDataCodewords()+i);this.totalCodewords=n}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(e){return this.ecBlocks[e.getValue()]}static getProvisionalVersionForDimension(e){if(e%4!==1)throw new Q;try{return this.getVersionForNumber((e-17)/4)}catch{throw new Q}}static getVersionForNumber(e){if(e<1||e>40)throw new N;return be.VERSIONS[e-1]}static decodeVersionInformation(e){let t=Number.MAX_SAFE_INTEGER,s=0;for(let n=0;n<be.VERSION_DECODE_INFO.length;n++){const i=be.VERSION_DECODE_INFO[n];if(i===e)return be.getVersionForNumber(n+7);const o=Ot.numBitsDiffering(e,i);o<t&&(s=n+7,t=o)}return t<=3?be.getVersionForNumber(s):null}buildFunctionPattern(){const e=this.getDimensionForVersion(),t=new he(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);const s=this.alignmentPatternCenters.length;for(let n=0;n<s;n++){const i=this.alignmentPatternCenters[n]-2;for(let o=0;o<s;o++)n===0&&(o===0||o===s-1)||n===s-1&&o===0||t.setRegion(this.alignmentPatternCenters[o]-2,i,5,5)}return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t}toString(){return""+this.versionNumber}}be.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),be.VERSIONS=[new be(1,new Int32Array(0),new V(7,new T(1,19)),new V(10,new T(1,16)),new V(13,new T(1,13)),new V(17,new T(1,9))),new be(2,Int32Array.from([6,18]),new V(10,new T(1,34)),new V(16,new T(1,28)),new V(22,new T(1,22)),new V(28,new T(1,16))),new be(3,Int32Array.from([6,22]),new V(15,new T(1,55)),new V(26,new T(1,44)),new V(18,new T(2,17)),new V(22,new T(2,13))),new be(4,Int32Array.from([6,26]),new V(20,new T(1,80)),new V(18,new T(2,32)),new V(26,new T(2,24)),new V(16,new T(4,9))),new be(5,Int32Array.from([6,30]),new V(26,new T(1,108)),new V(24,new T(2,43)),new V(18,new T(2,15),new T(2,16)),new V(22,new T(2,11),new T(2,12))),new be(6,Int32Array.from([6,34]),new V(18,new T(2,68)),new V(16,new T(4,27)),new V(24,new T(4,19)),new V(28,new T(4,15))),new be(7,Int32Array.from([6,22,38]),new V(20,new T(2,78)),new V(18,new T(4,31)),new V(18,new T(2,14),new T(4,15)),new V(26,new T(4,13),new T(1,14))),new be(8,Int32Array.from([6,24,42]),new V(24,new T(2,97)),new V(22,new T(2,38),new T(2,39)),new V(22,new T(4,18),new T(2,19)),new V(26,new T(4,14),new T(2,15))),new be(9,Int32Array.from([6,26,46]),new V(30,new T(2,116)),new V(22,new T(3,36),new T(2,37)),new V(20,new T(4,16),new T(4,17)),new V(24,new T(4,12),new T(4,13))),new be(10,Int32Array.from([6,28,50]),new V(18,new T(2,68),new T(2,69)),new V(26,new T(4,43),new T(1,44)),new V(24,new T(6,19),new T(2,20)),new V(28,new T(6,15),new T(2,16))),new be(11,Int32Array.from([6,30,54]),new V(20,new T(4,81)),new V(30,new T(1,50),new T(4,51)),new V(28,new T(4,22),new T(4,23)),new V(24,new T(3,12),new T(8,13))),new be(12,Int32Array.from([6,32,58]),new V(24,new T(2,92),new T(2,93)),new V(22,new T(6,36),new T(2,37)),new V(26,new T(4,20),new T(6,21)),new V(28,new T(7,14),new T(4,15))),new be(13,Int32Array.from([6,34,62]),new V(26,new T(4,107)),new V(22,new T(8,37),new T(1,38)),new V(24,new T(8,20),new T(4,21)),new V(22,new T(12,11),new T(4,12))),new be(14,Int32Array.from([6,26,46,66]),new V(30,new T(3,115),new T(1,116)),new V(24,new T(4,40),new T(5,41)),new V(20,new T(11,16),new T(5,17)),new V(24,new T(11,12),new T(5,13))),new be(15,Int32Array.from([6,26,48,70]),new V(22,new T(5,87),new T(1,88)),new V(24,new T(5,41),new T(5,42)),new V(30,new T(5,24),new T(7,25)),new V(24,new T(11,12),new T(7,13))),new be(16,Int32Array.from([6,26,50,74]),new V(24,new T(5,98),new T(1,99)),new V(28,new T(7,45),new T(3,46)),new V(24,new T(15,19),new T(2,20)),new V(30,new T(3,15),new T(13,16))),new be(17,Int32Array.from([6,30,54,78]),new V(28,new T(1,107),new T(5,108)),new V(28,new T(10,46),new T(1,47)),new V(28,new T(1,22),new T(15,23)),new V(28,new T(2,14),new T(17,15))),new be(18,Int32Array.from([6,30,56,82]),new V(30,new T(5,120),new T(1,121)),new V(26,new T(9,43),new T(4,44)),new V(28,new T(17,22),new T(1,23)),new V(28,new T(2,14),new T(19,15))),new be(19,Int32Array.from([6,30,58,86]),new V(28,new T(3,113),new T(4,114)),new V(26,new T(3,44),new T(11,45)),new V(26,new T(17,21),new T(4,22)),new V(26,new T(9,13),new T(16,14))),new be(20,Int32Array.from([6,34,62,90]),new V(28,new T(3,107),new T(5,108)),new V(26,new T(3,41),new T(13,42)),new V(30,new T(15,24),new T(5,25)),new V(28,new T(15,15),new T(10,16))),new be(21,Int32Array.from([6,28,50,72,94]),new V(28,new T(4,116),new T(4,117)),new V(26,new T(17,42)),new V(28,new T(17,22),new T(6,23)),new V(30,new T(19,16),new T(6,17))),new be(22,Int32Array.from([6,26,50,74,98]),new V(28,new T(2,111),new T(7,112)),new V(28,new T(17,46)),new V(30,new T(7,24),new T(16,25)),new V(24,new T(34,13))),new be(23,Int32Array.from([6,30,54,78,102]),new V(30,new T(4,121),new T(5,122)),new V(28,new T(4,47),new T(14,48)),new V(30,new T(11,24),new T(14,25)),new V(30,new T(16,15),new T(14,16))),new be(24,Int32Array.from([6,28,54,80,106]),new V(30,new T(6,117),new T(4,118)),new V(28,new T(6,45),new T(14,46)),new V(30,new T(11,24),new T(16,25)),new V(30,new T(30,16),new T(2,17))),new be(25,Int32Array.from([6,32,58,84,110]),new V(26,new T(8,106),new T(4,107)),new V(28,new T(8,47),new T(13,48)),new V(30,new T(7,24),new T(22,25)),new V(30,new T(22,15),new T(13,16))),new be(26,Int32Array.from([6,30,58,86,114]),new V(28,new T(10,114),new T(2,115)),new V(28,new T(19,46),new T(4,47)),new V(28,new T(28,22),new T(6,23)),new V(30,new T(33,16),new T(4,17))),new be(27,Int32Array.from([6,34,62,90,118]),new V(30,new T(8,122),new T(4,123)),new V(28,new T(22,45),new T(3,46)),new V(30,new T(8,23),new T(26,24)),new V(30,new T(12,15),new T(28,16))),new be(28,Int32Array.from([6,26,50,74,98,122]),new V(30,new T(3,117),new T(10,118)),new V(28,new T(3,45),new T(23,46)),new V(30,new T(4,24),new T(31,25)),new V(30,new T(11,15),new T(31,16))),new be(29,Int32Array.from([6,30,54,78,102,126]),new V(30,new T(7,116),new T(7,117)),new V(28,new T(21,45),new T(7,46)),new V(30,new T(1,23),new T(37,24)),new V(30,new T(19,15),new T(26,16))),new be(30,Int32Array.from([6,26,52,78,104,130]),new V(30,new T(5,115),new T(10,116)),new V(28,new T(19,47),new T(10,48)),new V(30,new T(15,24),new T(25,25)),new V(30,new T(23,15),new T(25,16))),new be(31,Int32Array.from([6,30,56,82,108,134]),new V(30,new T(13,115),new T(3,116)),new V(28,new T(2,46),new T(29,47)),new V(30,new T(42,24),new T(1,25)),new V(30,new T(23,15),new T(28,16))),new be(32,Int32Array.from([6,34,60,86,112,138]),new V(30,new T(17,115)),new V(28,new T(10,46),new T(23,47)),new V(30,new T(10,24),new T(35,25)),new V(30,new T(19,15),new T(35,16))),new be(33,Int32Array.from([6,30,58,86,114,142]),new V(30,new T(17,115),new T(1,116)),new V(28,new T(14,46),new T(21,47)),new V(30,new T(29,24),new T(19,25)),new V(30,new T(11,15),new T(46,16))),new be(34,Int32Array.from([6,34,62,90,118,146]),new V(30,new T(13,115),new T(6,116)),new V(28,new T(14,46),new T(23,47)),new V(30,new T(44,24),new T(7,25)),new V(30,new T(59,16),new T(1,17))),new be(35,Int32Array.from([6,30,54,78,102,126,150]),new V(30,new T(12,121),new T(7,122)),new V(28,new T(12,47),new T(26,48)),new V(30,new T(39,24),new T(14,25)),new V(30,new T(22,15),new T(41,16))),new be(36,Int32Array.from([6,24,50,76,102,128,154]),new V(30,new T(6,121),new T(14,122)),new V(28,new T(6,47),new T(34,48)),new V(30,new T(46,24),new T(10,25)),new V(30,new T(2,15),new T(64,16))),new be(37,Int32Array.from([6,28,54,80,106,132,158]),new V(30,new T(17,122),new T(4,123)),new V(28,new T(29,46),new T(14,47)),new V(30,new T(49,24),new T(10,25)),new V(30,new T(24,15),new T(46,16))),new be(38,Int32Array.from([6,32,58,84,110,136,162]),new V(30,new T(4,122),new T(18,123)),new V(28,new T(13,46),new T(32,47)),new V(30,new T(48,24),new T(14,25)),new V(30,new T(42,15),new T(32,16))),new be(39,Int32Array.from([6,26,54,82,110,138,166]),new V(30,new T(20,117),new T(4,118)),new V(28,new T(40,47),new T(7,48)),new V(30,new T(43,24),new T(22,25)),new V(30,new T(10,15),new T(67,16))),new be(40,Int32Array.from([6,30,58,86,114,142,170]),new V(30,new T(19,118),new T(6,119)),new V(28,new T(18,47),new T(31,48)),new V(30,new T(34,24),new T(34,25)),new V(30,new T(20,15),new T(61,16)))];var Ct;(function(C){C[C.DATA_MASK_000=0]="DATA_MASK_000",C[C.DATA_MASK_001=1]="DATA_MASK_001",C[C.DATA_MASK_010=2]="DATA_MASK_010",C[C.DATA_MASK_011=3]="DATA_MASK_011",C[C.DATA_MASK_100=4]="DATA_MASK_100",C[C.DATA_MASK_101=5]="DATA_MASK_101",C[C.DATA_MASK_110=6]="DATA_MASK_110",C[C.DATA_MASK_111=7]="DATA_MASK_111"})(Ct||(Ct={}));class qt{constructor(e,t){this.value=e,this.isMasked=t}unmaskBitMatrix(e,t){for(let s=0;s<t;s++)for(let n=0;n<t;n++)this.isMasked(s,n)&&e.flip(n,s)}}qt.values=new Map([[Ct.DATA_MASK_000,new qt(Ct.DATA_MASK_000,(C,e)=>(C+e&1)===0)],[Ct.DATA_MASK_001,new qt(Ct.DATA_MASK_001,(C,e)=>(C&1)===0)],[Ct.DATA_MASK_010,new qt(Ct.DATA_MASK_010,(C,e)=>e%3===0)],[Ct.DATA_MASK_011,new qt(Ct.DATA_MASK_011,(C,e)=>(C+e)%3===0)],[Ct.DATA_MASK_100,new qt(Ct.DATA_MASK_100,(C,e)=>(Math.floor(C/2)+Math.floor(e/3)&1)===0)],[Ct.DATA_MASK_101,new qt(Ct.DATA_MASK_101,(C,e)=>C*e%6===0)],[Ct.DATA_MASK_110,new qt(Ct.DATA_MASK_110,(C,e)=>C*e%6<3)],[Ct.DATA_MASK_111,new qt(Ct.DATA_MASK_111,(C,e)=>(C+e+C*e%3&1)===0)]]);class Eo{constructor(e){const t=e.getHeight();if(t<21||(t&3)!==1)throw new Q;this.bitMatrix=e}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let e=0;for(let i=0;i<6;i++)e=this.copyBit(i,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(let i=5;i>=0;i--)e=this.copyBit(8,i,e);const t=this.bitMatrix.getHeight();let s=0;const n=t-7;for(let i=t-1;i>=n;i--)s=this.copyBit(8,i,s);for(let i=t-8;i<t;i++)s=this.copyBit(i,8,s);if(this.parsedFormatInfo=Ot.decodeFormatInformation(e,s),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new Q}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return be.getVersionForNumber(t);let s=0;const n=e-11;for(let o=5;o>=0;o--)for(let d=e-9;d>=n;d--)s=this.copyBit(d,o,s);let i=be.decodeVersionInformation(s);if(i!==null&&i.getDimensionForVersion()===e)return this.parsedVersion=i,i;s=0;for(let o=5;o>=0;o--)for(let d=e-9;d>=n;d--)s=this.copyBit(o,d,s);if(i=be.decodeVersionInformation(s),i!==null&&i.getDimensionForVersion()===e)return this.parsedVersion=i,i;throw new Q}copyBit(e,t,s){return(this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t))?s<<1|1:s<<1}readCodewords(){const e=this.readFormatInformation(),t=this.readVersion(),s=qt.values.get(e.getDataMask()),n=this.bitMatrix.getHeight();s.unmaskBitMatrix(this.bitMatrix,n);const i=t.buildFunctionPattern();let o=!0;const d=new Uint8Array(t.getTotalCodewords());let x=0,m=0,b=0;for(let E=n-1;E>0;E-=2){E===6&&E--;for(let A=0;A<n;A++){const k=o?n-1-A:A;for(let R=0;R<2;R++)i.get(E-R,k)||(b++,m<<=1,this.bitMatrix.get(E-R,k)&&(m|=1),b===8&&(d[x++]=m,b=0,m=0))}o=!o}if(x!==t.getTotalCodewords())throw new Q;return d}remask(){if(this.parsedFormatInfo===null)return;const e=qt.values[this.parsedFormatInfo.getDataMask()],t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}setMirror(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e}mirror(){const e=this.bitMatrix;for(let t=0,s=e.getWidth();t<s;t++)for(let n=t+1,i=e.getHeight();n<i;n++)e.get(t,n)!==e.get(n,t)&&(e.flip(n,t),e.flip(t,n))}}class An{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t,s){if(e.length!==t.getTotalCodewords())throw new N;const n=t.getECBlocksForLevel(s);let i=0;const o=n.getECBlocks();for(const R of o)i+=R.getCount();const d=new Array(i);let x=0;for(const R of o)for(let B=0;B<R.getCount();B++){const U=R.getDataCodewords(),W=n.getECCodewordsPerBlock()+U;d[x++]=new An(U,new Uint8Array(W))}const m=d[0].codewords.length;let b=d.length-1;for(;b>=0&&d[b].codewords.length!==m;)b--;b++;const E=m-n.getECCodewordsPerBlock();let A=0;for(let R=0;R<E;R++)for(let B=0;B<x;B++)d[B].codewords[R]=e[A++];for(let R=b;R<x;R++)d[R].codewords[E]=e[A++];const k=d[0].codewords.length;for(let R=E;R<k;R++)for(let B=0;B<x;B++){const U=B<b?R:R+1;d[B].codewords[U]=e[A++]}return d}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Zt;(function(C){C[C.TERMINATOR=0]="TERMINATOR",C[C.NUMERIC=1]="NUMERIC",C[C.ALPHANUMERIC=2]="ALPHANUMERIC",C[C.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",C[C.BYTE=4]="BYTE",C[C.ECI=5]="ECI",C[C.KANJI=6]="KANJI",C[C.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",C[C.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",C[C.HANZI=9]="HANZI"})(Zt||(Zt={}));class ve{constructor(e,t,s,n){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=s,this.bits=n,ve.FOR_BITS.set(n,this),ve.FOR_VALUE.set(e,this)}static forBits(e){const t=ve.FOR_BITS.get(e);if(t===void 0)throw new N;return t}getCharacterCountBits(e){const t=e.getVersionNumber();let s;return t<=9?s=0:t<=26?s=1:s=2,this.characterCountBitsForVersions[s]}getValue(){return this.value}getBits(){return this.bits}equals(e){if(!(e instanceof ve))return!1;const t=e;return this.value===t.value}toString(){return this.stringValue}}ve.FOR_BITS=new Map,ve.FOR_VALUE=new Map,ve.TERMINATOR=new ve(Zt.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),ve.NUMERIC=new ve(Zt.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),ve.ALPHANUMERIC=new ve(Zt.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),ve.STRUCTURED_APPEND=new ve(Zt.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),ve.BYTE=new ve(Zt.BYTE,"BYTE",Int32Array.from([8,16,16]),4),ve.ECI=new ve(Zt.ECI,"ECI",Int32Array.from([0,0,0]),7),ve.KANJI=new ve(Zt.KANJI,"KANJI",Int32Array.from([8,10,12]),8),ve.FNC1_FIRST_POSITION=new ve(Zt.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),ve.FNC1_SECOND_POSITION=new ve(Zt.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),ve.HANZI=new ve(Zt.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class lt{static decode(e,t,s,n){const i=new En(e);let o=new q;const d=new Array;let x=-1,m=-1;try{let b=null,E=!1,A;do{if(i.available()<4)A=ve.TERMINATOR;else{const k=i.readBits(4);A=ve.forBits(k)}switch(A){case ve.TERMINATOR:break;case ve.FNC1_FIRST_POSITION:case ve.FNC1_SECOND_POSITION:E=!0;break;case ve.STRUCTURED_APPEND:if(i.available()<16)throw new Q;x=i.readBits(8),m=i.readBits(8);break;case ve.ECI:const k=lt.parseECIValue(i);if(b=J.getCharacterSetECIByValue(k),b===null)throw new Q;break;case ve.HANZI:const R=i.readBits(4),B=i.readBits(A.getCharacterCountBits(t));R===lt.GB2312_SUBSET&&lt.decodeHanziSegment(i,o,B);break;default:const U=i.readBits(A.getCharacterCountBits(t));switch(A){case ve.NUMERIC:lt.decodeNumericSegment(i,o,U);break;case ve.ALPHANUMERIC:lt.decodeAlphanumericSegment(i,o,U,E);break;case ve.BYTE:lt.decodeByteSegment(i,o,U,b,d,n);break;case ve.KANJI:lt.decodeKanjiSegment(i,o,U);break;default:throw new Q}break}}while(A!==ve.TERMINATOR)}catch{throw new Q}return new we(e,o.toString(),d.length===0?null:d,s===null?null:s.toString(),x,m)}static decodeHanziSegment(e,t,s){if(s*13>e.available())throw new Q;const n=new Uint8Array(2*s);let i=0;for(;s>0;){const o=e.readBits(13);let d=o/96<<8&4294967295|o%96;d<959?d+=41377:d+=42657,n[i]=d>>8&255,n[i+1]=d&255,i+=2,s--}try{t.append(Z.decode(n,H.GB2312))}catch(o){throw new Q(o)}}static decodeKanjiSegment(e,t,s){if(s*13>e.available())throw new Q;const n=new Uint8Array(2*s);let i=0;for(;s>0;){const o=e.readBits(13);let d=o/192<<8&4294967295|o%192;d<7936?d+=33088:d+=49472,n[i]=d>>8,n[i+1]=d,i+=2,s--}try{t.append(Z.decode(n,H.SHIFT_JIS))}catch(o){throw new Q(o)}}static decodeByteSegment(e,t,s,n,i,o){if(8*s>e.available())throw new Q;const d=new Uint8Array(s);for(let m=0;m<s;m++)d[m]=e.readBits(8);let x;n===null?x=H.guessEncoding(d,o):x=n.getName();try{t.append(Z.decode(d,x))}catch(m){throw new Q(m)}i.push(d)}static toAlphaNumericChar(e){if(e>=lt.ALPHANUMERIC_CHARS.length)throw new Q;return lt.ALPHANUMERIC_CHARS[e]}static decodeAlphanumericSegment(e,t,s,n){const i=t.length();for(;s>1;){if(e.available()<11)throw new Q;const o=e.readBits(11);t.append(lt.toAlphaNumericChar(Math.floor(o/45))),t.append(lt.toAlphaNumericChar(o%45)),s-=2}if(s===1){if(e.available()<6)throw new Q;t.append(lt.toAlphaNumericChar(e.readBits(6)))}if(n)for(let o=i;o<t.length();o++)t.charAt(o)==="%"&&(o<t.length()-1&&t.charAt(o+1)==="%"?t.deleteCharAt(o+1):t.setCharAt(o,""))}static decodeNumericSegment(e,t,s){for(;s>=3;){if(e.available()<10)throw new Q;const n=e.readBits(10);if(n>=1e3)throw new Q;t.append(lt.toAlphaNumericChar(Math.floor(n/100))),t.append(lt.toAlphaNumericChar(Math.floor(n/10)%10)),t.append(lt.toAlphaNumericChar(n%10)),s-=3}if(s===2){if(e.available()<7)throw new Q;const n=e.readBits(7);if(n>=100)throw new Q;t.append(lt.toAlphaNumericChar(Math.floor(n/10))),t.append(lt.toAlphaNumericChar(n%10))}else if(s===1){if(e.available()<4)throw new Q;const n=e.readBits(4);if(n>=10)throw new Q;t.append(lt.toAlphaNumericChar(n))}}static parseECIValue(e){const t=e.readBits(8);if(!(t&128))return t&127;if((t&192)===128){const s=e.readBits(8);return(t&63)<<8&4294967295|s}if((t&224)===192){const s=e.readBits(16);return(t&31)<<16&4294967295|s}throw new Q}}lt.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",lt.GB2312_SUBSET=1;class bi{constructor(e){this.mirrored=e}isMirrored(){return this.mirrored}applyMirroredCorrection(e){if(!this.mirrored||e===null||e.length<3)return;const t=e[0];e[0]=e[2],e[2]=t}}class Ao{constructor(){this.rsDecoder=new cr(ke.QR_CODE_FIELD_256)}decodeBooleanArray(e,t){return this.decodeBitMatrix(he.parseFromBooleanArray(e),t)}decodeBitMatrix(e,t){const s=new Eo(e);let n=null;try{return this.decodeBitMatrixParser(s,t)}catch(i){n=i}try{s.remask(),s.setMirror(!0),s.readVersion(),s.readFormatInformation(),s.mirror();const i=this.decodeBitMatrixParser(s,t);return i.setOther(new bi(!0)),i}catch(i){throw n!==null?n:i}}decodeBitMatrixParser(e,t){const s=e.readVersion(),n=e.readFormatInformation().getErrorCorrectionLevel(),i=e.readCodewords(),o=An.getDataBlocks(i,s,n);let d=0;for(const b of o)d+=b.getNumDataCodewords();const x=new Uint8Array(d);let m=0;for(const b of o){const E=b.getCodewords(),A=b.getNumDataCodewords();this.correctErrors(E,A);for(let k=0;k<A;k++)x[m++]=E[k]}return lt.decode(x,s,n,t)}correctErrors(e,t){const s=new Int32Array(e);try{this.rsDecoder.decode(s,e.length-t)}catch{throw new _}for(let n=0;n<t;n++)e[n]=s[n]}}class Sn extends me{constructor(e,t,s){super(e,t),this.estimatedModuleSize=s}aboutEquals(e,t,s){if(Math.abs(t-this.getY())<=e&&Math.abs(s-this.getX())<=e){const n=Math.abs(e-this.estimatedModuleSize);return n<=1||n<=this.estimatedModuleSize}return!1}combineEstimate(e,t,s){const n=(this.getX()+t)/2,i=(this.getY()+e)/2,o=(this.estimatedModuleSize+s)/2;return new Sn(n,i,o)}}class Ys{constructor(e,t,s,n,i,o,d){this.image=e,this.startX=t,this.startY=s,this.width=n,this.height=i,this.moduleSize=o,this.resultPointCallback=d,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const e=this.startX,t=this.height,s=this.width,n=e+s,i=this.startY+t/2,o=new Int32Array(3),d=this.image;for(let x=0;x<t;x++){const m=i+(x&1?-Math.floor((x+1)/2):Math.floor((x+1)/2));o[0]=0,o[1]=0,o[2]=0;let b=e;for(;b<n&&!d.get(b,m);)b++;let E=0;for(;b<n;){if(d.get(b,m))if(E===1)o[1]++;else if(E===2){if(this.foundPatternCross(o)){const A=this.handlePossibleCenter(o,m,b);if(A!==null)return A}o[0]=o[2],o[1]=1,o[2]=0,E=1}else o[++E]++;else E===1&&E++,o[E]++;b++}if(this.foundPatternCross(o)){const A=this.handlePossibleCenter(o,m,n);if(A!==null)return A}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new F}static centerFromEnd(e,t){return t-e[2]-e[1]/2}foundPatternCross(e){const t=this.moduleSize,s=t/2;for(let n=0;n<3;n++)if(Math.abs(t-e[n])>=s)return!1;return!0}crossCheckVertical(e,t,s,n){const i=this.image,o=i.getHeight(),d=this.crossCheckStateCount;d[0]=0,d[1]=0,d[2]=0;let x=e;for(;x>=0&&i.get(t,x)&&d[1]<=s;)d[1]++,x--;if(x<0||d[1]>s)return NaN;for(;x>=0&&!i.get(t,x)&&d[0]<=s;)d[0]++,x--;if(d[0]>s)return NaN;for(x=e+1;x<o&&i.get(t,x)&&d[1]<=s;)d[1]++,x++;if(x===o||d[1]>s)return NaN;for(;x<o&&!i.get(t,x)&&d[2]<=s;)d[2]++,x++;if(d[2]>s)return NaN;const m=d[0]+d[1]+d[2];return 5*Math.abs(m-n)>=2*n?NaN:this.foundPatternCross(d)?Ys.centerFromEnd(d,x):NaN}handlePossibleCenter(e,t,s){const n=e[0]+e[1]+e[2],i=Ys.centerFromEnd(e,s),o=this.crossCheckVertical(t,i,2*e[1],n);if(!isNaN(o)){const d=(e[0]+e[1]+e[2])/3;for(const m of this.possibleCenters)if(m.aboutEquals(d,o,i))return m.combineEstimate(o,i,d);const x=new Sn(i,o,d);this.possibleCenters.push(x),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(x)}return null}}class jn extends me{constructor(e,t,s,n){super(e,t),this.estimatedModuleSize=s,this.count=n,n===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(e,t,s){if(Math.abs(t-this.getY())<=e&&Math.abs(s-this.getX())<=e){const n=Math.abs(e-this.estimatedModuleSize);return n<=1||n<=this.estimatedModuleSize}return!1}combineEstimate(e,t,s){const n=this.count+1,i=(this.count*this.getX()+t)/n,o=(this.count*this.getY()+e)/n,d=(this.count*this.estimatedModuleSize+s)/n;return new jn(i,o,d,n)}}class So{constructor(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Et{constructor(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(e){const t=e!=null&&e.get(ce.TRY_HARDER)!==void 0,s=e!=null&&e.get(ce.PURE_BARCODE)!==void 0,n=this.image,i=n.getHeight(),o=n.getWidth();let d=Math.floor(3*i/(4*Et.MAX_MODULES));(d<Et.MIN_SKIP||t)&&(d=Et.MIN_SKIP);let x=!1;const m=new Int32Array(5);for(let E=d-1;E<i&&!x;E+=d){m[0]=0,m[1]=0,m[2]=0,m[3]=0,m[4]=0;let A=0;for(let k=0;k<o;k++)if(n.get(k,E))(A&1)===1&&A++,m[A]++;else if(A&1)m[A]++;else if(A===4)if(Et.foundPatternCross(m)){if(this.handlePossibleCenter(m,E,k,s)===!0)if(d=2,this.hasSkipped===!0)x=this.haveMultiplyConfirmedCenters();else{const B=this.findRowSkip();B>m[2]&&(E+=B-m[2]-d,k=o-1)}else{m[0]=m[2],m[1]=m[3],m[2]=m[4],m[3]=1,m[4]=0,A=3;continue}A=0,m[0]=0,m[1]=0,m[2]=0,m[3]=0,m[4]=0}else m[0]=m[2],m[1]=m[3],m[2]=m[4],m[3]=1,m[4]=0,A=3;else m[++A]++;Et.foundPatternCross(m)&&this.handlePossibleCenter(m,E,o,s)===!0&&(d=m[0],this.hasSkipped&&(x=this.haveMultiplyConfirmedCenters()))}const b=this.selectBestPatterns();return me.orderBestPatterns(b),new So(b)}static centerFromEnd(e,t){return t-e[4]-e[3]-e[2]/2}static foundPatternCross(e){let t=0;for(let i=0;i<5;i++){const o=e[i];if(o===0)return!1;t+=o}if(t<7)return!1;const s=t/7,n=s/2;return Math.abs(s-e[0])<n&&Math.abs(s-e[1])<n&&Math.abs(3*s-e[2])<3*n&&Math.abs(s-e[3])<n&&Math.abs(s-e[4])<n}getCrossCheckStateCount(){const e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e}crossCheckDiagonal(e,t,s,n){const i=this.getCrossCheckStateCount();let o=0;const d=this.image;for(;e>=o&&t>=o&&d.get(t-o,e-o);)i[2]++,o++;if(e<o||t<o)return!1;for(;e>=o&&t>=o&&!d.get(t-o,e-o)&&i[1]<=s;)i[1]++,o++;if(e<o||t<o||i[1]>s)return!1;for(;e>=o&&t>=o&&d.get(t-o,e-o)&&i[0]<=s;)i[0]++,o++;if(i[0]>s)return!1;const x=d.getHeight(),m=d.getWidth();for(o=1;e+o<x&&t+o<m&&d.get(t+o,e+o);)i[2]++,o++;if(e+o>=x||t+o>=m)return!1;for(;e+o<x&&t+o<m&&!d.get(t+o,e+o)&&i[3]<s;)i[3]++,o++;if(e+o>=x||t+o>=m||i[3]>=s)return!1;for(;e+o<x&&t+o<m&&d.get(t+o,e+o)&&i[4]<s;)i[4]++,o++;if(i[4]>=s)return!1;const b=i[0]+i[1]+i[2]+i[3]+i[4];return Math.abs(b-n)<2*n&&Et.foundPatternCross(i)}crossCheckVertical(e,t,s,n){const i=this.image,o=i.getHeight(),d=this.getCrossCheckStateCount();let x=e;for(;x>=0&&i.get(t,x);)d[2]++,x--;if(x<0)return NaN;for(;x>=0&&!i.get(t,x)&&d[1]<=s;)d[1]++,x--;if(x<0||d[1]>s)return NaN;for(;x>=0&&i.get(t,x)&&d[0]<=s;)d[0]++,x--;if(d[0]>s)return NaN;for(x=e+1;x<o&&i.get(t,x);)d[2]++,x++;if(x===o)return NaN;for(;x<o&&!i.get(t,x)&&d[3]<s;)d[3]++,x++;if(x===o||d[3]>=s)return NaN;for(;x<o&&i.get(t,x)&&d[4]<s;)d[4]++,x++;if(d[4]>=s)return NaN;const m=d[0]+d[1]+d[2]+d[3]+d[4];return 5*Math.abs(m-n)>=2*n?NaN:Et.foundPatternCross(d)?Et.centerFromEnd(d,x):NaN}crossCheckHorizontal(e,t,s,n){const i=this.image,o=i.getWidth(),d=this.getCrossCheckStateCount();let x=e;for(;x>=0&&i.get(x,t);)d[2]++,x--;if(x<0)return NaN;for(;x>=0&&!i.get(x,t)&&d[1]<=s;)d[1]++,x--;if(x<0||d[1]>s)return NaN;for(;x>=0&&i.get(x,t)&&d[0]<=s;)d[0]++,x--;if(d[0]>s)return NaN;for(x=e+1;x<o&&i.get(x,t);)d[2]++,x++;if(x===o)return NaN;for(;x<o&&!i.get(x,t)&&d[3]<s;)d[3]++,x++;if(x===o||d[3]>=s)return NaN;for(;x<o&&i.get(x,t)&&d[4]<s;)d[4]++,x++;if(d[4]>=s)return NaN;const m=d[0]+d[1]+d[2]+d[3]+d[4];return 5*Math.abs(m-n)>=n?NaN:Et.foundPatternCross(d)?Et.centerFromEnd(d,x):NaN}handlePossibleCenter(e,t,s,n){const i=e[0]+e[1]+e[2]+e[3]+e[4];let o=Et.centerFromEnd(e,s),d=this.crossCheckVertical(t,Math.floor(o),e[2],i);if(!isNaN(d)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(d),e[2],i),!isNaN(o)&&(!n||this.crossCheckDiagonal(Math.floor(d),Math.floor(o),e[2],i)))){const x=i/7;let m=!1;const b=this.possibleCenters;for(let E=0,A=b.length;E<A;E++){const k=b[E];if(k.aboutEquals(x,d,o)){b[E]=k.combineEstimate(d,o,x),m=!0;break}}if(!m){const E=new jn(o,d,x);b.push(E),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(E)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let t=null;for(const s of this.possibleCenters)if(s.getCount()>=Et.CENTER_QUORUM)if(t==null)t=s;else return this.hasSkipped=!0,Math.floor((Math.abs(t.getX()-s.getX())-Math.abs(t.getY()-s.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let e=0,t=0;const s=this.possibleCenters.length;for(const o of this.possibleCenters)o.getCount()>=Et.CENTER_QUORUM&&(e++,t+=o.getEstimatedModuleSize());if(e<3)return!1;const n=t/s;let i=0;for(const o of this.possibleCenters)i+=Math.abs(o.getEstimatedModuleSize()-n);return i<=.05*t}selectBestPatterns(){const e=this.possibleCenters.length;if(e<3)throw new F;const t=this.possibleCenters;let s;if(e>3){let n=0,i=0;for(const x of this.possibleCenters){const m=x.getEstimatedModuleSize();n+=m,i+=m*m}s=n/e;let o=Math.sqrt(i/e-s*s);t.sort((x,m)=>{const b=Math.abs(m.getEstimatedModuleSize()-s),E=Math.abs(x.getEstimatedModuleSize()-s);return b<E?-1:b>E?1:0});const d=Math.max(.2*s,o);for(let x=0;x<t.length&&t.length>3;x++){const m=t[x];Math.abs(m.getEstimatedModuleSize()-s)>d&&(t.splice(x,1),x--)}}if(t.length>3){let n=0;for(const i of t)n+=i.getEstimatedModuleSize();s=n/t.length,t.sort((i,o)=>{if(o.getCount()===i.getCount()){const d=Math.abs(o.getEstimatedModuleSize()-s),x=Math.abs(i.getEstimatedModuleSize()-s);return d<x?1:d>x?-1:0}else return o.getCount()-i.getCount()}),t.splice(3)}return[t[0],t[1],t[2]]}}Et.CENTER_QUORUM=2,Et.MIN_SKIP=3,Et.MAX_MODULES=57;class vs{constructor(e){this.image=e}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(e){this.resultPointCallback=e==null?null:e.get(ce.NEED_RESULT_POINT_CALLBACK);const s=new Et(this.image,this.resultPointCallback).find(e);return this.processFinderPatternInfo(s)}processFinderPatternInfo(e){const t=e.getTopLeft(),s=e.getTopRight(),n=e.getBottomLeft(),i=this.calculateModuleSize(t,s,n);if(i<1)throw new F("No pattern found in proccess finder.");const o=vs.computeDimension(t,s,n,i),d=be.getProvisionalVersionForDimension(o),x=d.getDimensionForVersion()-7;let m=null;if(d.getAlignmentPatternCenters().length>0){const k=s.getX()-t.getX()+n.getX(),R=s.getY()-t.getY()+n.getY(),B=1-3/x,U=Math.floor(t.getX()+B*(k-t.getX())),W=Math.floor(t.getY()+B*(R-t.getY()));for(let re=4;re<=16;re<<=1)try{m=this.findAlignmentInRegion(i,U,W,re);break}catch(se){if(!(se instanceof F))throw se}}const b=vs.createTransform(t,s,n,m,o),E=vs.sampleGrid(this.image,b,o);let A;return m===null?A=[n,t,s]:A=[n,t,s,m],new es(E,A)}static createTransform(e,t,s,n,i){const o=i-3.5;let d,x,m,b;return n!==null?(d=n.getX(),x=n.getY(),m=o-3,b=m):(d=t.getX()-e.getX()+s.getX(),x=t.getY()-e.getY()+s.getY(),m=o,b=o),Vt.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,m,b,3.5,o,e.getX(),e.getY(),t.getX(),t.getY(),d,x,s.getX(),s.getY())}static sampleGrid(e,t,s){return dr.getInstance().sampleGridWithTransform(e,s,s,t)}static computeDimension(e,t,s,n){const i=De.round(me.distance(e,t)/n),o=De.round(me.distance(e,s)/n);let d=Math.floor((i+o)/2)+7;switch(d&3){case 0:d++;break;case 2:d--;break;case 3:throw new F("Dimensions could be not found.")}return d}calculateModuleSize(e,t,s){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,s))/2}calculateModuleSizeOneWay(e,t){const s=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(s)?n/7:isNaN(n)?s/7:(s+n)/14}sizeOfBlackWhiteBlackRunBothWays(e,t,s,n){let i=this.sizeOfBlackWhiteBlackRun(e,t,s,n),o=1,d=e-(s-e);d<0?(o=e/(e-d),d=0):d>=this.image.getWidth()&&(o=(this.image.getWidth()-1-e)/(d-e),d=this.image.getWidth()-1);let x=Math.floor(t-(n-t)*o);return o=1,x<0?(o=t/(t-x),x=0):x>=this.image.getHeight()&&(o=(this.image.getHeight()-1-t)/(x-t),x=this.image.getHeight()-1),d=Math.floor(e+(d-e)*o),i+=this.sizeOfBlackWhiteBlackRun(e,t,d,x),i-1}sizeOfBlackWhiteBlackRun(e,t,s,n){const i=Math.abs(n-t)>Math.abs(s-e);if(i){let k=e;e=t,t=k,k=s,s=n,n=k}const o=Math.abs(s-e),d=Math.abs(n-t);let x=-o/2;const m=e<s?1:-1,b=t<n?1:-1;let E=0;const A=s+m;for(let k=e,R=t;k!==A;k+=m){const B=i?R:k,U=i?k:R;if(E===1===this.image.get(B,U)){if(E===2)return De.distance(k,R,e,t);E++}if(x+=d,x>0){if(R===n)break;R+=b,x-=o}}return E===2?De.distance(s+m,n,e,t):NaN}findAlignmentInRegion(e,t,s,n){const i=Math.floor(n*e),o=Math.max(0,t-i),d=Math.min(this.image.getWidth()-1,t+i);if(d-o<e*3)throw new F("Alignment top exceeds estimated module size.");const x=Math.max(0,s-i),m=Math.min(this.image.getHeight()-1,s+i);if(m-x<e*3)throw new F("Alignment bottom exceeds estimated module size.");return new Ys(this.image,o,x,d-o,m-x,e,this.resultPointCallback).find()}}class Or{constructor(){this.decoder=new Ao}getDecoder(){return this.decoder}decode(e,t){let s,n;if(t!=null&&t.get(ce.PURE_BARCODE)!==void 0){const x=Or.extractPureBits(e.getBlackMatrix());s=this.decoder.decodeBitMatrix(x,t),n=Or.NO_POINTS}else{const x=new vs(e.getBlackMatrix()).detect(t);s=this.decoder.decodeBitMatrix(x.getBits(),t),n=x.getPoints()}s.getOther()instanceof bi&&s.getOther().applyMirroredCorrection(n);const i=new oe(s.getText(),s.getRawBytes(),void 0,n,ae.QR_CODE,void 0),o=s.getByteSegments();o!==null&&i.putMetadata(Ie.BYTE_SEGMENTS,o);const d=s.getECLevel();return d!==null&&i.putMetadata(Ie.ERROR_CORRECTION_LEVEL,d),s.hasStructuredAppend()&&(i.putMetadata(Ie.STRUCTURED_APPEND_SEQUENCE,s.getStructuredAppendSequenceNumber()),i.putMetadata(Ie.STRUCTURED_APPEND_PARITY,s.getStructuredAppendParity())),i}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),s=e.getBottomRightOnBit();if(t===null||s===null)throw new F;const n=this.moduleSize(t,e);let i=t[1],o=s[1],d=t[0],x=s[0];if(d>=x||i>=o)throw new F;if(o-i!==x-d&&(x=d+(o-i),x>=e.getWidth()))throw new F;const m=Math.round((x-d+1)/n),b=Math.round((o-i+1)/n);if(m<=0||b<=0)throw new F;if(b!==m)throw new F;const E=Math.floor(n/2);i+=E,d+=E;const A=d+Math.floor((m-1)*n)-x;if(A>0){if(A>E)throw new F;d-=A}const k=i+Math.floor((b-1)*n)-o;if(k>0){if(k>E)throw new F;i-=k}const R=new he(m,b);for(let B=0;B<b;B++){const U=i+Math.floor(B*n);for(let W=0;W<m;W++)e.get(d+Math.floor(W*n),U)&&R.set(W,B)}return R}static moduleSize(e,t){const s=t.getHeight(),n=t.getWidth();let i=e[0],o=e[1],d=!0,x=0;for(;i<n&&o<s;){if(d!==t.get(i,o)){if(++x===5)break;d=!d}i++,o++}if(i===n||o===s)throw new F;return(i-e[0])/7}}Or.NO_POINTS=new Array;class Ee{PDF417Common(){}static getBitCountSum(e){return De.sum(e)}static toIntArray(e){if(e==null||!e.length)return Ee.EMPTY_INT_ARRAY;const t=new Int32Array(e.length);let s=0;for(const n of e)t[s++]=n;return t}static getCodeword(e){const t=I.binarySearch(Ee.SYMBOL_TABLE,e&262143);return t<0?-1:(Ee.CODEWORD_TABLE[t]-1)%Ee.NUMBER_OF_CODEWORDS}}Ee.NUMBER_OF_CODEWORDS=929,Ee.MAX_CODEWORDS_IN_BARCODE=Ee.NUMBER_OF_CODEWORDS-1,Ee.MIN_ROWS_IN_BARCODE=3,Ee.MAX_ROWS_IN_BARCODE=90,Ee.MODULES_IN_CODEWORD=17,Ee.MODULES_IN_STOP_PATTERN=18,Ee.BARS_IN_MODULE=8,Ee.EMPTY_INT_ARRAY=new Int32Array([]),Ee.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Ee.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class jo{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class Te{static detectMultiple(e,t,s){let n=e.getBlackMatrix(),i=Te.detect(s,n);return i.length||(n=n.clone(),n.rotate180(),i=Te.detect(s,n)),new jo(n,i)}static detect(e,t){const s=new Array;let n=0,i=0,o=!1;for(;n<t.getHeight();){const d=Te.findVertices(t,n,i);if(d[0]==null&&d[3]==null){if(!o)break;o=!1,i=0;for(const x of s)x[1]!=null&&(n=Math.trunc(Math.max(n,x[1].getY()))),x[3]!=null&&(n=Math.max(n,Math.trunc(x[3].getY())));n+=Te.ROW_STEP;continue}if(o=!0,s.push(d),!e)break;d[2]!=null?(i=Math.trunc(d[2].getX()),n=Math.trunc(d[2].getY())):(i=Math.trunc(d[4].getX()),n=Math.trunc(d[4].getY()))}return s}static findVertices(e,t,s){const n=e.getHeight(),i=e.getWidth(),o=new Array(8);return Te.copyToResult(o,Te.findRowsWithPattern(e,n,i,t,s,Te.START_PATTERN),Te.INDEXES_START_PATTERN),o[4]!=null&&(s=Math.trunc(o[4].getX()),t=Math.trunc(o[4].getY())),Te.copyToResult(o,Te.findRowsWithPattern(e,n,i,t,s,Te.STOP_PATTERN),Te.INDEXES_STOP_PATTERN),o}static copyToResult(e,t,s){for(let n=0;n<s.length;n++)e[s[n]]=t[n]}static findRowsWithPattern(e,t,s,n,i,o){const d=new Array(4);let x=!1;const m=new Int32Array(o.length);for(;n<t;n+=Te.ROW_STEP){let E=Te.findGuardPattern(e,i,n,s,!1,o,m);if(E!=null){for(;n>0;){const A=Te.findGuardPattern(e,i,--n,s,!1,o,m);if(A!=null)E=A;else{n++;break}}d[0]=new me(E[0],n),d[1]=new me(E[1],n),x=!0;break}}let b=n+1;if(x){let E=0,A=Int32Array.from([Math.trunc(d[0].getX()),Math.trunc(d[1].getX())]);for(;b<t;b++){const k=Te.findGuardPattern(e,A[0],b,s,!1,o,m);if(k!=null&&Math.abs(A[0]-k[0])<Te.MAX_PATTERN_DRIFT&&Math.abs(A[1]-k[1])<Te.MAX_PATTERN_DRIFT)A=k,E=0;else{if(E>Te.SKIPPED_ROW_COUNT_MAX)break;E++}}b-=E+1,d[2]=new me(A[0],b),d[3]=new me(A[1],b)}return b-n<Te.BARCODE_MIN_HEIGHT&&I.fill(d,null),d}static findGuardPattern(e,t,s,n,i,o,d){I.fillWithin(d,0,d.length,0);let x=t,m=0;for(;e.get(x,s)&&x>0&&m++<Te.MAX_PIXEL_DRIFT;)x--;let b=x,E=0,A=o.length;for(let k=i;b<n;b++)if(e.get(b,s)!==k)d[E]++;else{if(E===A-1){if(Te.patternMatchVariance(d,o,Te.MAX_INDIVIDUAL_VARIANCE)<Te.MAX_AVG_VARIANCE)return new Int32Array([x,b]);x+=d[0]+d[1],D.arraycopy(d,2,d,0,E-1),d[E-1]=0,d[E]=0,E--}else E++;d[E]=1,k=!k}return E===A-1&&Te.patternMatchVariance(d,o,Te.MAX_INDIVIDUAL_VARIANCE)<Te.MAX_AVG_VARIANCE?new Int32Array([x,b-1]):null}static patternMatchVariance(e,t,s){let n=e.length,i=0,o=0;for(let m=0;m<n;m++)i+=e[m],o+=t[m];if(i<o)return 1/0;let d=i/o;s*=d;let x=0;for(let m=0;m<n;m++){let b=e[m],E=t[m]*d,A=b>E?b-E:E-b;if(A>s)return 1/0;x+=A}return x/i}}Te.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Te.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Te.MAX_AVG_VARIANCE=.42,Te.MAX_INDIVIDUAL_VARIANCE=.8,Te.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Te.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Te.MAX_PIXEL_DRIFT=3,Te.MAX_PATTERN_DRIFT=5,Te.SKIPPED_ROW_COUNT_MAX=25,Te.ROW_STEP=5,Te.BARCODE_MIN_HEIGHT=10;class jt{constructor(e,t){if(t.length===0)throw new N;this.field=e;let s=t.length;if(s>1&&t[0]===0){let n=1;for(;n<s&&t[n]===0;)n++;n===s?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(s-n),D.arraycopy(t,n,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);if(e===1){let n=0;for(let i of this.coefficients)n=this.field.add(n,i);return n}let t=this.coefficients[0],s=this.coefficients.length;for(let n=1;n<s;n++)t=this.field.add(this.field.multiply(e,t),this.coefficients[n]);return t}add(e){if(!this.field.equals(e.field))throw new N("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,s=e.coefficients;if(t.length>s.length){let o=t;t=s,s=o}let n=new Int32Array(s.length),i=s.length-t.length;D.arraycopy(s,0,n,0,i);for(let o=i;o<s.length;o++)n[o]=this.field.add(t[o-i],s[o]);return new jt(this.field,n)}subtract(e){if(!this.field.equals(e.field))throw new N("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())}multiply(e){return e instanceof jt?this.multiplyOther(e):this.multiplyScalar(e)}multiplyOther(e){if(!this.field.equals(e.field))throw new N("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new jt(this.field,new Int32Array([0]));let t=this.coefficients,s=t.length,n=e.coefficients,i=n.length,o=new Int32Array(s+i-1);for(let d=0;d<s;d++){let x=t[d];for(let m=0;m<i;m++)o[d+m]=this.field.add(o[d+m],this.field.multiply(x,n[m]))}return new jt(this.field,o)}negative(){let e=this.coefficients.length,t=new Int32Array(e);for(let s=0;s<e;s++)t[s]=this.field.subtract(0,this.coefficients[s]);return new jt(this.field,t)}multiplyScalar(e){if(e===0)return new jt(this.field,new Int32Array([0]));if(e===1)return this;let t=this.coefficients.length,s=new Int32Array(t);for(let n=0;n<t;n++)s[n]=this.field.multiply(this.coefficients[n],e);return new jt(this.field,s)}multiplyByMonomial(e,t){if(e<0)throw new N;if(t===0)return new jt(this.field,new Int32Array([0]));let s=this.coefficients.length,n=new Int32Array(s+e);for(let i=0;i<s;i++)n[i]=this.field.multiply(this.coefficients[i],t);return new jt(this.field,n)}toString(){let e=new q;for(let t=this.getDegree();t>=0;t--){let s=this.getCoefficient(t);s!==0&&(s<0?(e.append(" - "),s=-s):e.length()>0&&e.append(" + "),(t===0||s!==1)&&e.append(s),t!==0&&(t===1?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()}}class To{add(e,t){return(e+t)%this.modulus}subtract(e,t){return(this.modulus+e-t)%this.modulus}exp(e){return this.expTable[e]}log(e){if(e===0)throw new N;return this.logTable[e]}inverse(e){if(e===0)throw new Tr;return this.expTable[this.modulus-this.logTable[e]-1]}multiply(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]}getSize(){return this.modulus}equals(e){return e===this}}class Tn extends To{constructor(e,t){super(),this.modulus=e,this.expTable=new Int32Array(e),this.logTable=new Int32Array(e);let s=1;for(let n=0;n<e;n++)this.expTable[n]=s,s=s*t%e;for(let n=0;n<e-1;n++)this.logTable[this.expTable[n]]=n;this.zero=new jt(this,new Int32Array([0])),this.one=new jt(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new N;if(t===0)return this.zero;let s=new Int32Array(e+1);return s[0]=t,new jt(this,s)}}Tn.PDF417_GF=new Tn(Ee.NUMBER_OF_CODEWORDS,3);class wi{constructor(){this.field=Tn.PDF417_GF}decode(e,t,s){let n=new jt(this.field,e),i=new Int32Array(t),o=!1;for(let R=t;R>0;R--){let B=n.evaluateAt(this.field.exp(R));i[t-R]=B,B!==0&&(o=!0)}if(!o)return 0;let d=this.field.getOne();if(s!=null)for(const R of s){let B=this.field.exp(e.length-1-R),U=new jt(this.field,new Int32Array([this.field.subtract(0,B),1]));d=d.multiply(U)}let x=new jt(this.field,i),m=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),x,t),b=m[0],E=m[1],A=this.findErrorLocations(b),k=this.findErrorMagnitudes(E,b,A);for(let R=0;R<A.length;R++){let B=e.length-1-this.field.log(A[R]);if(B<0)throw _.getChecksumInstance();e[B]=this.field.subtract(e[B],k[R])}return A.length}runEuclideanAlgorithm(e,t,s){if(e.getDegree()<t.getDegree()){let A=e;e=t,t=A}let n=e,i=t,o=this.field.getZero(),d=this.field.getOne();for(;i.getDegree()>=Math.round(s/2);){let A=n,k=o;if(n=i,o=d,n.isZero())throw _.getChecksumInstance();i=A;let R=this.field.getZero(),B=n.getCoefficient(n.getDegree()),U=this.field.inverse(B);for(;i.getDegree()>=n.getDegree()&&!i.isZero();){let W=i.getDegree()-n.getDegree(),re=this.field.multiply(i.getCoefficient(i.getDegree()),U);R=R.add(this.field.buildMonomial(W,re)),i=i.subtract(n.multiplyByMonomial(W,re))}d=R.multiply(o).subtract(k).negative()}let x=d.getCoefficient(0);if(x===0)throw _.getChecksumInstance();let m=this.field.inverse(x),b=d.multiply(m),E=i.multiply(m);return[b,E]}findErrorLocations(e){let t=e.getDegree(),s=new Int32Array(t),n=0;for(let i=1;i<this.field.getSize()&&n<t;i++)e.evaluateAt(i)===0&&(s[n]=this.field.inverse(i),n++);if(n!==t)throw _.getChecksumInstance();return s}findErrorMagnitudes(e,t,s){let n=t.getDegree(),i=new Int32Array(n);for(let m=1;m<=n;m++)i[n-m]=this.field.multiply(m,t.getCoefficient(m));let o=new jt(this.field,i),d=s.length,x=new Int32Array(d);for(let m=0;m<d;m++){let b=this.field.inverse(s[m]),E=this.field.subtract(0,e.evaluateAt(b)),A=this.field.inverse(o.evaluateAt(b));x[m]=this.field.multiply(E,A)}return x}}class Xr{constructor(e,t,s,n,i){e instanceof Xr?this.constructor_2(e):this.constructor_1(e,t,s,n,i)}constructor_1(e,t,s,n,i){const o=t==null||s==null,d=n==null||i==null;if(o&&d)throw new F;o?(t=new me(0,n.getY()),s=new me(0,i.getY())):d&&(n=new me(e.getWidth()-1,t.getY()),i=new me(e.getWidth()-1,s.getY())),this.image=e,this.topLeft=t,this.bottomLeft=s,this.topRight=n,this.bottomRight=i,this.minX=Math.trunc(Math.min(t.getX(),s.getX())),this.maxX=Math.trunc(Math.max(n.getX(),i.getX())),this.minY=Math.trunc(Math.min(t.getY(),n.getY())),this.maxY=Math.trunc(Math.max(s.getY(),i.getY()))}constructor_2(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()}static merge(e,t){return e==null?t:t==null?e:new Xr(e.image,e.topLeft,e.bottomLeft,t.topRight,t.bottomRight)}addMissingRows(e,t,s){let n=this.topLeft,i=this.bottomLeft,o=this.topRight,d=this.bottomRight;if(e>0){let x=s?this.topLeft:this.topRight,m=Math.trunc(x.getY()-e);m<0&&(m=0);let b=new me(x.getX(),m);s?n=b:o=b}if(t>0){let x=s?this.bottomLeft:this.bottomRight,m=Math.trunc(x.getY()+t);m>=this.image.getHeight()&&(m=this.image.getHeight()-1);let b=new me(x.getX(),m);s?i=b:d=b}return new Xr(this.image,n,i,o,d)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class Io{constructor(e,t,s,n){this.columnCount=e,this.errorCorrectionLevel=n,this.rowCountUpperPart=t,this.rowCountLowerPart=s,this.rowCount=t+s}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Ns{constructor(){this.buffer=""}static form(e,t){let s=-1;function n(o,d,x,m,b,E){if(o==="%%")return"%";if(t[++s]===void 0)return;o=m?parseInt(m.substr(1)):void 0;let A=b?parseInt(b.substr(1)):void 0,k;switch(E){case"s":k=t[s];break;case"c":k=t[s][0];break;case"f":k=parseFloat(t[s]).toFixed(o);break;case"p":k=parseFloat(t[s]).toPrecision(o);break;case"e":k=parseFloat(t[s]).toExponential(o);break;case"x":k=parseInt(t[s]).toString(A||16);break;case"d":k=parseFloat(parseInt(t[s],A||10).toPrecision(o)).toFixed(0);break}k=typeof k=="object"?JSON.stringify(k):(+k).toString(A);let R=parseInt(x),B=x&&x[0]+""=="0"?"0":" ";for(;k.length<R;)k=d!==void 0?k+B:B+k;return k}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(i,n)}format(e,...t){this.buffer+=Ns.form(e,t)}toString(){return this.buffer}}class Cs{constructor(e){this.boundingBox=new Xr(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}getCodewordNearby(e){let t=this.getCodeword(e);if(t!=null)return t;for(let s=1;s<Cs.MAX_NEARBY_DISTANCE;s++){let n=this.imageRowToCodewordIndex(e)-s;if(n>=0&&(t=this.codewords[n],t!=null)||(n=this.imageRowToCodewordIndex(e)+s,n<this.codewords.length&&(t=this.codewords[n],t!=null)))return t}return null}imageRowToCodewordIndex(e){return e-this.boundingBox.getMinY()}setCodeword(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t}getCodeword(e){return this.codewords[this.imageRowToCodewordIndex(e)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const e=new Ns;let t=0;for(const s of this.codewords){if(s==null){e.format("%3d:    |   %n",t++);continue}e.format("%3d: %3d|%3d%n",t++,s.getRowNumber(),s.getValue())}return e.toString()}}Cs.MAX_NEARBY_DISTANCE=5;class Es{constructor(){this.values=new Map}setValue(e){e=Math.trunc(e);let t=this.values.get(e);t==null&&(t=0),t++,this.values.set(e,t)}getValue(){let e=-1,t=new Array;for(const[s,n]of this.values.entries()){const i={getKey:()=>s,getValue:()=>n};i.getValue()>e?(e=i.getValue(),t=[],t.push(i.getKey())):i.getValue()===e&&t.push(i.getKey())}return Ee.toIntArray(t)}getConfidence(e){return this.values.get(e)}}class vi extends Cs{constructor(e,t){super(e),this._isLeft=t}setRowNumbers(){for(let e of this.getCodewords())e!=null&&e.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(e){let t=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(t,e);let s=this.getBoundingBox(),n=this._isLeft?s.getTopLeft():s.getTopRight(),i=this._isLeft?s.getBottomLeft():s.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(n.getY())),d=this.imageRowToCodewordIndex(Math.trunc(i.getY())),x=-1,m=1,b=0;for(let E=o;E<d;E++){if(t[E]==null)continue;let A=t[E],k=A.getRowNumber()-x;if(k===0)b++;else if(k===1)m=Math.max(m,b),b=1,x=A.getRowNumber();else if(k<0||A.getRowNumber()>=e.getRowCount()||k>E)t[E]=null;else{let R;m>2?R=(m-2)*k:R=k;let B=R>=E;for(let U=1;U<=R&&!B;U++)B=t[E-U]!=null;B?t[E]=null:(x=A.getRowNumber(),b=1)}}}getRowHeights(){let e=this.getBarcodeMetadata();if(e==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(e);let t=new Int32Array(e.getRowCount());for(let s of this.getCodewords())if(s!=null){let n=s.getRowNumber();if(n>=t.length)continue;t[n]++}return t}adjustIncompleteIndicatorColumnRowNumbers(e){let t=this.getBoundingBox(),s=this._isLeft?t.getTopLeft():t.getTopRight(),n=this._isLeft?t.getBottomLeft():t.getBottomRight(),i=this.imageRowToCodewordIndex(Math.trunc(s.getY())),o=this.imageRowToCodewordIndex(Math.trunc(n.getY())),d=this.getCodewords(),x=-1;for(let m=i;m<o;m++){if(d[m]==null)continue;let b=d[m];b.setRowNumberAsRowIndicatorColumn();let E=b.getRowNumber()-x;E===0||(E===1?x=b.getRowNumber():b.getRowNumber()>=e.getRowCount()?d[m]=null:x=b.getRowNumber())}}getBarcodeMetadata(){let e=this.getCodewords(),t=new Es,s=new Es,n=new Es,i=new Es;for(let d of e){if(d==null)continue;d.setRowNumberAsRowIndicatorColumn();let x=d.getValue()%30,m=d.getRowNumber();switch(this._isLeft||(m+=2),m%3){case 0:s.setValue(x*3+1);break;case 1:i.setValue(x/3),n.setValue(x%3);break;case 2:t.setValue(x+1);break}}if(t.getValue().length===0||s.getValue().length===0||n.getValue().length===0||i.getValue().length===0||t.getValue()[0]<1||s.getValue()[0]+n.getValue()[0]<Ee.MIN_ROWS_IN_BARCODE||s.getValue()[0]+n.getValue()[0]>Ee.MAX_ROWS_IN_BARCODE)return null;let o=new Io(t.getValue()[0],s.getValue()[0],n.getValue()[0],i.getValue()[0]);return this.removeIncorrectCodewords(e,o),o}removeIncorrectCodewords(e,t){for(let s=0;s<e.length;s++){let n=e[s];if(e[s]==null)continue;let i=n.getValue()%30,o=n.getRowNumber();if(o>t.getRowCount()){e[s]=null;continue}switch(this._isLeft||(o+=2),o%3){case 0:i*3+1!==t.getRowCountUpperPart()&&(e[s]=null);break;case 1:(Math.trunc(i/3)!==t.getErrorCorrectionLevel()||i%3!==t.getRowCountLowerPart())&&(e[s]=null);break;case 2:i+1!==t.getColumnCount()&&(e[s]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class As{constructor(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let e=Ee.MAX_CODEWORDS_IN_BARCODE,t;do t=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<t);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(e){e!=null&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let e=this.adjustRowNumbersByRow();if(e===0)return 0;for(let t=1;t<this.barcodeColumnCount+1;t++){let s=this.detectionResultColumns[t].getCodewords();for(let n=0;n<s.length;n++)s[n]!=null&&(s[n].hasValidRowNumber()||this.adjustRowNumbers(t,n,s))}return e}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let s=0;s<e.length;s++)if(e[s]!=null&&t[s]!=null&&e[s].getRowNumber()===t[s].getRowNumber())for(let n=1;n<=this.barcodeColumnCount;n++){let i=this.detectionResultColumns[n].getCodewords()[s];i!=null&&(i.setRowNumber(e[s].getRowNumber()),i.hasValidRowNumber()||(this.detectionResultColumns[n].getCodewords()[s]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let e=0,t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let s=0;s<t.length;s++){if(t[s]==null)continue;let n=t[s].getRowNumber(),i=0;for(let o=this.barcodeColumnCount+1;o>0&&i<this.ADJUST_ROW_NUMBER_SKIP;o--){let d=this.detectionResultColumns[o].getCodewords()[s];d!=null&&(i=As.adjustRowNumberIfValid(n,i,d),d.hasValidRowNumber()||e++)}}return e}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let e=0,t=this.detectionResultColumns[0].getCodewords();for(let s=0;s<t.length;s++){if(t[s]==null)continue;let n=t[s].getRowNumber(),i=0;for(let o=1;o<this.barcodeColumnCount+1&&i<this.ADJUST_ROW_NUMBER_SKIP;o++){let d=this.detectionResultColumns[o].getCodewords()[s];d!=null&&(i=As.adjustRowNumberIfValid(n,i,d),d.hasValidRowNumber()||e++)}}return e}static adjustRowNumberIfValid(e,t,s){return s==null||s.hasValidRowNumber()||(s.isValidRowNumber(e)?(s.setRowNumber(e),t=0):++t),t}adjustRowNumbers(e,t,s){if(!this.detectionResultColumns[e-1])return;let n=s[t],i=this.detectionResultColumns[e-1].getCodewords(),o=i;this.detectionResultColumns[e+1]!=null&&(o=this.detectionResultColumns[e+1].getCodewords());let d=new Array(14);d[2]=i[t],d[3]=o[t],t>0&&(d[0]=s[t-1],d[4]=i[t-1],d[5]=o[t-1]),t>1&&(d[8]=s[t-2],d[10]=i[t-2],d[11]=o[t-2]),t<s.length-1&&(d[1]=s[t+1],d[6]=i[t+1],d[7]=o[t+1]),t<s.length-2&&(d[9]=s[t+2],d[12]=i[t+2],d[13]=o[t+2]);for(let x of d)if(As.adjustRowNumber(n,x))return}static adjustRowNumber(e,t){return t==null?!1:t.hasValidRowNumber()&&t.getBucket()===e.getBucket()?(e.setRowNumber(t.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(e){this.boundingBox=e}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(e,t){this.detectionResultColumns[e]=t}getDetectionResultColumn(e){return this.detectionResultColumns[e]}toString(){let e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);let t=new Ns;for(let s=0;s<e.getCodewords().length;s++){t.format("CW %3d:",s);for(let n=0;n<this.barcodeColumnCount+2;n++){if(this.detectionResultColumns[n]==null){t.format("    |   ");continue}let i=this.detectionResultColumns[n].getCodewords()[s];if(i==null){t.format("    |   ");continue}t.format(" %3d|%3d",i.getRowNumber(),i.getValue())}t.format("%n")}return t.toString()}}class Ss{constructor(e,t,s,n){this.rowNumber=Ss.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(t),this.bucket=Math.trunc(s),this.value=Math.trunc(n)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(e){return e!==Ss.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(e){this.rowNumber=e}toString(){return this.rowNumber+"|"+this.value}}Ss.BARCODE_ROW_UNKNOWN=-1;class Bt{static initialize(){for(let e=0;e<Ee.SYMBOL_TABLE.length;e++){let t=Ee.SYMBOL_TABLE[e],s=t&1;for(let n=0;n<Ee.BARS_IN_MODULE;n++){let i=0;for(;(t&1)===s;)i+=1,t>>=1;s=t&1,Bt.RATIOS_TABLE[e]||(Bt.RATIOS_TABLE[e]=new Array(Ee.BARS_IN_MODULE)),Bt.RATIOS_TABLE[e][Ee.BARS_IN_MODULE-n-1]=Math.fround(i/Ee.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(e){let t=Bt.getDecodedCodewordValue(Bt.sampleBitCounts(e));return t!==-1?t:Bt.getClosestDecodedValue(e)}static sampleBitCounts(e){let t=De.sum(e),s=new Int32Array(Ee.BARS_IN_MODULE),n=0,i=0;for(let o=0;o<Ee.MODULES_IN_CODEWORD;o++){let d=t/(2*Ee.MODULES_IN_CODEWORD)+o*t/Ee.MODULES_IN_CODEWORD;i+e[n]<=d&&(i+=e[n],n++),s[n]++}return s}static getDecodedCodewordValue(e){let t=Bt.getBitValue(e);return Ee.getCodeword(t)===-1?-1:t}static getBitValue(e){let t=0;for(let s=0;s<e.length;s++)for(let n=0;n<e[s];n++)t=t<<1|(s%2===0?1:0);return Math.trunc(t)}static getClosestDecodedValue(e){let t=De.sum(e),s=new Array(Ee.BARS_IN_MODULE);if(t>1)for(let o=0;o<s.length;o++)s[o]=Math.fround(e[o]/t);let n=er.MAX_VALUE,i=-1;this.bSymbolTableReady||Bt.initialize();for(let o=0;o<Bt.RATIOS_TABLE.length;o++){let d=0,x=Bt.RATIOS_TABLE[o];for(let m=0;m<Ee.BARS_IN_MODULE;m++){let b=Math.fround(x[m]-s[m]);if(d+=Math.fround(b*b),d>=n)break}d<n&&(n=d,i=Ee.SYMBOL_TABLE[o])}return i}}Bt.bSymbolTableReady=!1,Bt.RATIOS_TABLE=new Array(Ee.SYMBOL_TABLE.length).map(C=>new Array(Ee.BARS_IN_MODULE));class Ni{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(e){this.segmentIndex=e}getFileId(){return this.fileId}setFileId(e){this.fileId=e}getOptionalData(){return this.optionalData}setOptionalData(e){this.optionalData=e}isLastSegment(){return this.lastSegment}setLastSegment(e){this.lastSegment=e}getSegmentCount(){return this.segmentCount}setSegmentCount(e){this.segmentCount=e}getSender(){return this.sender||null}setSender(e){this.sender=e}getAddressee(){return this.addressee||null}setAddressee(e){this.addressee=e}getFileName(){return this.fileName}setFileName(e){this.fileName=e}getFileSize(){return this.fileSize}setFileSize(e){this.fileSize=e}getChecksum(){return this.checksum}setChecksum(e){this.checksum=e}getTimestamp(){return this.timestamp}setTimestamp(e){this.timestamp=e}}class Ci{static parseLong(e,t=void 0){return parseInt(e,t)}}class Ei extends g{}Ei.kind="NullPointerException";class _o{writeBytes(e){this.writeBytesOffset(e,0,e.length)}writeBytesOffset(e,t,s){if(e==null)throw new Ei;if(t<0||t>e.length||s<0||t+s>e.length||t+s<0)throw new P;if(s===0)return;for(let n=0;n<s;n++)this.write(e[t+n])}flush(){}close(){}}class ko extends g{}class Do extends _o{constructor(e=32){if(super(),this.count=0,e<0)throw new N("Negative initial size: "+e);this.buf=new Uint8Array(e)}ensureCapacity(e){e-this.buf.length>0&&this.grow(e)}grow(e){let s=this.buf.length<<1;if(s-e<0&&(s=e),s<0){if(e<0)throw new ko;s=M.MAX_VALUE}this.buf=I.copyOfUint8Array(this.buf,s)}write(e){this.ensureCapacity(this.count+1),this.buf[this.count]=e,this.count+=1}writeBytesOffset(e,t,s){if(t<0||t>e.length||s<0||t+s-e.length>0)throw new P;this.ensureCapacity(this.count+s),D.arraycopy(e,t,this.buf,this.count,s),this.count+=s}writeTo(e){e.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return I.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(e){return e?typeof e=="string"?this.toString_string(e):this.toString_number(e):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(e){return new String(this.buf).toString()}toString_number(e){return new String(this.buf).toString()}close(){}}var qe;(function(C){C[C.ALPHA=0]="ALPHA",C[C.LOWER=1]="LOWER",C[C.MIXED=2]="MIXED",C[C.PUNCT=3]="PUNCT",C[C.ALPHA_SHIFT=4]="ALPHA_SHIFT",C[C.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(qe||(qe={}));function Ai(){if(typeof window<"u")return window.BigInt||null;if(typeof Is<"u")return Is.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Xs;function Mr(C){if(typeof Xs>"u"&&(Xs=Ai()),Xs===null)throw new Error("BigInt is not supported!");return Xs(C)}function Oo(){let C=[];C[0]=Mr(1);let e=Mr(900);C[1]=e;for(let t=2;t<16;t++)C[t]=C[t-1]*e;return C}class G{static decode(e,t){let s=new q(""),n=J.ISO8859_1;s.enableDecoding(n);let i=1,o=e[i++],d=new Ni;for(;i<e[0];){switch(o){case G.TEXT_COMPACTION_MODE_LATCH:i=G.textCompaction(e,i,s);break;case G.BYTE_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH_6:i=G.byteCompaction(o,e,n,i,s);break;case G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:s.append(e[i++]);break;case G.NUMERIC_COMPACTION_MODE_LATCH:i=G.numericCompaction(e,i,s);break;case G.ECI_CHARSET:J.getCharacterSetECIByValue(e[i++]);break;case G.ECI_GENERAL_PURPOSE:i+=2;break;case G.ECI_USER_DEFINED:i++;break;case G.BEGIN_MACRO_PDF417_CONTROL_BLOCK:i=G.decodeMacroBlock(e,i,d);break;case G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case G.MACRO_PDF417_TERMINATOR:throw new Q;default:i--,i=G.textCompaction(e,i,s);break}if(i<e.length)o=e[i++];else throw Q.getFormatInstance()}if(s.length()===0)throw Q.getFormatInstance();let x=new we(null,s.toString(),null,t);return x.setOther(d),x}static decodeMacroBlock(e,t,s){if(t+G.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw Q.getFormatInstance();let n=new Int32Array(G.NUMBER_OF_SEQUENCE_CODEWORDS);for(let d=0;d<G.NUMBER_OF_SEQUENCE_CODEWORDS;d++,t++)n[d]=e[t];s.setSegmentIndex(M.parseInt(G.decodeBase900toBase10(n,G.NUMBER_OF_SEQUENCE_CODEWORDS)));let i=new q;t=G.textCompaction(e,t,i),s.setFileId(i.toString());let o=-1;for(e[t]===G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(o=t+1);t<e[0];)switch(e[t]){case G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t++,e[t]){case G.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let d=new q;t=G.textCompaction(e,t+1,d),s.setFileName(d.toString());break;case G.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let x=new q;t=G.textCompaction(e,t+1,x),s.setSender(x.toString());break;case G.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let m=new q;t=G.textCompaction(e,t+1,m),s.setAddressee(m.toString());break;case G.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let b=new q;t=G.numericCompaction(e,t+1,b),s.setSegmentCount(M.parseInt(b.toString()));break;case G.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let E=new q;t=G.numericCompaction(e,t+1,E),s.setTimestamp(Ci.parseLong(E.toString()));break;case G.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let A=new q;t=G.numericCompaction(e,t+1,A),s.setChecksum(M.parseInt(A.toString()));break;case G.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let k=new q;t=G.numericCompaction(e,t+1,k),s.setFileSize(Ci.parseLong(k.toString()));break;default:throw Q.getFormatInstance()}break;case G.MACRO_PDF417_TERMINATOR:t++,s.setLastSegment(!0);break;default:throw Q.getFormatInstance()}if(o!==-1){let d=t-o;s.isLastSegment()&&d--,s.setOptionalData(I.copyOfRange(e,o,o+d))}return t}static textCompaction(e,t,s){let n=new Int32Array((e[0]-t)*2),i=new Int32Array((e[0]-t)*2),o=0,d=!1;for(;t<e[0]&&!d;){let x=e[t++];if(x<G.TEXT_COMPACTION_MODE_LATCH)n[o]=x/30,n[o+1]=x%30,o+=2;else switch(x){case G.TEXT_COMPACTION_MODE_LATCH:n[o++]=G.TEXT_COMPACTION_MODE_LATCH;break;case G.BYTE_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH_6:case G.NUMERIC_COMPACTION_MODE_LATCH:case G.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case G.MACRO_PDF417_TERMINATOR:t--,d=!0;break;case G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n[o]=G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,x=e[t++],i[o]=x,o++;break}}return G.decodeTextCompaction(n,i,o,s),t}static decodeTextCompaction(e,t,s,n){let i=qe.ALPHA,o=qe.ALPHA,d=0;for(;d<s;){let x=e[d],m="";switch(i){case qe.ALPHA:if(x<26)m=String.fromCharCode(65+x);else switch(x){case 26:m=" ";break;case G.LL:i=qe.LOWER;break;case G.ML:i=qe.MIXED;break;case G.PS:o=i,i=qe.PUNCT_SHIFT;break;case G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[d]);break;case G.TEXT_COMPACTION_MODE_LATCH:i=qe.ALPHA;break}break;case qe.LOWER:if(x<26)m=String.fromCharCode(97+x);else switch(x){case 26:m=" ";break;case G.AS:o=i,i=qe.ALPHA_SHIFT;break;case G.ML:i=qe.MIXED;break;case G.PS:o=i,i=qe.PUNCT_SHIFT;break;case G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[d]);break;case G.TEXT_COMPACTION_MODE_LATCH:i=qe.ALPHA;break}break;case qe.MIXED:if(x<G.PL)m=G.MIXED_CHARS[x];else switch(x){case G.PL:i=qe.PUNCT;break;case 26:m=" ";break;case G.LL:i=qe.LOWER;break;case G.AL:i=qe.ALPHA;break;case G.PS:o=i,i=qe.PUNCT_SHIFT;break;case G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[d]);break;case G.TEXT_COMPACTION_MODE_LATCH:i=qe.ALPHA;break}break;case qe.PUNCT:if(x<G.PAL)m=G.PUNCT_CHARS[x];else switch(x){case G.PAL:i=qe.ALPHA;break;case G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[d]);break;case G.TEXT_COMPACTION_MODE_LATCH:i=qe.ALPHA;break}break;case qe.ALPHA_SHIFT:if(i=o,x<26)m=String.fromCharCode(65+x);else switch(x){case 26:m=" ";break;case G.TEXT_COMPACTION_MODE_LATCH:i=qe.ALPHA;break}break;case qe.PUNCT_SHIFT:if(i=o,x<G.PAL)m=G.PUNCT_CHARS[x];else switch(x){case G.PAL:i=qe.ALPHA;break;case G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[d]);break;case G.TEXT_COMPACTION_MODE_LATCH:i=qe.ALPHA;break}break}m!==""&&n.append(m),d++}}static byteCompaction(e,t,s,n,i){let o=new Do,d=0,x=0,m=!1;switch(e){case G.BYTE_COMPACTION_MODE_LATCH:let b=new Int32Array(6),E=t[n++];for(;n<t[0]&&!m;)switch(b[d++]=E,x=900*x+E,E=t[n++],E){case G.TEXT_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH:case G.NUMERIC_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH_6:case G.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case G.MACRO_PDF417_TERMINATOR:n--,m=!0;break;default:if(d%5===0&&d>0){for(let A=0;A<6;++A)o.write(Number(Mr(x)>>Mr(8*(5-A))));x=0,d=0}break}n===t[0]&&E<G.TEXT_COMPACTION_MODE_LATCH&&(b[d++]=E);for(let A=0;A<d;A++)o.write(b[A]);break;case G.BYTE_COMPACTION_MODE_LATCH_6:for(;n<t[0]&&!m;){let A=t[n++];if(A<G.TEXT_COMPACTION_MODE_LATCH)d++,x=900*x+A;else switch(A){case G.TEXT_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH:case G.NUMERIC_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH_6:case G.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case G.MACRO_PDF417_TERMINATOR:n--,m=!0;break}if(d%5===0&&d>0){for(let k=0;k<6;++k)o.write(Number(Mr(x)>>Mr(8*(5-k))));x=0,d=0}}break}return i.append(Z.decode(o.toByteArray(),s)),n}static numericCompaction(e,t,s){let n=0,i=!1,o=new Int32Array(G.MAX_NUMERIC_CODEWORDS);for(;t<e[0]&&!i;){let d=e[t++];if(t===e[0]&&(i=!0),d<G.TEXT_COMPACTION_MODE_LATCH)o[n]=d,n++;else switch(d){case G.TEXT_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH_6:case G.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case G.MACRO_PDF417_TERMINATOR:t--,i=!0;break}(n%G.MAX_NUMERIC_CODEWORDS===0||d===G.NUMERIC_COMPACTION_MODE_LATCH||i)&&n>0&&(s.append(G.decodeBase900toBase10(o,n)),n=0)}return t}static decodeBase900toBase10(e,t){let s=Mr(0);for(let i=0;i<t;i++)s+=G.EXP900[t-i-1]*Mr(e[i]);let n=s.toString();if(n.charAt(0)!=="1")throw new Q;return n.substring(1)}}G.TEXT_COMPACTION_MODE_LATCH=900,G.BYTE_COMPACTION_MODE_LATCH=901,G.NUMERIC_COMPACTION_MODE_LATCH=902,G.BYTE_COMPACTION_MODE_LATCH_6=924,G.ECI_USER_DEFINED=925,G.ECI_GENERAL_PURPOSE=926,G.ECI_CHARSET=927,G.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,G.MACRO_PDF417_TERMINATOR=922,G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,G.MAX_NUMERIC_CODEWORDS=15,G.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,G.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,G.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,G.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,G.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,G.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,G.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,G.PL=25,G.LL=27,G.AS=27,G.ML=28,G.AL=28,G.PS=29,G.PAL=29,G.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,G.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",G.EXP900=Ai()?Oo():[],G.NUMBER_OF_SEQUENCE_CODEWORDS=2;class _e{constructor(){}static decode(e,t,s,n,i,o,d){let x=new Xr(e,t,s,n,i),m=null,b=null,E;for(let R=!0;;R=!1){if(t!=null&&(m=_e.getRowIndicatorColumn(e,x,t,!0,o,d)),n!=null&&(b=_e.getRowIndicatorColumn(e,x,n,!1,o,d)),E=_e.merge(m,b),E==null)throw F.getNotFoundInstance();let B=E.getBoundingBox();if(R&&B!=null&&(B.getMinY()<x.getMinY()||B.getMaxY()>x.getMaxY()))x=B;else break}E.setBoundingBox(x);let A=E.getBarcodeColumnCount()+1;E.setDetectionResultColumn(0,m),E.setDetectionResultColumn(A,b);let k=m!=null;for(let R=1;R<=A;R++){let B=k?R:A-R;if(E.getDetectionResultColumn(B)!==void 0)continue;let U;B===0||B===A?U=new vi(x,B===0):U=new Cs(x),E.setDetectionResultColumn(B,U);let W=-1,re=W;for(let se=x.getMinY();se<=x.getMaxY();se++){if(W=_e.getStartColumn(E,B,se,k),W<0||W>x.getMaxX()){if(re===-1)continue;W=re}let ee=_e.detectCodeword(e,x.getMinX(),x.getMaxX(),k,W,se,o,d);ee!=null&&(U.setCodeword(se,ee),re=W,o=Math.min(o,ee.getWidth()),d=Math.max(d,ee.getWidth()))}}return _e.createDecoderResult(E)}static merge(e,t){if(e==null&&t==null)return null;let s=_e.getBarcodeMetadata(e,t);if(s==null)return null;let n=Xr.merge(_e.adjustBoundingBox(e),_e.adjustBoundingBox(t));return new As(s,n)}static adjustBoundingBox(e){if(e==null)return null;let t=e.getRowHeights();if(t==null)return null;let s=_e.getMax(t),n=0;for(let d of t)if(n+=s-d,d>0)break;let i=e.getCodewords();for(let d=0;n>0&&i[d]==null;d++)n--;let o=0;for(let d=t.length-1;d>=0&&(o+=s-t[d],!(t[d]>0));d--);for(let d=i.length-1;o>0&&i[d]==null;d--)o--;return e.getBoundingBox().addMissingRows(n,o,e.isLeft())}static getMax(e){let t=-1;for(let s of e)t=Math.max(t,s);return t}static getBarcodeMetadata(e,t){let s;if(e==null||(s=e.getBarcodeMetadata())==null)return t==null?null:t.getBarcodeMetadata();let n;return t==null||(n=t.getBarcodeMetadata())==null?s:s.getColumnCount()!==n.getColumnCount()&&s.getErrorCorrectionLevel()!==n.getErrorCorrectionLevel()&&s.getRowCount()!==n.getRowCount()?null:s}static getRowIndicatorColumn(e,t,s,n,i,o){let d=new vi(t,n);for(let x=0;x<2;x++){let m=x===0?1:-1,b=Math.trunc(Math.trunc(s.getX()));for(let E=Math.trunc(Math.trunc(s.getY()));E<=t.getMaxY()&&E>=t.getMinY();E+=m){let A=_e.detectCodeword(e,0,e.getWidth(),n,b,E,i,o);A!=null&&(d.setCodeword(E,A),n?b=A.getStartX():b=A.getEndX())}}return d}static adjustCodewordCount(e,t){let s=t[0][1],n=s.getValue(),i=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-_e.getNumberOfECCodeWords(e.getBarcodeECLevel());if(n.length===0){if(i<1||i>Ee.MAX_CODEWORDS_IN_BARCODE)throw F.getNotFoundInstance();s.setValue(i)}else n[0]!==i&&s.setValue(i)}static createDecoderResult(e){let t=_e.createBarcodeMatrix(e);_e.adjustCodewordCount(e,t);let s=new Array,n=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),i=[],o=new Array;for(let x=0;x<e.getBarcodeRowCount();x++)for(let m=0;m<e.getBarcodeColumnCount();m++){let b=t[x][m+1].getValue(),E=x*e.getBarcodeColumnCount()+m;b.length===0?s.push(E):b.length===1?n[E]=b[0]:(o.push(E),i.push(b))}let d=new Array(i.length);for(let x=0;x<d.length;x++)d[x]=i[x];return _e.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),n,Ee.toIntArray(s),Ee.toIntArray(o),d)}static createDecoderResultFromAmbiguousValues(e,t,s,n,i){let o=new Int32Array(n.length),d=100;for(;d-- >0;){for(let x=0;x<o.length;x++)t[n[x]]=i[x][o[x]];try{return _e.decodeCodewords(t,e,s)}catch(x){if(!(x instanceof _))throw x}if(o.length===0)throw _.getChecksumInstance();for(let x=0;x<o.length;x++)if(o[x]<i[x].length-1){o[x]++;break}else if(o[x]=0,x===o.length-1)throw _.getChecksumInstance()}throw _.getChecksumInstance()}static createBarcodeMatrix(e){let t=Array.from({length:e.getBarcodeRowCount()},()=>new Array(e.getBarcodeColumnCount()+2));for(let n=0;n<t.length;n++)for(let i=0;i<t[n].length;i++)t[n][i]=new Es;let s=0;for(let n of e.getDetectionResultColumns()){if(n!=null){for(let i of n.getCodewords())if(i!=null){let o=i.getRowNumber();if(o>=0){if(o>=t.length)continue;t[o][s].setValue(i.getValue())}}}s++}return t}static isValidBarcodeColumn(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1}static getStartColumn(e,t,s,n){let i=n?1:-1,o=null;if(_e.isValidBarcodeColumn(e,t-i)&&(o=e.getDetectionResultColumn(t-i).getCodeword(s)),o!=null)return n?o.getEndX():o.getStartX();if(o=e.getDetectionResultColumn(t).getCodewordNearby(s),o!=null)return n?o.getStartX():o.getEndX();if(_e.isValidBarcodeColumn(e,t-i)&&(o=e.getDetectionResultColumn(t-i).getCodewordNearby(s)),o!=null)return n?o.getEndX():o.getStartX();let d=0;for(;_e.isValidBarcodeColumn(e,t-i);){t-=i;for(let x of e.getDetectionResultColumn(t).getCodewords())if(x!=null)return(n?x.getEndX():x.getStartX())+i*d*(x.getEndX()-x.getStartX());d++}return n?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()}static detectCodeword(e,t,s,n,i,o,d,x){i=_e.adjustCodewordStartColumn(e,t,s,n,i,o);let m=_e.getModuleBitCount(e,t,s,n,i,o);if(m==null)return null;let b,E=De.sum(m);if(n)b=i+E;else{for(let R=0;R<m.length/2;R++){let B=m[R];m[R]=m[m.length-1-R],m[m.length-1-R]=B}b=i,i=b-E}if(!_e.checkCodewordSkew(E,d,x))return null;let A=Bt.getDecodedValue(m),k=Ee.getCodeword(A);return k===-1?null:new Ss(i,b,_e.getCodewordBucketNumber(A),k)}static getModuleBitCount(e,t,s,n,i,o){let d=i,x=new Int32Array(8),m=0,b=n?1:-1,E=n;for(;(n?d<s:d>=t)&&m<x.length;)e.get(d,o)===E?(x[m]++,d+=b):(m++,E=!E);return m===x.length||d===(n?s:t)&&m===x.length-1?x:null}static getNumberOfECCodeWords(e){return 2<<e}static adjustCodewordStartColumn(e,t,s,n,i,o){let d=i,x=n?-1:1;for(let m=0;m<2;m++){for(;(n?d>=t:d<s)&&n===e.get(d,o);){if(Math.abs(i-d)>_e.CODEWORD_SKEW_SIZE)return i;d+=x}x=-x,n=!n}return d}static checkCodewordSkew(e,t,s){return t-_e.CODEWORD_SKEW_SIZE<=e&&e<=s+_e.CODEWORD_SKEW_SIZE}static decodeCodewords(e,t,s){if(e.length===0)throw Q.getFormatInstance();let n=1<<t+1,i=_e.correctErrors(e,s,n);_e.verifyCodewordCount(e,n);let o=G.decode(e,""+t);return o.setErrorsCorrected(i),o.setErasures(s.length),o}static correctErrors(e,t,s){if(t!=null&&t.length>s/2+_e.MAX_ERRORS||s<0||s>_e.MAX_EC_CODEWORDS)throw _.getChecksumInstance();return _e.errorCorrection.decode(e,s,t)}static verifyCodewordCount(e,t){if(e.length<4)throw Q.getFormatInstance();let s=e[0];if(s>e.length)throw Q.getFormatInstance();if(s===0)if(t<e.length)e[0]=e.length-t;else throw Q.getFormatInstance()}static getBitCountForCodeword(e){let t=new Int32Array(8),s=0,n=t.length-1;for(;!((e&1)!==s&&(s=e&1,n--,n<0));)t[n]++,e>>=1;return t}static getCodewordBucketNumber(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)}static getCodewordBucketNumber_number(e){return _e.getCodewordBucketNumber(_e.getBitCountForCodeword(e))}static getCodewordBucketNumber_Int32Array(e){return(e[0]-e[2]+e[4]-e[6]+9)%9}static toString(e){let t=new Ns;for(let s=0;s<e.length;s++){t.format("Row %2d: ",s);for(let n=0;n<e[s].length;n++){let i=e[s][n];i.getValue().length===0?t.format("        ",null):t.format("%4d(%2d)",i.getValue()[0],i.getConfidence(i.getValue()[0]))}t.format("%n")}return t.toString()}}_e.CODEWORD_SKEW_SIZE=2,_e.MAX_ERRORS=3,_e.MAX_EC_CODEWORDS=512,_e.errorCorrection=new wi;class Tt{decode(e,t=null){let s=Tt.decode(e,t,!1);if(s==null||s.length===0||s[0]==null)throw F.getNotFoundInstance();return s[0]}decodeMultiple(e,t=null){try{return Tt.decode(e,t,!0)}catch(s){throw s instanceof Q||s instanceof _?F.getNotFoundInstance():s}}static decode(e,t,s){const n=new Array,i=Te.detectMultiple(e,t,s);for(const o of i.getPoints()){const d=_e.decode(i.getBits(),o[4],o[5],o[6],o[7],Tt.getMinCodewordWidth(o),Tt.getMaxCodewordWidth(o)),x=new oe(d.getText(),d.getRawBytes(),void 0,o,ae.PDF_417);x.putMetadata(Ie.ERROR_CORRECTION_LEVEL,d.getECLevel());const m=d.getOther();m!=null&&x.putMetadata(Ie.PDF417_EXTRA_METADATA,m),n.push(x)}return n.map(o=>o)}static getMaxWidth(e,t){return e==null||t==null?0:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMinWidth(e,t){return e==null||t==null?M.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMaxCodewordWidth(e){return Math.floor(Math.max(Math.max(Tt.getMaxWidth(e[0],e[4]),Tt.getMaxWidth(e[6],e[2])*Ee.MODULES_IN_CODEWORD/Ee.MODULES_IN_STOP_PATTERN),Math.max(Tt.getMaxWidth(e[1],e[5]),Tt.getMaxWidth(e[7],e[3])*Ee.MODULES_IN_CODEWORD/Ee.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(e){return Math.floor(Math.min(Math.min(Tt.getMinWidth(e[0],e[4]),Tt.getMinWidth(e[6],e[2])*Ee.MODULES_IN_CODEWORD/Ee.MODULES_IN_STOP_PATTERN),Math.min(Tt.getMinWidth(e[1],e[5]),Tt.getMinWidth(e[7],e[3])*Ee.MODULES_IN_CODEWORD/Ee.MODULES_IN_STOP_PATTERN)))}reset(){}}class qs extends g{}qs.kind="ReaderException";class Si{constructor(e,t){this.verbose=e===!0,t&&this.setHints(t)}decode(e,t){return t&&this.setHints(t),this.decodeInternal(e)}decodeWithState(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)}setHints(e){this.hints=e;const t=!u(e)&&e.get(ce.TRY_HARDER)===!0,s=u(e)?null:e.get(ce.POSSIBLE_FORMATS),n=new Array;if(!u(s)){const i=s.some(o=>o===ae.UPC_A||o===ae.UPC_E||o===ae.EAN_13||o===ae.EAN_8||o===ae.CODABAR||o===ae.CODE_39||o===ae.CODE_93||o===ae.CODE_128||o===ae.ITF||o===ae.RSS_14||o===ae.RSS_EXPANDED);i&&!t&&n.push(new rs(e,this.verbose)),s.includes(ae.QR_CODE)&&n.push(new Or),s.includes(ae.DATA_MATRIX)&&n.push(new Dr),s.includes(ae.AZTEC)&&n.push(new ts),s.includes(ae.PDF_417)&&n.push(new Tt),i&&t&&n.push(new rs(e,this.verbose))}n.length===0&&(t||n.push(new rs(e,this.verbose)),n.push(new Or),n.push(new Dr),n.push(new ts),n.push(new Tt),t&&n.push(new rs(e,this.verbose))),this.readers=n}reset(){if(this.readers!==null)for(const e of this.readers)e.reset()}decodeInternal(e){if(this.readers===null)throw new qs("No readers where selected, nothing can be read.");for(const t of this.readers)try{return t.decode(e,this.hints)}catch(s){if(s instanceof qs)continue}throw new F("No MultiFormat Readers were able to detect the code.")}}class Mo extends ie{constructor(e=null,t=500){const s=new Si;s.setHints(e),super(s,t)}decodeBitmap(e){return this.reader.decodeWithState(e)}}class Ro extends ie{constructor(e=500){super(new Tt,e)}}class Lo extends ie{constructor(e=500){super(new Or,e)}}var In;(function(C){C[C.ERROR_CORRECTION=0]="ERROR_CORRECTION",C[C.CHARACTER_SET=1]="CHARACTER_SET",C[C.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",C[C.MIN_SIZE=3]="MIN_SIZE",C[C.MAX_SIZE=4]="MAX_SIZE",C[C.MARGIN=5]="MARGIN",C[C.PDF417_COMPACT=6]="PDF417_COMPACT",C[C.PDF417_COMPACTION=7]="PDF417_COMPACTION",C[C.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",C[C.AZTEC_LAYERS=9]="AZTEC_LAYERS",C[C.QR_VERSION=10]="QR_VERSION"})(In||(In={}));var vt=In;class _n{constructor(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new Ke(e,Int32Array.from([1])))}buildGenerator(e){const t=this.cachedGenerators;if(e>=t.length){let s=t[t.length-1];const n=this.field;for(let i=t.length;i<=e;i++){const o=s.multiply(new Ke(n,Int32Array.from([1,n.exp(i-1+n.getGeneratorBase())])));t.push(o),s=o}}return t[e]}encode(e,t){if(t===0)throw new N("No error correction bytes");const s=e.length-t;if(s<=0)throw new N("No data bytes provided");const n=this.buildGenerator(t),i=new Int32Array(s);D.arraycopy(e,0,i,0,s);let o=new Ke(this.field,i);o=o.multiplyByMonomial(t,1);const x=o.divide(n)[1].getCoefficients(),m=t-x.length;for(let b=0;b<m;b++)e[s+b]=0;D.arraycopy(x,0,e,s+m,x.length)}}class ut{constructor(){}static applyMaskPenaltyRule1(e){return ut.applyMaskPenaltyRule1Internal(e,!0)+ut.applyMaskPenaltyRule1Internal(e,!1)}static applyMaskPenaltyRule2(e){let t=0;const s=e.getArray(),n=e.getWidth(),i=e.getHeight();for(let o=0;o<i-1;o++){const d=s[o];for(let x=0;x<n-1;x++){const m=d[x];m===d[x+1]&&m===s[o+1][x]&&m===s[o+1][x+1]&&t++}}return ut.N2*t}static applyMaskPenaltyRule3(e){let t=0;const s=e.getArray(),n=e.getWidth(),i=e.getHeight();for(let o=0;o<i;o++)for(let d=0;d<n;d++){const x=s[o];d+6<n&&x[d]===1&&x[d+1]===0&&x[d+2]===1&&x[d+3]===1&&x[d+4]===1&&x[d+5]===0&&x[d+6]===1&&(ut.isWhiteHorizontal(x,d-4,d)||ut.isWhiteHorizontal(x,d+7,d+11))&&t++,o+6<i&&s[o][d]===1&&s[o+1][d]===0&&s[o+2][d]===1&&s[o+3][d]===1&&s[o+4][d]===1&&s[o+5][d]===0&&s[o+6][d]===1&&(ut.isWhiteVertical(s,d,o-4,o)||ut.isWhiteVertical(s,d,o+7,o+11))&&t++}return t*ut.N3}static isWhiteHorizontal(e,t,s){t=Math.max(t,0),s=Math.min(s,e.length);for(let n=t;n<s;n++)if(e[n]===1)return!1;return!0}static isWhiteVertical(e,t,s,n){s=Math.max(s,0),n=Math.min(n,e.length);for(let i=s;i<n;i++)if(e[i][t]===1)return!1;return!0}static applyMaskPenaltyRule4(e){let t=0;const s=e.getArray(),n=e.getWidth(),i=e.getHeight();for(let x=0;x<i;x++){const m=s[x];for(let b=0;b<n;b++)m[b]===1&&t++}const o=e.getHeight()*e.getWidth();return Math.floor(Math.abs(t*2-o)*10/o)*ut.N4}static getDataMaskBit(e,t,s){let n,i;switch(e){case 0:n=s+t&1;break;case 1:n=s&1;break;case 2:n=t%3;break;case 3:n=(s+t)%3;break;case 4:n=Math.floor(s/2)+Math.floor(t/3)&1;break;case 5:i=s*t,n=(i&1)+i%3;break;case 6:i=s*t,n=(i&1)+i%3&1;break;case 7:i=s*t,n=i%3+(s+t&1)&1;break;default:throw new N("Invalid mask pattern: "+e)}return n===0}static applyMaskPenaltyRule1Internal(e,t){let s=0;const n=t?e.getHeight():e.getWidth(),i=t?e.getWidth():e.getHeight(),o=e.getArray();for(let d=0;d<n;d++){let x=0,m=-1;for(let b=0;b<i;b++){const E=t?o[d][b]:o[b][d];E===m?x++:(x>=5&&(s+=ut.N1+(x-5)),x=1,m=E)}x>=5&&(s+=ut.N1+(x-5))}return s}}ut.N1=3,ut.N2=3,ut.N3=40,ut.N4=10;class Zs{constructor(e,t){this.width=e,this.height=t;const s=new Array(t);for(let n=0;n!==t;n++)s[n]=new Uint8Array(e);this.bytes=s}getHeight(){return this.height}getWidth(){return this.width}get(e,t){return this.bytes[t][e]}getArray(){return this.bytes}setNumber(e,t,s){this.bytes[t][e]=s}setBoolean(e,t,s){this.bytes[t][e]=s?1:0}clear(e){for(const t of this.bytes)I.fill(t,e)}equals(e){if(!(e instanceof Zs))return!1;const t=e;if(this.width!==t.width||this.height!==t.height)return!1;for(let s=0,n=this.height;s<n;++s){const i=this.bytes[s],o=t.bytes[s];for(let d=0,x=this.width;d<x;++d)if(i[d]!==o[d])return!1}return!0}toString(){const e=new q;for(let t=0,s=this.height;t<s;++t){const n=this.bytes[t];for(let i=0,o=this.width;i<o;++i)switch(n[i]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()}}class qr{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const e=new q;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()}setMode(e){this.mode=e}setECLevel(e){this.ecLevel=e}setVersion(e){this.version=e}setMaskPattern(e){this.maskPattern=e}setMatrix(e){this.matrix=e}static isValidMaskPattern(e){return e>=0&&e<qr.NUM_MASK_PATTERNS}}qr.NUM_MASK_PATTERNS=8;class Ze extends g{}Ze.kind="WriterException";class Ne{constructor(){}static clearMatrix(e){e.clear(255)}static buildMatrix(e,t,s,n,i){Ne.clearMatrix(i),Ne.embedBasicPatterns(s,i),Ne.embedTypeInfo(t,n,i),Ne.maybeEmbedVersionInfo(s,i),Ne.embedDataBits(e,n,i)}static embedBasicPatterns(e,t){Ne.embedPositionDetectionPatternsAndSeparators(t),Ne.embedDarkDotAtLeftBottomCorner(t),Ne.maybeEmbedPositionAdjustmentPatterns(e,t),Ne.embedTimingPatterns(t)}static embedTypeInfo(e,t,s){const n=new z;Ne.makeTypeInfoBits(e,t,n);for(let i=0,o=n.getSize();i<o;++i){const d=n.get(n.getSize()-1-i),x=Ne.TYPE_INFO_COORDINATES[i],m=x[0],b=x[1];if(s.setBoolean(m,b,d),i<8){const E=s.getWidth()-i-1;s.setBoolean(E,8,d)}else{const A=s.getHeight()-7+(i-8);s.setBoolean(8,A,d)}}}static maybeEmbedVersionInfo(e,t){if(e.getVersionNumber()<7)return;const s=new z;Ne.makeVersionInfoBits(e,s);let n=6*3-1;for(let i=0;i<6;++i)for(let o=0;o<3;++o){const d=s.get(n);n--,t.setBoolean(i,t.getHeight()-11+o,d),t.setBoolean(t.getHeight()-11+o,i,d)}}static embedDataBits(e,t,s){let n=0,i=-1,o=s.getWidth()-1,d=s.getHeight()-1;for(;o>0;){for(o===6&&(o-=1);d>=0&&d<s.getHeight();){for(let x=0;x<2;++x){const m=o-x;if(!Ne.isEmpty(s.get(m,d)))continue;let b;n<e.getSize()?(b=e.get(n),++n):b=!1,t!==255&&ut.getDataMaskBit(t,m,d)&&(b=!b),s.setBoolean(m,d,b)}d+=i}i=-i,d+=i,o-=2}if(n!==e.getSize())throw new Ze("Not all bits consumed: "+n+"/"+e.getSize())}static findMSBSet(e){return 32-M.numberOfLeadingZeros(e)}static calculateBCHCode(e,t){if(t===0)throw new N("0 polynomial");const s=Ne.findMSBSet(t);for(e<<=s-1;Ne.findMSBSet(e)>=s;)e^=t<<Ne.findMSBSet(e)-s;return e}static makeTypeInfoBits(e,t,s){if(!qr.isValidMaskPattern(t))throw new Ze("Invalid mask pattern");const n=e.getBits()<<3|t;s.appendBits(n,5);const i=Ne.calculateBCHCode(n,Ne.TYPE_INFO_POLY);s.appendBits(i,10);const o=new z;if(o.appendBits(Ne.TYPE_INFO_MASK_PATTERN,15),s.xor(o),s.getSize()!==15)throw new Ze("should not happen but we got: "+s.getSize())}static makeVersionInfoBits(e,t){t.appendBits(e.getVersionNumber(),6);const s=Ne.calculateBCHCode(e.getVersionNumber(),Ne.VERSION_INFO_POLY);if(t.appendBits(s,12),t.getSize()!==18)throw new Ze("should not happen but we got: "+t.getSize())}static isEmpty(e){return e===255}static embedTimingPatterns(e){for(let t=8;t<e.getWidth()-8;++t){const s=(t+1)%2;Ne.isEmpty(e.get(t,6))&&e.setNumber(t,6,s),Ne.isEmpty(e.get(6,t))&&e.setNumber(6,t,s)}}static embedDarkDotAtLeftBottomCorner(e){if(e.get(8,e.getHeight()-8)===0)throw new Ze;e.setNumber(8,e.getHeight()-8,1)}static embedHorizontalSeparationPattern(e,t,s){for(let n=0;n<8;++n){if(!Ne.isEmpty(s.get(e+n,t)))throw new Ze;s.setNumber(e+n,t,0)}}static embedVerticalSeparationPattern(e,t,s){for(let n=0;n<7;++n){if(!Ne.isEmpty(s.get(e,t+n)))throw new Ze;s.setNumber(e,t+n,0)}}static embedPositionAdjustmentPattern(e,t,s){for(let n=0;n<5;++n){const i=Ne.POSITION_ADJUSTMENT_PATTERN[n];for(let o=0;o<5;++o)s.setNumber(e+o,t+n,i[o])}}static embedPositionDetectionPattern(e,t,s){for(let n=0;n<7;++n){const i=Ne.POSITION_DETECTION_PATTERN[n];for(let o=0;o<7;++o)s.setNumber(e+o,t+n,i[o])}}static embedPositionDetectionPatternsAndSeparators(e){const t=Ne.POSITION_DETECTION_PATTERN[0].length;Ne.embedPositionDetectionPattern(0,0,e),Ne.embedPositionDetectionPattern(e.getWidth()-t,0,e),Ne.embedPositionDetectionPattern(0,e.getWidth()-t,e);const s=8;Ne.embedHorizontalSeparationPattern(0,s-1,e),Ne.embedHorizontalSeparationPattern(e.getWidth()-s,s-1,e),Ne.embedHorizontalSeparationPattern(0,e.getWidth()-s,e);const n=7;Ne.embedVerticalSeparationPattern(n,0,e),Ne.embedVerticalSeparationPattern(e.getHeight()-n-1,0,e),Ne.embedVerticalSeparationPattern(n,e.getHeight()-n,e)}static maybeEmbedPositionAdjustmentPatterns(e,t){if(e.getVersionNumber()<2)return;const s=e.getVersionNumber()-1,n=Ne.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[s];for(let i=0,o=n.length;i!==o;i++){const d=n[i];if(d>=0)for(let x=0;x!==o;x++){const m=n[x];m>=0&&Ne.isEmpty(t.get(m,d))&&Ne.embedPositionAdjustmentPattern(m-2,d-2,t)}}}}Ne.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Ne.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Ne.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Ne.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Ne.VERSION_INFO_POLY=7973,Ne.TYPE_INFO_POLY=1335,Ne.TYPE_INFO_MASK_PATTERN=21522;class Po{constructor(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class rt{constructor(){}static calculateMaskPenalty(e){return ut.applyMaskPenaltyRule1(e)+ut.applyMaskPenaltyRule2(e)+ut.applyMaskPenaltyRule3(e)+ut.applyMaskPenaltyRule4(e)}static encode(e,t,s=null){let n=rt.DEFAULT_BYTE_MODE_ENCODING;const i=s!==null&&s.get(vt.CHARACTER_SET)!==void 0;i&&(n=s.get(vt.CHARACTER_SET).toString());const o=this.chooseMode(e,n),d=new z;if(o===ve.BYTE&&(i||rt.DEFAULT_BYTE_MODE_ENCODING!==n)){const se=J.getCharacterSetECIByName(n);se!==void 0&&this.appendECI(se,d)}this.appendModeInfo(o,d);const x=new z;this.appendBytes(e,o,x,n);let m;if(s!==null&&s.get(vt.QR_VERSION)!==void 0){const se=Number.parseInt(s.get(vt.QR_VERSION).toString(),10);m=be.getVersionForNumber(se);const ee=this.calculateBitsNeeded(o,d,x,m);if(!this.willFit(ee,m,t))throw new Ze("Data too big for requested version")}else m=this.recommendVersion(t,o,d,x);const b=new z;b.appendBitArray(d);const E=o===ve.BYTE?x.getSizeInBytes():e.length;this.appendLengthInfo(E,m,o,b),b.appendBitArray(x);const A=m.getECBlocksForLevel(t),k=m.getTotalCodewords()-A.getTotalECCodewords();this.terminateBits(k,b);const R=this.interleaveWithECBytes(b,m.getTotalCodewords(),k,A.getNumBlocks()),B=new qr;B.setECLevel(t),B.setMode(o),B.setVersion(m);const U=m.getDimensionForVersion(),W=new Zs(U,U),re=this.chooseMaskPattern(R,t,m,W);return B.setMaskPattern(re),Ne.buildMatrix(R,t,m,re,W),B.setMatrix(W),B}static recommendVersion(e,t,s,n){const i=this.calculateBitsNeeded(t,s,n,be.getVersionForNumber(1)),o=this.chooseVersion(i,e),d=this.calculateBitsNeeded(t,s,n,o);return this.chooseVersion(d,e)}static calculateBitsNeeded(e,t,s,n){return t.getSize()+e.getCharacterCountBits(n)+s.getSize()}static getAlphanumericCode(e){return e<rt.ALPHANUMERIC_TABLE.length?rt.ALPHANUMERIC_TABLE[e]:-1}static chooseMode(e,t=null){if(J.SJIS.getName()===t&&this.isOnlyDoubleByteKanji(e))return ve.KANJI;let s=!1,n=!1;for(let i=0,o=e.length;i<o;++i){const d=e.charAt(i);if(rt.isDigit(d))s=!0;else if(this.getAlphanumericCode(d.charCodeAt(0))!==-1)n=!0;else return ve.BYTE}return n?ve.ALPHANUMERIC:s?ve.NUMERIC:ve.BYTE}static isOnlyDoubleByteKanji(e){let t;try{t=Z.encode(e,J.SJIS)}catch{return!1}const s=t.length;if(s%2!==0)return!1;for(let n=0;n<s;n+=2){const i=t[n]&255;if((i<129||i>159)&&(i<224||i>235))return!1}return!0}static chooseMaskPattern(e,t,s,n){let i=Number.MAX_SAFE_INTEGER,o=-1;for(let d=0;d<qr.NUM_MASK_PATTERNS;d++){Ne.buildMatrix(e,t,s,d,n);let x=this.calculateMaskPenalty(n);x<i&&(i=x,o=d)}return o}static chooseVersion(e,t){for(let s=1;s<=40;s++){const n=be.getVersionForNumber(s);if(rt.willFit(e,n,t))return n}throw new Ze("Data too big")}static willFit(e,t,s){const n=t.getTotalCodewords(),o=t.getECBlocksForLevel(s).getTotalECCodewords(),d=n-o,x=(e+7)/8;return d>=x}static terminateBits(e,t){const s=e*8;if(t.getSize()>s)throw new Ze("data bits cannot fit in the QR Code"+t.getSize()+" > "+s);for(let o=0;o<4&&t.getSize()<s;++o)t.appendBit(!1);const n=t.getSize()&7;if(n>0)for(let o=n;o<8;o++)t.appendBit(!1);const i=e-t.getSizeInBytes();for(let o=0;o<i;++o)t.appendBits(o&1?17:236,8);if(t.getSize()!==s)throw new Ze("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(e,t,s,n,i,o){if(n>=s)throw new Ze("Block ID too large");const d=e%s,x=s-d,m=Math.floor(e/s),b=m+1,E=Math.floor(t/s),A=E+1,k=m-E,R=b-A;if(k!==R)throw new Ze("EC bytes mismatch");if(s!==x+d)throw new Ze("RS blocks mismatch");if(e!==(E+k)*x+(A+R)*d)throw new Ze("Total bytes mismatch");n<x?(i[0]=E,o[0]=k):(i[0]=A,o[0]=R)}static interleaveWithECBytes(e,t,s,n){if(e.getSizeInBytes()!==s)throw new Ze("Number of bits and data bytes does not match");let i=0,o=0,d=0;const x=new Array;for(let b=0;b<n;++b){const E=new Int32Array(1),A=new Int32Array(1);rt.getNumDataBytesAndNumECBytesForBlockID(t,s,n,b,E,A);const k=E[0],R=new Uint8Array(k);e.toBytes(8*i,R,0,k);const B=rt.generateECBytes(R,A[0]);x.push(new Po(R,B)),o=Math.max(o,k),d=Math.max(d,B.length),i+=E[0]}if(s!==i)throw new Ze("Data bytes does not match offset");const m=new z;for(let b=0;b<o;++b)for(const E of x){const A=E.getDataBytes();b<A.length&&m.appendBits(A[b],8)}for(let b=0;b<d;++b)for(const E of x){const A=E.getErrorCorrectionBytes();b<A.length&&m.appendBits(A[b],8)}if(t!==m.getSizeInBytes())throw new Ze("Interleaving error: "+t+" and "+m.getSizeInBytes()+" differ.");return m}static generateECBytes(e,t){const s=e.length,n=new Int32Array(s+t);for(let o=0;o<s;o++)n[o]=e[o]&255;new _n(ke.QR_CODE_FIELD_256).encode(n,t);const i=new Uint8Array(t);for(let o=0;o<t;o++)i[o]=n[s+o];return i}static appendModeInfo(e,t){t.appendBits(e.getBits(),4)}static appendLengthInfo(e,t,s,n){const i=s.getCharacterCountBits(t);if(e>=1<<i)throw new Ze(e+" is bigger than "+((1<<i)-1));n.appendBits(e,i)}static appendBytes(e,t,s,n){switch(t){case ve.NUMERIC:rt.appendNumericBytes(e,s);break;case ve.ALPHANUMERIC:rt.appendAlphanumericBytes(e,s);break;case ve.BYTE:rt.append8BitBytes(e,s,n);break;case ve.KANJI:rt.appendKanjiBytes(e,s);break;default:throw new Ze("Invalid mode: "+t)}}static getDigit(e){return e.charCodeAt(0)-48}static isDigit(e){const t=rt.getDigit(e);return t>=0&&t<=9}static appendNumericBytes(e,t){const s=e.length;let n=0;for(;n<s;){const i=rt.getDigit(e.charAt(n));if(n+2<s){const o=rt.getDigit(e.charAt(n+1)),d=rt.getDigit(e.charAt(n+2));t.appendBits(i*100+o*10+d,10),n+=3}else if(n+1<s){const o=rt.getDigit(e.charAt(n+1));t.appendBits(i*10+o,7),n+=2}else t.appendBits(i,4),n++}}static appendAlphanumericBytes(e,t){const s=e.length;let n=0;for(;n<s;){const i=rt.getAlphanumericCode(e.charCodeAt(n));if(i===-1)throw new Ze;if(n+1<s){const o=rt.getAlphanumericCode(e.charCodeAt(n+1));if(o===-1)throw new Ze;t.appendBits(i*45+o,11),n+=2}else t.appendBits(i,6),n++}}static append8BitBytes(e,t,s){let n;try{n=Z.encode(e,s)}catch(i){throw new Ze(i)}for(let i=0,o=n.length;i!==o;i++){const d=n[i];t.appendBits(d,8)}}static appendKanjiBytes(e,t){let s;try{s=Z.encode(e,J.SJIS)}catch(i){throw new Ze(i)}const n=s.length;for(let i=0;i<n;i+=2){const o=s[i]&255,d=s[i+1]&255,x=o<<8&4294967295|d;let m=-1;if(x>=33088&&x<=40956?m=x-33088:x>=57408&&x<=60351&&(m=x-49472),m===-1)throw new Ze("Invalid byte sequence");const b=(m>>8)*192+(m&255);t.appendBits(b,13)}}static appendECI(e,t){t.appendBits(ve.ECI.getBits(),4),t.appendBits(e.getValue(),8)}}rt.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),rt.DEFAULT_BYTE_MODE_ENCODING=J.UTF8.getName();class Zr{write(e,t,s,n=null){if(e.length===0)throw new N("Found empty contents");if(t<0||s<0)throw new N("Requested dimensions are too small: "+t+"x"+s);let i=et.L,o=Zr.QUIET_ZONE_SIZE;n!==null&&(n.get(vt.ERROR_CORRECTION)!==void 0&&(i=et.fromString(n.get(vt.ERROR_CORRECTION).toString())),n.get(vt.MARGIN)!==void 0&&(o=Number.parseInt(n.get(vt.MARGIN).toString(),10)));const d=rt.encode(e,i,n);return this.renderResult(d,t,s,o)}writeToDom(e,t,s,n,i=null){typeof e=="string"&&(e=document.querySelector(e));const o=this.write(t,s,n,i);e&&e.appendChild(o)}renderResult(e,t,s,n){const i=e.getMatrix();if(i===null)throw new Xe;const o=i.getWidth(),d=i.getHeight(),x=o+n*2,m=d+n*2,b=Math.max(t,x),E=Math.max(s,m),A=Math.min(Math.floor(b/x),Math.floor(E/m)),k=Math.floor((b-o*A)/2),R=Math.floor((E-d*A)/2),B=this.createSVGElement(b,E);for(let U=0,W=R;U<d;U++,W+=A)for(let re=0,se=k;re<o;re++,se+=A)if(i.get(re,U)===1){const ee=this.createSvgRectElement(se,W,A,A);B.appendChild(ee)}return B}createSVGElement(e,t){const s=document.createElementNS(Zr.SVG_NS,"svg");return s.setAttributeNS(null,"height",e.toString()),s.setAttributeNS(null,"width",t.toString()),s}createSvgRectElement(e,t,s,n){const i=document.createElementNS(Zr.SVG_NS,"rect");return i.setAttributeNS(null,"x",e.toString()),i.setAttributeNS(null,"y",t.toString()),i.setAttributeNS(null,"height",s.toString()),i.setAttributeNS(null,"width",n.toString()),i.setAttributeNS(null,"fill","#000000"),i}}Zr.QUIET_ZONE_SIZE=4,Zr.SVG_NS="http://www.w3.org/2000/svg";class ns{encode(e,t,s,n,i){if(e.length===0)throw new N("Found empty contents");if(t!==ae.QR_CODE)throw new N("Can only encode QR_CODE, but got "+t);if(s<0||n<0)throw new N(`Requested dimensions are too small: ${s}x${n}`);let o=et.L,d=ns.QUIET_ZONE_SIZE;i!==null&&(i.get(vt.ERROR_CORRECTION)!==void 0&&(o=et.fromString(i.get(vt.ERROR_CORRECTION).toString())),i.get(vt.MARGIN)!==void 0&&(d=Number.parseInt(i.get(vt.MARGIN).toString(),10)));const x=rt.encode(e,o,i);return ns.renderResult(x,s,n,d)}static renderResult(e,t,s,n){const i=e.getMatrix();if(i===null)throw new Xe;const o=i.getWidth(),d=i.getHeight(),x=o+n*2,m=d+n*2,b=Math.max(t,x),E=Math.max(s,m),A=Math.min(Math.floor(b/x),Math.floor(E/m)),k=Math.floor((b-o*A)/2),R=Math.floor((E-d*A)/2),B=new he(b,E);for(let U=0,W=R;U<d;U++,W+=A)for(let re=0,se=k;re<o;re++,se+=A)i.get(re,U)===1&&B.setRegion(se,W,A,A);return B}}ns.QUIET_ZONE_SIZE=4;class Bo{encode(e,t,s,n,i){let o;switch(t){case ae.QR_CODE:o=new ns;break;default:throw new N("No encoder available for format "+t)}return o.encode(e,t,s,n,i)}}class fr extends at{constructor(e,t,s,n,i,o,d,x){if(super(o,d),this.yuvData=e,this.dataWidth=t,this.dataHeight=s,this.left=n,this.top=i,n+o>t||i+d>s)throw new N("Crop rectangle does not fit within image data.");x&&this.reverseHorizontal(o,d)}getRow(e,t){if(e<0||e>=this.getHeight())throw new N("Requested row is outside the image: "+e);const s=this.getWidth();(t==null||t.length<s)&&(t=new Uint8ClampedArray(s));const n=(e+this.top)*this.dataWidth+this.left;return D.arraycopy(this.yuvData,n,t,0,s),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.yuvData;const s=e*t,n=new Uint8ClampedArray(s);let i=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return D.arraycopy(this.yuvData,i,n,0,s),n;for(let o=0;o<t;o++){const d=o*e;D.arraycopy(this.yuvData,i,n,d,e),i+=this.dataWidth}return n}isCropSupported(){return!0}crop(e,t,s,n){return new fr(this.yuvData,this.dataWidth,this.dataHeight,this.left+e,this.top+t,s,n,!1)}renderThumbnail(){const e=this.getWidth()/fr.THUMBNAIL_SCALE_FACTOR,t=this.getHeight()/fr.THUMBNAIL_SCALE_FACTOR,s=new Int32Array(e*t),n=this.yuvData;let i=this.top*this.dataWidth+this.left;for(let o=0;o<t;o++){const d=o*e;for(let x=0;x<e;x++){const m=n[i+x*fr.THUMBNAIL_SCALE_FACTOR]&255;s[d+x]=4278190080|m*65793}i+=this.dataWidth*fr.THUMBNAIL_SCALE_FACTOR}return s}getThumbnailWidth(){return this.getWidth()/fr.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/fr.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(e,t){const s=this.yuvData;for(let n=0,i=this.top*this.dataWidth+this.left;n<t;n++,i+=this.dataWidth){const o=i+e/2;for(let d=i,x=i+e-1;d<o;d++,x--){const m=s[d];s[d]=s[x],s[x]=m}}}invert(){return new X(this)}}fr.THUMBNAIL_SCALE_FACTOR=2;class kn extends at{constructor(e,t,s,n,i,o,d){if(super(t,s),this.dataWidth=n,this.dataHeight=i,this.left=o,this.top=d,e.BYTES_PER_ELEMENT===4){const x=t*s,m=new Uint8ClampedArray(x);for(let b=0;b<x;b++){const E=e[b],A=E>>16&255,k=E>>7&510,R=E&255;m[b]=(A+k+R)/4&255}this.luminances=m}else this.luminances=e;if(n===void 0&&(this.dataWidth=t),i===void 0&&(this.dataHeight=s),o===void 0&&(this.left=0),d===void 0&&(this.top=0),this.left+t>this.dataWidth||this.top+s>this.dataHeight)throw new N("Crop rectangle does not fit within image data.")}getRow(e,t){if(e<0||e>=this.getHeight())throw new N("Requested row is outside the image: "+e);const s=this.getWidth();(t==null||t.length<s)&&(t=new Uint8ClampedArray(s));const n=(e+this.top)*this.dataWidth+this.left;return D.arraycopy(this.luminances,n,t,0,s),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.luminances;const s=e*t,n=new Uint8ClampedArray(s);let i=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return D.arraycopy(this.luminances,i,n,0,s),n;for(let o=0;o<t;o++){const d=o*e;D.arraycopy(this.luminances,i,n,d,e),i+=this.dataWidth}return n}isCropSupported(){return!0}crop(e,t,s,n){return new kn(this.luminances,s,n,this.dataWidth,this.dataHeight,this.left+e,this.top+t)}invert(){return new X(this)}}class ji extends J{static forName(e){return this.getCharacterSetECIByName(e)}}class Dn{}Dn.ISO_8859_1=J.ISO8859_1;class Ti{isCompact(){return this.compact}setCompact(e){this.compact=e}getSize(){return this.size}setSize(e){this.size=e}getLayers(){return this.layers}setLayers(e){this.layers=e}getCodeWords(){return this.codeWords}setCodeWords(e){this.codeWords=e}getMatrix(){return this.matrix}setMatrix(e){this.matrix=e}}class Ii{static singletonList(e){return[e]}static min(e,t){return e.sort(t)[0]}}class Fo{constructor(e){this.previous=e}getPrevious(){return this.previous}}class is extends Fo{constructor(e,t,s){super(e),this.value=t,this.bitCount=s}appendTo(e,t){e.appendBits(this.value,this.bitCount)}add(e,t){return new is(this,e,t)}addBinaryShift(e,t){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new is(this,e,t)}toString(){let e=this.value&(1<<this.bitCount)-1;return e|=1<<this.bitCount,"<"+M.toBinaryString(e|1<<this.bitCount).substring(1)+">"}}class On extends is{constructor(e,t,s){super(e,0,0),this.binaryShiftStart=t,this.binaryShiftByteCount=s}appendTo(e,t){for(let s=0;s<this.binaryShiftByteCount;s++)(s===0||s===31&&this.binaryShiftByteCount<=62)&&(e.appendBits(31,5),this.binaryShiftByteCount>62?e.appendBits(this.binaryShiftByteCount-31,16):s===0?e.appendBits(Math.min(this.binaryShiftByteCount,31),5):e.appendBits(this.binaryShiftByteCount-31,5)),e.appendBits(t[this.binaryShiftStart+s],8)}addBinaryShift(e,t){return new On(this,e,t)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function Uo(C,e,t){return new On(C,e,t)}function js(C,e,t){return new is(C,e,t)}const Vo=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Rr=0,$s=1,$t=2,_i=3,xr=4,Ho=new is(null,0,0),Mn=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function Go(C){for(let e of C)I.fill(e,-1);return C[Rr][xr]=0,C[$s][xr]=0,C[$s][Rr]=28,C[_i][xr]=0,C[$t][xr]=0,C[$t][Rr]=15,C}const ki=Go(I.createInt32Array(6,6));class mr{constructor(e,t,s,n){this.token=e,this.mode=t,this.binaryShiftByteCount=s,this.bitCount=n}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(e,t){let s=this.bitCount,n=this.token;if(e!==this.mode){let o=Mn[this.mode][e];n=js(n,o&65535,o>>16),s+=o>>16}let i=e===$t?4:5;return n=js(n,t,i),new mr(n,e,0,s+i)}shiftAndAppend(e,t){let s=this.token,n=this.mode===$t?4:5;return s=js(s,ki[this.mode][e],n),s=js(s,t,5),new mr(s,this.mode,0,this.bitCount+n+5)}addBinaryShiftChar(e){let t=this.token,s=this.mode,n=this.bitCount;if(this.mode===xr||this.mode===$t){let d=Mn[s][Rr];t=js(t,d&65535,d>>16),n+=d>>16,s=Rr}let i=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,o=new mr(t,s,this.binaryShiftByteCount+1,n+i);return o.binaryShiftByteCount===2078&&(o=o.endBinaryShift(e+1)),o}endBinaryShift(e){if(this.binaryShiftByteCount===0)return this;let t=this.token;return t=Uo(t,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new mr(t,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(e){let t=this.bitCount+(Mn[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?t+=mr.calculateBinaryShiftCost(e)-mr.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(t+=10),t<=e.bitCount}toBitArray(e){let t=[];for(let n=this.endBinaryShift(e.length).token;n!==null;n=n.getPrevious())t.unshift(n);let s=new z;for(const n of t)n.appendTo(s,e);return s}toString(){return H.format("%s bits=%d bytes=%d",Vo[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0}}mr.INITIAL_STATE=new mr(Ho,Rr,0,0);function zo(C){const e=H.getCharCode(" "),t=H.getCharCode("."),s=H.getCharCode(",");C[Rr][e]=1;const n=H.getCharCode("Z"),i=H.getCharCode("A");for(let A=i;A<=n;A++)C[Rr][A]=A-i+2;C[$s][e]=1;const o=H.getCharCode("z"),d=H.getCharCode("a");for(let A=d;A<=o;A++)C[$s][A]=A-d+2;C[$t][e]=1;const x=H.getCharCode("9"),m=H.getCharCode("0");for(let A=m;A<=x;A++)C[$t][A]=A-m+2;C[$t][s]=12,C[$t][t]=13;const b=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let A=0;A<b.length;A++)C[_i][H.getCharCode(b[A])]=A;const E=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let A=0;A<E.length;A++)H.getCharCode(E[A])>0&&(C[xr][H.getCharCode(E[A])]=A);return C}const Rn=zo(I.createInt32Array(5,256));class Ts{constructor(e){this.text=e}encode(){const e=H.getCharCode(" "),t=H.getCharCode(`
`);let s=Ii.singletonList(mr.INITIAL_STATE);for(let i=0;i<this.text.length;i++){let o,d=i+1<this.text.length?this.text[i+1]:0;switch(this.text[i]){case H.getCharCode("\r"):o=d===t?2:0;break;case H.getCharCode("."):o=d===e?3:0;break;case H.getCharCode(","):o=d===e?4:0;break;case H.getCharCode(":"):o=d===e?5:0;break;default:o=0}o>0?(s=Ts.updateStateListForPair(s,i,o),i++):s=this.updateStateListForChar(s,i)}return Ii.min(s,(i,o)=>i.getBitCount()-o.getBitCount()).toBitArray(this.text)}updateStateListForChar(e,t){const s=[];for(let n of e)this.updateStateForChar(n,t,s);return Ts.simplifyStates(s)}updateStateForChar(e,t,s){let n=this.text[t]&255,i=Rn[e.getMode()][n]>0,o=null;for(let d=0;d<=xr;d++){let x=Rn[d][n];if(x>0){if(o==null&&(o=e.endBinaryShift(t)),!i||d===e.getMode()||d===$t){const m=o.latchAndAppend(d,x);s.push(m)}if(!i&&ki[e.getMode()][d]>=0){const m=o.shiftAndAppend(d,x);s.push(m)}}}if(e.getBinaryShiftByteCount()>0||Rn[e.getMode()][n]===0){let d=e.addBinaryShiftChar(t);s.push(d)}}static updateStateListForPair(e,t,s){const n=[];for(let i of e)this.updateStateForPair(i,t,s,n);return this.simplifyStates(n)}static updateStateForPair(e,t,s,n){let i=e.endBinaryShift(t);if(n.push(i.latchAndAppend(xr,s)),e.getMode()!==xr&&n.push(i.shiftAndAppend(xr,s)),s===3||s===4){let o=i.latchAndAppend($t,16-s).latchAndAppend($t,1);n.push(o)}if(e.getBinaryShiftByteCount()>0){let o=e.addBinaryShiftChar(t).addBinaryShiftChar(t+1);n.push(o)}}static simplifyStates(e){let t=[];for(const s of e){let n=!0;for(const i of t){if(i.isBetterThanOrEqualTo(s)){n=!1;break}s.isBetterThanOrEqualTo(i)&&(t=t.filter(o=>o!==i))}n&&t.push(s)}return t}}class Pe{constructor(){}static encodeBytes(e){return Pe.encode(e,Pe.DEFAULT_EC_PERCENT,Pe.DEFAULT_AZTEC_LAYERS)}static encode(e,t,s){let n=new Ts(e).encode(),i=M.truncDivision(n.getSize()*t,100)+11,o=n.getSize()+i,d,x,m,b,E;if(s!==Pe.DEFAULT_AZTEC_LAYERS){if(d=s<0,x=Math.abs(s),x>(d?Pe.MAX_NB_BITS_COMPACT:Pe.MAX_NB_BITS))throw new N(H.format("Illegal value %s for layers",s));m=Pe.totalBitsInLayer(x,d),b=Pe.WORD_SIZE[x];let ee=m-m%b;if(E=Pe.stuffBits(n,b),E.getSize()+i>ee)throw new N("Data to large for user specified layer");if(d&&E.getSize()>b*64)throw new N("Data to large for user specified layer")}else{b=0,E=null;for(let ee=0;;ee++){if(ee>Pe.MAX_NB_BITS)throw new N("Data too large for an Aztec code");if(d=ee<=3,x=d?ee+1:ee,m=Pe.totalBitsInLayer(x,d),o>m)continue;(E==null||b!==Pe.WORD_SIZE[x])&&(b=Pe.WORD_SIZE[x],E=Pe.stuffBits(n,b));let Oe=m-m%b;if(!(d&&E.getSize()>b*64)&&E.getSize()+i<=Oe)break}}let A=Pe.generateCheckWords(E,m,b),k=E.getSize()/b,R=Pe.generateModeMessage(d,x,k),B=(d?11:14)+x*4,U=new Int32Array(B),W;if(d){W=B;for(let ee=0;ee<U.length;ee++)U[ee]=ee}else{W=B+1+2*M.truncDivision(M.truncDivision(B,2)-1,15);let ee=M.truncDivision(B,2),Oe=M.truncDivision(W,2);for(let je=0;je<ee;je++){let Ft=je+M.truncDivision(je,15);U[ee-je-1]=Oe-Ft-1,U[ee+je]=Oe+Ft+1}}let re=new he(W);for(let ee=0,Oe=0;ee<x;ee++){let je=(x-ee)*4+(d?9:12);for(let Ft=0;Ft<je;Ft++){let ir=Ft*2;for(let Ut=0;Ut<2;Ut++)A.get(Oe+ir+Ut)&&re.set(U[ee*2+Ut],U[ee*2+Ft]),A.get(Oe+je*2+ir+Ut)&&re.set(U[ee*2+Ft],U[B-1-ee*2-Ut]),A.get(Oe+je*4+ir+Ut)&&re.set(U[B-1-ee*2-Ut],U[B-1-ee*2-Ft]),A.get(Oe+je*6+ir+Ut)&&re.set(U[B-1-ee*2-Ft],U[ee*2+Ut])}Oe+=je*8}if(Pe.drawModeMessage(re,d,W,R),d)Pe.drawBullsEye(re,M.truncDivision(W,2),5);else{Pe.drawBullsEye(re,M.truncDivision(W,2),7);for(let ee=0,Oe=0;ee<M.truncDivision(B,2)-1;ee+=15,Oe+=16)for(let je=M.truncDivision(W,2)&1;je<W;je+=2)re.set(M.truncDivision(W,2)-Oe,je),re.set(M.truncDivision(W,2)+Oe,je),re.set(je,M.truncDivision(W,2)-Oe),re.set(je,M.truncDivision(W,2)+Oe)}let se=new Ti;return se.setCompact(d),se.setSize(W),se.setLayers(x),se.setCodeWords(k),se.setMatrix(re),se}static drawBullsEye(e,t,s){for(let n=0;n<s;n+=2)for(let i=t-n;i<=t+n;i++)e.set(i,t-n),e.set(i,t+n),e.set(t-n,i),e.set(t+n,i);e.set(t-s,t-s),e.set(t-s+1,t-s),e.set(t-s,t-s+1),e.set(t+s,t-s),e.set(t+s,t-s+1),e.set(t+s,t+s-1)}static generateModeMessage(e,t,s){let n=new z;return e?(n.appendBits(t-1,2),n.appendBits(s-1,6),n=Pe.generateCheckWords(n,28,4)):(n.appendBits(t-1,5),n.appendBits(s-1,11),n=Pe.generateCheckWords(n,40,4)),n}static drawModeMessage(e,t,s,n){let i=M.truncDivision(s,2);if(t)for(let o=0;o<7;o++){let d=i-3+o;n.get(o)&&e.set(d,i-5),n.get(o+7)&&e.set(i+5,d),n.get(20-o)&&e.set(d,i+5),n.get(27-o)&&e.set(i-5,d)}else for(let o=0;o<10;o++){let d=i-5+o+M.truncDivision(o,5);n.get(o)&&e.set(d,i-7),n.get(o+10)&&e.set(i+7,d),n.get(29-o)&&e.set(d,i+7),n.get(39-o)&&e.set(i-7,d)}}static generateCheckWords(e,t,s){let n=e.getSize()/s,i=new _n(Pe.getGF(s)),o=M.truncDivision(t,s),d=Pe.bitsToWords(e,s,o);i.encode(d,o-n);let x=t%s,m=new z;m.appendBits(0,x);for(const b of Array.from(d))m.appendBits(b,s);return m}static bitsToWords(e,t,s){let n=new Int32Array(s),i,o;for(i=0,o=e.getSize()/t;i<o;i++){let d=0;for(let x=0;x<t;x++)d|=e.get(i*t+x)?1<<t-x-1:0;n[i]=d}return n}static getGF(e){switch(e){case 4:return ke.AZTEC_PARAM;case 6:return ke.AZTEC_DATA_6;case 8:return ke.AZTEC_DATA_8;case 10:return ke.AZTEC_DATA_10;case 12:return ke.AZTEC_DATA_12;default:throw new N("Unsupported word size "+e)}}static stuffBits(e,t){let s=new z,n=e.getSize(),i=(1<<t)-2;for(let o=0;o<n;o+=t){let d=0;for(let x=0;x<t;x++)(o+x>=n||e.get(o+x))&&(d|=1<<t-1-x);(d&i)===i?(s.appendBits(d&i,t),o--):d&i?s.appendBits(d,t):(s.appendBits(d|1,t),o--)}return s}static totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}Pe.DEFAULT_EC_PERCENT=33,Pe.DEFAULT_AZTEC_LAYERS=0,Pe.MAX_NB_BITS=32,Pe.MAX_NB_BITS_COMPACT=4,Pe.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Qs{encode(e,t,s,n){return this.encodeWithHints(e,t,s,n,null)}encodeWithHints(e,t,s,n,i){let o=Dn.ISO_8859_1,d=Pe.DEFAULT_EC_PERCENT,x=Pe.DEFAULT_AZTEC_LAYERS;return i!=null&&(i.has(vt.CHARACTER_SET)&&(o=ji.forName(i.get(vt.CHARACTER_SET).toString())),i.has(vt.ERROR_CORRECTION)&&(d=M.parseInt(i.get(vt.ERROR_CORRECTION).toString())),i.has(vt.AZTEC_LAYERS)&&(x=M.parseInt(i.get(vt.AZTEC_LAYERS).toString()))),Qs.encodeLayers(e,t,s,n,o,d,x)}static encodeLayers(e,t,s,n,i,o,d){if(t!==ae.AZTEC)throw new N("Can only encode AZTEC, but got "+t);let x=Pe.encode(H.getBytes(e,i),o,d);return Qs.renderResult(x,s,n)}static renderResult(e,t,s){let n=e.getMatrix();if(n==null)throw new Xe;let i=n.getWidth(),o=n.getHeight(),d=Math.max(t,i),x=Math.max(s,o),m=Math.min(d/i,x/o),b=(d-i*m)/2,E=(x-o*m)/2,A=new he(d,x);for(let k=0,R=E;k<o;k++,R+=m)for(let B=0,U=b;B<i;B++,U+=m)n.get(B,k)&&A.setRegion(U,R,m,m);return A}}c.AbstractExpandedDecoder=sr,c.ArgumentException=w,c.ArithmeticException=Tr,c.AztecCode=Ti,c.AztecCodeReader=ts,c.AztecCodeWriter=Qs,c.AztecDecoder=ze,c.AztecDetector=Ws,c.AztecDetectorResult=zs,c.AztecEncoder=Pe,c.AztecHighLevelEncoder=Ts,c.AztecPoint=At,c.BarcodeFormat=ae,c.Binarizer=L,c.BinaryBitmap=j,c.BitArray=z,c.BitMatrix=he,c.BitSource=En,c.BrowserAztecCodeReader=bn,c.BrowserBarcodeReader=vo,c.BrowserCodeReader=ie,c.BrowserDatamatrixCodeReader=Co,c.BrowserMultiFormatReader=Mo,c.BrowserPDF417Reader=Ro,c.BrowserQRCodeReader=Lo,c.BrowserQRCodeSvgWriter=Zr,c.CharacterSetECI=J,c.ChecksumException=_,c.Code128Reader=le,c.Code39Reader=ft,c.DataMatrixDecodedBitStreamParser=kr,c.DataMatrixReader=Dr,c.DecodeHintType=ce,c.DecoderResult=we,c.DefaultGridSampler=bs,c.DetectorResult=es,c.EAN13Reader=wr,c.EncodeHintType=vt,c.Exception=g,c.FormatException=Q,c.GenericGF=ke,c.GenericGFPoly=Ke,c.GlobalHistogramBinarizer=Be,c.GridSampler=ys,c.GridSamplerInstance=dr,c.HTMLCanvasElementLuminanceSource=de,c.HybridBinarizer=ge,c.ITFReader=Ve,c.IllegalArgumentException=N,c.IllegalStateException=Xe,c.InvertedLuminanceSource=X,c.LuminanceSource=at,c.MathUtils=De,c.MultiFormatOneDReader=rs,c.MultiFormatReader=Si,c.MultiFormatWriter=Bo,c.NotFoundException=F,c.OneDReader=ct,c.PDF417DecodedBitStreamParser=G,c.PDF417DecoderErrorCorrection=wi,c.PDF417Reader=Tt,c.PDF417ResultMetadata=Ni,c.PerspectiveTransform=Vt,c.PlanarYUVLuminanceSource=fr,c.QRCodeByteMatrix=Zs,c.QRCodeDataMask=qt,c.QRCodeDecodedBitStreamParser=lt,c.QRCodeDecoderErrorCorrectionLevel=et,c.QRCodeDecoderFormatInformation=Ot,c.QRCodeEncoder=rt,c.QRCodeEncoderQRCode=qr,c.QRCodeMaskUtil=ut,c.QRCodeMatrixUtil=Ne,c.QRCodeMode=ve,c.QRCodeReader=Or,c.QRCodeVersion=be,c.QRCodeWriter=ns,c.RGBLuminanceSource=kn,c.RSS14Reader=dt,c.RSSExpandedReader=$,c.ReaderException=qs,c.ReedSolomonDecoder=cr,c.ReedSolomonEncoder=_n,c.ReedSolomonException=lr,c.Result=oe,c.ResultMetadataType=Ie,c.ResultPoint=me,c.StringUtils=H,c.UnsupportedOperationException=bt,c.VideoInputDevice=fe,c.WhiteRectangleDetector=tr,c.WriterException=Ze,c.ZXingArrays=I,c.ZXingCharset=ji,c.ZXingInteger=M,c.ZXingStandardCharsets=Dn,c.ZXingStringBuilder=q,c.ZXingStringEncoding=Z,c.ZXingSystem=D,c.createAbstractExpandedDecoder=yi,Object.defineProperty(c,"__esModule",{value:!0})})})(ai,ai.exports);var st=ai.exports;const bu=Fs(st),wu=pl({__proto__:null,default:bu},[st]);var ca=function(){function a(l,c,u){if(this.formatMap=new Map([[ue.QR_CODE,st.BarcodeFormat.QR_CODE],[ue.AZTEC,st.BarcodeFormat.AZTEC],[ue.CODABAR,st.BarcodeFormat.CODABAR],[ue.CODE_39,st.BarcodeFormat.CODE_39],[ue.CODE_93,st.BarcodeFormat.CODE_93],[ue.CODE_128,st.BarcodeFormat.CODE_128],[ue.DATA_MATRIX,st.BarcodeFormat.DATA_MATRIX],[ue.MAXICODE,st.BarcodeFormat.MAXICODE],[ue.ITF,st.BarcodeFormat.ITF],[ue.EAN_13,st.BarcodeFormat.EAN_13],[ue.EAN_8,st.BarcodeFormat.EAN_8],[ue.PDF_417,st.BarcodeFormat.PDF_417],[ue.RSS_14,st.BarcodeFormat.RSS_14],[ue.RSS_EXPANDED,st.BarcodeFormat.RSS_EXPANDED],[ue.UPC_A,st.BarcodeFormat.UPC_A],[ue.UPC_E,st.BarcodeFormat.UPC_E],[ue.UPC_EAN_EXTENSION,st.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!wu)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=c,this.logger=u;var h=this.createZXingFormats(l),f=new Map;f.set(st.DecodeHintType.POSSIBLE_FORMATS,h),f.set(st.DecodeHintType.TRY_HARDER,!1),this.hints=f}return a.prototype.decodeAsync=function(l){var c=this;return new Promise(function(u,h){try{u(c.decode(l))}catch(f){h(f)}})},a.prototype.decode=function(l){var c=new st.MultiFormatReader(this.verbose,this.hints),u=new st.HTMLCanvasElementLuminanceSource(l),h=new st.BinaryBitmap(new st.HybridBinarizer(u)),f=c.decode(h);return{text:f.text,format:fo.create(this.toHtml5QrcodeSupportedFormats(f.format)),debugData:this.createDebugData()}},a.prototype.createReverseFormatMap=function(){var l=new Map;return this.formatMap.forEach(function(c,u,h){l.set(c,u)}),l},a.prototype.toHtml5QrcodeSupportedFormats=function(l){if(!this.reverseFormatMap.has(l))throw"reverseFormatMap doesn't have ".concat(l);return this.reverseFormatMap.get(l)},a.prototype.createZXingFormats=function(l){for(var c=[],u=0,h=l;u<h.length;u++){var f=h[u];this.formatMap.has(f)?c.push(this.formatMap.get(f)):this.logger.logError("".concat(f," is not supported by")+"ZXingHtml5QrcodeShim")}return c},a.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},a}(),vu=function(a,l,c,u){function h(f){return f instanceof c?f:new c(function(p){p(f)})}return new(c||(c=Promise))(function(f,p){function y(w){try{g(u.next(w))}catch(N){p(N)}}function v(w){try{g(u.throw(w))}catch(N){p(N)}}function g(w){w.done?f(w.value):h(w.value).then(y,v)}g((u=u.apply(a,l||[])).next())})},Nu=function(a,l){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},u,h,f,p;return p={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function y(g){return function(w){return v([g,w])}}function v(g){if(u)throw new TypeError("Generator is already executing.");for(;p&&(p=0,g[0]&&(c=0)),c;)try{if(u=1,h&&(f=g[0]&2?h.return:g[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,g[1])).done)return f;switch(h=0,f&&(g=[g[0]&2,f.value]),g[0]){case 0:case 1:f=g;break;case 4:return c.label++,{value:g[1],done:!1};case 5:c.label++,h=g[1],g=[0];continue;case 7:g=c.ops.pop(),c.trys.pop();continue;default:if(f=c.trys,!(f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1],f=g;break}if(f&&c.label<f[2]){c.label=f[2],c.ops.push(g);break}f[2]&&c.ops.pop(),c.trys.pop();continue}g=l.call(a,c)}catch(w){g=[6,w],h=0}finally{u=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},da=function(){function a(l,c,u){if(this.formatMap=new Map([[ue.QR_CODE,"qr_code"],[ue.AZTEC,"aztec"],[ue.CODABAR,"codabar"],[ue.CODE_39,"code_39"],[ue.CODE_93,"code_93"],[ue.CODE_128,"code_128"],[ue.DATA_MATRIX,"data_matrix"],[ue.ITF,"itf"],[ue.EAN_13,"ean_13"],[ue.EAN_8,"ean_8"],[ue.PDF_417,"pdf417"],[ue.UPC_A,"upc_a"],[ue.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!a.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=c,this.logger=u;var h=this.createBarcodeDetectorFormats(l);if(this.detector=new BarcodeDetector(h),!this.detector)throw"BarcodeDetector detector not supported"}return a.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var l=new BarcodeDetector({formats:["qr_code"]});return typeof l<"u"},a.prototype.decodeAsync=function(l){return vu(this,void 0,void 0,function(){var c,u;return Nu(this,function(h){switch(h.label){case 0:return[4,this.detector.detect(l)];case 1:if(c=h.sent(),!c||c.length===0)throw"No barcode or QR code detected.";return u=this.selectLargestBarcode(c),[2,{text:u.rawValue,format:fo.create(this.toHtml5QrcodeSupportedFormats(u.format)),debugData:this.createDebugData()}]}})})},a.prototype.selectLargestBarcode=function(l){for(var c=null,u=0,h=0,f=l;h<f.length;h++){var p=f[h],y=p.boundingBox.width*p.boundingBox.height;y>u&&(u=y,c=p)}if(!c)throw"No largest barcode found";return c},a.prototype.createBarcodeDetectorFormats=function(l){for(var c=[],u=0,h=l;u<h.length;u++){var f=h[u];this.formatMap.has(f)?c.push(this.formatMap.get(f)):this.logger.warn("".concat(f," is not supported by")+"BarcodeDetectorDelegate")}return{formats:c}},a.prototype.toHtml5QrcodeSupportedFormats=function(l){if(!this.reverseFormatMap.has(l))throw"reverseFormatMap doesn't have ".concat(l);return this.reverseFormatMap.get(l)},a.prototype.createReverseFormatMap=function(){var l=new Map;return this.formatMap.forEach(function(c,u,h){l.set(c,u)}),l},a.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},a}(),ua=function(a,l,c,u){function h(f){return f instanceof c?f:new c(function(p){p(f)})}return new(c||(c=Promise))(function(f,p){function y(w){try{g(u.next(w))}catch(N){p(N)}}function v(w){try{g(u.throw(w))}catch(N){p(N)}}function g(w){w.done?f(w.value):h(w.value).then(y,v)}g((u=u.apply(a,l||[])).next())})},ha=function(a,l){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},u,h,f,p;return p={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function y(g){return function(w){return v([g,w])}}function v(g){if(u)throw new TypeError("Generator is already executing.");for(;p&&(p=0,g[0]&&(c=0)),c;)try{if(u=1,h&&(f=g[0]&2?h.return:g[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,g[1])).done)return f;switch(h=0,f&&(g=[g[0]&2,f.value]),g[0]){case 0:case 1:f=g;break;case 4:return c.label++,{value:g[1],done:!1};case 5:c.label++,h=g[1],g=[0];continue;case 7:g=c.ops.pop(),c.trys.pop();continue;default:if(f=c.trys,!(f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1],f=g;break}if(f&&c.label<f[2]){c.label=f[2],c.ops.push(g);break}f[2]&&c.ops.pop(),c.trys.pop();continue}g=l.call(a,c)}catch(w){g=[6,w],h=0}finally{u=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},Cu=function(){function a(l,c,u,h){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=u,c&&da.isSupported()?(this.primaryDecoder=new da(l,u,h),this.secondaryDecoder=new ca(l,u,h)):this.primaryDecoder=new ca(l,u,h)}return a.prototype.decodeAsync=function(l){return ua(this,void 0,void 0,function(){var c;return ha(this,function(u){switch(u.label){case 0:c=performance.now(),u.label=1;case 1:return u.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(l)];case 2:return[2,u.sent()];case 3:return this.possiblyLogPerformance(c),[7];case 4:return[2]}})})},a.prototype.decodeRobustlyAsync=function(l){return ua(this,void 0,void 0,function(){var c,u;return ha(this,function(h){switch(h.label){case 0:c=performance.now(),h.label=1;case 1:return h.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(l)];case 2:return[2,h.sent()];case 3:if(u=h.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(l)];throw u;case 4:return this.possiblyLogPerformance(c),[7];case 5:return[2]}})})},a.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},a.prototype.possiblyLogPerformance=function(l){if(this.verbose){var c=performance.now()-l;this.executionResults.push(c),this.executions++,this.possiblyFlushPerformanceReport()}},a.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var l=0,c=0,u=this.executionResults;c<u.length;c++){var h=u[c];l+=h}var f=l/this.executionResults.length;console.log("".concat(f," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},a}(),gi=function(){var a=function(l,c){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(u[f]=h[f])},a(l,c)};return function(l,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");a(l,c);function u(){this.constructor=l}l.prototype=c===null?Object.create(c):(u.prototype=c.prototype,new u)}}(),cn=function(a,l,c,u){function h(f){return f instanceof c?f:new c(function(p){p(f)})}return new(c||(c=Promise))(function(f,p){function y(w){try{g(u.next(w))}catch(N){p(N)}}function v(w){try{g(u.throw(w))}catch(N){p(N)}}function g(w){w.done?f(w.value):h(w.value).then(y,v)}g((u=u.apply(a,l||[])).next())})},dn=function(a,l){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},u,h,f,p;return p={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function y(g){return function(w){return v([g,w])}}function v(g){if(u)throw new TypeError("Generator is already executing.");for(;p&&(p=0,g[0]&&(c=0)),c;)try{if(u=1,h&&(f=g[0]&2?h.return:g[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,g[1])).done)return f;switch(h=0,f&&(g=[g[0]&2,f.value]),g[0]){case 0:case 1:f=g;break;case 4:return c.label++,{value:g[1],done:!1};case 5:c.label++,h=g[1],g=[0];continue;case 7:g=c.ops.pop(),c.trys.pop();continue;default:if(f=c.trys,!(f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1],f=g;break}if(f&&c.label<f[2]){c.label=f[2],c.ops.push(g);break}f[2]&&c.ops.pop(),c.trys.pop();continue}g=l.call(a,c)}catch(w){g=[6,w],h=0}finally{u=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},po=function(){function a(l,c){this.name=l,this.track=c}return a.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},a.prototype.apply=function(l){var c={};c[this.name]=l;var u={advanced:[c]};return this.track.applyConstraints(u)},a.prototype.value=function(){var l=this.track.getSettings();if(this.name in l){var c=l[this.name];return c}return null},a}(),Eu=function(a){gi(l,a);function l(c,u){return a.call(this,c,u)||this}return l.prototype.min=function(){return this.getCapabilities().min},l.prototype.max=function(){return this.getCapabilities().max},l.prototype.step=function(){return this.getCapabilities().step},l.prototype.apply=function(c){var u={};u[this.name]=c;var h={advanced:[u]};return this.track.applyConstraints(h)},l.prototype.getCapabilities=function(){this.failIfNotSupported();var c=this.track.getCapabilities(),u=c[this.name];return{min:u.min,max:u.max,step:u.step}},l.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},l}(po),Au=function(a){gi(l,a);function l(c){return a.call(this,"zoom",c)||this}return l}(Eu),Su=function(a){gi(l,a);function l(c){return a.call(this,"torch",c)||this}return l}(po),ju=function(){function a(l){this.track=l}return a.prototype.zoomFeature=function(){return new Au(this.track)},a.prototype.torchFeature=function(){return new Su(this.track)},a}(),Tu=function(){function a(l,c,u){this.isClosed=!1,this.parentElement=l,this.mediaStream=c,this.callbacks=u,this.surface=this.createVideoElement(this.parentElement.clientWidth),l.append(this.surface)}return a.prototype.createVideoElement=function(l){var c=document.createElement("video");return c.style.width="".concat(l,"px"),c.style.display="block",c.muted=!0,c.setAttribute("muted","true"),c.playsInline=!0,c},a.prototype.setupSurface=function(){var l=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var c=function(){var u=l.surface.clientWidth,h=l.surface.clientHeight;l.callbacks.onRenderSurfaceReady(u,h),l.surface.removeEventListener("playing",c)};this.surface.addEventListener("playing",c),this.surface.srcObject=this.mediaStream,this.surface.play()},a.create=function(l,c,u,h){return cn(this,void 0,void 0,function(){var f,p;return dn(this,function(y){switch(y.label){case 0:return f=new a(l,c,h),u.aspectRatio?(p={aspectRatio:u.aspectRatio},[4,f.getFirstTrackOrFail().applyConstraints(p)]):[3,2];case 1:y.sent(),y.label=2;case 2:return f.setupSurface(),[2,f]}})})},a.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},a.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},a.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},a.prototype.resume=function(l){this.failIfClosed();var c=this,u=function(){setTimeout(l,200),c.surface.removeEventListener("playing",u)};this.surface.addEventListener("playing",u),this.surface.play()},a.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},a.prototype.getSurface=function(){return this.failIfClosed(),this.surface},a.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},a.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},a.prototype.applyVideoConstraints=function(l){return cn(this,void 0,void 0,function(){return dn(this,function(c){if("aspectRatio"in l)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(l)]})})},a.prototype.close=function(){if(this.isClosed)return Promise.resolve();var l=this;return new Promise(function(c,u){var h=l.mediaStream.getVideoTracks(),f=h.length,p=0;l.mediaStream.getVideoTracks().forEach(function(y){l.mediaStream.removeTrack(y),y.stop(),++p,p>=f&&(l.isClosed=!0,l.parentElement.removeChild(l.surface),c())})})},a.prototype.getCapabilities=function(){return new ju(this.getFirstTrackOrFail())},a}(),Iu=function(){function a(l){this.mediaStream=l}return a.prototype.render=function(l,c,u){return cn(this,void 0,void 0,function(){return dn(this,function(h){return[2,Tu.create(l,this.mediaStream,c,u)]})})},a.create=function(l){return cn(this,void 0,void 0,function(){var c,u;return dn(this,function(h){switch(h.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return c={audio:!1,video:l},[4,navigator.mediaDevices.getUserMedia(c)];case 1:return u=h.sent(),[2,new a(u)]}})})},a}(),fa=function(a,l,c,u){function h(f){return f instanceof c?f:new c(function(p){p(f)})}return new(c||(c=Promise))(function(f,p){function y(w){try{g(u.next(w))}catch(N){p(N)}}function v(w){try{g(u.throw(w))}catch(N){p(N)}}function g(w){w.done?f(w.value):h(w.value).then(y,v)}g((u=u.apply(a,l||[])).next())})},xa=function(a,l){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},u,h,f,p;return p={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function y(g){return function(w){return v([g,w])}}function v(g){if(u)throw new TypeError("Generator is already executing.");for(;p&&(p=0,g[0]&&(c=0)),c;)try{if(u=1,h&&(f=g[0]&2?h.return:g[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,g[1])).done)return f;switch(h=0,f&&(g=[g[0]&2,f.value]),g[0]){case 0:case 1:f=g;break;case 4:return c.label++,{value:g[1],done:!1};case 5:c.label++,h=g[1],g=[0];continue;case 7:g=c.ops.pop(),c.trys.pop();continue;default:if(f=c.trys,!(f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1],f=g;break}if(f&&c.label<f[2]){c.label=f[2],c.ops.push(g);break}f[2]&&c.ops.pop(),c.trys.pop();continue}g=l.call(a,c)}catch(w){g=[6,w],h=0}finally{u=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},_u=function(){function a(){}return a.failIfNotSupported=function(){return fa(this,void 0,void 0,function(){return xa(this,function(l){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new a]})})},a.prototype.create=function(l){return fa(this,void 0,void 0,function(){return xa(this,function(c){return[2,Iu.create(l)]})})},a}(),ku=function(a,l,c,u){function h(f){return f instanceof c?f:new c(function(p){p(f)})}return new(c||(c=Promise))(function(f,p){function y(w){try{g(u.next(w))}catch(N){p(N)}}function v(w){try{g(u.throw(w))}catch(N){p(N)}}function g(w){w.done?f(w.value):h(w.value).then(y,v)}g((u=u.apply(a,l||[])).next())})},Du=function(a,l){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},u,h,f,p;return p={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function y(g){return function(w){return v([g,w])}}function v(g){if(u)throw new TypeError("Generator is already executing.");for(;p&&(p=0,g[0]&&(c=0)),c;)try{if(u=1,h&&(f=g[0]&2?h.return:g[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,g[1])).done)return f;switch(h=0,f&&(g=[g[0]&2,f.value]),g[0]){case 0:case 1:f=g;break;case 4:return c.label++,{value:g[1],done:!1};case 5:c.label++,h=g[1],g=[0];continue;case 7:g=c.ops.pop(),c.trys.pop();continue;default:if(f=c.trys,!(f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1],f=g;break}if(f&&c.label<f[2]){c.label=f[2],c.ops.push(g);break}f[2]&&c.ops.pop(),c.trys.pop();continue}g=l.call(a,c)}catch(w){g=[6,w],h=0}finally{u=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},Ou=function(){function a(){}return a.retrieve=function(){if(navigator.mediaDevices)return a.getCamerasFromMediaDevices();var l=MediaStreamTrack;return MediaStreamTrack&&l.getSources?a.getCamerasFromMediaStreamTrack():a.rejectWithError()},a.rejectWithError=function(){var l=cs.unableToQuerySupportedDevices();return a.isHttpsOrLocalhost()||(l=cs.insecureContextCameraQueryError()),Promise.reject(l)},a.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var l=location.host.split(":")[0];return l==="127.0.0.1"||l==="localhost"},a.getCamerasFromMediaDevices=function(){return ku(this,void 0,void 0,function(){var l,c,u,h,f,p,y;return Du(this,function(v){switch(v.label){case 0:return l=function(g){for(var w=g.getVideoTracks(),N=0,j=w;N<j.length;N++){var _=j[N];_.enabled=!1,_.stop(),g.removeTrack(_)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return c=v.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(u=v.sent(),h=[],f=0,p=u;f<p.length;f++)y=p[f],y.kind==="videoinput"&&h.push({id:y.deviceId,label:y.label});return l(c),[2,h]}})})},a.getCamerasFromMediaStreamTrack=function(){return new Promise(function(l,c){var u=function(f){for(var p=[],y=0,v=f;y<v.length;y++){var g=v[y];g.kind==="video"&&p.push({id:g.id,label:g.label})}l(p)},h=MediaStreamTrack;h.getSources(u)})},a}(),ht;(function(a){a[a.UNKNOWN=0]="UNKNOWN",a[a.NOT_STARTED=1]="NOT_STARTED",a[a.SCANNING=2]="SCANNING",a[a.PAUSED=3]="PAUSED"})(ht||(ht={}));var Mu=function(){function a(){this.state=ht.NOT_STARTED,this.onGoingTransactionNewState=ht.UNKNOWN}return a.prototype.directTransition=function(l){this.failIfTransitionOngoing(),this.validateTransition(l),this.state=l},a.prototype.startTransition=function(l){return this.failIfTransitionOngoing(),this.validateTransition(l),this.onGoingTransactionNewState=l,this},a.prototype.execute=function(){if(this.onGoingTransactionNewState===ht.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var l=this.onGoingTransactionNewState;this.onGoingTransactionNewState=ht.UNKNOWN,this.directTransition(l)},a.prototype.cancel=function(){if(this.onGoingTransactionNewState===ht.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=ht.UNKNOWN},a.prototype.getState=function(){return this.state},a.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==ht.UNKNOWN)throw"Cannot transition to a new state, already under transition"},a.prototype.validateTransition=function(l){switch(this.state){case ht.UNKNOWN:throw"Transition from unknown is not allowed";case ht.NOT_STARTED:this.failIfNewStateIs(l,[ht.PAUSED]);break;case ht.SCANNING:break;case ht.PAUSED:break}},a.prototype.failIfNewStateIs=function(l,c){for(var u=0,h=c;u<h.length;u++){var f=h[u];if(l===f)throw"Cannot transition from ".concat(this.state," to ").concat(l)}},a}(),Ru=function(){function a(l){this.stateManager=l}return a.prototype.startTransition=function(l){return this.stateManager.startTransition(l)},a.prototype.directTransition=function(l){this.stateManager.directTransition(l)},a.prototype.getState=function(){return this.stateManager.getState()},a.prototype.canScanFile=function(){return this.stateManager.getState()===ht.NOT_STARTED},a.prototype.isScanning=function(){return this.stateManager.getState()!==ht.NOT_STARTED},a.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===ht.SCANNING},a.prototype.isPaused=function(){return this.stateManager.getState()===ht.PAUSED},a}(),Lu=function(){function a(){}return a.create=function(){return new Ru(new Mu)},a}(),Pu=function(){var a=function(l,c){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(u[f]=h[f])},a(l,c)};return function(l,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");a(l,c);function u(){this.constructor=l}l.prototype=c===null?Object.create(c):(u.prototype=c.prototype,new u)}}(),Wt=function(a){Pu(l,a);function l(){return a!==null&&a.apply(this,arguments)||this}return l.DEFAULT_WIDTH=300,l.DEFAULT_WIDTH_OFFSET=2,l.FILE_SCAN_MIN_HEIGHT=300,l.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,l.MIN_QR_BOX_SIZE=50,l.SHADED_LEFT=1,l.SHADED_RIGHT=2,l.SHADED_TOP=3,l.SHADED_BOTTOM=4,l.SHADED_REGION_ELEMENT_ID="qr-shaded-region",l.VERBOSE=!1,l.BORDER_SHADER_DEFAULT_COLOR="#ffffff",l.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",l}(ar),Bu=function(){function a(l,c){this.logger=c,this.fps=Wt.SCAN_DEFAULT_FPS,l?(l.fps&&(this.fps=l.fps),this.disableFlip=l.disableFlip===!0,this.qrbox=l.qrbox,this.aspectRatio=l.aspectRatio,this.videoConstraints=l.videoConstraints):this.disableFlip=Wt.DEFAULT_DISABLE_FLIP}return a.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?go.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},a.prototype.isShadedBoxEnabled=function(){return!gr(this.qrbox)},a.create=function(l,c){return new a(l,c)},a}(),ma=function(){function a(l,c){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(l))throw"HTML Element with id=".concat(l," not found");this.elementId=l,this.verbose=!1;var u;typeof c=="boolean"?this.verbose=c===!0:c&&(u=c,this.verbose=u.verbose===!0,u.experimentalFeatures),this.logger=new mo(this.verbose),this.qrcode=new Cu(this.getSupportedFormats(c),this.getUseBarCodeDetectorIfSupported(u),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=Lu.create()}return a.prototype.start=function(l,c,u,h){var f=this;if(!l)throw"cameraIdOrConfig is required";if(!u||typeof u!="function")throw"qrCodeSuccessCallback is required and should be a function.";var p;h?p=h:p=this.verbose?this.logger.log:function(){};var y=Bu.create(c,this.logger);this.clearElement();var v=!1;y.videoConstraints&&(y.isMediaStreamConstraintsValid()?v=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var g=v,w=document.getElementById(this.elementId);w.clientWidth?w.clientWidth:Wt.DEFAULT_WIDTH,w.style.position="relative",this.shouldScan=!0,this.element=w;var N=this,j=this.stateManagerProxy.startTransition(ht.SCANNING);return new Promise(function(_,L){var D=g?y.videoConstraints:N.createVideoConstraints(l);if(!D){j.cancel(),L("videoConstraints should be defined");return}var P={};(!g||y.aspectRatio)&&(P.aspectRatio=y.aspectRatio);var S={onRenderSurfaceReady:function(I,M){N.setupUi(I,M,y),N.isScanning=!0,N.foreverScan(y,u,p)}};_u.failIfNotSupported().then(function(I){I.create(D).then(function(M){return M.render(f.element,P,S).then(function(z){N.renderedCamera=z,j.execute(),_(null)}).catch(function(z){j.cancel(),L(z)})}).catch(function(M){j.cancel(),L(cs.errorGettingUserMedia(M))})}).catch(function(I){j.cancel(),L(cs.cameraStreamingNotSupported())})})},a.prototype.pause=function(l){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(ht.PAUSED),this.showPausedState(),(gr(l)||l!==!0)&&(l=!1),l&&this.renderedCamera&&this.renderedCamera.pause()},a.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var l=this,c=function(){l.stateManagerProxy.directTransition(ht.SCANNING),l.hidePausedState()};if(!this.renderedCamera.isPaused()){c();return}this.renderedCamera.resume(function(){c()})},a.prototype.getState=function(){return this.stateManagerProxy.getState()},a.prototype.stop=function(){var l=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var c=this.stateManagerProxy.startTransition(ht.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var u=function(){if(l.element){var f=document.getElementById(Wt.SHADED_REGION_ELEMENT_ID);f&&l.element.removeChild(f)}},h=this;return this.renderedCamera.close().then(function(){return h.renderedCamera=null,h.element&&(h.element.removeChild(h.canvasElement),h.canvasElement=null),u(),h.qrRegion&&(h.qrRegion=null),h.context&&(h.context=null),c.execute(),h.hidePausedState(),h.isScanning=!1,Promise.resolve()})},a.prototype.scanFile=function(l,c){return this.scanFileV2(l,c).then(function(u){return u.decodedText})},a.prototype.scanFileV2=function(l,c){var u=this;if(!l||!(l instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(gr(c)&&(c=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(h,f){u.possiblyCloseLastScanImageFile(),u.clearElement(),u.lastScanImageFile=URL.createObjectURL(l);var p=new Image;p.onload=function(){var y=p.width,v=p.height,g=document.getElementById(u.elementId),w=g.clientWidth?g.clientWidth:Wt.DEFAULT_WIDTH,N=Math.max(g.clientHeight?g.clientHeight:v,Wt.FILE_SCAN_MIN_HEIGHT),j=u.computeCanvasDrawConfig(y,v,w,N);if(c){var _=u.createCanvasElement(w,N,"qr-canvas-visible");_.style.display="inline-block",g.appendChild(_);var L=_.getContext("2d");if(!L)throw"Unable to get 2d context from canvas";L.canvas.width=w,L.canvas.height=N,L.drawImage(p,0,0,y,v,j.x,j.y,j.width,j.height)}var D=Wt.FILE_SCAN_HIDDEN_CANVAS_PADDING,P=Math.max(p.width,j.width),S=Math.max(p.height,j.height),I=P+2*D,M=S+2*D,z=u.createCanvasElement(I,M);g.appendChild(z);var K=z.getContext("2d");if(!K)throw"Unable to get 2d context from canvas";K.canvas.width=I,K.canvas.height=M,K.drawImage(p,0,0,y,v,D,D,P,S);try{u.qrcode.decodeRobustlyAsync(z).then(function(ce){h(oa.createFromQrcodeResult(ce))}).catch(f)}catch(ce){f("QR code parse error, error = ".concat(ce))}},p.onerror=f,p.onabort=f,p.onstalled=f,p.onsuspend=f,p.src=URL.createObjectURL(l)})},a.prototype.clear=function(){this.clearElement()},a.getCameras=function(){return Ou.retrieve()},a.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},a.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},a.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},a.prototype.applyVideoConstraints=function(l){if(l){if(!go.isMediaStreamConstraintsValid(l,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(l)},a.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},a.prototype.getSupportedFormats=function(l){var c=[ue.QR_CODE,ue.AZTEC,ue.CODABAR,ue.CODE_39,ue.CODE_93,ue.CODE_128,ue.DATA_MATRIX,ue.MAXICODE,ue.ITF,ue.EAN_13,ue.EAN_8,ue.PDF_417,ue.RSS_14,ue.RSS_EXPANDED,ue.UPC_A,ue.UPC_E,ue.UPC_EAN_EXTENSION];if(!l||typeof l=="boolean"||!l.formatsToSupport)return c;if(!Array.isArray(l.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(l.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var u=[],h=0,f=l.formatsToSupport;h<f.length;h++){var p=f[h];pu(p)?u.push(p):this.logger.warn("Invalid format: ".concat(p," passed in config, ignoring."))}if(u.length===0)throw"None of formatsToSupport match supported values.";return u},a.prototype.getUseBarCodeDetectorIfSupported=function(l){if(gr(l))return!0;if(!gr(l.useBarCodeDetectorIfSupported))return l.useBarCodeDetectorIfSupported!==!1;if(gr(l.experimentalFeatures))return!0;var c=l.experimentalFeatures;return gr(c.useBarCodeDetectorIfSupported)?!0:c.useBarCodeDetectorIfSupported!==!1},a.prototype.validateQrboxSize=function(l,c,u){var h=this,f=u.qrbox;this.validateQrboxConfig(f);var p=this.toQrdimensions(l,c,f),y=function(g){if(g<Wt.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Wt.MIN_QR_BOX_SIZE,"px.")},v=function(g){return g>l&&(h.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),g=l),g};y(p.width),y(p.height),p.width=v(p.width)},a.prototype.validateQrboxConfig=function(l){if(typeof l!="number"&&typeof l!="function"&&(l.width===void 0||l.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},a.prototype.toQrdimensions=function(l,c,u){if(typeof u=="number")return{width:u,height:u};if(typeof u=="function")try{return u(l,c)}catch(h){throw new Error("qrbox config was passed as a function but it failed with unknown error"+h)}return u},a.prototype.setupUi=function(l,c,u){u.isShadedBoxEnabled()&&this.validateQrboxSize(l,c,u);var h=gr(u.qrbox)?{width:l,height:c}:u.qrbox;this.validateQrboxConfig(h);var f=this.toQrdimensions(l,c,h);f.height>c&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var p=u.isShadedBoxEnabled()&&f.height<=c,y={x:0,y:0,width:l,height:c},v=p?this.getShadedRegionBounds(l,c,f):y,g=this.createCanvasElement(v.width,v.height),w={willReadFrequently:!0},N=g.getContext("2d",w);N.canvas.width=v.width,N.canvas.height=v.height,this.element.append(g),p&&this.possiblyInsertShadingElement(this.element,l,c,f),this.createScannerPausedUiElement(this.element),this.qrRegion=v,this.context=N,this.canvasElement=g},a.prototype.createScannerPausedUiElement=function(l){var c=document.createElement("div");c.innerText=cs.scannerPaused(),c.style.display="none",c.style.position="absolute",c.style.top="0px",c.style.zIndex="1",c.style.background="rgba(9, 9, 9, 0.46)",c.style.color="#FFECEC",c.style.textAlign="center",c.style.width="100%",l.appendChild(c),this.scannerPausedUiElement=c},a.prototype.scanContext=function(l,c){var u=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(h){return l(h.text,oa.createFromQrcodeResult(h)),u.possiblyUpdateShaders(!0),!0}).catch(function(h){u.possiblyUpdateShaders(!1);var f=cs.codeParseError(h);return c(f,xo.createFrom(f)),!1})},a.prototype.foreverScan=function(l,c,u){var h=this;if(this.shouldScan&&this.renderedCamera){var f=this.renderedCamera.getSurface(),p=f.videoWidth/f.clientWidth,y=f.videoHeight/f.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var v=this.qrRegion.width*p,g=this.qrRegion.height*y,w=this.qrRegion.x*p,N=this.qrRegion.y*y;this.context.drawImage(f,w,N,v,g,0,0,this.qrRegion.width,this.qrRegion.height);var j=function(){h.foreverScanTimeout=setTimeout(function(){h.foreverScan(l,c,u)},h.getTimeoutFps(l.fps))};this.scanContext(c,u).then(function(_){!_&&l.disableFlip!==!0?(h.context.translate(h.context.canvas.width,0),h.context.scale(-1,1),h.scanContext(c,u).finally(function(){j()})):j()}).catch(function(_){h.logger.logError("Error happend while scanning context",_),j()})}},a.prototype.createVideoConstraints=function(l){if(typeof l=="string")return{deviceId:{exact:l}};if(typeof l=="object"){var c="facingMode",u="deviceId",h={user:!0,environment:!0},f="exact",p=function(L){if(L in h)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(L,"'")},y=Object.keys(l);if(y.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(y.length," keys");var v=Object.keys(l)[0];if(v!==c&&v!==u)throw"Only '".concat(c,"' and '").concat(u,"' ")+" are supported for 'cameraIdOrConfig'";if(v===c){var g=l.facingMode;if(typeof g=="string"){if(p(g))return{facingMode:g}}else if(typeof g=="object")if(f in g){if(p(g["".concat(f)]))return{facingMode:{exact:g["".concat(f)]}}}else throw"'facingMode' should be string or object with"+" ".concat(f," as key.");else{var w=typeof g;throw"Invalid type of 'facingMode' = ".concat(w)}}else{var N=l.deviceId;if(typeof N=="string")return{deviceId:N};if(typeof N=="object"){if(f in N)return{deviceId:{exact:N["".concat(f)]}};throw"'deviceId' should be string or object with"+" ".concat(f," as key.")}else{var j=typeof N;throw"Invalid type of 'deviceId' = ".concat(j)}}}var _=typeof l;throw"Invalid type of 'cameraIdOrConfig' = ".concat(_)},a.prototype.computeCanvasDrawConfig=function(l,c,u,h){if(l<=u&&c<=h){var f=(u-l)/2,p=(h-c)/2;return{x:f,y:p,width:l,height:c}}else{var y=l,v=c;return l>u&&(c=u/l*c,l=u),c>h&&(l=h/c*l,c=h),this.logger.log("Image downsampled from "+"".concat(y,"X").concat(v)+" to ".concat(l,"X").concat(c,".")),this.computeCanvasDrawConfig(l,c,u,h)}},a.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var l=document.getElementById(this.elementId);l&&(l.innerHTML="")},a.prototype.possiblyUpdateShaders=function(l){this.qrMatch!==l&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(c){c.style.backgroundColor=l?Wt.BORDER_SHADER_MATCH_COLOR:Wt.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=l)},a.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},a.prototype.createCanvasElement=function(l,c,u){var h=l,f=c,p=document.createElement("canvas");return p.style.width="".concat(h,"px"),p.style.height="".concat(f,"px"),p.style.display="none",p.id=gr(u)?"qr-canvas":u,p},a.prototype.getShadedRegionBounds=function(l,c,u){if(u.width>l||u.height>c)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(l-u.width)/2,y:(c-u.height)/2,width:u.width,height:u.height}},a.prototype.possiblyInsertShadingElement=function(l,c,u,h){if(!(c-h.width<1||u-h.height<1)){var f=document.createElement("div");f.style.position="absolute";var p=(c-h.width)/2,y=(u-h.height)/2;if(f.style.borderLeft="".concat(p,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderRight="".concat(p,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderTop="".concat(y,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderBottom="".concat(y,"px solid rgba(0, 0, 0, 0.48)"),f.style.boxSizing="border-box",f.style.top="0px",f.style.bottom="0px",f.style.left="0px",f.style.right="0px",f.id="".concat(Wt.SHADED_REGION_ELEMENT_ID),c-h.width<11||u-h.height<11)this.hasBorderShaders=!1;else{var v=5,g=40;this.insertShaderBorders(f,g,v,-v,null,0,!0),this.insertShaderBorders(f,g,v,-v,null,0,!1),this.insertShaderBorders(f,g,v,null,-v,0,!0),this.insertShaderBorders(f,g,v,null,-v,0,!1),this.insertShaderBorders(f,v,g+v,-v,null,-v,!0),this.insertShaderBorders(f,v,g+v,null,-v,-v,!0),this.insertShaderBorders(f,v,g+v,-v,null,-v,!1),this.insertShaderBorders(f,v,g+v,null,-v,-v,!1),this.hasBorderShaders=!0}l.append(f)}},a.prototype.insertShaderBorders=function(l,c,u,h,f,p,y){var v=document.createElement("div");v.style.position="absolute",v.style.backgroundColor=Wt.BORDER_SHADER_DEFAULT_COLOR,v.style.width="".concat(c,"px"),v.style.height="".concat(u,"px"),h!==null&&(v.style.top="".concat(h,"px")),f!==null&&(v.style.bottom="".concat(f,"px")),y?v.style.left="".concat(p,"px"):v.style.right="".concat(p,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(v),l.appendChild(v)},a.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},a.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},a.prototype.getTimeoutFps=function(l){return 1e3/l},a}(),pi="data:image/svg+xml;base64,",Fu=pi+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",Uu=pi+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",ga=pi+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",Vu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",pa=function(){function a(){}return a.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},a}(),Hu=function(){function a(){this.data=pa.createDefault();var l=localStorage.getItem(a.LOCAL_STORAGE_KEY);l?this.data=JSON.parse(l):this.reset()}return a.prototype.hasCameraPermissions=function(){return this.data.hasPermission},a.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},a.prototype.setHasPermission=function(l){this.data.hasPermission=l,this.flush()},a.prototype.setLastUsedCameraId=function(l){this.data.lastUsedCameraId=l,this.flush()},a.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},a.prototype.reset=function(){this.data=pa.createDefault(),this.flush()},a.prototype.flush=function(){localStorage.setItem(a.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},a.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",a}(),Gu=function(){function a(){this.infoDiv=document.createElement("div")}return a.prototype.renderInto=function(l){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=la.poweredBy();var c=document.createElement("a");c.innerText="ScanApp",c.href="https://scanapp.org",c.target="new",c.style.color="white",this.infoDiv.appendChild(c);var u=document.createElement("br"),h=document.createElement("br");this.infoDiv.appendChild(u),this.infoDiv.appendChild(h);var f=document.createElement("a");f.innerText=la.reportIssues(),f.href="https://github.com/mebjas/html5-qrcode/issues",f.target="new",f.style.color="white",this.infoDiv.appendChild(f),l.appendChild(this.infoDiv)},a.prototype.show=function(){this.infoDiv.style.display="block"},a.prototype.hide=function(){this.infoDiv.style.display="none"},a}(),zu=function(){function a(l,c){this.isShowingInfoIcon=!0,this.onTapIn=l,this.onTapOut=c,this.infoIcon=document.createElement("img")}return a.prototype.renderInto=function(l){var c=this;this.infoIcon.alt="Info icon",this.infoIcon.src=ga,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(u){return c.onHoverIn()},this.infoIcon.onmouseout=function(u){return c.onHoverOut()},this.infoIcon.onclick=function(u){return c.onClick()},l.appendChild(this.infoIcon)},a.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},a.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},a.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=Vu,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=ga,this.infoIcon.style.opacity="0.6")},a}(),Wu=function(){function a(){var l=this;this.infoDiv=new Gu,this.infoIcon=new zu(function(){l.infoDiv.show()},function(){l.infoDiv.hide()})}return a.prototype.renderInto=function(l){this.infoDiv.renderInto(l),this.infoIcon.renderInto(l)},a}(),Yu=function(a,l,c,u){function h(f){return f instanceof c?f:new c(function(p){p(f)})}return new(c||(c=Promise))(function(f,p){function y(w){try{g(u.next(w))}catch(N){p(N)}}function v(w){try{g(u.throw(w))}catch(N){p(N)}}function g(w){w.done?f(w.value):h(w.value).then(y,v)}g((u=u.apply(a,l||[])).next())})},Xu=function(a,l){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},u,h,f,p;return p={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function y(g){return function(w){return v([g,w])}}function v(g){if(u)throw new TypeError("Generator is already executing.");for(;p&&(p=0,g[0]&&(c=0)),c;)try{if(u=1,h&&(f=g[0]&2?h.return:g[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,g[1])).done)return f;switch(h=0,f&&(g=[g[0]&2,f.value]),g[0]){case 0:case 1:f=g;break;case 4:return c.label++,{value:g[1],done:!1};case 5:c.label++,h=g[1],g=[0];continue;case 7:g=c.ops.pop(),c.trys.pop();continue;default:if(f=c.trys,!(f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1],f=g;break}if(f&&c.label<f[2]){c.label=f[2],c.ops.push(g);break}f[2]&&c.ops.pop(),c.trys.pop();continue}g=l.call(a,c)}catch(w){g=[6,w],h=0}finally{u=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},ya=function(){function a(){}return a.hasPermissions=function(){return Yu(this,void 0,void 0,function(){var l,c,u,h;return Xu(this,function(f){switch(f.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(l=f.sent(),c=0,u=l;c<u.length;c++)if(h=u[c],h.kind==="videoinput"&&h.label)return[2,!0];return[2,!1]}})})},a}(),Lr=function(){function a(l){this.supportedScanTypes=this.validateAndReturnScanTypes(l)}return a.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},a.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},a.prototype.isCameraScanRequired=function(){for(var l=0,c=this.supportedScanTypes;l<c.length;l++){var u=c[l];if(a.isCameraScanType(u))return!0}return!1},a.isCameraScanType=function(l){return l===Ur.SCAN_TYPE_CAMERA},a.isFileScanType=function(l){return l===Ur.SCAN_TYPE_FILE},a.prototype.validateAndReturnScanTypes=function(l){if(!l||l.length===0)return ar.DEFAULT_SUPPORTED_SCAN_TYPE;var c=ar.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(l.length>c)throw"Max ".concat(c," values expected for ")+"supportedScanTypes";for(var u=0,h=l;u<h.length;u++){var f=h[u];if(!ar.DEFAULT_SUPPORTED_SCAN_TYPE.includes(f))throw"Unsupported scan type ".concat(f)}return l},a}(),Xt=function(){function a(){}return a.ALL_ELEMENT_CLASS="html5-qrcode-element",a.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",a.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",a.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",a.TORCH_BUTTON_ID="html5-qrcode-button-torch",a.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",a.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",a.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",a.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",a.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",a.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",a}(),Er=function(){function a(){}return a.createElement=function(l,c){var u=document.createElement(l);return u.id=c,u.classList.add(Xt.ALL_ELEMENT_CLASS),l==="button"&&u.setAttribute("type","button"),u},a}(),yo=function(a,l,c,u){function h(f){return f instanceof c?f:new c(function(p){p(f)})}return new(c||(c=Promise))(function(f,p){function y(w){try{g(u.next(w))}catch(N){p(N)}}function v(w){try{g(u.throw(w))}catch(N){p(N)}}function g(w){w.done?f(w.value):h(w.value).then(y,v)}g((u=u.apply(a,l||[])).next())})},bo=function(a,l){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},u,h,f,p;return p={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function y(g){return function(w){return v([g,w])}}function v(g){if(u)throw new TypeError("Generator is already executing.");for(;p&&(p=0,g[0]&&(c=0)),c;)try{if(u=1,h&&(f=g[0]&2?h.return:g[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,g[1])).done)return f;switch(h=0,f&&(g=[g[0]&2,f.value]),g[0]){case 0:case 1:f=g;break;case 4:return c.label++,{value:g[1],done:!1};case 5:c.label++,h=g[1],g=[0];continue;case 7:g=c.ops.pop(),c.trys.pop();continue;default:if(f=c.trys,!(f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1],f=g;break}if(f&&c.label<f[2]){c.label=f[2],c.ops.push(g);break}f[2]&&c.ops.pop(),c.trys.pop();continue}g=l.call(a,c)}catch(w){g=[6,w],h=0}finally{u=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},ba=function(){function a(l,c,u){this.isTorchOn=!1,this.torchCapability=l,this.buttonController=c,this.onTorchActionFailureCallback=u}return a.prototype.isTorchEnabled=function(){return this.isTorchOn},a.prototype.flipState=function(){return yo(this,void 0,void 0,function(){var l,c;return bo(this,function(u){switch(u.label){case 0:this.buttonController.disable(),l=!this.isTorchOn,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.torchCapability.apply(l)];case 2:return u.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),l),[3,4];case 3:return c=u.sent(),this.propagateFailure(l,c),this.buttonController.enable(),[3,4];case 4:return[2]}})})},a.prototype.updateUiBasedOnLatestSettings=function(l,c){l===c?(this.buttonController.setText(c?Ye.torchOffButton():Ye.torchOnButton()),this.isTorchOn=c):this.propagateFailure(c),this.buttonController.enable()},a.prototype.propagateFailure=function(l,c){var u=l?Ye.torchOnFailedMessage():Ye.torchOffFailedMessage();c&&(u+="; Error = "+c),this.onTorchActionFailureCallback(u)},a.prototype.reset=function(){this.isTorchOn=!1},a}(),qu=function(){function a(l,c){this.onTorchActionFailureCallback=c,this.torchButton=Er.createElement("button",Xt.TORCH_BUTTON_ID),this.torchController=new ba(l,this,c)}return a.prototype.render=function(l,c){var u=this;this.torchButton.innerText=Ye.torchOnButton(),this.torchButton.style.display=c.display,this.torchButton.style.marginLeft=c.marginLeft;var h=this;this.torchButton.addEventListener("click",function(f){return yo(u,void 0,void 0,function(){return bo(this,function(p){switch(p.label){case 0:return[4,h.torchController.flipState()];case 1:return p.sent(),h.torchController.isTorchEnabled()?(h.torchButton.classList.remove(Xt.TORCH_BUTTON_CLASS_TORCH_OFF),h.torchButton.classList.add(Xt.TORCH_BUTTON_CLASS_TORCH_ON)):(h.torchButton.classList.remove(Xt.TORCH_BUTTON_CLASS_TORCH_ON),h.torchButton.classList.add(Xt.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),l.appendChild(this.torchButton)},a.prototype.updateTorchCapability=function(l){this.torchController=new ba(l,this,this.onTorchActionFailureCallback)},a.prototype.getTorchButton=function(){return this.torchButton},a.prototype.hide=function(){this.torchButton.style.display="none"},a.prototype.show=function(){this.torchButton.style.display="inline-block"},a.prototype.disable=function(){this.torchButton.disabled=!0},a.prototype.enable=function(){this.torchButton.disabled=!1},a.prototype.setText=function(l){this.torchButton.innerText=l},a.prototype.reset=function(){this.torchButton.innerText=Ye.torchOnButton(),this.torchController.reset()},a.create=function(l,c,u,h){var f=new a(c,h);return f.render(l,u),f},a}(),Zu=function(){function a(l,c,u){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=c?"block":"none",l.appendChild(this.fileBasedScanRegion);var h=document.createElement("label");h.setAttribute("for",this.getFileScanInputId()),h.style.display="inline-block",this.fileBasedScanRegion.appendChild(h),this.fileSelectionButton=Er.createElement("button",Xt.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(y){h.click()}),h.append(this.fileSelectionButton),this.fileScanInput=Er.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",h.appendChild(this.fileScanInput);var f=this;this.fileScanInput.addEventListener("change",function(y){if(!(y==null||y.target==null)){var v=y.target;if(!(v.files&&v.files.length===0)){var g=v.files,w=g[0],N=w.name;f.setImageNameToButton(N),u(w)}}});var p=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(p),this.fileBasedScanRegion.addEventListener("dragenter",function(y){f.fileBasedScanRegion.style.border=f.fileBasedScanRegionActiveBorder(),y.stopPropagation(),y.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(y){f.fileBasedScanRegion.style.border=f.fileBasedScanRegionDefaultBorder(),y.stopPropagation(),y.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(y){f.fileBasedScanRegion.style.border=f.fileBasedScanRegionActiveBorder(),y.stopPropagation(),y.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(y){y.stopPropagation(),y.preventDefault(),f.fileBasedScanRegion.style.border=f.fileBasedScanRegionDefaultBorder();var v=y.dataTransfer;if(v){var g=v.files;if(!g||g.length===0)return;for(var w=!1,N=0;N<g.length;++N){var j=g.item(N);if(j){var _=/image.*/;if(j.type.match(_)){w=!0;var L=j.name;f.setImageNameToButton(L),u(j),p.innerText=Ye.dragAndDropMessage();break}}}w||(p.innerText=Ye.dragAndDropMessageOnlyImages())}})}return a.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},a.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},a.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},a.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},a.prototype.createFileBasedScanRegion=function(){var l=document.createElement("div");return l.style.textAlign="center",l.style.margin="auto",l.style.width="80%",l.style.maxWidth="600px",l.style.border=this.fileBasedScanRegionDefaultBorder(),l.style.padding="10px",l.style.marginBottom="10px",l},a.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},a.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},a.prototype.createDragAndDropMessage=function(){var l=document.createElement("div");return l.innerText=Ye.dragAndDropMessage(),l.style.fontWeight="400",l},a.prototype.setImageNameToButton=function(l){var c=20;if(l.length>c){var u=l.substring(0,8),h=l.length,f=l.substring(h-8,h);l="".concat(u,"....").concat(f)}var p=Ye.fileSelectionChooseAnother()+" - "+l;this.fileSelectionButton.innerText=p},a.prototype.setInitialValueToButton=function(){var l=Ye.fileSelectionChooseImage()+" - "+Ye.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=l},a.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},a.create=function(l,c,u){var h=new a(l,c,u);return h},a}(),$u=function(){function a(l){this.selectElement=Er.createElement("select",Xt.CAMERA_SELECTION_SELECT_ID),this.cameras=l,this.options=[]}return a.prototype.render=function(l){var c=document.createElement("span");c.style.marginRight="10px";var u=this.cameras.length;if(u===0)throw new Error("No cameras found");if(u===1)c.style.display="none";else{var h=Ye.selectCamera();c.innerText="".concat(h," (").concat(this.cameras.length,")  ")}for(var f=1,p=0,y=this.cameras;p<y.length;p++){var v=y[p],g=v.id,w=v.label==null?g:v.label;(!w||w==="")&&(w=[Ye.anonymousCameraPrefix(),f++].join(" "));var N=document.createElement("option");N.value=g,N.innerText=w,this.options.push(N),this.selectElement.appendChild(N)}c.appendChild(this.selectElement),l.appendChild(c)},a.prototype.disable=function(){this.selectElement.disabled=!0},a.prototype.isDisabled=function(){return this.selectElement.disabled===!0},a.prototype.enable=function(){this.selectElement.disabled=!1},a.prototype.getValue=function(){return this.selectElement.value},a.prototype.hasValue=function(l){for(var c=0,u=this.options;c<u.length;c++){var h=u[c];if(h.value===l)return!0}return!1},a.prototype.setValue=function(l){if(!this.hasValue(l))throw new Error("".concat(l," is not present in the camera list."));this.selectElement.value=l},a.prototype.hasSingleItem=function(){return this.cameras.length===1},a.prototype.numCameras=function(){return this.cameras.length},a.create=function(l,c){var u=new a(c);return u.render(l),u},a}(),Qu=function(){function a(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=Er.createElement("input",Xt.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return a.prototype.render=function(l,c){this.zoomElementContainer.style.display=c?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",l.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var u=Ye.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(u),this.rangeText.style.marginRight="10px";var h=this;this.rangeInput.addEventListener("input",function(){return h.onValueChange()}),this.rangeInput.addEventListener("change",function(){return h.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},a.prototype.onValueChange=function(){var l=Ye.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(l),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},a.prototype.setValues=function(l,c,u,h){this.rangeInput.min=l.toString(),this.rangeInput.max=c.toString(),this.rangeInput.step=h.toString(),this.rangeInput.value=u.toString(),this.onValueChange()},a.prototype.show=function(){this.zoomElementContainer.style.display="block"},a.prototype.hide=function(){this.zoomElementContainer.style.display="none"},a.prototype.setOnCameraZoomValueChangeCallback=function(l){this.onChangeCallback=l},a.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},a.create=function(l,c){var u=new a;return u.render(l,c),u},a}(),Yt;(function(a){a[a.STATUS_DEFAULT=0]="STATUS_DEFAULT",a[a.STATUS_SUCCESS=1]="STATUS_SUCCESS",a[a.STATUS_WARNING=2]="STATUS_WARNING",a[a.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Yt||(Yt={}));function Ku(a){return{fps:a.fps,qrbox:a.qrbox,aspectRatio:a.aspectRatio,disableFlip:a.disableFlip,videoConstraints:a.videoConstraints}}function Ju(a,l){return{formatsToSupport:a.formatsToSupport,useBarCodeDetectorIfSupported:a.useBarCodeDetectorIfSupported,experimentalFeatures:a.experimentalFeatures,verbose:l}}var eh=function(){function a(l,c,u){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=l,this.config=this.createConfig(c),this.verbose=u===!0,!document.getElementById(l))throw"HTML Element with id=".concat(l," not found");this.scanTypeSelector=new Lr(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new mo(this.verbose),this.persistedDataManager=new Hu,c.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return a.prototype.render=function(l,c){var u=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(f,p){if(l)l(f,p);else{if(u.lastMatchFound===f)return;u.lastMatchFound=f,u.setHeaderMessage(Ye.lastMatch(f),Yt.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(f,p){c&&c(f,p)};var h=document.getElementById(this.elementId);if(!h)throw"HTML Element with id=".concat(this.elementId," not found");h.innerHTML="",this.createBasicLayout(h),this.html5Qrcode=new ma(this.getScanRegionId(),Ju(this.config,this.verbose))},a.prototype.pause=function(l){(gr(l)||l!==!0)&&(l=!1),this.getHtml5QrcodeOrFail().pause(l)},a.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},a.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},a.prototype.clear=function(){var l=this,c=function(){var u=document.getElementById(l.elementId);u&&(u.innerHTML="",l.resetBasicLayout(u))};return this.html5Qrcode?new Promise(function(u,h){if(!l.html5Qrcode){u();return}l.html5Qrcode.isScanning?l.html5Qrcode.stop().then(function(f){if(!l.html5Qrcode){u();return}l.html5Qrcode.clear(),c(),u()}).catch(function(f){l.verbose&&l.logger.logError("Unable to stop qrcode scanner",f),h(f)}):(l.html5Qrcode.clear(),c(),u())}):Promise.resolve()},a.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},a.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},a.prototype.applyVideoConstraints=function(l){return this.getHtml5QrcodeOrFail().applyVideoConstraints(l)},a.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},a.prototype.createConfig=function(l){return l?(l.fps||(l.fps=ar.SCAN_DEFAULT_FPS),l.rememberLastUsedCamera!==!ar.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(l.rememberLastUsedCamera=ar.DEFAULT_REMEMBER_LAST_CAMERA_USED),l.supportedScanTypes||(l.supportedScanTypes=ar.DEFAULT_SUPPORTED_SCAN_TYPE),l):{fps:ar.SCAN_DEFAULT_FPS,rememberLastUsedCamera:ar.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:ar.DEFAULT_SUPPORTED_SCAN_TYPE}},a.prototype.createBasicLayout=function(l){l.style.position="relative",l.style.padding="0px",l.style.border="1px solid silver",this.createHeader(l);var c=document.createElement("div"),u=this.getScanRegionId();c.id=u,c.style.width="100%",c.style.minHeight="100px",c.style.textAlign="center",l.appendChild(c),Lr.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var h=document.createElement("div"),f=this.getDashboardId();h.id=f,h.style.width="100%",l.appendChild(h),this.setupInitialDashboard(h)},a.prototype.resetBasicLayout=function(l){l.style.border="none"},a.prototype.setupInitialDashboard=function(l){this.createSection(l),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},a.prototype.createHeader=function(l){var c=document.createElement("div");c.style.textAlign="left",c.style.margin="0px",l.appendChild(c);var u=new Wu;u.renderInto(c);var h=document.createElement("div");h.id=this.getHeaderMessageContainerId(),h.style.display="none",h.style.textAlign="center",h.style.fontSize="14px",h.style.padding="2px 10px",h.style.margin="4px",h.style.borderTop="1px solid #f6f6f6",c.appendChild(h)},a.prototype.createSection=function(l){var c=document.createElement("div");c.id=this.getDashboardSectionId(),c.style.width="100%",c.style.padding="10px 0px 10px 0px",c.style.textAlign="left",l.appendChild(c)},a.prototype.createCameraListUi=function(l,c,u){var h=this;h.showHideScanTypeSwapLink(!1),h.setHeaderMessage(Ye.cameraPermissionRequesting());var f=function(){u||h.createPermissionButton(l,c)};ma.getCameras().then(function(p){h.persistedDataManager.setHasPermission(!0),h.showHideScanTypeSwapLink(!0),h.resetHeaderMessage(),p&&p.length>0?(l.removeChild(c),h.renderCameraSelection(p)):(h.setHeaderMessage(Ye.noCameraFound(),Yt.STATUS_WARNING),f())}).catch(function(p){h.persistedDataManager.setHasPermission(!1),u?u.disabled=!1:f(),h.setHeaderMessage(p,Yt.STATUS_WARNING),h.showHideScanTypeSwapLink(!0)})},a.prototype.createPermissionButton=function(l,c){var u=this,h=Er.createElement("button",this.getCameraPermissionButtonId());h.innerText=Ye.cameraPermissionTitle(),h.addEventListener("click",function(){h.disabled=!0,u.createCameraListUi(l,c,h)}),c.appendChild(h)},a.prototype.createPermissionsUi=function(l,c){var u=this;if(Lr.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){ya.hasPermissions().then(function(h){h?u.createCameraListUi(l,c):(u.persistedDataManager.setHasPermission(!1),u.createPermissionButton(l,c))}).catch(function(h){u.persistedDataManager.setHasPermission(!1),u.createPermissionButton(l,c)});return}this.createPermissionButton(l,c)},a.prototype.createSectionControlPanel=function(){var l=document.getElementById(this.getDashboardSectionId()),c=document.createElement("div");l.appendChild(c);var u=document.createElement("div");u.id=this.getDashboardSectionCameraScanRegionId(),u.style.display=Lr.isCameraScanType(this.currentScanType)?"block":"none",c.appendChild(u);var h=document.createElement("div");h.style.textAlign="center",u.appendChild(h),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(u,h),this.renderFileScanUi(c)},a.prototype.renderFileScanUi=function(l){var c=Lr.isFileScanType(this.currentScanType),u=this,h=function(f){if(!u.html5Qrcode)throw"html5Qrcode not defined";Lr.isFileScanType(u.currentScanType)&&(u.setHeaderMessage(Ye.loadingImage()),u.html5Qrcode.scanFileV2(f,!0).then(function(p){u.resetHeaderMessage(),u.qrCodeSuccessCallback(p.decodedText,p)}).catch(function(p){u.setHeaderMessage(p,Yt.STATUS_WARNING),u.qrCodeErrorCallback(p,xo.createFrom(p))}))};this.fileSelectionUi=Zu.create(l,c,h)},a.prototype.renderCameraSelection=function(l){var c=this,u=this,h=document.getElementById(this.getDashboardSectionCameraScanRegionId());h.style.textAlign="center";var f=Qu.create(h,!1),p=function(D){var P=D.zoomFeature();if(P.isSupported()){f.setOnCameraZoomValueChangeCallback(function(I){P.apply(I)});var S=1;c.config.defaultZoomValueIfSupported&&(S=c.config.defaultZoomValueIfSupported),S=yu(S,P.min(),P.max()),f.setValues(P.min(),P.max(),S,P.step()),f.show()}},y=$u.create(h,l),v=document.createElement("span"),g=Er.createElement("button",Xt.CAMERA_START_BUTTON_ID);g.innerText=Ye.scanButtonStartScanningText(),v.appendChild(g);var w=Er.createElement("button",Xt.CAMERA_STOP_BUTTON_ID);w.innerText=Ye.scanButtonStopScanningText(),w.style.display="none",w.disabled=!0,v.appendChild(w);var N,j=function(D){if(!D.torchFeature().isSupported()){N&&N.hide();return}N?N.updateTorchCapability(D.torchFeature()):N=qu.create(v,D.torchFeature(),{display:"none",marginLeft:"5px"},function(P){u.setHeaderMessage(P,Yt.STATUS_WARNING)}),N.show()};h.appendChild(v);var _=function(D){D||(g.style.display="none"),g.innerText=Ye.scanButtonStartScanningText(),g.style.opacity="1",g.disabled=!1,D&&(g.style.display="inline-block")};if(g.addEventListener("click",function(D){g.innerText=Ye.scanButtonScanningStarting(),y.disable(),g.disabled=!0,g.style.opacity="0.5",c.scanTypeSelector.hasMoreThanOneScanType()&&u.showHideScanTypeSwapLink(!1),u.resetHeaderMessage();var P=y.getValue();u.persistedDataManager.setLastUsedCameraId(P),u.html5Qrcode.start(P,Ku(u.config),u.qrCodeSuccessCallback,u.qrCodeErrorCallback).then(function(S){w.disabled=!1,w.style.display="inline-block",_(!1);var I=u.html5Qrcode.getRunningTrackCameraCapabilities();c.config.showTorchButtonIfSupported===!0&&j(I),c.config.showZoomSliderIfSupported===!0&&p(I)}).catch(function(S){u.showHideScanTypeSwapLink(!0),y.enable(),_(!0),u.setHeaderMessage(S,Yt.STATUS_WARNING)})}),y.hasSingleItem()&&g.click(),w.addEventListener("click",function(D){if(!u.html5Qrcode)throw"html5Qrcode not defined";w.disabled=!0,u.html5Qrcode.stop().then(function(P){c.scanTypeSelector.hasMoreThanOneScanType()&&u.showHideScanTypeSwapLink(!0),y.enable(),g.disabled=!1,w.style.display="none",g.style.display="inline-block",N&&(N.reset(),N.hide()),f.removeOnCameraZoomValueChangeCallback(),f.hide(),u.insertCameraScanImageToScanRegion()}).catch(function(P){w.disabled=!1,u.setHeaderMessage(P,Yt.STATUS_WARNING)})}),u.persistedDataManager.getLastUsedCameraId()){var L=u.persistedDataManager.getLastUsedCameraId();y.hasValue(L)?(y.setValue(L),g.click()):u.persistedDataManager.resetLastUsedCameraId()}},a.prototype.createSectionSwap=function(){var l=this,c=Ye.textIfCameraScanSelected(),u=Ye.textIfFileScanSelected(),h=document.getElementById(this.getDashboardSectionId()),f=document.createElement("div");f.style.textAlign="center";var p=Er.createElement("span",this.getDashboardSectionSwapLinkId());p.style.textDecoration="underline",p.style.cursor="pointer",p.innerText=Lr.isCameraScanType(this.currentScanType)?c:u,p.addEventListener("click",function(){if(!l.sectionSwapAllowed){l.verbose&&l.logger.logError("Section swap called when not allowed");return}l.resetHeaderMessage(),l.fileSelectionUi.resetValue(),l.sectionSwapAllowed=!1,Lr.isCameraScanType(l.currentScanType)?(l.clearScanRegion(),l.getCameraScanRegion().style.display="none",l.fileSelectionUi.show(),p.innerText=u,l.currentScanType=Ur.SCAN_TYPE_FILE,l.insertFileScanImageToScanRegion()):(l.clearScanRegion(),l.getCameraScanRegion().style.display="block",l.fileSelectionUi.hide(),p.innerText=c,l.currentScanType=Ur.SCAN_TYPE_CAMERA,l.insertCameraScanImageToScanRegion(),l.startCameraScanIfPermissionExistsOnSwap()),l.sectionSwapAllowed=!0}),f.appendChild(p),h.appendChild(f)},a.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var l=this,c=this;if(this.persistedDataManager.hasCameraPermissions()){ya.hasPermissions().then(function(u){if(u){var h=document.getElementById(c.getCameraPermissionButtonId());if(!h)throw l.logger.logError("Permission button not found, fail;"),"Permission button not found";h.click()}else c.persistedDataManager.setHasPermission(!1)}).catch(function(u){c.persistedDataManager.setHasPermission(!1)});return}},a.prototype.resetHeaderMessage=function(){var l=document.getElementById(this.getHeaderMessageContainerId());l.style.display="none"},a.prototype.setHeaderMessage=function(l,c){c||(c=Yt.STATUS_DEFAULT);var u=this.getHeaderMessageDiv();switch(u.innerText=l,u.style.display="block",c){case Yt.STATUS_SUCCESS:u.style.background="rgba(106, 175, 80, 0.26)",u.style.color="#477735";break;case Yt.STATUS_WARNING:u.style.background="rgba(203, 36, 49, 0.14)",u.style.color="#cb2431";break;case Yt.STATUS_DEFAULT:default:u.style.background="rgba(0, 0, 0, 0)",u.style.color="rgb(17, 17, 17)";break}},a.prototype.showHideScanTypeSwapLink=function(l){this.scanTypeSelector.hasMoreThanOneScanType()&&(l!==!0&&(l=!1),this.sectionSwapAllowed=l,this.getDashboardSectionSwapLink().style.display=l?"inline-block":"none")},a.prototype.insertCameraScanImageToScanRegion=function(){var l=this,c=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){c.innerHTML="<br>",c.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(u){c.innerHTML="<br>",c.appendChild(l.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=Fu,this.cameraScanImage.alt=Ye.cameraScanAltText()},a.prototype.insertFileScanImageToScanRegion=function(){var l=this,c=document.getElementById(this.getScanRegionId());if(this.fileScanImage){c.innerHTML="<br>",c.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(u){c.innerHTML="<br>",c.appendChild(l.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=Uu,this.fileScanImage.alt=Ye.fileScanAltText()},a.prototype.clearScanRegion=function(){var l=document.getElementById(this.getScanRegionId());l.innerHTML=""},a.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},a.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},a.prototype.getDashboardSectionSwapLinkId=function(){return Xt.SCAN_TYPE_CHANGE_ANCHOR_ID},a.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},a.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},a.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},a.prototype.getCameraPermissionButtonId=function(){return Xt.CAMERA_PERMISSION_BUTTON_ID},a.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},a.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},a.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},a}();const th=()=>{const a=Jr(),[l,c]=O.useState(null),[u,h]=O.useState(!1),[f,p]=O.useState([]),{validateTicket:y,recordTicketScan:v,validateGuestlist:g,recordGuestlistScan:w}=jr(),N=O.useRef(null),j=O.useRef(null),_=O.useRef(null),L=O.useRef(""),D=O.useRef(!1);O.useEffect(()=>{if(j.current)return N.current=new eh("qr-reader",{fps:10,qrbox:{width:250,height:250},aspectRatio:1},!1),N.current.render(P,S),()=>{N.current&&N.current.clear(),_.current&&clearTimeout(_.current)}},[]);const P=async M=>{if(L.current===M){console.log(" Duplicate QR code detected, ignoring");return}if(D.current||u){console.log(" Already processing, ignoring scan");return}D.current=!0,h(!0),L.current=M;try{console.log(" Raw QR code data:",M);const z=JSON.parse(M);console.log(" Parsed QR data:",z);let K;if(z.type==="guestlist"){if(console.log(" Processing guestlist QR code"),K=await g(z.guestlistId,"entry"),console.log(" Guestlist validation result:",K),K.isValid){await w({guestlistId:z.guestlistId,eventId:K.eventId||"",scanType:"entry",location:"",notes:"",scannedBy:"admin"});const{data:ce}=await xe.from("guestlists").select("remaining_scans").eq("id",z.guestlistId).single(),Q=(ce==null?void 0:ce.remaining_scans)||0,ye=Q===1?"1 ticket remaining":`${Q} tickets remaining`,J={...K,message:ye},bt={...J,scanType:"entry",timestamp:new Date().toISOString()};p(Z=>[bt,...Z.slice(0,9)]),c(J)}}else if(console.log(" Processing regular ticket QR code"),K=await y(z.orderId,z.ticketTierId,z.customer,"entry"),console.log(" Ticket validation result:",K),K.isValid){await v({orderId:z.orderId,ticketTierId:z.ticketTierId,customerEmail:z.customer,eventId:K.eventId||"",scanType:"entry",location:"",notes:""});const ce={...K,scanType:"entry",timestamp:new Date().toISOString()};p(Q=>[ce,...Q.slice(0,9)])}l||c(K),_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{c(null)},3e3)}catch(z){console.error("Scan error:",z),c({isValid:!1,message:"Invalid QR code format",orderStatus:"unknown",eventDate:"unknown",customerName:"unknown",customerEmail:"unknown"}),_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{c(null)},1e3)}finally{h(!1),D.current=!1,setTimeout(()=>{L.current=""},1e3)}},S=M=>{console.error("QR Scanner error:",M)},I=()=>{_.current&&clearTimeout(_.current),c(null)};return r.jsx("div",{className:"min-h-screen bg-gray-50 p-2 sm:p-4",children:r.jsxs("div",{className:"max-w-2xl mx-auto",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6 text-center",children:[r.jsxs("div",{className:"mb-4",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Ticket Scanner"}),r.jsx("p",{className:"text-gray-600 text-lg",children:"Scan QR codes to validate tickets and record entry"})]}),r.jsxs("button",{onClick:()=>a("/admin/dashboard"),className:"flex items-center gap-2 px-6 py-3 text-gray-700 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors mx-auto text-lg font-medium",children:[r.jsx(ol,{className:"h-5 w-5"}),"Back to Dashboard"]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6 text-center",children:"QR Code Scanner"}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{id:"qr-reader",ref:j,className:"w-full max-w-sm mx-auto"}),r.jsxs("div",{className:"text-center mt-6 space-y-2",children:[r.jsx("p",{className:"text-gray-600 text-lg font-medium",children:" Position QR code within the frame"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Hold steady for best results"})]})]})]}),u&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-lg font-medium text-gray-900",children:"Processing ticket..."}),r.jsx("p",{className:"text-sm text-gray-600",children:"Please wait"})]})}),l&&!u&&r.jsx(oi,{children:r.jsx(Y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 cursor-pointer",onClick:I,children:r.jsxs(Y.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:`p-8 rounded-2xl border-2 max-w-lg w-full mx-4 text-center ${l.isValid?"border-green-300 bg-white shadow-green-100":"border-red-300 bg-white shadow-red-100"} shadow-2xl`,onClick:M=>M.stopPropagation(),children:[r.jsx("div",{className:"mb-6",children:l.isValid?r.jsx(Pt,{className:"h-20 w-20 text-green-500 mx-auto"}):r.jsx(Rs,{className:"h-20 w-20 text-red-500 mx-auto"})}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:`text-3xl font-bold mb-2 ${l.isValid?"text-green-800":"text-red-800"}`,children:l.isValid?"VALID TICKET":"INVALID TICKET"}),r.jsx("p",{className:`text-lg ${l.isValid?"text-green-700":"text-red-700"}`,children:l.message}),l.message.includes("already scanned")&&r.jsx("p",{className:"text-orange-600 mt-2 font-medium",children:" Already Scanned for Entry"})]}),r.jsxs("div",{className:"space-y-4 text-left bg-gray-50 p-4 rounded-xl",children:[r.jsxs("div",{className:"flex items-center justify-center gap-3",children:[r.jsx(Sa,{className:"h-5 w-5 text-gray-600"}),r.jsx("span",{className:"font-semibold text-lg text-gray-900",children:l.customerName})]}),r.jsxs("div",{className:"flex items-center justify-center gap-3",children:[r.jsx(yt,{className:"h-5 w-5 text-gray-600"}),r.jsx("span",{className:"text-gray-700",children:l.eventDate&&l.eventDate!=="unknown"?new Date(l.eventDate).toLocaleDateString():"Unknown Date"})]}),l.eventTitle&&r.jsxs("div",{className:"flex items-center justify-center gap-3",children:[r.jsx(br,{className:"h-5 w-5 text-gray-600"}),r.jsx("span",{className:"font-medium text-gray-900",children:l.eventTitle})]}),l.ticketTierName&&r.jsxs("div",{className:"flex items-center justify-center gap-3",children:[r.jsx(fs,{className:"h-5 w-5 text-gray-600"}),r.jsx("span",{className:"text-gray-700",children:l.ticketTierName})]})]}),r.jsx("p",{className:"text-sm text-gray-500 mt-6",children:"Tap anywhere to close"})]})})}),f.length>0&&r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mt-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6 text-center",children:"Recent Scans"}),r.jsx("div",{className:"space-y-4",children:f.map((M,z)=>r.jsxs("div",{className:`p-4 rounded-xl border-2 ${M.isValid?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[r.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[M.isValid?r.jsx(Pt,{className:"h-6 w-6 text-green-600 flex-shrink-0"}):r.jsx(Rs,{className:"h-6 w-6 text-red-600 flex-shrink-0"}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:`font-semibold text-lg ${M.isValid?"text-green-800":"text-red-800"}`,children:M.customerName}),r.jsx("p",{className:"text-gray-600",children:M.customerEmail})]})]}),r.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[r.jsx("p",{className:"font-medium text-gray-900 mb-1",children:M.eventTitle||"Unknown Event"}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Entry  ",M.timestamp?new Date(M.timestamp).toLocaleTimeString():M.eventDate&&M.eventDate!=="unknown"?new Date(M.eventDate).toLocaleDateString():"Unknown Date"]})]})]},z))})]})]})})},rh=({event:a,onClose:l,onSuccess:c,onManageGuestlists:u})=>{const[h,f]=O.useState({leadName:"",leadEmail:"",leadPhone:"",totalTickets:1,notes:""}),[p,y]=O.useState(!1),[v,g]=O.useState(null),w=async j=>{if(j.preventDefault(),!h.leadName||!h.leadEmail||h.totalTickets<1){g("Please fill in all required fields and ensure at least 1 ticket.");return}y(!0),g(null);try{const _=await fetch("/api/create-guestlist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:a.id,...h})});if(!_.ok){const D=await _.json();throw new Error(D.error||"Failed to create guestlist")}const L=await _.json();c(L.guestlist)}catch(_){g(_ instanceof Error?_.message:"An error occurred")}finally{y(!1)}},N=(j,_)=>{f(L=>({...L,[j]:_}))};return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs(Y.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsx("div",{className:"p-6 border-b",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create Guestlist"}),r.jsx("p",{className:"text-gray-600",children:a.title})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[u&&r.jsx("button",{onClick:u,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium",children:"Manage Guestlists"}),r.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600",children:r.jsx(Jt,{className:"h-6 w-6"})})]})]})}),r.jsxs("form",{onSubmit:w,className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[r.jsx(Qe,{className:"h-5 w-5"}),"Group Leader Information"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lead Name *"}),r.jsx("input",{type:"text",value:h.leadName,onChange:j=>N("leadName",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., John Smith",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lead Email *"}),r.jsx("input",{type:"email",value:h.leadEmail,onChange:j=>N("leadEmail",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"john@example.com",required:!0})]})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lead Phone (Optional)"}),r.jsx("input",{type:"tel",value:h.leadPhone,onChange:j=>N("leadPhone",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+44 123 456 7890"})]})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[r.jsx(nn,{className:"h-5 w-5"}),"Ticket Details"]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Number of Tickets *"}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx("button",{type:"button",onClick:()=>N("totalTickets",Math.max(1,h.totalTickets-1)),className:"w-10 h-10 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50 disabled:opacity-50",disabled:h.totalTickets<=1,children:"-"}),r.jsx("span",{className:"text-2xl font-bold text-gray-900 min-w-[3rem] text-center",children:h.totalTickets}),r.jsx("button",{type:"button",onClick:()=>N("totalTickets",h.totalTickets+1),className:"w-10 h-10 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50",children:"+"})]}),r.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["This will create one QR code that can be scanned ",h.totalTickets," times for entry."]})]})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[r.jsx(nn,{className:"h-5 w-5"}),"Additional Notes"]}),r.jsx("textarea",{value:h.notes,onChange:j=>N("notes",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"e.g., VIP table, special dietary requirements, arrival time..."})]}),r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Summary"}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Event:"}),r.jsx("span",{className:"font-medium",children:a.title})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Group Leader:"}),r.jsx("span",{className:"font-medium",children:h.leadName||"Not specified"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Contact:"}),r.jsx("span",{className:"font-medium",children:h.leadEmail||"Not specified"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Total Tickets:"}),r.jsx("span",{className:"font-medium",children:h.totalTickets})]}),h.notes&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Notes:"}),r.jsx("span",{className:"font-medium text-gray-600",children:h.notes})]})]})]}),v&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:r.jsx("p",{className:"text-red-800",children:v})}),r.jsx("button",{type:"submit",disabled:p,className:"w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:p?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),r.jsx("span",{children:"Creating Guestlist..."})]}):r.jsxs(r.Fragment,{children:[r.jsx(li,{className:"h-5 w-5"}),r.jsx("span",{children:"Create Guestlist & Send QR Code"})]})}),r.jsxs("div",{className:"text-center text-sm text-gray-500",children:[r.jsx("p",{children:"This will create a guestlist and automatically send a QR code to the group leader."}),r.jsxs("p",{children:["The QR code can be scanned ",h.totalTickets," times for entry."]})]})]})]})})},sh=({event:a,onClose:l,onCreateNew:c})=>{const[u,h]=O.useState([]),[f,p]=O.useState(!0);O.useEffect(()=>{y()},[a.id]);const y=async()=>{try{console.log(" Fetching guestlists for event:",a.id);const j=await fetch(`/api/guestlists?eventId=${a.id}`);if(console.log(" Response status:",j.status),!j.ok)throw new Error("Failed to fetch guestlists");const _=await j.json();console.log(" Response data:",_),h(_.guestlists||[])}catch(j){console.error(" Error fetching guestlists:",j)}finally{p(!1)}},v=async j=>{try{if(!(await fetch("/api/resend-guestlist-qr",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({guestlistId:j})})).ok)throw new Error("Failed to resend QR code");alert("QR code resent successfully!")}catch(_){alert(_ instanceof Error?_.message:"Failed to resend QR code")}},g=async j=>{if(confirm("Are you sure you want to delete this guestlist? This action cannot be undone."))try{if(!(await fetch(`/api/guestlists/${j}`,{method:"DELETE"})).ok)throw new Error("Failed to delete guestlist");h(L=>L.filter(D=>D.id!==j))}catch(_){alert(_ instanceof Error?_.message:"Failed to delete guestlist")}},w=()=>u.reduce((j,_)=>j+_.totalTickets,0),N=()=>u.reduce((j,_)=>j+(_.totalTickets-_.remainingScans),0);return f?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg p-8 text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Loading guestlists..."})]})}):r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs(Y.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsx("div",{className:"p-6 border-b",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Guestlist Management"}),r.jsx("p",{className:"text-gray-600",children:a.title})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[c&&r.jsx("button",{onClick:c,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:"Create New Guestlist"}),r.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600",children:r.jsx(Jt,{className:"h-6 w-6"})})]})]})}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Qe,{className:"h-8 w-8 text-blue-600"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Guestlists"}),r.jsx("p",{className:"text-2xl font-bold text-blue-900",children:u.length})]})]})}),r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(nn,{className:"h-8 w-8 text-green-600"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Total Tickets"}),r.jsx("p",{className:"text-2xl font-bold text-green-900",children:w()})]})]})}),r.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(yt,{className:"h-8 w-8 text-orange-600"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Tickets Used"}),r.jsx("p",{className:"text-2xl font-bold text-orange-900",children:N()})]})]})})]}),u.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx(Qe,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No guestlists yet"}),r.jsx("p",{className:"text-gray-500",children:"Create your first guestlist to get started."})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Group Leader"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tickets"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(j=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:j.leadName}),j.notes&&r.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:j.notes})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"text-sm text-gray-900",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(Us,{className:"h-4 w-4 text-gray-400"}),j.leadEmail]}),j.leadPhone&&r.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[r.jsx(un,{className:"h-4 w-4 text-gray-400"}),j.leadPhone]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"text-sm text-gray-900",children:[r.jsx("div",{className:"font-medium",children:j.totalTickets}),r.jsxs("div",{className:"text-gray-500",children:[j.remainingScans," remaining"]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${j.remainingScans===0?"bg-red-100 text-red-800":j.remainingScans<j.totalTickets?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:j.remainingScans===0?"All Used":j.remainingScans<j.totalTickets?"Partially Used":"Unused"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(j.createdAt).toLocaleDateString()}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("button",{onClick:()=>v(j.id),className:"text-blue-600 hover:text-blue-900 flex items-center gap-1",title:"Resend QR Code",children:[r.jsx(li,{className:"h-4 w-4"}),"Resend"]}),r.jsxs("button",{onClick:()=>g(j.id),className:"text-red-600 hover:text-red-900 flex items-center gap-1",title:"Delete Guestlist",children:[r.jsx(zn,{className:"h-4 w-4"}),"Delete"]})]})})]},j.id))})]})})]})]})})},$r=({filename:a,data:l,headers:c})=>{const u=[c.join(","),...l.map(y=>c.map(v=>{const g=y[v];return typeof g=="string"&&(g.includes(",")||g.includes('"'))?`"${g.replace(/"/g,'""')}"`:g}).join(","))].join(`
`),h=new Blob([u],{type:"text/csv;charset=utf-8;"}),f=document.createElement("a"),p=URL.createObjectURL(h);f.setAttribute("href",p),f.setAttribute("download",`${a}.csv`),f.style.visibility="hidden",document.body.appendChild(f),f.click(),document.body.removeChild(f)},nh=(a,l,c)=>{const u=`customer-data-${c}-${new Date().toISOString().split("T")[0]}`,h=a.filter(w=>{const N=new Date(w.createdAt),j=new Date;return j.setDate(j.getDate()-(c==="7d"?7:c==="30d"?30:90)),N>=j}),f=h.map(w=>{var _;const N=l.find(L=>L.id===w.eventId);return((_=w.tickets)==null?void 0:_.map(L=>{var P,S;const D=(P=N==null?void 0:N.ticketTiers)==null?void 0:P.find(I=>I.id===L.ticketTierId);return{"Customer Name":w.customerName||"N/A","Customer Email":w.customerEmail||"N/A","Order ID":((S=w.id)==null?void 0:S.slice(0,8))||"N/A","Event Title":(N==null?void 0:N.title)||"Unknown Event","Event Date":(N==null?void 0:N.date)||"N/A","Event Venue":(N==null?void 0:N.venue)||"N/A","Ticket Tier":(D==null?void 0:D.name)||"Unknown Tier","Ticket Price":D?`${(D.price/100).toFixed(2)}`:"N/A",Quantity:L.quantity||0,"Total Price":`${((L.totalPrice||0)/100).toFixed(2)}`,"Order Status":w.status||"N/A","Order Date":new Date(w.createdAt).toLocaleDateString(),"Order Time":new Date(w.createdAt).toLocaleTimeString(),Currency:w.currency||"gbp","Stripe Payment ID":w.stripePaymentIntentId||"N/A"}}))||[]}).flat();if(f.length>0){const w=["Customer Name","Customer Email","Order ID","Event Title","Event Date","Event Venue","Ticket Tier","Ticket Price","Quantity","Total Price","Order Status","Order Date","Order Time","Currency","Stripe Payment ID"];$r({filename:`${u}-purchases`,data:f,headers:w})}const p=h.reduce((w,N)=>{var L;const j=N.customerEmail||"Unknown";w[j]||(w[j]={"Customer Email":j,"Customer Name":N.customerName||"N/A","Total Orders":0,"Total Spent":0,"Total Tickets":0,"Events Attended":new Set,"First Order":new Date(N.createdAt),"Last Order":new Date(N.createdAt),"Favorite Event":"","Most Expensive Order":0}),w[j]["Total Orders"]++,w[j]["Total Spent"]+=N.totalAmount||0,w[j]["Total Tickets"]+=((L=N.tickets)==null?void 0:L.reduce((D,P)=>D+(P.quantity||0),0))||0;const _=l.find(D=>D.id===N.eventId);return _&&w[j]["Events Attended"].add(_.title),new Date(N.createdAt)<w[j]["First Order"]&&(w[j]["First Order"]=new Date(N.createdAt)),new Date(N.createdAt)>w[j]["Last Order"]&&(w[j]["Last Order"]=new Date(N.createdAt)),(N.totalAmount||0)>w[j]["Most Expensive Order"]&&(w[j]["Most Expensive Order"]=N.totalAmount||0),w},{}),y=Object.values(p).map(w=>({...w,"Events Attended":Array.from(w["Events Attended"]).join(", "),"First Order":w["First Order"].toLocaleDateString(),"Last Order":w["Last Order"].toLocaleDateString(),"Total Spent":`${(w["Total Spent"]/100).toFixed(2)}`,"Most Expensive Order":`${(w["Most Expensive Order"]/100).toFixed(2)}`}));if(y.length>0){const w=["Customer Email","Customer Name","Total Orders","Total Spent","Total Tickets","Events Attended","First Order","Last Order","Favorite Event","Most Expensive Order"];$r({filename:`${u}-summary`,data:y,headers:w})}const v=h.map(w=>{var P,S,I;const N=l.find(M=>M.id===w.eventId),j=new Date(w.createdAt),_=j.toLocaleDateString("en-GB",{weekday:"long"}),L=j.getHours(),D=L<12?"Morning":L<17?"Afternoon":"Evening";return{"Customer Email":w.customerEmail||"N/A","Customer Name":w.customerName||"N/A","Order ID":((P=w.id)==null?void 0:P.slice(0,8))||"N/A","Event Title":(N==null?void 0:N.title)||"Unknown Event","Event Category":((S=N==null?void 0:N.tags)==null?void 0:S.join(", "))||"N/A","Day of Week":_,"Time of Day":D,"Hour of Day":L,"Order Amount":`${((w.totalAmount||0)/100).toFixed(2)}`,"Ticket Count":((I=w.tickets)==null?void 0:I.reduce((M,z)=>M+(z.quantity||0),0))||0,"Order Status":w.status||"N/A","Order Date":j.toLocaleDateString(),"Days Until Event":(N!=null&&N.date,"N/A")}});if(v.length>0){const w=["Customer Email","Customer Name","Order ID","Event Title","Event Category","Day of Week","Time of Day","Hour of Day","Order Amount","Ticket Count","Order Status","Order Date","Days Until Event"];$r({filename:`${u}-behavior`,data:v,headers:w})}const g=y.filter(w=>parseFloat(w["Total Spent"].replace("",""))>=100).sort((w,N)=>parseFloat(N["Total Spent"].replace("",""))-parseFloat(w["Total Spent"].replace("","")));if(g.length>0){const w=["Customer Email","Customer Name","Total Spent","Total Orders","Total Tickets","Events Attended","First Order","Last Order","Customer Value Tier"],N=g.map(j=>{const _=parseFloat(j["Total Spent"].replace("",""));let L="Bronze";return _>=500?L="Platinum":_>=300?L="Gold":_>=150&&(L="Silver"),{...j,"Customer Value Tier":L}});$r({filename:`${u}-high-value-customers`,data:N,headers:w})}},ih=(a,l,c)=>{const u=`event-${a.title.replace(/[^a-z0-9]/gi,"-").toLowerCase()}-${c}-${new Date().toISOString().split("T")[0]}`,h=l.filter(p=>p.eventId===a.id),f=[{Event:a.title,Date:a.date,Venue:a.venue,"Total Revenue":`${(h.reduce((p,y)=>p+(y.totalAmount||0),0)/100).toFixed(2)}`,"Total Orders":h.length,"Total Tickets":h.reduce((p,y)=>{var v;return p+(((v=y.tickets)==null?void 0:v.reduce((g,w)=>g+(w.quantity||0),0))||0)},0),Period:c}];if($r({filename:`${u}-overview`,data:f,headers:["Event","Date","Venue","Total Revenue","Total Orders","Total Tickets","Period"]}),h.length>0){const p=h.map(y=>{var v,g;return{"Order ID":((v=y.id)==null?void 0:v.slice(0,8))||"N/A","Customer Name":y.customerName||"N/A","Customer Email":y.customerEmail||"N/A",Amount:`${((y.totalAmount||0)/100).toFixed(2)}`,Status:y.status||"N/A",Date:new Date(y.createdAt).toLocaleDateString(),Tickets:((g=y.tickets)==null?void 0:g.reduce((w,N)=>w+(N.quantity||0),0))||0}});$r({filename:`${u}-orders`,data:p,headers:["Order ID","Customer Name","Customer Email","Amount","Status","Date","Tickets"]})}if(a.ticketTiers&&a.ticketTiers.length>0){const p=a.ticketTiers.map(y=>{const v=h.filter(N=>{var j;return(j=N.tickets)==null?void 0:j.some(_=>_.ticketTierId===y.id)}),g=v.reduce((N,j)=>{var L;const _=((L=j.tickets)==null?void 0:L.filter(D=>D.ticketTierId===y.id))||[];return N+_.reduce((D,P)=>D+(P.totalPrice||0),0)},0),w=v.reduce((N,j)=>{var L;const _=((L=j.tickets)==null?void 0:L.filter(D=>D.ticketTierId===y.id))||[];return N+_.reduce((D,P)=>D+(P.quantity||0),0)},0);return{"Tier Name":y.name,Price:`${(y.price/100).toFixed(2)}`,Capacity:y.capacity,Sold:w,Available:y.capacity-w,Utilization:`${(w/y.capacity*100).toFixed(1)}%`,Revenue:`${(g/100).toFixed(2)}`,"Revenue per Ticket":w>0?`${(g/w/100).toFixed(2)}`:"0.00"}});$r({filename:`${u}-tiers`,data:p,headers:["Tier Name","Price","Capacity","Sold","Available","Utilization","Revenue","Revenue per Ticket"]})}},ah=()=>{const{events:a,orders:l,affiliateSocieties:c,affiliateLinks:u,affiliateStats:h,getEvents:f,getOrders:p,addEvent:y,deleteEvent:v,archiveEvent:g,getAffiliateSocieties:w,addAffiliateSociety:N,updateAffiliateSociety:j,deleteAffiliateSociety:_,createAffiliateLinks:L,getAffiliateLinks:D,getAffiliateStats:P,getSocietyPerformance:S}=jr(),[I,M]=O.useState(null),[z,K]=O.useState(!0),[ce,Q]=O.useState("30d"),[ye,J]=O.useState("all"),[bt,Z]=O.useState([]),[H,q]=O.useState("analytics"),[he,F]=O.useState(!1),[Be,ge]=O.useState(null),[at,X]=O.useState(null),[de,fe]=O.useState(!1),[te,ie]=O.useState(!1),[oe,Ce]=O.useState(null),[ae,Ge]=O.useState(!1),[Ie,we]=O.useState(!1),[ot,Ke]=O.useState(null),[Tr,ke]=O.useState([]),[lr,Xe]=O.useState(!1),[cr,gt]=O.useState(!1),[ze,De]=O.useState(null);O.useEffect(()=>{er()},[]),O.useEffect(()=>{if(a&&l){const pe=Ve();M(pe)}},[a,l,ce,ye]);const er=async()=>{console.log(" Loading dashboard data..."),K(!0);const pe=setTimeout(()=>{console.log(" Loading timeout - forcing completion"),K(!1)},1e4);try{console.log(" Fetching events, orders, affiliate societies, affiliate links, and stats..."),await Promise.all([f(),p(),w(),D(),P()]);const Ae=await S();ke(Ae),console.log(" Data fetched successfully");const Se=Ve();M(Se),console.log(" Stats calculated:",Se)}catch(Ae){console.error(" Error loading dashboard data:",Ae)}finally{clearTimeout(pe),K(!1),console.log(" Dashboard loading complete")}},me=()=>{ge(null),F(!0)},es=pe=>{ge(pe),F(!0)},zs=pe=>{X({type:"delete",event:pe})},tr=pe=>{X({type:"archive",event:pe})},ys=pe=>{Ce(pe),fe(!0)},Vt=pe=>{fe(!1),Ce(null),Re.success(`Guestlist created successfully! QR code sent to ${pe.leadEmail}`),er()},bs=()=>{Ke(null),Ge(!0)},dr=pe=>{Ke(pe),Ge(!0)},At=async pe=>{try{ot?await j(ot.id,pe):await N(pe),Ge(!1),Ke(null);const Ae=await S();ke(Ae)}catch(Ae){console.error("Error saving society:",Ae)}},Ws=()=>{we(!0)},ts=async(pe,Ae)=>{try{await L(pe,Ae),we(!1);const Se=await Promise.all([D(),S()]);ke(Se[1])}catch(Se){console.error("Error generating tracking links:",Se)}},bn=pe=>{De(pe),Xe(!0)},ct=pe=>{De(pe),gt(!0)},le=async pe=>{if(window.confirm(`Are you sure you want to delete ${pe.name}? This action cannot be undone.`))try{await _(pe.id);const Ae=await S();ke(Ae)}catch(Ae){console.error("Error deleting society:",Ae)}},ft=async pe=>{Z(We=>[...We,pe]);const Ae=new Date,Se=new Date(Ae.getTime()+30*24*60*60*1e3);let Fe;switch(pe){case"sundowner":Fe={title:"Carnival LDN Sundowner",date:Se.toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),time:"18:00 - 22:00",venue:"Sky Garden, London",price:"From 25",description:"Experience the magic of London at sunset with our exclusive Carnival LDN Sundowner. Enjoy live music, craft cocktails, and breathtaking city views from one of London's most iconic venues.",capacity:"150",image:"/palace.png",tags:"sundowner,networking,music,cocktails,views",gradient:"from-orange-400 via-red-500 to-pink-500",ticketTiers:[{id:`tier_${Date.now()}_1`,name:"Early Bird",price:2500,originalPrice:3500,capacity:50,soldCount:0,description:"Limited early bird tickets",benefits:["Priority entry","Welcome drink","Canaps"],isActive:!0},{id:`tier_${Date.now()}_2`,name:"Standard",price:3500,originalPrice:null,capacity:80,soldCount:0,description:"Standard admission",benefits:["Entry","Welcome drink","Canaps","Live music"],isActive:!0},{id:`tier_${Date.now()}_3`,name:"VIP",price:5500,originalPrice:null,capacity:20,soldCount:0,description:"Premium experience",benefits:["Priority entry","Premium drinks","Full catering","Reserved seating","Meet & greet with artists"],isActive:!0}]};break;case"bollywood":Fe={title:"Bollywood Night - Carnival LDN",date:Se.toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),time:"19:00 - 02:00",venue:"O2 Academy Brixton, London",price:"From 20",description:"Get ready for the most vibrant Bollywood night in London! Dance to the latest Bollywood hits, enjoy authentic Indian cuisine, and experience the magic of Indian cinema with live performances.",capacity:"200",image:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&h=600&fit=crop",tags:"bollywood,indian,music,dance,food,culture",gradient:"from-purple-400 via-pink-500 to-red-500",ticketTiers:[{id:`tier_${Date.now()}_1`,name:"General Admission",price:2e3,originalPrice:null,capacity:120,soldCount:0,description:"Basic entry",benefits:["Entry","Live music","Dance floor access"],isActive:!0},{id:`tier_${Date.now()}_2`,name:"Premium",price:3500,originalPrice:null,capacity:60,soldCount:0,description:"Enhanced experience",benefits:["Entry","Live music","Dance floor access","Food vouchers","Reserved seating"],isActive:!0},{id:`tier_${Date.now()}_3`,name:"VIP Experience",price:6500,originalPrice:null,capacity:20,soldCount:0,description:"Ultimate Bollywood experience",benefits:["Priority entry","Premium seating","All-inclusive food & drinks","Meet performers","Photo opportunities","Exclusive dance workshop"],isActive:!0}]};break;case"carnival":Fe={title:"Carnival LDN Street Festival",date:Se.toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),time:"12:00 - 20:00",venue:"Brockwell Park, London SE24 9BJ",price:"Free - 40",description:"Join us for the biggest Caribbean carnival celebration in London! Experience vibrant costumes, steel pan music, Caribbean food stalls, and an unforgettable day of culture and celebration.",capacity:"500",image:"https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?w=800&h=600&fit=crop",tags:"carnival,caribbean,culture,music,food,family",gradient:"from-green-400 via-blue-500 to-purple-500",ticketTiers:[{id:`tier_${Date.now()}_1`,name:"Free Entry",price:0,originalPrice:null,capacity:300,soldCount:0,description:"General festival access",benefits:["Entry","Live music","Food stalls access","Family activities"],isActive:!0},{id:`tier_${Date.now()}_2`,name:"Premium Pass",price:2500,originalPrice:null,capacity:150,soldCount:0,description:"Enhanced festival experience",benefits:["Priority entry","Reserved seating areas","Food vouchers","Exclusive bar access","Meet & greet with performers"],isActive:!0},{id:`tier_${Date.now()}_3`,name:"VIP Experience",price:4e3,originalPrice:null,capacity:50,soldCount:0,description:"Ultimate carnival experience",benefits:["Priority entry","VIP seating","All-inclusive food & drinks","Backstage access","Exclusive workshops","Commemorative gift bag"],isActive:!0}]};break}try{await y(Fe),Re.success(`${Fe.title} created successfully!`),await er()}catch(We){console.error("Error creating test event:",We),Re.error("Failed to create test event")}finally{Z(We=>We.filter(Mt=>Mt!==pe))}},Ve=()=>{var St;if(!a||!l)return{totalRevenue:0,totalOrders:0,totalTickets:0,conversionRate:0,averageOrderValue:0,topPerformingEvent:"N/A",recentOrders:[],revenueByEvent:[],ticketSalesByTier:[],dailyRevenue:[]};const pe=l.filter(tt=>{if(ye!=="all"&&tt.eventId!==ye)return!1;const Je=new Date(tt.createdAt),ne=new Date;return ne.setDate(ne.getDate()-(ce==="7d"?7:ce==="30d"?30:90)),Je>=ne}),Ae=pe.reduce((tt,Je)=>tt+(Je.totalAmount||0),0),Se=pe.length,Fe=pe.reduce((tt,Je)=>{var ne;return tt+(((ne=Je.tickets)==null?void 0:ne.reduce((kt,sr)=>kt+(sr.quantity||0),0))||0)},0),We=Se>0?Ae/Se:0,Mt=Se>0?Math.min(95,Math.random()*20+5):0,rr=a.map(tt=>{const ne=pe.filter(kt=>kt.eventId===tt.id).reduce((kt,sr)=>kt+(sr.totalAmount||0),0);return{event:tt.title,revenue:ne}}),_t=((St=rr.sort((tt,Je)=>Je.revenue-tt.revenue)[0])==null?void 0:St.event)||"N/A",Wr=rr.filter(tt=>tt.revenue>0),Ht=[];a.forEach(tt=>{var Je;(Je=tt.ticketTiers)==null||Je.forEach(ne=>{const kt=pe.filter(Rt=>{var nr;return(nr=Rt.tickets)==null?void 0:nr.some(ur=>ur.ticketTierId===ne.id)}),sr=kt.reduce((Rt,nr)=>{var Dt;const ur=((Dt=nr.tickets)==null?void 0:Dt.filter(vr=>vr.ticketTierId===ne.id))||[];return Rt+ur.reduce((vr,ws)=>vr+(ws.totalPrice||0),0)},0),pt=kt.reduce((Rt,nr)=>{var Dt;const ur=((Dt=nr.tickets)==null?void 0:Dt.filter(vr=>vr.ticketTierId===ne.id))||[];return Rt+ur.reduce((vr,ws)=>vr+(ws.quantity||0),0)},0);Ht.push({tier:`${tt.title} - ${ne.name}`,sold:pt,revenue:sr,capacity:ne.capacity||0})})});const Yr=Array.from({length:30},(tt,Je)=>{const ne=new Date;ne.setDate(ne.getDate()-(29-Je));const sr=pe.filter(pt=>new Date(pt.createdAt).toDateString()===ne.toDateString()).reduce((pt,Rt)=>pt+(Rt.totalAmount||0),0);return{date:ne.toLocaleDateString("en-GB",{month:"short",day:"numeric"}),revenue:sr}});return{totalRevenue:Ae,totalOrders:Se,totalTickets:Fe,conversionRate:Mt,averageOrderValue:We,topPerformingEvent:_t,recentOrders:pe.slice(0,5),revenueByEvent:Wr,ticketSalesByTier:Ht,dailyRevenue:Yr}},nt=()=>{a&&l&&(nh(l,a,ce),Re.success("Customer data exported successfully!"))},zr=pe=>{const Ae=a==null?void 0:a.find(Se=>Se.id===pe);Ae&&l&&(ih(Ae,l,ce),Re.success(`${Ae.title} data exported successfully!`))},Ir=pe=>{if(!pe)return null;let Ae=String(pe).trim();const Se=Ae.match(/^[A-Za-z]+,\s*(.*)$/);Se&&(Ae=Se[1]);let Fe=new Date(Ae);if(!isNaN(Fe.getTime()))return Fe;const We=Ae.match(/^(\d{1,2})\s+([A-Za-z]+)\s+(\d{4})$/);if(We){const[,rr,_t,Wr]=We;if(Fe=new Date(`${_t} ${rr}, ${Wr}`),!isNaN(Fe.getTime()))return Fe}const Mt=Ae.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})$/);if(Mt){const[,rr,_t,Wr]=Mt,Ht=Yr=>Yr.padStart(2,"0");if(Fe=new Date(`${Wr}-${Ht(_t)}-${Ht(rr)}`),!isNaN(Fe.getTime()))return Fe}return null};new Date().setHours(0,0,0,0);const Le=(a||[]).filter(pe=>!pe.isArchived).sort((pe,Ae)=>{const Se=Ir(pe.date),Fe=Ir(Ae.date);return!Se&&!Fe?0:Se?Fe?Se.getTime()-Fe.getTime():-1:1}),wr=(a||[]).filter(pe=>pe.isArchived).sort((pe,Ae)=>{const Se=Ir(pe.date),Fe=Ir(Ae.date);return!Se&&!Fe?0:Se?Fe?((Fe==null?void 0:Fe.getTime())||0)-((Se==null?void 0:Se.getTime())||0):-1:1});return z?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-xl font-semibold text-gray-700",children:"Loading Dashboard..."}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This may take a few seconds..."}),r.jsx("button",{onClick:()=>{console.log(" Manual refresh triggered"),K(!1),er()},className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Refresh Dashboard"})]})}):r.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(ou,{selectedTimeframe:ce,selectedEvent:ye,events:a||[],activeTab:H,onTimeframeChange:Q,onEventChange:J,onTabChange:q,onRefresh:er}),r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:r.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(an,{className:"h-6 w-6 text-blue-600"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-blue-900",children:"Google Analytics Dashboard"}),r.jsx("p",{className:"text-blue-700 text-sm",children:"Track real-time visitor behavior, conversions, and revenue insights"})]})]}),r.jsxs("a",{href:"/analytics",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[r.jsx(an,{className:"h-4 w-4"}),r.jsx("span",{children:"View Analytics"})]})]})})}),r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[H==="analytics"&&r.jsx(r.Fragment,{children:ye!=="all"?r.jsx(gu,{events:a||[],orders:l||[],selectedEvent:ye,onExportEventData:zr}):r.jsxs(r.Fragment,{children:[r.jsx(lu,{stats:I,onExportAll:nt,quickEventButtons:r.jsx(fu,{creatingEvents:bt,onCreateEvent:ft})}),r.jsx(cu,{stats:I,events:a||[]}),r.jsx(hu,{orders:(I==null?void 0:I.recentOrders)||[],events:a||[]})]})}),H==="events"&&r.jsx(du,{currentEvents:Le,archivedEvents:wr,onAddEvent:me,onEditEvent:es,onArchiveToggle:tr,onDeleteEvent:zs,onGuestlist:ys}),H==="orders"&&r.jsx(uu,{orders:l||[],events:a||[]}),H==="affiliate"&&r.jsxs("div",{className:"space-y-8",children:[r.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-lg p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-purple-900",children:"Affiliate Tracking"}),r.jsx("p",{className:"text-purple-700 mt-2",children:"Track university society performance and generate custom promotional links"})]}),r.jsxs("div",{className:"flex space-x-3",children:[r.jsx("button",{onClick:bs,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Add Society"}),r.jsx("button",{onClick:Ws,className:"px-4 py-2 bg-pink-600 text-white rounded-lg hover:bg-pink-700 transition-colors",children:"Generate Links"})]})]})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Societies"}),r.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:(h==null?void 0:h.totalSocieties)||0})]})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:r.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Clicks"}),r.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:(h==null?void 0:h.totalClicks)||0})]})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:r.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tickets Sold"}),r.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:(h==null?void 0:h.totalTicketsSold)||0})]})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:r.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Revenue"}),r.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:["",(((h==null?void 0:h.totalRevenue)||0)/100).toFixed(0)]})]})]})})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow",children:[r.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Society Performance"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Track clicks, conversions, and revenue by society"})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Society"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"University"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Clicks"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tickets Sold"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx(Qe,{className:"h-12 w-12 text-gray-300 mb-4"}),r.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"No societies added yet"}),r.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Start by adding your first university society to track their performance"}),r.jsx("button",{onClick:bs,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Add Your First Society"})]})})}):Tr.map(pe=>{const Ae=pe.society,Se=["from-blue-400 to-blue-600","from-purple-400 to-purple-600","from-pink-400 to-pink-600","from-green-400 to-green-600","from-yellow-400 to-yellow-600","from-red-400 to-red-600"],Fe=Se[Math.floor(Math.random()*Se.length)],We=Ae.name.split(" ").map(Mt=>Mt[0]).join("").substring(0,2).toUpperCase();return r.jsxs("tr",{children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:`h-10 w-10 rounded-full bg-gradient-to-r ${Fe} flex items-center justify-center`,children:r.jsx("span",{className:"text-white font-semibold text-sm",children:We})})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:Ae.name}),r.jsx("div",{className:"text-sm text-gray-500",children:Ae.code})]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Ae.university||"Not specified"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:pe.clicks}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:pe.ticketsSold}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(pe.revenue/100).toFixed(0)]}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[r.jsx("button",{onClick:()=>bn(Ae),className:"text-blue-600 hover:text-blue-900 mr-3",children:"View"}),r.jsx("button",{onClick:()=>ct(Ae),className:"text-green-600 hover:text-green-900 mr-3",children:"Links"}),r.jsx("button",{onClick:()=>dr(Ae),className:"text-gray-600 hover:text-gray-900 mr-3",children:"Edit"}),r.jsx("button",{onClick:()=>le(Ae),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},Ae.id)})})]})})]})]})]}),he&&r.jsx(ru,{event:Be,onClose:()=>{F(!1),ge(null),er()}}),r.jsx(xu,{confirm:at,onClose:()=>X(null),onConfirm:async()=>{at&&(at.type==="delete"?await v(at.event.id):await g(at.event.id,!at.event.isArchived),X(null))}}),de&&oe&&r.jsx(rh,{event:oe,onClose:()=>{fe(!1),Ce(null)},onSuccess:Vt,onManageGuestlists:()=>{fe(!1),ie(!0)}}),te&&oe&&r.jsx(sh,{event:oe,onClose:()=>{ie(!1),Ce(null)},onCreateNew:()=>{ie(!1),fe(!0)}}),ae&&r.jsx(su,{isOpen:ae,onClose:()=>{Ge(!1),Ke(null)},onSave:At,editingSociety:ot}),Ie&&r.jsx(nu,{isOpen:Ie,onClose:()=>we(!1),onGenerateLinks:ts,societies:c,events:a||[]}),r.jsx(iu,{society:ze,isOpen:lr,onClose:()=>{Xe(!1),De(null)}}),r.jsx(au,{society:ze,isOpen:cr,onClose:()=>{gt(!1),De(null)}})]})},oh=hl("pk_test_51OyBk9IgkIAGwv6wTnbqfLaivBQ0wYCltGf0gS4yeEZpxkD1f5jKEwarmr294R0LXNEzEMNxHuCKLRpMH8DYgaWD00g8BPRDAG"),lh=({event:a,onClose:l,onSuccess:c})=>{var Z;O.useEffect(()=>{const H=document.createElement("style");return H.textContent=`
      input[type="date"]::-webkit-calendar-picker-indicator {
        background: transparent;
        bottom: 0;
        color: transparent;
        cursor: pointer;
        height: auto;
        left: 0;
        position: absolute;
        right: 0;
        top: 0;
        width: auto;
        opacity: 0;
      }

      /* Ensure date picker opens on mobile */
      input[type="date"] {
        position: relative;
      }

      /* Make the entire input clickable for date picker */
      input[type="date"]::-webkit-calendar-picker-indicator:hover {
        opacity: 0.1;
      }

      input[type="date"]::-webkit-datetime-edit {
        color: #374151;
      }

      input[type="date"]::-webkit-datetime-edit-fields-wrapper {
        padding: 0;
      }

      input[type="date"]::-webkit-datetime-edit-text {
        color: #9CA3AF;
        padding: 0 0.2em;
      }

      input[type="date"]::-webkit-datetime-edit-month-field,
      input[type="date"]::-webkit-datetime-edit-day-field,
      input[type="date"]::-webkit-datetime-edit-year-field {
        color: #374151;
        padding: 0 0.2em;
      }

      input[type="date"]::-webkit-inner-spin-button {
        display: none;
      }

      input[type="date"]::-webkit-clear-button {
        display: none;
      }

      /* iOS specific fixes */
      input, select {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        border-radius: 8px;
        font-size: 16px;
      }

      /* Ensure consistent height on iOS */
      input, select {
        min-height: 48px;
        line-height: 1.5;
      }

      /* Fix iOS select dropdown styling */
      select {
        background-image: none;
      }

      /* Ensure text inputs don't zoom on iOS */
      input[type="text"], input[type="email"], input[type="tel"] {
        font-size: 16px;
      }
    `,document.head.appendChild(H),()=>{document.head.removeChild(H)}},[]);const u=xl(),h=ml(),[f,p]=O.useState([]),[y,v]=O.useState({name:"",email:"",phone:"",dateOfBirth:"",gender:"male"}),g=O.useRef(y);O.useEffect(()=>{g.current=y},[y]);const[w,N]=O.useState(!1),[j,_]=O.useState(null),[L,D]=O.useState(!1);O.useEffect(()=>{if(console.log("Event ticket tiers:",a.ticketTiers),a.ticketTiers&&a.ticketTiers.length>0){const q=[...a.ticketTiers].sort((he,F)=>he.price-F.price).map(he=>({tierId:he.id,tier:he,quantity:0}));p(q)}},[a]);const P=()=>f.reduce((H,q)=>H+q.quantity,0),S=()=>{let H=0;return f.forEach(q=>{if(q.quantity>0){const he=q.tier.price;let F;he<=4e3?F=150:he<=5e3?F=200:F=250,H+=F*q.quantity}}),H},I=()=>{const H=f.reduce((he,F)=>he+F.tier.price*F.quantity,0),q=S();return H+q},M=f.some(H=>H.quantity>0),z=((Z=y.email)==null?void 0:Z.trim())!=="",K=O.useMemo(()=>{if(!u||!M||I()<=0||!z)return null;const H=I();console.log(" Creating Apple Pay request:",{hasSelectedTickets:M,totalAmount:H,ticketSelections:f.filter(he=>he.quantity>0)});const q=u.paymentRequest({country:"GB",currency:"gbp",total:{label:`${a.title} Tickets`,amount:H},requestPayerName:!0,requestPayerEmail:!0,requestPayerPhone:!0});return q.on("paymentmethod",async he=>{var Be;const F=g.current;console.log(" Apple Pay triggered - latestCustomerInfo.email:",F.email),console.log(" Full latestCustomerInfo:",JSON.stringify(F,null,2));try{const ge=await fetch("/api/create-payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:a.id,tickets:f.filter(fe=>fe.quantity>0),customerInfo:{...F,name:F.name||he.payerName||"",email:F.email||"",applePayEmail:he.payerEmail||null,phone:F.phone||he.payerPhone||""},totalAmount:I(),affiliateLinkId:sessionStorage.getItem("affiliate_link_id"),isApplePay:!0})});if(!ge.ok){const fe=await ge.json().catch(()=>({})),te=fe.error||"Failed to create payment intent";console.error(" Payment intent creation failed:",fe),he.complete("fail"),_(te);return}const{clientSecret:at}=await ge.json(),{error:X,paymentIntent:de}=await u.confirmCardPayment(at,{payment_method:he.paymentMethod.id},{handleActions:!1});if(X){he.complete("fail"),_(X.message||"Payment failed");return}if(he.complete("success"),de.status==="succeeded"){const fe=g.current,te=await fetch("/api/confirm-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentIntentId:de.id,eventId:a.id,tickets:f.filter(ie=>ie.quantity>0),customerInfo:{...fe,name:fe.name||he.payerName||"",email:fe.email,applePayEmail:he.payerEmail||null,phone:fe.phone||he.payerPhone||""},totalAmount:I(),affiliateLinkId:sessionStorage.getItem("affiliate_link_id")})});if(te.ok){const ie=await te.json(),oe=g.current,Ce={id:((Be=ie.order)==null?void 0:Be.id)||`order_${Date.now()}`,eventId:a.id,userId:oe.email,stripePaymentIntentId:ie.paymentIntentId,status:"completed",totalAmount:I(),currency:"gbp",tickets:f.filter(we=>we.quantity>0).map(we=>{var ot;return{id:`ticket_${Date.now()}_${we.tierId}`,orderId:((ot=ie.order)==null?void 0:ot.id)||`order_${Date.now()}`,ticketTierId:we.tierId,quantity:we.quantity,unitPrice:we.tier.price,totalPrice:we.tier.price*we.quantity}}),customerEmail:oe.email,customerName:oe.name||he.payerName||"",customerPhone:oe.phone||he.payerPhone||"",customerDateOfBirth:oe.dateOfBirth,customerGender:oe.gender||void 0,createdAt:new Date,updatedAt:new Date},ae=f.filter(we=>we.quantity>0),Ge=I(),Ie=ae.map(we=>({tier:we.tier.name,price:we.tier.price,quantity:we.quantity}));Un(Ce.id,a.id,a.title,Ge,Ie),c(Ce)}}}catch(ge){he.complete("fail"),_(ge instanceof Error?ge.message:"An error occurred")}}),q},[u,a.id,a.title,f,y,M,z]);O.useEffect(()=>{K?K.canMakePayment().then(H=>{console.log(" Apple Pay availability check:",H),console.log(" Device info:",{userAgent:navigator.userAgent,isIOS:/iPad|iPhone|iPod/.test(navigator.userAgent),isSafari:/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent),isMac:/Mac/.test(navigator.userAgent),domain:window.location.hostname,protocol:window.location.protocol,isHTTPS:window.location.protocol==="https:"}),H&&H.applePay===!0?(console.log(" Apple Pay is available"),D(!0)):(console.log(" Apple Pay is NOT available"),console.log(" Requirements check:"),console.log("- Safari browser:",/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)),console.log("- HTTPS:",window.location.protocol==="https:"),console.log("- Domain registered:","Check Stripe dashboard"),console.log("- Cards in wallet:","User must have cards in Apple Wallet"),D(!1))}).catch(H=>{console.error(" Error checking Apple Pay:",H),D(!1)}):D(!1)},[K]),O.useEffect(()=>{console.log("Rendering Apple Pay section:",{canMakePayment:L,hasPaymentRequest:!!K})},[L,K]);const ce=(H,q)=>{p(he=>he.map(F=>F.tierId===H?{...F,quantity:Math.max(0,q)}:F))},Q=()=>{var H;return(H=a.ticketTiers)==null?void 0:H.some(q=>q.price===0&&q.isActive!==!1)},ye=()=>{const H=f.filter(q=>q.quantity>0);return H.length>0&&H.every(q=>q.tier.price===0)},J=async H=>{var ge,at,X,de,fe;if(H.preventDefault(),P()===0){_("Please select at least one ticket.");return}const q=[];if((ge=y.name)!=null&&ge.trim()||q.push("Name is required"),(at=y.email)!=null&&at.trim()||q.push("Email is required"),(X=y.phone)!=null&&X.trim()||q.push("Phone number is required"),(!y.dateOfBirth||y.dateOfBirth.trim()==="")&&q.push("Date of birth is required"),y.gender||q.push("Gender is required"),y.dateOfBirth){const te=new Date,ie=new Date(y.dateOfBirth);if(isNaN(ie.getTime()))q.push("Please enter a valid date of birth");else{let oe=te.getFullYear()-ie.getFullYear();const Ce=te.getMonth()-ie.getMonth();(Ce<0||Ce===0&&te.getDate()<ie.getDate())&&oe--,oe<18&&q.push("You must be 18 years or older to purchase tickets")}}if(q.length>0){_(q.join(", "));return}console.log("Sending customer info:",y),N(!0),_(null);const he=f.filter(te=>te.quantity>0),F=I(),Be=he.map(te=>({tier:te.tier.name,price:te.tier.price,quantity:te.quantity}));d0(a.id,a.title,F,Be);try{if(I()===0){const oe=await fetch("/api/create-free-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:a.id,tickets:f.filter(we=>we.quantity>0),customerInfo:y,totalAmount:0})});if(!oe.ok){const we=await oe.json();throw new Error(we.error||"Failed to create free order")}const Ce=await oe.json(),ae={id:((de=Ce.order)==null?void 0:de.id)||`order_${Date.now()}`,eventId:a.id,userId:y.email,stripePaymentIntentId:null,status:"completed",totalAmount:0,currency:"gbp",tickets:f.filter(we=>we.quantity>0).map(we=>{var ot;return{id:`ticket_${Date.now()}_${we.tierId}`,orderId:((ot=Ce.order)==null?void 0:ot.id)||`order_${Date.now()}`,ticketTierId:we.tierId,quantity:we.quantity,unitPrice:0,totalPrice:0}}),customerEmail:y.email,customerName:y.name,customerPhone:y.phone,customerDateOfBirth:y.dateOfBirth,customerGender:y.gender||void 0,createdAt:new Date,updatedAt:new Date},Ie=f.filter(we=>we.quantity>0).map(we=>({tier:we.tier.name,price:0,quantity:we.quantity}));Un(ae.id,a.id,a.title,0,Ie),c(ae)}else{if(!u||!h){_("Stripe has not loaded yet. Please try again.");return}const oe={eventId:a.id,tickets:f.filter(we=>we.quantity>0),customerInfo:y,totalAmount:I(),affiliateLinkId:sessionStorage.getItem("affiliate_link_id")};console.log(" Creating payment intent with data:",oe),console.log(" Date of birth value:",y.dateOfBirth,"Type:",typeof y.dateOfBirth);const Ce=await fetch("/api/create-payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(oe)});if(!Ce.ok){const we=await Ce.json();throw console.error(" Payment intent creation failed:",we),new Error(we.error||"Failed to create payment intent")}const{clientSecret:ae}=await Ce.json(),{error:Ge,paymentIntent:Ie}=await u.confirmCardPayment(ae,{payment_method:{card:h.getElement(Pi),billing_details:{name:y.name,email:y.email}}});if(Ge){_(Ge.message||"Payment failed");return}if(Ie.status==="succeeded"){const we=await fetch("/api/confirm-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentIntentId:Ie.id,eventId:a.id,tickets:f.filter(ot=>ot.quantity>0),customerInfo:y,totalAmount:I(),affiliateLinkId:sessionStorage.getItem("affiliate_link_id")})});if(we.ok){const ot=await we.json(),Ke={id:((fe=ot.order)==null?void 0:fe.id)||`order_${Date.now()}`,eventId:a.id,userId:y.email,stripePaymentIntentId:ot.paymentIntentId,status:"completed",totalAmount:I(),currency:"gbp",tickets:f.filter(Xe=>Xe.quantity>0).map(Xe=>{var cr;return{id:`ticket_${Date.now()}_${Xe.tierId}`,orderId:((cr=ot.order)==null?void 0:cr.id)||`order_${Date.now()}`,ticketTierId:Xe.tierId,quantity:Xe.quantity,unitPrice:Xe.tier.price,totalPrice:Xe.tier.price*Xe.quantity}}),customerEmail:y.email,customerName:y.name,customerPhone:y.phone,customerDateOfBirth:y.dateOfBirth,customerGender:y.gender||void 0,createdAt:new Date,updatedAt:new Date},Tr=f.filter(Xe=>Xe.quantity>0),ke=I(),lr=Tr.map(Xe=>({tier:Xe.tier.name,price:Xe.tier.price,quantity:Xe.quantity}));Un(Ke.id,a.id,a.title,ke,lr),c(Ke)}}}}catch(te){_(te instanceof Error?te.message:"An error occurred")}finally{N(!1)}},bt=(a.ticketTiers||[]).filter(H=>H.isActive!==!1&&H.capacity>H.soldCount);return r.jsxs("form",{onSubmit:J,className:"space-y-6",children:[r.jsxs("div",{className:"mb-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-sm font-medium text-gray-700",children:ye()?"Step 1 of 2":"Step 1 of 3"}),r.jsx("span",{className:"text-sm text-gray-500",children:"Select Tickets"})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:r.jsx(Y.div,{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",initial:{width:0},animate:{width:ye()?"50%":"33%"}})})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Tickets"}),bt.length===0&&r.jsx("div",{className:"mb-4 text-sm text-red-600",children:"This event is sold out."}),r.jsx("div",{className:"space-y-4",children:(a.ticketTiers||[]).sort((H,q)=>H.price-q.price).map(H=>{const q=f.find(Be=>Be.tierId===H.id)||{quantity:0},he=H.capacity-H.soldCount,F=he<=0||H.isActive===!1;return r.jsxs("div",{className:"border rounded-lg p-4",children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-gray-900",children:H.name}),!F&&r.jsx("p",{className:"text-sm text-gray-600",children:H.description}),!F&&H.lastEntryTime&&r.jsxs("p",{className:"text-sm font-bold text-gray-900 mt-1",children:["Last Entry: ",H.lastEntryTime]}),!F&&H.benefits&&H.benefits.length>0&&r.jsx("div",{className:"mt-2",children:H.benefits.map((Be,ge)=>r.jsxs("div",{className:"text-sm text-green-600 flex items-center gap-1",children:[r.jsx(Pt,{className:"h-3 w-3"}),Be]},ge))})]}),r.jsx("div",{className:"text-right",children:F?r.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-red-100 text-red-700",children:"Sold out"}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["",(H.price/100).toFixed(2)]}),H.originalPrice&&H.originalPrice>H.price&&r.jsxs("div",{className:"text-sm text-gray-400 line-through",children:["",(H.originalPrice/100).toFixed(2)]})]})})]}),F?r.jsx("div",{className:"text-sm text-gray-500",children:"This Tier is Sold Out"}):r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("button",{type:"button",onClick:()=>ce(H.id,(q.quantity||0)-1),className:"w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50",children:"-"}),r.jsx("span",{className:"w-12 text-center font-medium",children:q.quantity||0}),r.jsx("button",{type:"button",onClick:()=>ce(H.id,(q.quantity||0)+1),disabled:(q.quantity||0)>=he,className:"w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"+"})]}),r.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["",(H.price*(q.quantity||0)/100).toFixed(2)]})]})]},H.id)})})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),r.jsx("input",{id:"name",type:"text",placeholder:"e.g. John Smith",value:y.name,onChange:H=>v({...y,name:H.target.value}),className:"w-full h-12 px-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none"},required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),r.jsx("input",{id:"email",type:"email",placeholder:"e.g. john.smith@email.com",value:y.email,onChange:H=>v({...y,email:H.target.value}),className:"w-full h-12 px-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none"},required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),r.jsx("input",{id:"phone",type:"tel",placeholder:"e.g. 07123456789",value:y.phone,onChange:H=>v({...y,phone:H.target.value}),className:"w-full h-12 px-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none"},required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"dateOfBirth",className:"block text-sm font-medium text-gray-700 mb-1",children:["Date of Birth * ",r.jsx("span",{className:"text-red-500",children:"(Required)"})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{id:"dateOfBirth",type:"date",value:y.dateOfBirth,onChange:H=>v({...y,dateOfBirth:H.target.value}),placeholder:"Select date of birth",className:`w-full h-12 px-3 pr-10 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white cursor-pointer hover:border-blue-400 transition-colors shadow-sm ${y.dateOfBirth?"border-gray-300":"border-red-300 bg-red-50"}`,style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none"},required:!0}),r.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:r.jsx("svg",{className:"h-5 w-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"You must be 18 years or older to purchase tickets"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{htmlFor:"gender",className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender *"}),r.jsxs("div",{className:"relative",children:[r.jsxs("select",{id:"gender",value:y.gender,onChange:H=>v({...y,gender:H.target.value}),className:"w-full h-12 px-3 pr-10 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white cursor-pointer hover:border-blue-400 transition-colors",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none"},required:!0,children:[r.jsx("option",{value:"male",children:"Male"}),r.jsx("option",{value:"female",children:"Female"}),r.jsx("option",{value:"other",children:"Other"}),r.jsx("option",{value:"prefer_not_to_say",children:"Prefer not to say"})]}),r.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:r.jsx("svg",{className:"h-5 w-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]})]}),I()>0&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Payment"}),!z&&r.jsx("div",{className:"mb-4 bg-blue-50 border border-blue-200 rounded-lg p-3",children:r.jsx("p",{className:"text-sm text-blue-800",children:" Please enter your email address above to enable Apple Pay"})}),L&&K&&r.jsxs("div",{className:"mb-4",children:[r.jsx(gl,{options:{paymentRequest:K,style:{paymentRequestButton:{theme:"dark",height:"48px"}}}}),r.jsx("div",{className:"text-center text-sm text-gray-500 mt-2",children:"or pay with card below"})]}),r.jsx("div",{className:"border rounded-lg p-4",children:r.jsx(Pi,{options:{style:{base:{fontSize:"16px",color:"#424770","::placeholder":{color:"#aab7c4"}},invalid:{color:"#9e2146"}}}})})]}),Q()&&ye()&&r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Pt,{className:"h-5 w-5 text-green-600"}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-green-800",children:"Free Event"}),r.jsx("p",{className:"text-sm text-green-700",children:"No payment required. Your tickets will be sent to your email after confirmation."})]})]})}),r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Order Summary"}),r.jsxs("div",{className:"space-y-2",children:[f.filter(H=>H.quantity>0).map(H=>r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsxs("span",{children:[H.quantity,"x ",H.tier.name]}),r.jsxs("span",{children:["",(H.tier.price*H.quantity/100).toFixed(2)]})]}),H.tier.lastEntryTime&&r.jsxs("div",{className:"text-sm font-bold text-gray-900 mt-1",children:["Last Entry: ",H.tier.lastEntryTime]})]},H.tierId)),r.jsxs("div",{className:"border-t pt-2 mt-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Subtotal"}),r.jsxs("span",{children:["",(f.reduce((H,q)=>H+q.tier.price*q.quantity,0)/100).toFixed(2)]})]}),r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Processing Fee"}),r.jsxs("span",{children:["",(S()/100).toFixed(2)]})]}),r.jsxs("div",{className:"flex justify-between font-semibold text-lg",children:[r.jsx("span",{children:"Total"}),r.jsxs("span",{children:["",(I()/100).toFixed(2)]})]})]})]})]}),j&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:r.jsx("p",{className:"text-red-800",children:j})}),r.jsx("button",{type:"submit",disabled:w||P()===0||I()>0&&(!u||!h),className:"w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:w?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),r.jsx("span",{className:"ml-2",children:ye()?"Processing Order...":"Processing Payment..."})]}):r.jsx(r.Fragment,{children:ye()?r.jsxs(r.Fragment,{children:[r.jsx(Pt,{className:"h-5 w-5"}),r.jsx("span",{className:"ml-2",children:"Get Free Tickets"})]}):r.jsxs(r.Fragment,{children:[r.jsx(Os,{className:"h-5 w-5"}),r.jsxs("span",{className:"ml-2",children:["Pay ",(I()/100).toFixed(2)]})]})})}),w&&r.jsx(Y.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center rounded-lg",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-lg font-semibold text-gray-700",children:ye()?"Processing your order...":"Processing your payment..."}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Please don't close this window"})]})}),I()>0&&r.jsx("div",{className:"text-center text-sm text-gray-500",children:r.jsxs("div",{className:"flex items-center justify-center gap-2",children:[r.jsx(Os,{className:"h-4 w-4"}),"Secure payment powered by Stripe"]})})]})},ch=({event:a,onClose:l,onSuccess:c})=>r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs(Y.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsx("div",{className:"p-6 border-b",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Buy Tickets"}),r.jsx("p",{className:"text-gray-600",children:a.title})]}),r.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600",children:r.jsx(Jt,{className:"h-6 w-6"})})]})}),r.jsx("div",{className:"p-6",children:r.jsx(fl,{stripe:oh,children:r.jsx(lh,{event:a,onClose:l,onSuccess:c})})})]})}),dh=({order:a,onClose:l})=>{var h,f;const c=((h=a.tickets)==null?void 0:h.reduce((p,y)=>p+(y.quantity||0),0))||0,u=p=>{p.target===p.currentTarget&&l()};return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:u,children:r.jsxs(Y.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 text-center",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:r.jsx(Pt,{className:"h-8 w-8 text-green-600"})}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Payment Successful!"}),r.jsx("p",{className:"text-gray-600",children:"Your tickets have been purchased successfully! Check your email for the confirmation and attached PDF tickets."})]}),r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6 text-left",children:[r.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Order Summary"}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Order ID:"}),r.jsxs("span",{className:"font-mono text-gray-600",children:[((f=a.id)==null?void 0:f.slice(0,8))||"N/A","..."]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Total Tickets:"}),r.jsx("span",{className:"font-semibold",children:c})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Total Amount:"}),r.jsxs("span",{className:"font-semibold",children:["",((a.totalAmount||0)/100).toFixed(2)]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Status:"}),r.jsx("span",{className:"text-green-600 font-semibold capitalize",children:a.status||"completed"})]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"text-sm text-gray-600",children:["Confirmation & tickets sent to ",r.jsx("span",{className:"font-semibold text-black",children:a.customerEmail||"your email"})]}),r.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-600",children:[r.jsx(fs,{className:"h-4 w-4 flex-shrink-0"}),r.jsx("span",{children:"PDF tickets attached to your email"})]}),r.jsx("div",{className:"text-xs text-gray-500 text-center",children:" Check your inbox (and spam folder) for your tickets"})]}),r.jsx("div",{className:"flex gap-3 mt-6",children:r.jsx("button",{onClick:l,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Close"})})]})})},uh=()=>{var J,bt;const{events:a,getEvents:l,isLoading:c,trackAffiliateClick:u,affiliateLinks:h,getAffiliateLinks:f,affiliateSocieties:p,getAffiliateSocieties:y}=jr(),[v,g]=O.useState(null),[w,N]=O.useState(!1),[j,_]=O.useState(null),[L]=jc(),[D,P]=O.useState(!1),[S,I]=O.useState(null),[M,z]=O.useState(!0),K=O.useRef(new Set),{glitchRef:ce,isGlitching:Q,glitchType:ye}=Sr();return O.useEffect(()=>{(async()=>{try{console.log(" Starting to load events, affiliate links, and societies..."),await Promise.all([l(),f(),y()]),console.log(" All data loaded successfully"),console.log("Events, affiliate links, and societies loaded in EventsPage:",a,h,p)}catch(H){console.error(" Failed to load events:",H)}})()},[l,f,y]),O.useEffect(()=>{if(a.length>0){const Z=L.get("event");Z&&a.find(q=>q.id===Z)&&(_(Z),setTimeout(()=>{var q;(q=document.getElementById("events-grid"))==null||q.scrollIntoView({behavior:"smooth",block:"start"})},500))}},[a,L]),O.useEffect(()=>{const Z=L.get("ref"),H=L.get("event"),q=`${Z}-${H}`;if(console.log(" Affiliate tracking check:",{refCode:Z,eventId:H,clickKey:q,alreadyProcessed:K.current.has(q),affiliateLinksLength:h.length,affiliateSocietiesLength:p.length}),Z&&H&&h.length>0&&p.length>0){if(K.current.has(q)){console.log(" Click already processed, skipping:",q);return}const he=h.find(F=>{const ge=F.linkCode.split("-").slice(0,5).join("-"),at=p.find(X=>X.code===Z&&X.id===ge);return console.log(" Link matching check:",{linkId:F.id,linkCode:F.linkCode,societyIdFromLink:ge,matchingSociety:at,refCode:Z,eventId:F.eventId}),at&&F.eventId===H});he?(console.log(" Tracking affiliate click:",{refCode:Z,eventId:H,linkId:he.id}),K.current.add(q),u(he.id),sessionStorage.setItem("affiliate_link_id",he.id),sessionStorage.setItem("affiliate_ref_code",Z),console.log("Stored affiliate link ID for checkout attribution:",he.id)):console.log("No matching affiliate link found for:",{refCode:Z,eventId:H})}},[L,h,u,p]),O.useEffect(()=>{const Z=()=>{window.scrollY>100&&z(!1)};return window.addEventListener("scroll",Z),()=>window.removeEventListener("scroll",Z)},[]),r.jsxs("div",{className:"min-h-screen relative overflow-hidden",children:[r.jsx(gn,{}),r.jsxs("section",{className:"relative min-h-screen flex items-center justify-center overflow-hidden pt-16 sm:pt-20 md:pt-32 pb-12 sm:pb-16 md:pb-24 px-2 sm:px-4",children:[r.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[r.jsx("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover",children:r.jsx("source",{src:"/vid.mp4",type:"video/mp4"})}),r.jsx("div",{className:"absolute inset-0 bg-black/60"})]}),r.jsx("div",{className:"relative z-10 max-w-7xl mx-auto px-4 md:px-6 lg:px-8 text-center",children:r.jsxs(Y.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.8},className:"space-y-4 md:space-y-6 lg:space-y-8",children:[r.jsx(Y.h1,{ref:ce,animate:{backgroundPosition:["0% 50%","100% 50%","0% 50%"]},transition:{duration:8,repeat:1/0,ease:"linear"},className:`text-6xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-8xl 2xl:text-8xl glitch-text ${Q?`glitch-active glitch-${ye}`:""}`,"data-text":"EVENTS",style:{textTransform:"uppercase",letterSpacing:"0.1em"},children:"EVENTS"}),r.jsx(Y.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6,delay:.2},className:"text-base sm:text-lg md:text-xl lg:text-xl font-light max-w-4xl mx-auto leading-relaxed px-2 text-white drop-shadow-lg",children:r.jsxs(Y.span,{className:"inline-block px-3 sm:px-4 md:px-6 py-2 sm:py-2.5 md:py-3 bg-black/20 backdrop-blur-sm rounded-full border border-white/20 text-sm sm:text-base md:text-lg",whileHover:{scale:1.05,boxShadow:"0 0 20px rgba(255, 255, 255, 0.3)",borderColor:"rgba(255, 255, 255, 0.5)"},animate:{boxShadow:["0 0 10px rgba(255, 255, 255, 0.1)","0 0 20px rgba(255, 255, 255, 0.2)","0 0 10px rgba(255, 255, 255, 0.1)"]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:[r.jsx("span",{className:"block sm:hidden",children:" Events that hit different "}),r.jsx("span",{className:"hidden sm:block",children:" From rooftop raves to underground vibes - events that hit different "})]})}),r.jsx(Y.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6,delay:.4},className:"text-white/80 text-base sm:text-lg md:text-xl",children:c?r.jsx("span",{children:"Loading events..."}):r.jsxs("span",{children:[((J=a==null?void 0:a.filter(Z=>!Z.isArchived))==null?void 0:J.length)||0," upcoming events"]})}),r.jsx(Y.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6,delay:.6},className:"flex flex-col sm:flex-row gap-3 sm:gap-4 md:gap-6 justify-center items-center pt-4 sm:pt-6 md:pt-8 px-2 sm:px-4",children:r.jsxs(Y.button,{onClick:()=>{var Z;(Z=document.getElementById("events-grid"))==null||Z.scrollIntoView({behavior:"smooth",block:"start"})},whileHover:{scale:1.05,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},whileTap:{scale:.95},className:"bg-transparent hover:bg-white/90 text-white hover:text-gray-900 px-4 sm:px-6 md:px-8 py-2.5 sm:py-3 md:py-4 text-base sm:text-base md:text-lg font-semibold rounded-lg border-2 border-white/70 w-3/4 sm:w-auto transition-all backdrop-blur-sm group flex items-center justify-center gap-3",children:[r.jsx("span",{children:"Get Tickets"}),r.jsx(sn,{className:"w-3 h-3 sm:w-4 sm:h-4 md:w-5 md:h-5 group-hover:translate-x-1 transition-transform"})]})})]})}),M&&r.jsx(Y.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6,delay:.8},className:"absolute bottom-8 left-1/2 transform -translate-x-1/2 z-20 w-full flex justify-center",children:r.jsxs(Y.div,{animate:{y:[0,10,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"flex flex-col items-center space-y-2 cursor-pointer",onClick:()=>{var Z;(Z=document.getElementById("events-grid"))==null||Z.scrollIntoView({behavior:"smooth",block:"start"})},children:[r.jsx(Y.div,{animate:{y:[0,8,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"w-6 h-10 border-2 border-white/50 rounded-full flex justify-center",children:r.jsx(Y.div,{animate:{y:[0,12,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"w-1 h-3 bg-white/70 rounded-full mt-2"})}),r.jsx(Y.p,{animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"text-white/70 text-xs font-medium",children:"Scroll to explore"})]})})]}),r.jsxs("section",{id:"events-grid",className:"py-16 md:py-20 relative px-4 overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[r.jsx("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover scale-150",children:r.jsx("source",{src:"/vid-ev.mp4",type:"video/mp4"})}),r.jsx("div",{className:"absolute inset-0 bg-gray-900/70"})]}),r.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 md:px-6 lg:px-8",children:[r.jsxs(Y.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.8},className:"text-center mb-12 md:mb-16",children:[r.jsx(Y.h2,{className:`text-5xl sm:text-4xl md:text-5xl lg:text-6xl font-bold mb-4 md:mb-6 text-white glitch-text ${Q?`glitch-active glitch-${ye}`:""}`,"data-text":"WHAT'S ON",style:{textTransform:"uppercase",letterSpacing:"0.1em"},children:"WHAT'S ON"}),r.jsx("div",{className:"flex justify-center",children:r.jsx(Y.span,{className:"inline-block px-3 sm:px-4 md:px-6 py-2 sm:py-2.5 md:py-3 bg-black/20 backdrop-blur-sm rounded-full border border-white/20 text-sm sm:text-base md:text-lg text-white/80",whileHover:{scale:1.05,boxShadow:"0 0 20px rgba(255, 255, 255, 0.3)",borderColor:"rgba(255, 255, 255, 0.5)"},animate:{boxShadow:["0 0 10px rgba(255, 255, 255, 0.1)","0 0 20px rgba(255, 255, 255, 0.2)","0 0 10px rgba(255, 255, 255, 0.1)"]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:"  Check out our upcoming events  "})})]}),c?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"text-white text-lg mb-4",children:"Loading events..."}),r.jsx("div",{className:"text-white/70 text-sm",children:"Please wait while we fetch the latest events"})]}):!a||a.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"text-white text-lg mb-4",children:"No events available"}),r.jsx("div",{className:"text-white/70 text-sm",children:"Check back later for upcoming events"})]}):a.filter(Z=>!Z.isArchived).length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"text-white text-lg mb-4",children:"No upcoming events"}),r.jsx("div",{className:"text-white/70 text-sm",children:"All events are currently archived"})]}):r.jsx("div",{className:`grid gap-6 md:gap-8 ${a.filter(Z=>!Z.isArchived).length===1?"grid-cols-1 max-w-md mx-auto":a.filter(Z=>!Z.isArchived).length===2?"grid-cols-1 md:grid-cols-2 max-w-4xl mx-auto":"grid-cols-1 md:grid-cols-2 lg:grid-cols-3"}`,children:a.filter(Z=>!Z.isArchived).map((Z,H)=>r.jsxs(Y.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},transition:{duration:.6,delay:j===Z.id?.2:H*.1},whileHover:{y:-4},className:`group relative bg-gradient-to-br from-white via-gray-50 to-white border rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden cursor-pointer backdrop-blur-sm ${j===Z.id?"border-blue-500 shadow-blue-500/25 scale-105 ring-2 ring-blue-500/20":"border-gray-100"}`,children:[r.jsxs("div",{className:"relative h-48 md:h-56 overflow-hidden",onClick:()=>{g(Z),N(!0)},children:[j===Z.id&&r.jsx("div",{className:"absolute top-4 right-4 z-10 bg-gradient-to-r from-blue-500 to-purple-600 text-white text-xs font-bold px-3 py-1.5 rounded-full shadow-lg animate-pulse",children:" Featured Event"}),r.jsx("img",{src:Z.image,alt:Z.title,className:"w-full h-full object-contain transition-transform duration-500 group-hover:scale-110",onError:q=>{const he=q.target;he.src=`https://via.placeholder.com/400x300/6B7280/FFFFFF?text=${encodeURIComponent(Z.title)}`}}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"}),r.jsx("div",{className:"absolute top-4 left-4 flex flex-wrap gap-2",children:Z.tags.slice(0,2).map(q=>r.jsx("span",{className:"bg-white/95 backdrop-blur-sm px-3 py-1.5 rounded-full text-xs font-semibold text-gray-800 shadow-sm border border-white/20",children:q},q))}),Z.ticketTiers&&Z.ticketTiers.length>0&&Z.ticketTiers.every(q=>q.capacity-q.soldCount<=0||q.isActive===!1)&&r.jsx("div",{className:"absolute top-4 right-4 bg-red-500 text-white text-xs font-bold px-3 py-1.5 rounded-full shadow-lg",children:"Sold Out"}),r.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:r.jsx("h3",{className:"text-xl md:text-2xl font-bold text-white mb-2 leading-tight drop-shadow-lg",children:Z.title})})]}),r.jsxs("div",{className:"p-5 md:p-6 space-y-4",onClick:()=>{g(Z),N(!0)},children:[r.jsx("p",{className:"text-gray-600 text-sm leading-relaxed line-clamp-2",children:Z.description}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-center gap-3 p-2.5 bg-gray-50 rounded-xl",children:[r.jsx(yt,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),r.jsx("span",{className:"text-sm font-semibold text-gray-900",children:Z.date})]}),r.jsxs("div",{className:"flex items-center justify-center gap-3 p-2.5 bg-gray-50 rounded-xl",children:[r.jsx(Kt,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),r.jsx("span",{className:"text-sm font-semibold text-gray-900",children:Z.time})]}),r.jsxs("div",{className:"flex items-center justify-center gap-3 p-2.5 bg-gray-50 rounded-xl",children:[r.jsx(br,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),r.jsx("span",{className:"text-sm font-semibold text-gray-900",children:Z.venue})]})]}),Z.ticketTiers&&Z.ticketTiers.length>0&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Ticket Options"}),r.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:Math.min(...Z.ticketTiers.map(q=>q.price))===0?"Free":`From ${(Math.min(...Z.ticketTiers.map(q=>q.price))/100).toFixed(2)}`})]}),r.jsxs("div",{className:"space-y-1.5",children:[Z.ticketTiers.sort((q,he)=>q.price-he.price).slice(-3).map(q=>{const F=q.capacity-q.soldCount<=0||q.isActive===!1;return r.jsxs("div",{className:`flex items-center justify-between p-2.5 rounded-lg border ${F?"bg-gradient-to-r from-red-50 to-red-100 border-red-200":"bg-gradient-to-r from-gray-50 to-white border-gray-100"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-2 h-2 rounded-full ${F?"bg-red-500":"bg-blue-500"}`}),r.jsx("span",{className:`text-sm font-medium ${F?"text-red-800":"text-gray-800"}`,children:q.name})]}),r.jsx("div",{className:"flex items-center gap-2",children:F?r.jsx("span",{className:"text-sm font-bold text-red-700",children:"Sold out"}):r.jsxs(r.Fragment,{children:[q.originalPrice&&q.originalPrice>q.price&&r.jsxs("span",{className:"text-xs text-gray-400 line-through",children:["",(q.originalPrice/100).toFixed(2)]}),r.jsx("span",{className:"text-lg font-bold text-gray-900",children:q.price===0?"Free":`${(q.price/100).toFixed(2)}`})]})})]},q.id)}),Z.ticketTiers.length>3&&r.jsx("div",{className:"text-center",children:r.jsxs("span",{className:"text-xs text-gray-500 bg-gray-100 px-3 py-1.5 rounded-full",children:["+",Z.ticketTiers.length-3," more options"]})})]})]}),r.jsxs(Y.button,{onClick:q=>{q.stopPropagation(),g(Z),P(!0)},whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-gradient-to-r from-gray-900 via-gray-800 to-gray-800 hover:from-gray-800 hover:via-gray-700 hover:to-gray-800 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 text-sm md:text-base flex items-center justify-center gap-3 shadow-lg hover:shadow-xl group-hover:shadow-2xl",children:[Z.ticketTiers&&Z.ticketTiers.length>0?"Get Tickets":"Book Now",r.jsx(sn,{className:"w-4 h-4 transition-transform group-hover:translate-x-1"})]})]})]},Z.id))})]})]}),w&&v&&r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>N(!1),children:r.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full overflow-hidden",onClick:Z=>Z.stopPropagation(),children:[r.jsxs("div",{className:"relative h-48 overflow-hidden",children:[r.jsx("img",{src:v.image,alt:v.title,className:"w-full h-full object-cover"}),r.jsx("button",{className:"absolute top-3 right-3 bg-white/90 rounded-full p-1",onClick:()=>N(!1),children:r.jsx(Jt,{className:"w-5 h-5 text-gray-700"})})]}),r.jsxs("div",{className:"p-6 space-y-4 text-center",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900",children:v.title}),r.jsx("p",{className:"text-gray-600 text-sm",children:v.description}),r.jsxs("div",{className:"space-y-3 text-sm text-black",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2",children:[r.jsx(yt,{className:"w-4 h-4"}),r.jsx("span",{className:"font-semibold",children:v.date})]}),r.jsxs("div",{className:"flex items-center justify-center gap-2",children:[r.jsx(Kt,{className:"w-4 h-4"}),r.jsx("span",{className:"font-semibold",children:v.time})]}),r.jsxs("div",{className:"flex items-center justify-center gap-2",children:[r.jsx(br,{className:"w-4 h-4"}),r.jsx("span",{className:"font-semibold",children:v.venue})]})]}),v.ticketTiers&&v.ticketTiers.length>0&&r.jsxs("div",{className:"text-left",children:[r.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Ticket Tiers"}),r.jsx("div",{className:"space-y-2",children:v.ticketTiers.sort((Z,H)=>Z.price-H.price).map(Z=>{const q=Z.capacity-Z.soldCount<=0||Z.isActive===!1;return r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-gray-700",children:Z.name}),q?r.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-red-100 text-red-700",children:"Sold out"}):r.jsxs("div",{className:"flex items-center gap-2",children:[Z.originalPrice&&Z.originalPrice>Z.price&&r.jsxs("span",{className:"text-gray-400 line-through",children:["",(Z.originalPrice/100).toFixed(2)]}),r.jsx("span",{className:"font-semibold text-gray-900",children:Z.price===0?"Free":`${(Z.price/100).toFixed(2)}`})]})]},Z.id)})})]}),r.jsx("button",{onClick:()=>{N(!1),g(v),P(!0)},disabled:(bt=v.ticketTiers)==null?void 0:bt.every(Z=>Z.capacity-Z.soldCount<=0||Z.isActive===!1),className:"w-full bg-gray-900 hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed text-white px-4 py-2 rounded-lg text-sm",children:"Buy Tickets"})]})]})}),D&&v&&r.jsx(ch,{event:v,onClose:()=>P(!1),onSuccess:Z=>{I(Z),P(!1)}}),S&&r.jsx(dh,{order:S,onClose:()=>I(null)}),r.jsx(yn,{})]})},hh=()=>r.jsx("div",{className:"min-h-screen bg-gray-50",children:r.jsx(th,{})}),fh=({className:a=""})=>{var j,_,L,D,P,S;const[l,c]=O.useState(null),[u,h]=O.useState(!0),[f,p]=O.useState(new Date),[y,v]=O.useState("24h"),[g,w]=O.useState("overview");O.useEffect(()=>{const I=()=>{h(!0),setTimeout(()=>{const z={liveVisitors:Math.floor(Math.random()*50)+10,currentSessions:Math.floor(Math.random()*30)+5,totalSessions:Math.floor(Math.random()*1e3)+500,averageSessionDuration:Math.floor(Math.random()*300)+120,bounceRate:Math.random()*40+20,totalPageViews:Math.floor(Math.random()*3e3)+1500,averageTimeOnPage:Math.floor(Math.random()*180)+60,mostVisitedPages:[{page:"/",views:450,averageTime:120},{page:"/events",views:320,averageTime:180},{page:"/about",views:180,averageTime:90},{page:"/contact",views:120,averageTime:60}],totalEventsViewed:Math.floor(Math.random()*200)+100,mostViewedEvents:[{eventId:"1",views:85,uniqueViewers:65},{eventId:"2",views:72,uniqueViewers:58},{eventId:"3",views:68,uniqueViewers:52}],totalCheckouts:Math.floor(Math.random()*50)+20,totalPurchases:Math.floor(Math.random()*30)+15,conversionRate:Math.random()*15+5,averageOrderValue:Math.floor(Math.random()*50)+25,trafficSources:[{source:"Google",sessions:450,conversionRate:8.5},{source:"Direct",sessions:280,conversionRate:12.3},{source:"Social Media",sessions:180,conversionRate:6.2},{source:"Referral",sessions:90,conversionRate:4.1}],deviceBreakdown:[{device:"Mobile",sessions:520,percentage:52},{device:"Desktop",sessions:380,percentage:38},{device:"Tablet",sessions:100,percentage:10}],topLocations:[{location:"London",sessions:650,conversionRate:9.8},{location:"Manchester",sessions:120,conversionRate:7.2},{location:"Birmingham",sessions:85,conversionRate:6.5},{location:"Leeds",sessions:65,conversionRate:5.8}]};c(z),p(new Date),h(!1)},1e3)};I();const M=setInterval(I,5*60*1e3);return()=>clearInterval(M)},[y]);const N=()=>{h(!0),setTimeout(()=>{p(new Date),h(!1)},1e3)};return u&&!l?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-xl font-semibold text-gray-700",children:"Loading Analytics..."})]})}):r.jsxs("div",{className:`min-h-screen bg-gray-50 ${a}`,children:[r.jsx("div",{className:"bg-white shadow-sm border-b",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Analytics Dashboard"}),r.jsx("p",{className:"text-gray-600 mt-1",children:"Real-time insights into your Carnival LDN website performance"})]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("select",{value:y,onChange:I=>v(I.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[r.jsx("option",{value:"1h",children:"Last Hour"}),r.jsx("option",{value:"24h",children:"Last 24 Hours"}),r.jsx("option",{value:"7d",children:"Last 7 Days"}),r.jsx("option",{value:"30d",children:"Last 30 Days"})]}),r.jsxs("button",{onClick:N,disabled:u,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[r.jsx(Na,{className:`h-4 w-4 ${u?"animate-spin":""}`}),r.jsx("span",{children:"Refresh"})]})]})]}),r.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Last updated: ",f.toLocaleTimeString()]})]})}),r.jsx("div",{className:"bg-white border-b",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:r.jsx("nav",{className:"flex space-x-8",children:[{id:"overview",label:"Overview",icon:an},{id:"traffic",label:"Traffic",icon:ja},{id:"conversions",label:"Conversions",icon:ll},{id:"events",label:"Events",icon:yt},{id:"users",label:"Users",icon:Qe}].map(I=>{const M=I.icon;return r.jsxs("button",{onClick:()=>w(I.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm ${g===I.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[r.jsx(M,{className:"h-4 w-4"}),r.jsx("span",{children:I.label})]},I.id)})})})}),r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[g==="overview"&&r.jsxs("div",{className:"space-y-8",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[r.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx(Qe,{className:"h-6 w-6 text-blue-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Live Visitors"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l==null?void 0:l.liveVisitors})]})]})}),r.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-lg shadow p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:r.jsx(hs,{className:"h-6 w-6 text-green-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Page Views"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(j=l==null?void 0:l.totalPageViews)==null?void 0:j.toLocaleString()})]})]})}),r.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-lg shadow p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:r.jsx(Li,{className:"h-6 w-6 text-purple-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Conversions"}),r.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[(_=l==null?void 0:l.conversionRate)==null?void 0:_.toFixed(1),"%"]})]})]})}),r.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-lg shadow p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:r.jsx(Ms,{className:"h-6 w-6 text-orange-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Order Value"}),r.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["",l==null?void 0:l.averageOrderValue]})]})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Traffic Sources"}),r.jsx("div",{className:"space-y-4",children:l==null?void 0:l.trafficSources.map((I,M)=>r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:`w-3 h-3 rounded-full ${M===0?"bg-blue-500":M===1?"bg-green-500":M===2?"bg-purple-500":"bg-gray-500"}`}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:I.source})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm font-semibold text-gray-900",children:I.sessions.toLocaleString()}),r.jsxs("p",{className:"text-xs text-gray-500",children:[I.conversionRate.toFixed(1),"% conversion"]})]})]},I.source))})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Device Breakdown"}),r.jsx("div",{className:"space-y-4",children:l==null?void 0:l.deviceBreakdown.map((I,M)=>r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:`w-3 h-3 rounded-full ${M===0?"bg-blue-500":M===1?"bg-green-500":"bg-purple-500"}`}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:I.device})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm font-semibold text-gray-900",children:I.sessions.toLocaleString()}),r.jsxs("p",{className:"text-xs text-gray-500",children:[I.percentage,"%"]})]})]},I.device))})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Most Visited Pages"}),r.jsx("div",{className:"space-y-3",children:l==null?void 0:l.mostVisitedPages.map((I,M)=>r.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["#",M+1]}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:I.page})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[I.views.toLocaleString()," views"]}),r.jsxs("p",{className:"text-xs text-gray-500",children:[I.averageTime,"s avg time"]})]})]},I.page))})]})]}),g==="traffic"&&r.jsx("div",{className:"space-y-8",children:r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Geographic Distribution"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:l==null?void 0:l.topLocations.map((I,M)=>r.jsxs("div",{className:"border rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(br,{className:"h-4 w-4 text-gray-500"}),r.jsx("span",{className:"font-medium text-gray-900",children:I.location})]}),r.jsxs("span",{className:"text-sm text-gray-500",children:["#",M+1]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Sessions:"}),r.jsx("span",{className:"font-medium",children:I.sessions.toLocaleString()})]}),r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Conversion Rate:"}),r.jsxs("span",{className:"font-medium text-green-600",children:[I.conversionRate.toFixed(1),"%"]})]})]})]},I.location))})]})}),g==="conversions"&&r.jsx("div",{className:"space-y-8",children:r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Conversion Funnel"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(hs,{className:"h-5 w-5 text-blue-600"}),r.jsx("span",{className:"font-medium",children:"Page Views"})]}),r.jsx("span",{className:"text-lg font-bold text-gray-900",children:(L=l==null?void 0:l.totalPageViews)==null?void 0:L.toLocaleString()})]}),r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Li,{className:"h-5 w-5 text-green-600"}),r.jsx("span",{className:"font-medium",children:"Checkouts Started"})]}),r.jsx("span",{className:"text-lg font-bold text-gray-900",children:l==null?void 0:l.totalCheckouts})]}),r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Pt,{className:"h-5 w-5 text-purple-600"}),r.jsx("span",{className:"font-medium",children:"Purchases Completed"})]}),r.jsx("span",{className:"text-lg font-bold text-gray-900",children:l==null?void 0:l.totalPurchases})]})]})]})}),g==="events"&&r.jsx("div",{className:"space-y-8",children:r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Event Performance"}),r.jsx("div",{className:"space-y-4",children:l==null?void 0:l.mostViewedEvents.map((I,M)=>r.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["#",M+1]}),r.jsxs("span",{className:"font-medium text-gray-900",children:["Event ",I.eventId]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[I.views," views"]}),r.jsxs("p",{className:"text-xs text-gray-500",children:[I.uniqueViewers," unique viewers"]})]})]},I.eventId))})]})}),g==="users"&&r.jsx("div",{className:"space-y-8",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Session Metrics"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Total Sessions:"}),r.jsx("span",{className:"font-medium",children:(D=l==null?void 0:l.totalSessions)==null?void 0:D.toLocaleString()})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Avg Duration:"}),r.jsxs("span",{className:"font-medium",children:[Math.floor(((l==null?void 0:l.averageSessionDuration)||0)/60),"m ",((l==null?void 0:l.averageSessionDuration)||0)%60,"s"]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Bounce Rate:"}),r.jsxs("span",{className:"font-medium",children:[(P=l==null?void 0:l.bounceRate)==null?void 0:P.toFixed(1),"%"]})]})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Page Engagement"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Total Page Views:"}),r.jsx("span",{className:"font-medium",children:(S=l==null?void 0:l.totalPageViews)==null?void 0:S.toLocaleString()})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Avg Time on Page:"}),r.jsxs("span",{className:"font-medium",children:[Math.floor(((l==null?void 0:l.averageTimeOnPage)||0)/60),"m ",((l==null?void 0:l.averageTimeOnPage)||0)%60,"s"]})]})]})]})]})})]})]})},xh=[{id:"1",src:"https://res.cloudinary.com/dg9reru4s/image/upload/v1756201990/_DSC8186-min_jzvcgg.jpg",alt:"Event photography - DSC8186"},{id:"2",src:"https://res.cloudinary.com/dg9reru4s/image/upload/v1756201990/_DSC8702-Edit_1_-min_mk9qdi.jpg",alt:"Event photography - DSC8702"},{id:"3",src:"https://res.cloudinary.com/dg9reru4s/image/upload/v1756201989/_DSC8327-Edit-min_ogv4qm.jpg",alt:"Event photography - DSC8327"},{id:"4",src:"https://res.cloudinary.com/dg9reru4s/image/upload/v1756201988/_DSC8059-min_xoupnm.jpg",alt:"Event photography - DSC8059"},{id:"5",src:"https://res.cloudinary.com/dg9reru4s/image/upload/v1756201987/_DSC7965-Edit-min_k5uqwc.jpg",alt:"Event photography - DSC7965"},{id:"6",src:"https://res.cloudinary.com/dg9reru4s/image/upload/v1756201457/IMG_6073_1_bpf2ic.jpg",alt:"Event photography - IMG_6073"},{id:"7",src:"https://res.cloudinary.com/dg9reru4s/image/upload/v1756201228/IMG_6075_v67xz7.jpg",alt:"Event photography - IMG_6075"},{id:"8",src:"https://res.cloudinary.com/dg9reru4s/image/upload/v1756201228/IMG_6070_1_w5mhof.jpg",alt:"Event photography - IMG_6070"},{id:"9",src:"https://res.cloudinary.com/dg9reru4s/image/upload/v1756201227/DSC02821_uw11th.jpg",alt:"Event photography - DSC02821"}],mh=()=>{const{glitchRef:a,isGlitching:l,glitchType:c}=Sr();return r.jsxs("div",{className:"min-h-screen bg-black",children:[r.jsx("div",{className:"pt-40 pb-16 px-4",children:r.jsx("div",{className:"max-w-6xl mx-auto text-center",children:r.jsx(Y.h1,{ref:a,animate:{backgroundPosition:["0% 50%","100% 50%","0% 50%"]},transition:{duration:8,repeat:1/0,ease:"linear"},className:`text-5xl sm:text-4xl md:text-5xl lg:text-6xl font-bold mb-6 pb-1 glitch-text ${l?`glitch-active glitch-${c}`:""}`,"data-text":"GALLERY",style:{textTransform:"uppercase",letterSpacing:"0.1em"},children:"GALLERY"})})}),r.jsx("div",{className:"px-4 pb-16",children:r.jsx("div",{className:"max-w-6xl mx-auto",children:r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:xh.map((u,h)=>r.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:h*.1},className:"group relative overflow-hidden rounded-lg cursor-pointer",children:r.jsx("div",{className:"aspect-[4/3] overflow-hidden",children:r.jsx("img",{src:u.src,alt:u.alt,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",loading:"lazy"})})},u.id))})})}),r.jsx(yn,{})]})},ps=({title:a,description:l,keywords:c="Carnival LDN, London events, nightlife London, club nights London, Bollywood parties London, Diwali celebrations London, New Year parties London, corporate events London, private parties London, event planning London",image:u="/carnival-logo.svg",url:h="https://carnivalldn.com",type:f="website"})=>{const p=`${a} | Carnival LDN - London's Premier Events Company`;return r.jsxs(io,{children:[r.jsx("title",{children:p}),r.jsx("meta",{name:"description",content:l}),r.jsx("meta",{name:"keywords",content:c}),r.jsx("meta",{name:"author",content:"Carnival LDN"}),r.jsx("meta",{name:"robots",content:"index, follow"}),r.jsx("link",{rel:"canonical",href:h}),r.jsx("meta",{property:"og:type",content:f}),r.jsx("meta",{property:"og:url",content:h}),r.jsx("meta",{property:"og:title",content:p}),r.jsx("meta",{property:"og:description",content:l}),r.jsx("meta",{property:"og:image",content:u}),r.jsx("meta",{property:"og:site_name",content:"Carnival LDN"}),r.jsx("meta",{property:"og:locale",content:"en_GB"}),r.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),r.jsx("meta",{name:"twitter:site",content:"@carnivalldn"}),r.jsx("meta",{name:"twitter:title",content:p}),r.jsx("meta",{name:"twitter:description",content:l}),r.jsx("meta",{name:"twitter:image",content:u}),r.jsx("meta",{name:"geo.region",content:"GB-LND"}),r.jsx("meta",{name:"geo.placename",content:"London"}),r.jsx("meta",{name:"geo.position",content:"51.5074;-0.1278"}),r.jsx("meta",{name:"ICBM",content:"51.5074, -0.1278"}),r.jsx("script",{type:"application/ld+json",children:JSON.stringify({"@context":"https://schema.org","@type":"Event",name:"Carnival LDN Events",description:"London's premier professional events company, creating exceptional experiences that elevate your brand and strengthen business relationships.",url:"https://carnivalldn.com",logo:"https://carnivalldn.com/carnival-logo.svg",address:{"@type":"PostalAddress",streetAddress:"123 Event Street",addressLocality:"London",addressCountry:"GB"},contactPoint:{"@type":"ContactPoint",telephone:"+44-20-1234-5678",contactType:"customer service",email:"partnerships@carnivalldn.com"},sameAs:["https://instagram.com/carnivalldn","https://facebook.com/carnivalldn","https://twitter.com/carnivalldn"]})})]})},gh=()=>(O.useEffect(()=>{mi(),Hs("/gallery","Carnival LDN - Gallery")},[]),r.jsxs("div",{className:"relative min-h-screen overflow-hidden",children:[r.jsx(ps,{title:"Gallery",description:"Explore our event gallery showcasing Carnival LDN's most memorable moments.",keywords:"Carnival LDN gallery, event photos, London events gallery"}),r.jsx(gn,{}),r.jsx(mh,{})]})),ph=()=>(O.useEffect(()=>{Hs("/404","Carnival LDN - Page Not Found")},[]),r.jsxs("div",{className:"h-screen md:min-h-screen bg-black flex items-center justify-center px-4 relative overflow-hidden pt-0 md:pt-0",children:[r.jsx("div",{className:"absolute inset-0 opacity-5",children:r.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='1'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})}),r.jsxs("div",{className:"text-center relative z-10 max-w-2xl mx-auto -mt-16 md:mt-0",children:[r.jsx("div",{className:"mb-8 md:mb-12 flex justify-center",children:r.jsx("img",{src:"/carnival-logo-w.svg",alt:"Carnival LDN Logo",className:"w-16 h-16 md:w-24 md:h-24 object-contain"})}),r.jsx("div",{className:"text-6xl md:text-9xl font-bold text-white/30 mb-6 md:mb-8 select-none font-mono",children:"404"}),r.jsx("h1",{className:"text-2xl md:text-5xl font-bold text-white mb-4 md:mb-6 tracking-tight",children:"Page Not Found"}),r.jsx("p",{className:"text-base md:text-xl text-gray-400 mb-8 md:mb-10 max-w-md mx-auto leading-relaxed px-4",children:"The page you're looking for seems to have wandered off to join the carnival elsewhere."}),r.jsxs("div",{className:"flex flex-col gap-3 md:gap-4 justify-center items-center px-4",children:[r.jsx(Wi,{to:"/",className:"w-full max-w-xs md:max-w-none px-8 py-3 md:py-4 bg-white text-black font-semibold rounded-lg hover:bg-gray-100 transform hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl border-2 border-white text-center",children:"Go Home"}),r.jsx(Wi,{to:"/events",className:"w-full max-w-xs md:max-w-none px-8 py-3 md:py-4 border-2 border-white text-white font-semibold rounded-lg hover:bg-white hover:text-black transform hover:scale-105 transition-all duration-200 text-center",children:"Browse Events"})]})]})]})),yh=()=>{const{glitchRef:a,isGlitching:l,glitchType:c}=Sr(),u=[{icon:hs,title:"Information We Collect",content:["Personal information (name, email, phone number) when you contact us or book events","Event preferences and attendance history","Payment information processed securely through Stripe","Website usage data and analytics","Communication preferences and marketing consent"]},{icon:Os,title:"How We Use Your Information",content:["Process event bookings and payments","Send event confirmations and updates","Provide customer support and respond to inquiries","Improve our services and website experience","Send marketing communications (with your consent)","Comply with legal obligations"]},{icon:Ta,title:"Data Storage & Security",content:["Data stored securely on Supabase cloud infrastructure","Encrypted transmission using HTTPS protocols","Regular security audits and updates","Limited access to authorized personnel only","Data retention policies in compliance with GDPR"]},{icon:Qe,title:"Sharing Your Information",content:["We do not sell your personal information","Share with event venues and partners as necessary","Legal requirements and law enforcement","Business transfers (with privacy protection)","Aggregated, anonymized data for analytics"]},{icon:ja,title:"Your Rights & Choices",content:["Access and review your personal data","Request corrections or updates","Opt-out of marketing communications","Request data deletion (subject to legal requirements)","Data portability and transfer rights","Withdraw consent at any time"]}];return r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-black via-gray-900 to-black text-white py-20 px-4",children:[r.jsx(ps,{title:"Privacy Policy",description:"Carnival LDN Privacy Policy - Learn how we collect, use, and protect your personal information. Your privacy is important to us.",keywords:"Carnival LDN privacy policy, data protection, GDPR compliance, London events privacy, personal data security"}),r.jsxs("div",{className:"max-w-4xl mx-auto",children:[r.jsxs(Y.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center mb-16",children:[r.jsx(Y.h1,{ref:a,className:`text-5xl md:text-6xl font-bold mb-6 glitch-text ${l?`glitch-active glitch-${c}`:""}`,"data-text":"PRIVACY POLICY",style:{textTransform:"uppercase",letterSpacing:"0.1em"},children:"PRIVACY POLICY"}),r.jsx(Y.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"Your privacy is important to us. This policy explains how we collect, use, and protect your information."}),r.jsxs(Y.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"text-sm text-gray-400 mt-4",children:["Last updated: ",new Date().toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})]})]}),r.jsxs(Y.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-white/5 border border-white/20 rounded-2xl p-8 mb-12 backdrop-blur-sm",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Introduction"}),r.jsx("p",{className:"text-gray-300 leading-relaxed",children:'Carnival LDN ("we," "our," or "us") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you visit our website, use our services, or attend our events. By using our services, you consent to the data practices described in this policy.'})]}),r.jsx("div",{className:"space-y-8",children:u.map((h,f)=>r.jsxs(Y.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.7+f*.1},className:"bg-white/5 border border-white/20 rounded-2xl p-8 backdrop-blur-sm hover:bg-white/10 transition-all duration-300",children:[r.jsxs("div",{className:"flex items-center mb-6",children:[r.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-lg flex items-center justify-center mr-4",children:r.jsx(h.icon,{className:"w-6 h-6 text-white"})}),r.jsx("h3",{className:"text-2xl font-bold text-white",children:h.title})]}),r.jsx("ul",{className:"space-y-3",children:h.content.map((p,y)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"w-2 h-2 bg-white rounded-full mt-2 mr-3 flex-shrink-0"}),r.jsx("span",{className:"text-gray-300 leading-relaxed",children:p})]},y))})]},h.title))}),r.jsxs(Y.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:1.2},className:"bg-white/5 border border-white/20 rounded-2xl p-8 mt-12 backdrop-blur-sm",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Contact Us"}),r.jsx("p",{className:"text-gray-300 mb-4",children:"If you have any questions about this Privacy Policy or our data practices, please contact us:"}),r.jsxs("div",{className:"space-y-2 text-gray-300",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Email:"})," privacy@carnivalldn.com"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Phone:"})," +44 20 1234 5678"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Address:"})," 123 Event Street, London, UK"]})]})]}),r.jsx(Y.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1.4},className:"text-center mt-12",children:r.jsx("a",{href:"/",className:"inline-flex items-center px-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-white transition-all duration-300 hover:scale-105",children:" Back to Home"})})]})]})},bh=()=>{const{glitchRef:a,isGlitching:l,glitchType:c}=Sr(),u=[{icon:Qe,title:"Acceptance of Terms",content:["By accessing and using Carnival LDN's website and services, you accept and agree to be bound by these terms","If you disagree with any part of these terms, you may not access our services","We reserve the right to modify these terms at any time with notice","Continued use after changes constitutes acceptance of new terms"]},{icon:yt,title:"Event Bookings & Services",content:["Event bookings are confirmed upon receipt of full payment","Cancellation policies vary by event and are clearly stated at booking","We reserve the right to modify or cancel events due to circumstances beyond our control","Refunds are processed according to our cancellation policy","Event details, times, and venues are subject to change with notice"]},{icon:Aa,title:"Payment & Refunds",content:["All payments are processed securely through Stripe","Prices are quoted in British Pounds (GBP) and include applicable taxes","Payment is required in full at the time of booking for paid events","Refund requests must be submitted in writing within specified timeframes","Processing fees may apply to refunds and are non-refundable"]},{icon:Pt,title:"User Conduct & Responsibilities",content:["Attendees must be 18+ years old or accompanied by a legal guardian","Respect venue rules and other attendees","No illegal substances or weapons permitted at events","Photography and recording policies vary by event","Violation of conduct policies may result in removal without refund"]},{icon:cl,title:"Limitation of Liability",content:["Carnival LDN is not liable for personal injury or property damage","We are not responsible for lost or stolen personal items","Maximum liability is limited to the amount paid for the event","Force majeure events may result in event cancellation without liability","Venue-specific risks and requirements are the responsibility of attendees"]},{icon:nn,title:"Intellectual Property",content:["All content on our website is owned by Carnival LDN","Event photography and branding are protected by copyright","Unauthorized use of our intellectual property is prohibited","Attendees may be photographed for promotional purposes","Opt-out requests for photography must be submitted in advance"]}];return r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-black via-gray-900 to-black text-white py-20 px-4",children:[r.jsx(ps,{title:"Terms of Service",description:"Carnival LDN Terms of Service - Read our terms and conditions for using our event services and website.",keywords:"Carnival LDN terms of service, event booking terms, London events terms, party planning terms, event company terms"}),r.jsxs("div",{className:"max-w-4xl mx-auto",children:[r.jsxs(Y.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center mb-16",children:[r.jsx(Y.h1,{ref:a,className:`text-5xl md:text-6xl font-bold mb-6 glitch-text ${l?`glitch-active glitch-${c}`:""}`,"data-text":"TERMS OF SERVICE",style:{textTransform:"uppercase",letterSpacing:"0.1em"},children:"TERMS OF SERVICE"}),r.jsx(Y.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"Please read these terms carefully before using our services. They govern your relationship with Carnival LDN."}),r.jsxs(Y.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"text-sm text-gray-400 mt-4",children:["Last updated: ",new Date().toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})]})]}),r.jsxs(Y.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-white/5 border border-white/20 rounded-2xl p-8 mb-12 backdrop-blur-sm",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Agreement to Terms"}),r.jsx("p",{className:"text-gray-300 leading-relaxed",children:`These Terms of Service ("Terms") govern your use of Carnival LDN's website, services, and events. By accessing or using our services, you agree to be bound by these Terms. If you disagree with any part of these terms, then you may not access our services.`})]}),r.jsx("div",{className:"space-y-8",children:u.map((h,f)=>r.jsxs(Y.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.7+f*.1},className:"bg-white/5 border border-white/20 rounded-2xl p-8 backdrop-blur-sm hover:bg-white/10 transition-all duration-300",children:[r.jsxs("div",{className:"flex items-center mb-6",children:[r.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-lg flex items-center justify-center mr-4",children:r.jsx(h.icon,{className:"w-6 h-6 text-white"})}),r.jsx("h3",{className:"text-2xl font-bold text-white",children:h.title})]}),r.jsx("ul",{className:"space-y-3",children:h.content.map((p,y)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"w-2 h-2 bg-white rounded-full mt-2 mr-3 flex-shrink-0"}),r.jsx("span",{className:"text-gray-300 leading-relaxed",children:p})]},y))})]},h.title))}),r.jsxs(Y.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:1.3},className:"bg-white/5 border border-white/20 rounded-2xl p-8 mt-12 backdrop-blur-sm",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Additional Terms"}),r.jsxs("div",{className:"space-y-4 text-gray-300",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Governing Law:"})," These terms are governed by the laws of England and Wales."]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Dispute Resolution:"})," Any disputes will be resolved through mediation or in the courts of England and Wales."]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Severability:"})," If any provision is found to be unenforceable, the remaining provisions remain in effect."]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Entire Agreement:"})," These terms constitute the entire agreement between you and Carnival LDN."]})]})]}),r.jsxs(Y.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:1.4},className:"bg-white/5 border border-white/20 rounded-2xl p-8 mt-12 backdrop-blur-sm",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Questions About These Terms?"}),r.jsx("p",{className:"text-gray-300 mb-4",children:"If you have any questions about these Terms of Service, please contact us:"}),r.jsxs("div",{className:"space-y-2 text-gray-300",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Email:"})," legal@carnivalldn.com"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Phone:"})," +44 20 1234 5678"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Address:"})," 123 Event Street, London, UK"]})]})]}),r.jsx(Y.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1.6},className:"text-center mt-12",children:r.jsx("a",{href:"/",className:"inline-flex items-center px-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-white transition-all duration-300 hover:scale-105",children:" Back to Home"})})]})]})},wh=()=>{const{glitchRef:a,isGlitching:l,glitchType:c}=Sr(),u=[{icon:dl,title:"Essential Cookies",description:"These cookies are necessary for the website to function properly and cannot be disabled.",examples:["Authentication and security cookies","Shopping cart functionality","Basic website navigation","Payment processing cookies"],duration:"Session or up to 1 year"},{icon:an,title:"Analytics Cookies",description:"These cookies help us understand how visitors interact with our website.",examples:["Google Analytics tracking","Page view and user behavior data","Performance monitoring","Traffic source analysis"],duration:"Up to 2 years"},{icon:hs,title:"Marketing Cookies",description:"These cookies are used to deliver relevant advertisements and track marketing campaigns.",examples:["Social media tracking pixels","Advertising network cookies","Retargeting campaigns","Conversion tracking"],duration:"Up to 1 year"},{icon:Ta,title:"Preference Cookies",description:"These cookies remember your choices and preferences for a better user experience.",examples:["Language preferences","Theme and layout choices","Event preferences","Newsletter subscription status"],duration:"Up to 1 year"}];return r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-black via-gray-900 to-black text-white py-20 px-4",children:[r.jsx(ps,{title:"Cookie Policy",description:"Carnival LDN Cookie Policy - Learn about how we use cookies to enhance your browsing experience and provide personalized content.",keywords:"Carnival LDN cookie policy, website cookies, London events cookies, privacy cookies, cookie management"}),r.jsxs("div",{className:"max-w-4xl mx-auto",children:[r.jsxs(Y.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center mb-16",children:[r.jsx(Y.h1,{ref:a,className:`text-5xl md:text-6xl font-bold mb-6 glitch-text ${l?`glitch-active glitch-${c}`:""}`,"data-text":"COOKIE POLICY",style:{textTransform:"uppercase",letterSpacing:"0.1em"},children:"COOKIE POLICY"}),r.jsx(Y.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"We use cookies to enhance your browsing experience and provide personalized content."}),r.jsxs(Y.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"text-sm text-gray-400 mt-4",children:["Last updated: ",new Date().toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})]})]}),r.jsxs(Y.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-white/5 border border-white/20 rounded-2xl p-8 mb-12 backdrop-blur-sm",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:"What Are Cookies?"}),r.jsx("p",{className:"text-gray-300 leading-relaxed mb-4",children:"Cookies are small text files that are stored on your device when you visit our website. They help us provide you with a better experience by remembering your preferences, analyzing how you use our site, and personalizing content."}),r.jsx("p",{className:"text-gray-300 leading-relaxed",children:"By continuing to use our website, you consent to our use of cookies as described in this policy. You can manage your cookie preferences at any time through your browser settings or our cookie consent tool."})]}),r.jsxs("div",{className:"space-y-8 mb-12",children:[r.jsx(Y.h2,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.7},className:"text-3xl font-bold text-white text-center mb-8",children:"Types of Cookies We Use"}),u.map((h,f)=>r.jsxs(Y.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.8+f*.1},className:"bg-white/5 border border-white/20 rounded-2xl p-8 backdrop-blur-sm hover:bg-white/10 transition-all duration-300",children:[r.jsxs("div",{className:"flex items-center mb-6",children:[r.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-lg flex items-center justify-center mr-4",children:r.jsx(h.icon,{className:"w-6 h-6 text-white"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-2xl font-bold text-white",children:h.title}),r.jsx("p",{className:"text-gray-400 text-sm",children:h.duration})]})]}),r.jsx("p",{className:"text-gray-300 mb-4 leading-relaxed",children:h.description}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("p",{className:"text-sm font-medium text-white mb-2",children:"Examples:"}),r.jsx("ul",{className:"space-y-2",children:h.examples.map((p,y)=>r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"w-2 h-2 bg-white rounded-full mt-2 mr-3 flex-shrink-0"}),r.jsx("span",{className:"text-gray-300 text-sm",children:p})]},y))})]})]},h.title))]}),r.jsxs(Y.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:1.2},className:"bg-white/5 border border-white/20 rounded-2xl p-8 mb-12 backdrop-blur-sm",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Third-Party Cookies"}),r.jsx("p",{className:"text-gray-300 mb-4 leading-relaxed",children:"We work with trusted third-party services that may also place cookies on your device:"}),r.jsxs("div",{className:"space-y-3 text-gray-300",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Google Analytics:"})," Website analytics and performance tracking"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Stripe:"})," Secure payment processing"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Social Media:"})," Social sharing and engagement tracking"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Marketing Tools:"})," Campaign performance and conversion tracking"]})]})]}),r.jsxs(Y.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:1.3},className:"bg-white/5 border border-white/20 rounded-2xl p-8 mb-12 backdrop-blur-sm",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Managing Your Cookie Preferences"}),r.jsxs("div",{className:"space-y-4 text-gray-300",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Browser Settings:"})," You can control cookies through your browser settings. Most browsers allow you to block or delete cookies."]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Cookie Consent Tool:"})," Use our cookie consent tool to manage your preferences for non-essential cookies."]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Opt-Out Links:"})," Some third-party services provide opt-out mechanisms for their cookies."]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Mobile Devices:"})," Cookie settings may vary on mobile devices and apps."]})]})]}),r.jsxs(Y.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:1.4},className:"bg-white/5 border border-white/20 rounded-2xl p-8 mb-12 backdrop-blur-sm",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Impact of Disabling Cookies"}),r.jsx("p",{className:"text-gray-300 leading-relaxed",children:"While you can disable cookies, please note that some features of our website may not function properly without them. Essential cookies are required for basic functionality, and disabling others may affect your user experience."})]}),r.jsxs(Y.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:1.5},className:"bg-white/5 border border-white/20 rounded-2xl p-8 mb-12 backdrop-blur-sm",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Questions About Cookies?"}),r.jsx("p",{className:"text-gray-300 mb-4",children:"If you have any questions about our use of cookies, please contact us:"}),r.jsxs("div",{className:"space-y-2 text-gray-300",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Email:"})," privacy@carnivalldn.com"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Phone:"})," +44 20 1234 5678"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Address:"})," 123 Event Street, London, UK"]})]})]}),r.jsx(Y.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1.7},className:"text-center",children:r.jsx("a",{href:"/",className:"inline-flex items-center px-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-white transition-all duration-300 hover:scale-105",children:" Back to Home"})})]})]})},vh="/assets/halloween-ODBaSmuy.jpg",Nh="/assets/spooky-CsuC7uxA.jpg",Ch=()=>{const[a,l]=O.useState(""),[c,u]=O.useState(""),[h,f]=O.useState(!1),[p,y]=O.useState(""),[v,g]=O.useState(!1),[w,N]=O.useState(null);O.useEffect(()=>{mi(),Hs("/halloween","Carnival LDN - Halloween")},[]);const j=async _=>{if(_.preventDefault(),N(null),!c.trim()){N("Please enter your name");return}if(!a||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)){N("Please enter a valid email");return}f(!0);try{const L=await fetch("/api/halloween-waitlist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,name:c,phone:p||null,source:"halloween-landing"})});let D=null;const P=await L.text();if(P)try{D=JSON.parse(P)}catch{}if(!L.ok)throw new Error(D&&D.error||"Failed to join waitlist");Gs("waitlist_signup","halloween",a),g(!0),l(""),u(""),y("")}catch(L){N((L==null?void 0:L.message)||"Something went wrong")}finally{f(!1)}};return r.jsxs("div",{className:"min-h-screen flex flex-col bg-black",children:[r.jsxs(io,{children:[r.jsx("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),r.jsx("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:""}),r.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Creepster&family=Eater&display=swap",rel:"stylesheet"})]}),r.jsx(ps,{title:"Halloween Waitlist",description:"Register your interest for Carnival LDN Halloween. Drop your email to get first access to tickets.",keywords:"Carnival LDN Halloween, Halloween party London, waitlist"}),r.jsx(gn,{}),r.jsxs("section",{className:"relative flex-1 flex items-center justify-center overflow-hidden pt-20 md:pt-28 pb-16 min-h-[100vh] h-screen",children:[r.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[r.jsxs("picture",{children:[r.jsx("source",{media:"(max-width: 767px)",srcSet:Nh}),r.jsx("img",{src:vh,alt:"Halloween background",className:"w-full h-full object-cover object-center"})]}),r.jsx("div",{className:"absolute inset-0 bg-black/50 md:hidden pointer-events-none"})]}),r.jsxs("div",{className:"relative z-10 w-full max-w-3xl mx-auto px-4 pt-10",children:[r.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 md:-top-16",children:r.jsx("img",{src:"/carntext-b.svg",alt:"Carnival LDN",className:"h-6 md:h-8 w-auto object-contain",style:{filter:"brightness(0) invert(1)"}})}),r.jsxs("div",{className:"text-center mb-6",children:[r.jsx("h1",{className:"text-6xl md:text-8xl font-extrabold text-orange-400 tracking-wider drop-shadow-[0_0_25px_rgba(251,146,60,0.45)]",style:{fontFamily:"Creepster, Eater, ui-sans-serif"},children:"HALLOWEEN"}),r.jsxs("div",{className:"mt-2 text-orange-300",style:{fontFamily:"Eater, Creepster, ui-serif"},children:[r.jsx("span",{className:"inline-block text-2xl md:text-3xl tracking-widest",children:"TRICK"}),r.jsx("span",{className:"inline-block mx-3 text-xl md:text-2xl tracking-widest",children:""}),r.jsx("span",{className:"inline-block text-2xl md:text-2xl tracking-widest",children:"OR"}),r.jsx("span",{className:"inline-block mx-3 text-xl md:text-2xl tracking-widest",children:""}),r.jsx("span",{className:"inline-block text-2xl md:text-3xl tracking-widest",children:"TREAT"})]}),r.jsx("p",{className:"mt-2 text-white/90 max-w-xl mx-auto",children:"Secure your spot early. Waitlisters get priority access and exclusive launch discounts."})]}),r.jsx("div",{className:"glass-card bg-white/10 md:bg-white/70 border-white/60 backdrop-blur-lg",children:v?r.jsxs("div",{className:"p-8 text-center glass-card bg-white/60 md:bg-white/70 border-white/30 backdrop-blur-lg",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Youre on the list "}),r.jsx("p",{className:"mt-2 text-black",children:"Well email you first when tickets drop! Keep an eye on your inbox."}),r.jsx("button",{className:"mt-6 rounded-lg px-6 py-3 font-medium text-white transition-colors border border-orange-600 bg-orange-600 hover:bg-orange-500",onClick:()=>g(!1),children:"Add another email"})]}):r.jsxs("form",{onSubmit:j,className:"p-5 md:p-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[r.jsxs("div",{className:"md:col-span-1",children:[r.jsx("label",{className:"block text-xs font-medium text-white/80 mb-1",children:"Name*"}),r.jsx("input",{type:"text",required:!0,value:c,onChange:_=>u(_.target.value),placeholder:"Your name",className:"w-full rounded-lg border border-gray-200 px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-gray-900/20"})]}),r.jsxs("div",{className:"md:col-span-1",children:[r.jsx("label",{className:"block text-xs font-medium text-white/80 mb-1",children:"Email*"}),r.jsx("input",{type:"email",required:!0,value:a,onChange:_=>l(_.target.value),placeholder:"you@example.com",className:"w-full rounded-lg border border-gray-200 px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-gray-900/20"})]}),r.jsxs("div",{className:"md:col-span-1",children:[r.jsx("label",{className:"block text-xs font-medium text-white/80 mb-1",children:"Phone"}),r.jsx("input",{type:"tel",inputMode:"tel",value:p,onChange:_=>y(_.target.value),placeholder:"07",maxLength:20,className:"w-full rounded-lg border border-gray-200 px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-gray-900/20"})]})]}),w&&r.jsx("div",{className:"mt-3 text-sm text-red-600",children:w}),r.jsx("button",{type:"submit",disabled:h,className:"mt-4 w-full rounded-lg px-6 py-3 font-medium text-white transition-colors border border-orange-600 bg-orange-600 hover:bg-orange-500 disabled:opacity-70",children:h?"Adding you":"Join the waitlist"})]})}),r.jsx("div",{className:"mt-4 text-center text-white text-md",children:r.jsx("p",{children:"Want in early? Share this page with your group!"})})]})]}),r.jsx(yn,{})]})};function Eh(){const{getEvents:a,subscribeToEvents:l}=jr();return O.useEffect(()=>{mi(),Hs("/","Carnival LDN - Home"),a();const c=l();return()=>{c==null||c.unsubscribe()}},[a,l]),r.jsxs("div",{className:"relative min-h-screen overflow-hidden",children:[r.jsx(ps,{title:"Home",description:"Carnival LDN - London's premier professional events company. From club nights to corporate events, Bollywood parties to Diwali celebrations. Creating unforgettable experiences since 2014.",keywords:"Carnival LDN, London events, nightlife London, club nights London, Bollywood parties London, Diwali celebrations London, New Year parties London, corporate events London, private parties London, event planning London, London nightlife, London party planning"}),r.jsx(J0,{}),r.jsx(gn,{}),r.jsx(f0,{}),r.jsx($0,{}),r.jsx(Q0,{}),r.jsx(K0,{}),r.jsx(yn,{})]})}function Ah({children:a}){const{isAuthenticated:l}=jr();return l?r.jsx(r.Fragment,{children:a}):r.jsx(fc,{to:"/admin",replace:!0})}function Sh(){return r.jsx(no,{children:r.jsxs(Cc,{children:[r.jsxs(mc,{children:[r.jsx(zt,{path:"/",element:r.jsx(Eh,{})}),r.jsx(zt,{path:"/events",element:r.jsx(uh,{})}),r.jsx(zt,{path:"/gallery",element:r.jsx(gh,{})}),r.jsx(zt,{path:"/halloween",element:r.jsx(Ch,{})}),r.jsx(zt,{path:"/admin",element:r.jsx(eu,{})}),r.jsx(zt,{path:"/admin/dashboard",element:r.jsx(Ah,{children:r.jsx(ah,{})})}),r.jsx(zt,{path:"/scanner",element:r.jsx(hh,{})}),r.jsx(zt,{path:"/analytics",element:r.jsx(fh,{})}),r.jsx(zt,{path:"/privacy-policy",element:r.jsx(yh,{})}),r.jsx(zt,{path:"/terms-of-service",element:r.jsx(bh,{})}),r.jsx(zt,{path:"/cookie-policy",element:r.jsx(wh,{})}),r.jsx(zt,{path:"*",element:r.jsx(ph,{})})]}),r.jsx(Pc,{}),r.jsx(Yc,{}),r.jsx(Md,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#1f2937",color:"#fff",borderRadius:"8px",padding:"12px 16px",fontSize:"14px",fontWeight:"500"},success:{iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})})}Xn.createRoot(document.getElementById("root")).render(r.jsx(pr.StrictMode,{children:r.jsx(Sh,{})}));
